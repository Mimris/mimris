(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[663],{196:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/modelling",function(){return l(4745)}])},2586:function(e,t,l){"use strict";l.r(t),l.d(t,{admin:function(){return d},fs:function(){return r},gojs:function(){return s},params:function(){return o},relkinds:function(){return n},types:function(){return a},viewkinds:function(){return i}});let o={MEMBERSCALE:"1"},i={OBJ:"Object",AKM:"AkmObject",CONT:"Container",TREE:"Tree",IMAGE:"Image",REL:"Relationship"},n={REL:"Association",GEN:"Generalization",AGGR:"Aggregation",COMP:"Composition"},s={C_CONTAINER:"Container",C_DATATYPE:"Datatype",C_ENUMERATION:"Enumeration",C_FIELDTYPE:"Field type",C_GEOMETRY:"Geometry",C_INPUTPATTERN:"Input pattern",C_LINKEMPLATE:"linkTemplate1",C_METAMODEL:"Metamodel",C_METACONTAINER:"Metacontainer",C_METHOD:"Method",C_METIS:"Metis",C_MODEL:"Model",C_MODELVIEW:"Model view",C_NODETEMPLATE:"textAndIcon",C_AKM_OBJECT:"AKM Object",C_OBJECT:"Object",C_OBJECTTYPE:"Object type",C_OBJECTTYPEVIEW:"Object type view",C_OBJECTTYPEGEO:"Object type geo",C_OBJECTVIEW:"Object view",C_PALETTEGROUP_OBJ:"typeitem",C_PROPERTY:"Property",C_PROPVALUE:"Property value",C_RELATIONSHIP:"Relationship",C_RELSHIPTYPE:"Relationship type",C_RELSHIPTYPEVIEW:"Relationship type view",C_RELSHIPVIEW:"Relationship view",C_UNIT:"Unit",C_UNITCATEGORY:"Unit category",C_VALUE:"Value",C_VIEWFORMAT:"View format",C_VIEWSTYLE:"Viewstyle"},a={AKM_COLLECTION:"Collection",AKM_CONTAINER:"Container",AKM_ENTITY_TYPE:"EntityType",AKM_INFORMATION:"Information",AKM_ROLE:"Role",AKM_TASK:"Task",AKM_VIEW:"View",AKM_PRODUCT:"Product",AKM_ORGANISATION:"Organisation",AKM_PROCESS:"Process",AKM_SYSTEM:"System",AKM_PROPERTY:"Property",AKM_METHOD:"Method",AKM_METHODTYPE:"MethodType",AKM_DATATYPE:"Datatype",AKM_VALUE:"Value",AKM_INPUTPATTERN:"InputPattern",AKM_VIEWFORMAT:"ViewFormat",AKM_FIELDTYPE:"FieldType",AKM_UNIT:"Unit",AKM_LABEL:"Label",AKM_GENERIC:"Generic",AKM_CONTAINS:"contains",AKM_ANNOTATES:"annotates",AKM_HAS_COLLECTION:"has",AKM_HAS_MEMBER:"hasMember",AKM_HAS_PART:"hasPart",AKM_HAS_PROPERTY:"has",AKM_HAS_PROPERTIES:"hasContent",AKM_IS:"Is",AKM_IS_OF_DATATYPE:"isOf",AKM_IS_DEFAULTVALUE:"isDefault",AKM_HAS_METHOD:"has",AKM_HAS_ALLOWED_VALUE:"hasAllowed",AKM_HAS_INPUTPATTERN:"has",AKM_HAS_VIEWFORMAT:"has",AKM_HAS_FIELDTYPE:"has",AKM_POINTS_TO:"pointsTo",AKM_GENERIC_REL:"generic",OBJECTTYPE_ID:"objecttype",OBJECTTYPE:"Object type",OBJECTTYPE_NAME:"Object type",OBJECTTYPE_DESC:"",CONTAINERTYPE_NAME:"Container type",RELATIONSHIPTYPE_ID:"relationshiptype",RELATIONSHIPTYPE:"Relationship type",RELATIONSHIPTYPE_NAME:"My Relationship type",RELATIONSHIPTYPE_DESC:"",MTD_TRAVERSE:"Traverse",MTD_CALCULATEVALUE:"CalculateValue",MTD_AGGREGATEVALUE:"AggregateValue",MTD_GETCONNECTEDOBJECT:"GetConnectedObject",EKA_ELEMENT:"EKA Element",EKA_SPACE:"EKA Space",EKA_OBJECT:"EKA Object",EKA_PROPERTY:"EKA Property",EKA_METHOD:"EKA Method",EKA_ROLE:"EKA Role",EKA_ORIGIN:"Origin",EKA_TARGET:"Target",EKA_RELATIONSHIP:"Relationship",EKA_MEMBER:"Member",EKA_PART:"Part",EKA_DEPENDS_ON:"Depends on",EKA_IS:"Is",EKA_IS_A:"Is a",_EKA_IS:"_is",_EKA_MEMBER:"_member",_EKA_PART:"_part"},r={FS_C_CATEGORIES:"categories",FS_C_DATATYPES:"datatypes",FS_C_ENUMERATIONS:"enumerations",FS_C_METAMODELS:"metamodels",FS_C_MODELS:"models",FS_C_MODELVIEWS:"modelviews",FS_C_OBJECTS:"objects",FS_C_OBJECTTYPES:"objecttypes",FS_C_OBJECTTYPEVIEWS:"objecttypeviews",FS_C_OBJTYPEGEOS:"objtypegeos",FS_C_OBJECTVIEWS:"objectviews",FS_C_PROPERTIES:"properties",FS_C_METHODS:"methods",FS_C_RELATIONSHIPS:"relationships",FS_C_RELSHIPTYPES:"relationshiptypes",FS_C_RELSHIPTYPEVIEWS:"relationshiptypeviews",FS_C_RELSHIPVIEWS:"relationshipviews",FS_C_TYPES:"types",FS_C_UNITS:"units",FS_C_PROPVALUES:"propertyvalues",FS_C_VALUES:"values"},d={AKM_ADMIN_MM:"AKM-ADMIN_MM",AKM_ADMIN_MODEL:"_ADMIN_MODEL",AKM_ADMIN_MODELVIEW:"_ADMIN",AKM_ADMIN_GOMODEL:"_ADMIN_GOMODEL",AKM_PROJECT:"Project",AKM_METAMODEL:"Metamodel",AKM_MODEL:"Model",AKM_MODELVIEW:"Modelview",AKM_HAS_METAMODEL:"has",AKM_HAS_MODEL:"has",AKM_HAS_MODELVIEW:"has",AKM_REFERSTO_METAMODEL:"refersTo",AKM_GENERATEDFROM_MODEL:"generatedFrom",AKM_PROP_METAMODEL_ID:"metamodelId",AKM_PROP_MODEL_ID:"modelId",AKM_PROP_MODELVIEW_ID:"modelviewId"}},8749:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Az:function(){return cxMethodType},DG:function(){return cxObjectTypeView},Dw:function(){return cxViewStyle},IM:function(){return cxRelationshipView},M$:function(){return cxRelationshipType},Nn:function(){return cxModelView},OP:function(){return cxMetis},QN:function(){return cxRelationshipTypeView},Uj:function(){return cxRelationship},ZJ:function(){return cxDatatype},cY:function(){return cxProperty},e9:function(){return cxObject},eK:function(){return cxMetaModel},ho:function(){return cxMethod},m2:function(){return cxObjectType},q6:function(){return cxObjectView},qv:function(){return cxModel},sS:function(){return cxObjtypeGeo},u4:function(){return cxAttribute}});var _ui_methods__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9803);let debug=!1,utils=__webpack_require__(3165),constants=__webpack_require__(2586);class cxMetis{importData(e,t){debug&&console.log("79 importedData",e),this.name=e.name,this.description=e.description,this.initImport(e,t),debug&&console.log("83 importedData, this",e,this);let l=e&&e.projects;if(l&&l.length)for(let o=0;o<l.length;o++){let i=l[o];i&&this.importProject(i),debug&&console.log("90 importData",this)}debug&&console.log("93 Imported project",this);let n=e&&e.metamodels;if(debug&&console.log("120 metamodels",n),n&&n.length)for(let s=0;s<n.length;s++){let a=n[s];a&&this.importMetamodel(a),debug&&console.log("121 metamodel",a,this)}debug&&console.log("124 relshiptypes",this.relshiptypes),debug&&console.log("125 relshiptypeviews",this.relshiptypeviews),debug&&console.log("126 Imported metamodel",this);let r=e&&e.viewstyles;r&&r.length&&r.forEach(e=>{e&&!e.markedAsDeleted&&this.importViewStyle(e,null)});let d=e&&e.geometries;d&&d.length&&d.forEach(e=>{e&&!e.markedAsDeleted&&this.importGeometry(e,null)});let c=e&&e.models;c&&c.length&&c.forEach(e=>{e&&!e.markedAsDeleted&&this.importModel(e)});let p=e&&e.objects;p&&p.length&&p.forEach(e=>{e&&!e.markedAsDeleted&&this.importObject(e,null)});let h=e&&e.relships;if(h&&h.length&&h.forEach(e=>{e&&!e.markedAsDeleted&&this.importRelship(e,null)}),debug&&console.log("174 relships",this.relships),e.currentProjectRef){let u=this.findProject(e.currentProjectRef);u&&(this.currentProject=u)}if(e.currentMetamodelRef){let m=this.findMetamodel(e.currentMetamodelRef);m&&(this.currentMetamodel=m,this.currentMetamodelRef=m.id)}if(e.currentModelRef){let g=this.findModel(e.currentModelRef);g&&(this.currentModel=g,this.currentModelRef=g.id)}if(e.currentModelviewRef){let f=this.findModelView(e.currentModelviewRef);f&&(this.currentModelview=f,this.currentModelviewRef=f.id)}if(e.currentTemplateModelRef){let y=this.findModel(e.currentTemplateModelRef);y&&this.setCurrentTemplateModel(y)}if(e.currentTargetMetamodelRef){let v=this.findMetamodel(e.currentTargetMetamodelRef);v&&this.setCurrentTargetMetamodel(v)}if(e.currentTargetModelRef){let b=this.findModel(e.currentTargetModelRef);b&&this.setCurrentTargetModel(b)}if(e.currentModelviewRef){let w=this.findModelView(e.currentTargetModelviewRef);w&&(this.currentTargetModelview=w)}if(e.currentTaskModelRef){let j=this.findModel(e.currentTaskModelRef);j&&this.setCurrentTaskModel(j)}debug&&console.log("211 this",this);let T=this.objecttypes;for(let k=0;k<(null==T?void 0:T.length);k++){let O=T[k],M=O.findSupertypes(0);for(let D=0;D<(null==M?void 0:M.length);D++){let E=M[D];O.addSupertype(E)}debug&&console.log("184 otype, stypes",O,M)}debug&&console.log("224 this",this);let x=this.objecttypeviews;for(let R=0;R<(null==x?void 0:x.length);R++){let N=x[R];if(N&&N.name===N.id){let A=this.findObjectType(N.typeRef);A&&(N.name=A.name)}}let S=this.metamodels,C=null,P=this.findRelationshipTypeByName(constants.types.AKM_ANNOTATES);if(P){var I;let _=this.findRelationshipTypeView(null===(I=P.typeview)||void 0===I?void 0:I.id);_&&(C=_)}for(let L=0;L<(null==S?void 0:S.length);L++){let V=S[L],F=V.relshiptypes;for(let G=0;G<(null==F?void 0:F.length);G++){let K=F[G];"annotates"===K.name&&(K.typeview=C)}}}initImport(e,t){debug&&console.log("304 importedData",e);let l=e&&e.metamodels,o=[];if(l&&l.length)for(let i=0;i<l.length;i++){let n=l[i];if(t||!n.markedAsDeleted){let s=n&&new cxMetaModel(n.id,n.name,n.description);s.markedAsDeleted=n.markedAsDeleted,s.layout=n.layout,s.routing=n.routing,s.linkcurve=n.linkcurve,s.generatedFromModelRef=n.generatedFromModelRef,s.includeInheritedReltypes=n.includeInheritedReltypes,this.addMetamodel(s);let a=n.datatypes;if(a&&a.length)for(let r=0;r<a.length;r++){let d=a[r];if(t||!d.markedAsDeleted){let c=new cxDatatype(d.id,d.name,d.description);s.addDatatype(c),this.addDatatype(c)}}if((a=n.methodtypes)&&a.length)for(let p=0;p<a.length;p++){let h=a[p];if(t||!h.markedAsDeleted){let u=new cxMethodType(h.id,h.name,h.description);s.addMethodType(u),this.addMethodType(u)}}if((a=n.properties)&&a.length)for(let m=0;m<a.length;m++){let g=a[m];if(t||!g.markedAsDeleted){let f=new cxProperty(g.id,g.name,g.description);if(!f)continue;s.addProperty(f),this.addProperty(f)}}if((a=n.methods)&&a.length)for(let y=0;y<a.length;y++){let v=a[y];if(t||!v.markedAsDeleted){let b=new cxMethod(v.id,v.name,v.description);if(!b)continue;b.methodtype=v.methodtype,b.expression=v.expression,s.addMethod(b),this.addMethod(b)}}if(debug&&console.log("368 this",this),(a=n.objecttypes)&&a.length)for(let w=0;w<a.length;w++){let j=a[w];if(t||!j.markedAsDeleted){let T=new cxObjectType(j.id,j.name,j.description);if(!T)continue;s.addObjectType(T),this.addObjectType(T),debug&&console.log("183 otype",T)}}if((a=n.objtypegeos)&&a.length)for(let k=0;k<a.length;k++){let O=a[k];if(t||!O.markedAsDeleted){let M=new cxObjtypeGeo(O.id,null,null,"","");if(!M)continue;s.addObjtypeGeo(M),this.addObjtypeGeo(M)}}if((a=n.objecttypeviews)&&a.length)for(let D=0;D<a.length;D++){let E=a[D];if(t||!E.markedAsDeleted){let x=new cxObjectTypeView(E.id,E.name,null,E.description);if(!x)continue;s.addObjectTypeView(x),this.addObjectTypeView(x)}}if((a=n.relshiptypes)&&a.length)for(let R=0;R<a.length;R++){let N=a[R];if(t||!N.markedAsDeleted){let A=new cxRelationshipType(N.id,N.name,null,null,N.description);if(!A)continue;s.addRelationshipType(A),this.addRelationshipType(A)}}if(s.relshiptypeviews=[],(a=n.relshiptypeviews).sort(utils.compare),debug&&console.log("421 items",a),a&&a.length){for(let S=0;S<a.length;S++){let C=a[S],P=n[S+1];if((null==P?void 0:P.name)===C.name&&(null==P?void 0:P.typeRef)===C.typeRef){C.markedAsDeleted=!0;continue}}for(let I=0;I<a.length;I++){let _=a[I];if(t||!_.markedAsDeleted){let L=new cxRelationshipTypeView(_.id,_.name,null,_.description);if(!L)continue;s.addRelationshipTypeView(L),this.addRelationshipTypeView(L)}}}if(debug&&console.log("441 relshiptypeviews",s.name,s.relshiptypeviews),(a=n.viewstyles)&&a.length)for(let V=0;V<a.length;V++){let F=a[V];if(t||!F.markedAsDeleted){let G=new cxViewStyle(F.id,F.name,F.description);if(!G)continue;s.addViewStyle(G),this.addViewStyle(G)}}if((a=n.geometries)&&a.length)for(let K=0;K<a.length;K++){let B=a[K];if(t||!B.markedAsDeleted){let U=new cxGeometry(B.id,B.name,B.description);if(!U)continue;s.addGeometry(U),this.addGeometry(U)}}o.push(s)}}this.metamodels=o,debug&&console.log("471 metamodels, mmodels",l,o);let J=e&&e.models;if(J&&J.length)for(let z=0;z<J.length;z++){let H=J[z],W=new cxModel(H.id,H.name,null,H.description);this.addModel(W);let X=e&&e.models;if(X&&X.length)for(let Y=0;Y<X.length;Y++){let Z=X[Y];if(t||!Z.markedAsDeleted){let $=new cxModel(Z.id,Z.name,null,Z.description);if(!$)continue;this.addModel($);let q=Z.objects;if(q&&q.length)for(let Q=0;Q<q.length;Q++){let ee=q[Q];if(t||!ee.markedAsDeleted){let et=new cxObject(ee.id,ee.name,null,ee.description);for(let el in ee)et[el]=ee[el];if(!et)continue;$.addObject(et),this.addObject(et)}}let eo=Z.relships;if(eo&&eo.length)for(let ei=0;ei<eo.length;ei++){let en=eo[ei];if(t||!en.markedAsDeleted){let es=new cxRelationship(en.id,null,null,null,en.name,en.description);if(!es)continue;$.addRelationship(es),this.addRelationship(es)}}let ea=Z.modelviews;if(ea&&ea.length)for(let er=0;er<ea.length;er++){let ed=ea[er];if(t||!ed.markedAsDeleted){debug&&console.log("237 initImport",ed);let ec=new cxModelView(ed.id,ed.name,null,ed.description);if(!ec)continue;ec.layout=ed.layout,ec.routing=ed.routing,ec.linkcurve=ed.linkcurve,ec.showCardinality=ed.showCardinality,ec.showRelshipNames=ed.showRelshipNames,ec.askForRelshipName=ed.askForRelshipName,ec.includeInheritedReltypes=ed.includeInheritedReltypes,$.addModelView(ec),this.addModelView(ec),ec.setModel($);let ep=ed.objectviews;if(ep&&ep.length)for(let eh=0;eh<ep.length;eh++){let eu=ep[eh];if(t||!eu.markedAsDeleted){let em=new cxObjectView(eu.id,eu.name,null,eu.description);if(!em)continue;ec.addObjectView(em),this.addObjectView(em)}}if((ep=ed.relshipviews)&&ep.length)for(let eg=0;eg<ep.length;eg++){let ef=ep[eg];if(t||!ef.markedAsDeleted){let ey=new cxRelationshipView(ef.id,ef.name,null,ef.description);if(!ey)continue;ec.addRelationshipView(ey),this.addRelationshipView(ey)}}}}}}}}importProject(e){let t=e.id,l=this.findProject(t);if(debug&&console.log("360 item",e),l){for(let o in e)l[o]=e[o];debug&&console.log("365 project",l)}}importViewStyle(e,t){let l=this.findViewStyle(e.id);if(debug&&console.log("392 item",e),!l)return;let o=e.objecttypeviews;o&&o.length&&o.forEach(e=>{e&&this.importObjectTypeView(e,l)}),debug&&console.log("402 this",this);let i=e.relshiptypeviews;i&&i.length&&i.forEach(e=>{e&&"undefined_undefined"!==e.name&&this.importRelshipTypeView(e,l)}),this.addViewStyle(l),t&&t.addViewStyle(l),debug&&console.log("412 viewstyle",l)}importGeometry(e,t){let l=this.findGeometry(e.id);debug&&console.log("491 item",e),l&&(this.addGeometry(l),t&&t.addGeometry(l),debug&&console.log("496 geometry",l))}importMetamodel(e){var t,l;let o=this.findMetamodel(e.id);if(!o)return;o.includeInheritedReltypes=e.includeInheritedReltypes,o.includeSystemtypes=e.includeSystemtypes;let i=e.metamodelRefs;i&&i.length&&i.forEach(e=>{if(e){let t=this.findMetamodel(e);t&&o.addMetamodel(t)}});let n=e.datatypes;n&&n.length&&n.forEach(e=>{e&&this.importDatatype(e,o)});let s=e.methodtypes;s&&s.length&&s.forEach(e=>{e&&this.importMethodType(e,o)});let a=e.methods;a&&a.length&&a.forEach(e=>{e&&this.importMethod(e,o)});let r=e.viewstyles;r&&r.length&&r.forEach(e=>{e&&this.importViewStyle(e,o)});let d=e.geometries;d&&d.length&&d.forEach(e=>{e&&this.importGeometry(e,o)}),debug&&console.log("666 this",this);let c=e.objecttypes;c&&c.length&&c.forEach(e=>{if(e){this.importObjectType(e,o);let t=this.findObjectType(e.id);t.removeDuplicateProperties();let l=t.methods;l.forEach(e=>{let l=this.findMethod(e.id);t.addMethod(l)})}});let p=e.objecttypes0;p&&p.length&&p.forEach(e=>{if(e){let t=this.findObjectType(e.id);t||this.addObjectType(e),o.addObjectType0(t)}}),debug&&console.log("695 this",this);let h=e.objtypegeos;h&&h.length&&h.forEach(e=>{e&&this.importObjectTypegeo(e,o)}),debug&&console.log("703 this",this);let u=e.objecttypeviews;u&&u.length&&u.forEach(e=>{e&&this.importObjectTypeView(e,o)});let m=e.relshiptypes;debug&&console.log("361 relshiptypes",m),m&&m.length&&m.forEach(e=>{if(debug&&console.log("371 reltype",e),e){this.importRelshipType(e,o);let t=o.relshiptypes;debug&&console.log("376 reltypes",t),t.forEach(t=>{t.id===e.id&&(t.fromObjtype=e.fromObjtype,t.fromobjtypeRef=e.fromobjtypeRef,t.toObjtype=e.toObjtype,t.toobjtypeRef=e.toobjtypeRef,t.relshipkind=e.relshipkind,t.removeDuplicateProperties(),debug&&console.log("379 rtype",t))})}});let g=e.relshiptypes0;debug&&console.log("736 relshiptypes0",g),g&&g.length&&g.forEach(e=>{if(debug&&console.log("371 reltype0",e),e){let t=this.findRelationshipType(e.id);t||this.addRelationshipType(e),o.addRelationshipType0(t)}}),debug&&console.log("658 metamodel",o);let f=e.relshiptypeviews;f&&f.length&&f.forEach(e=>{e&&"undefined_undefined"!==e.name&&this.importRelshipTypeView(e,o)});let y=o.relshiptypeviews;y.sort(utils.compare);for(let v=0;v<y.length;v++){let b=y[v],w=y[v+1];(null==w?void 0:w.name)===b.name&&(null==w?void 0:w.typeRef)===b.typeRef&&(b.markedAsDeleted=!0)}for(let j=0;j<(null===(t=this.metamodels)||void 0===t?void 0:t.length);j++){let T=this.metamodels[j],k=T.relshiptypes;for(let O=0;O<(null==k?void 0:k.length);O++){let M=k[O],D=this.findRelationshipType(M.id);D&&D.typeview&&(M.typeview=D.typeview)}}{let E=o.relshiptypeviews,x=null===(l=o.relshiptypeviews)||void 0===l?void 0:l.length;for(let R=x-1;R>=0;R--){let N=E[R];N.markedAsDeleted&&E.splice(R,1)}}debug&&console.log("770 rtvs, metamodel",y,o)}importDatatype(e,t){let l=e.id,o=this.findDatatype(l);if(debug&&console.log("412 item",e),o){for(let i in e)o[i]=e[i];debug&&console.log("417 datatype",o),t.addDatatype(o)}}importObjectType(e,t){let l=this.findObjectType(e.id);if(l||(l=new cxObjectType(e.id,e.name,e.description)),l){debug&&console.log("637 item, objtype",e,l),l.markedAsDeleted=e.markedAsDeleted;let o=l;for(let i in e)o[i]=e[i];if(l=o,debug&&console.log("645 item, otype, objtype",e,o,l),e.typeviewRef){let n=this.findObjectTypeView(e.typeviewRef);l&&n&&l.setDefaultTypeView(n),n&&t.addObjectTypeView(n),debug&&console.log("425 objtype, objtypeview",l,n,t)}l&&(t.addObjectType(l),this.addObjectType(l));let s=e.properties;s&&s.length&&s.forEach(e=>{let l=e;l&&this.importProperty(l,t)}),l.attributes=[];let a=l.properties;a&&a.length&&a.forEach(e=>{let t=e,o=l.findAttributeByProperty(t.id);o||(o=new cxAttribute(l,t),l.addAttribute(o))});let r=e.methods;r&&r.length&&r.forEach(e=>{let l=e;l&&this.importMethod(l,t)})}}importRelshipType(e,t){let l=this.findRelationshipType(e.id),o=t.findObjectType(e.fromobjtypeRef),i=t.findObjectType(e.toobjtypeRef);if(debug&&console.log("447 reltype, fromtype, totype: ",l,o,i),l||(o&&i&&(l=new cxRelationshipType(e.id,e.name,o,i,e.description)),t.addRelationshipType(l),o.addOutputreltype(l),i.addInputreltype(l)),debug&&console.log("453 reltype",l),l){l.markedAsDeleted=e.markedAsDeleted;let n=l;for(let s in n)e[s]&&(n[s]=e[s]);if(e.fromobjtypeRef&&e.toobjtypeRef){let a=this.findObjectType(e.fromobjtypeRef),r=this.findObjectType(e.toobjtypeRef);if(l&&a&&(l.setFromObjtype(a),a.addOutputreltype(l)),l&&r&&(l.setToObjtype(r),r.addInputreltype(l)),l&&e.typeviewRef){let d=this.findRelationshipTypeView(e.typeviewRef);if(d)l.setDefaultTypeView(d);else{let c=e.typeviewRef,p=new cxRelationshipTypeView(c,"",l,"");this.addRelationshipTypeView(p),t.addRelationshipTypeView(p),l.typeview=p}}debug&&console.log("472 item, reltype",e,l),debug&&console.log("Importing relshiptype: "+e.id+", "+e.name);let h=e.properties;h&&h.length&&h.forEach(e=>{let l=e;l&&this.importProperty(l,t)})}debug&&console.log("485 reltype",l,t,this)}}importObjectTypeView(e,t){let l=this.findObjectTypeView(e.id),o=e.typeRef,i=this.findObjectType(o);e.template||(e.template=constants.gojs.C_NODETEMPLATE),e.geometry||(e.geometry=""),l&&i&&(l.setMarkedAsDeleted(e.markedAsDeleted),l.setStrokewidth(e.strokewidth),l.setType(i),l.setTemplate(e.template),l.setViewKind(e.viewkind),l.setMemberscale(e.memberscale),l.setGeometry(e.geometry),l.setFigure(e.figure),l.setFillcolor(e.fillcolor),l.setFillcolor2(e.fillcolor2),l.setTextcolor(e.textcolor),l.setTextscale(e.textscale),l.setStrokecolor(e.strokecolor),l.setStrokecolor2(e.strokecolor2),l.setStrokewidth(e.strokewidth),l.setIcon(e.icon),debug&&console.log("222 objtypeview",l,e),t.addObjectTypeView(l),debug&&console.log("Importing objtypeview: "+e.id+", "+e.name))}importObjectTypegeo(e,t){let l=e.typeRef,o=this.findObjectType(l);if(o){let i=this.findObjtypeGeo(e.id);i&&(i.setType(o),i.setMetamodel(t),i.setLoc(e.loc),i.setSize(e.size),t.addObjtypeGeo(i))}}importRelshipTypeView(e,t){let l=this.findRelationshipTypeView(e.id),o=e.typeRef,i=this.findRelationshipType(o);e.template||(e.template=constants.gojs.C_LINKEMPLATE),l&&i&&(l.setMarkedAsDeleted(e.markedAsDeleted),l.setType(i),l.setName(e.name),l.setTemplate(e.template),l.setStrokecolor(e.strokecolor),l.setTextcolor(e.textcolor),l.setStrokewidth(e.strokewidth),l.setDash(e.dash),l.setFromArrow(e.fromArrow),l.setToArrow(e.toArrow),l.setFromArrowColor(e.fromArrowColor),l.setToArrowColor(e.toArrowColor),t.addRelationshipTypeView(l),debug&&console.log("929 item.id, item.name, reltypeview: "+e.id+", "+e.name,l),i.setDefaultTypeView(l))}importProperty(e,t){let l=this.findProperty(e.id);if(l){for(let o in e)e[o]&&(l[o]=e[o]);t.addProperty(l)}}importMethodType(e,t){debug&&console.log("720 item",e);let l=this.findMethodType(e.id);if(l){for(let o in e)e[o]&&(l[o]=e[o]);t.addMethodType(l)}}importMethod(e,t){let l=this.findMethod(e.id);if(l){for(let o in e)e[o]&&(l[o]=e[o]);t.addMethod(l)}}importModel(e){let t=this.findModel(e.id);if(t){let l=this.findMetamodel(e.metamodelRef);if(l){t.setMetamodel(l);let o=e.objects;debug&&console.log("833 model",t),o&&o.length&&o.forEach(e=>{t&&this.importObject(e,t)});let i=e.relships;debug&&console.log("845 relships",i),i&&i.length>0&&i.forEach(e=>{t&&this.importRelship(e,t)});let n=e.modelviews;n&&n.length>0&&(n.sort(utils.compare),n.forEach(e=>{t&&this.importModelView(e,t)})),t.includeRelshipkind=e.includeRelshipkind,t.targetMetamodelRef=e.targetMetamodelRef,t.sourceModelRef=e.sourceModelRef,t.targetModelRef=e.targetModelRef,t.args1=e.args1}debug&&console.log("863 item, model",e,t)}}importObject(e,t){let l=this.findObject(e.id);if(l){let o=this.findObjectType(e.typeRef);debug&&console.log("866 item, obj, objtype",e,l,o),o?(l.setType(o),l.markedAsDeleted=e.markedAsDeleted,l.generatedTypeId=e.generatedTypeId,t&&t.addObject(l)):l.typeName=e.typeName,debug&&console.log("623 model",t)}}importRelship(e,t){if(t){let l=this.findRelationship(e.id);if(debug&&console.log("948 item, rel",e,l),l&&e.typeRef){let o=this.findRelationshipType(e.typeRef),i=this.findObject(e.fromobjectRef),n=this.findObject(e.toobjectRef);o&&i&&n&&(l.setType(o),l.setFromObject(i),l.setToObject(n),i.addOutputrel(l),n.addInputrel(l),l.relshipkind=e.relshipkind,l.cardinality=e.cardinality,l.cardinalityFrom=e.cardinalityFrom,l.cardinalityTo=e.cardinalityTo,l.markedAsDeleted=e.markedAsDeleted,l.generatedTypeId=e.generatedTypeId,t.addRelationship(l),debug&&console.log("966 fromObj, toObj, rel",i,n,l))}else l&&(l.typeName=e.typeName)}}importModelView(e,t){if(t){let l=this.findModelView(e.id);if(l){l.layout=e.layout,l.showCardinality=e.showCardinality,l.showRelshipNames=e.showRelshipNames,l.askForRelshipName=e.askForRelshipName,l.includeInheritedReltypes=e.includeInheritedReltypes,l.viewstyle=this.findViewStyle(e.viewstyleRef),t.addModelView(l);let o=e&&e.objectviews;o.forEach(e=>{e&&(this.importObjectView(e,l),debug&&console.log("630 model",t))});let i=e.relshipviews;debug&&console.log("978 relshipviews",i),i.forEach(e=>{e&&this.importRelshipView(e,l)})}debug&&console.log("641 model",t)}}importObjectView(e,t){if(t){let l=this.findObjectView(e.id);if(l){debug&&console.log("648 item, objview",e,l);let o=this.findObject(e.objectRef);if(o){if(debug&&console.log("651 item.markedAsDeleted",e.markedAsDeleted),l.setObject(o),l.setIcon(e.icon),l.setLoc(e.loc),l.setSize(e.size),l.setScale(e.scale),l.setTextscale(e.textscale),l.setGroup(e.group),l.setIsGroup(e.isGroup),l.setMarkedAsDeleted(e.markedAsDeleted),l.isCollapsed=e.isCollapsed,l.text=e.text,l.modified=!0,debug&&console.log("660 objview",l),e.typeviewRef){let i=this.findObjectTypeView(e.typeviewRef);if(i){l.setTypeView(i);let n=i.getData();for(let s in n)e[s]&&""!==e[s]&&(l[s]=e[s])}}debug&&console.log("672 objview.markedAsDeleted",l.markedAsDeleted,l),o.addObjectView(l),debug&&console.log("675 objview.markedAsDeleted",l.markedAsDeleted,l)}t.removeObjectView(l),debug&&console.log("677 modelview",l.markedAsDeleted,l,t),t.addObjectView(l),debug&&console.log("679 modelview",l.markedAsDeleted,l,t)}}}importRelshipView(e,t){if(t){debug&&console.log("1034 item (relshipview): ",e);let l=this.findRelationshipView(e.id);if(l){let o=this.findRelationship(e.relshipRef);if(o){let i;l.setRelationship(o);let n=t.findObjectView(e.fromobjviewRef),s=t.findObjectView(e.toobjviewRef);if(l.setFromObjectView(n),l.setToObjectView(s),l.textscale=e.textscale,l.arrowscale=e.arrowscale,l.fromArrow=e.fromArrow,l.toArrow=e.toArrow,l.points=e.points,debug&&console.log("1050 relview",l),e.typeviewRef&&(i=this.findRelationshipTypeView(e.typeviewRef))){l.setTypeView(i);let a=i.getData();for(let r in a)e[r]&&""!==e[r]&&(l[r]=e[r],debug&&console.log("1063 prop, relview",r,l[r]))}if(!i){var d,c;if(i=null===(d=l.relship)||void 0===d?void 0:null===(c=d.type)||void 0===c?void 0:c.typeview){l.setTypeView(i);let p=i.getData();for(let h in p)e[h]&&""!==e[h]&&(l[h]=e[h])}}debug&&console.log("1074 relview",l),l.markedAsDeleted=e.markedAsDeleted,debug&&console.log("1076 item, relview: ",e,l),o.addRelationshipView(l),t.addRelationshipView(l),l.template=e.template,debug&&console.log("1078 item, relview: ",e.markedAsDeleted,l.markedAsDeleted),debug&&console.log("1079 item, relview: ",e,l)}}}}addMetamodel(e){if(e.category===constants.gojs.C_METAMODEL){if(null==this.metamodels&&(this.metamodels=[]),this.findMetamodel(e.id)){let t=this.metamodels;for(let l=0;l<t.length;l++){let o=t[l];if(o.id===e.id){t[l]=e;break}}}else this.metamodels.push(e)}}addModel(e){e.category!==constants.gojs.C_MODEL||(null==this.models&&(this.models=[]),this.findModel(e.id)||this.models.push(e))}addModelView(e){e.category!==constants.gojs.C_MODELVIEW||(null==this.modelviews&&(this.modelviews=[]),this.findModelView(e.id)||this.modelviews.push(e))}addDatatype(e){e.category!==constants.gojs.C_DATATYPE||(null==this.datatypes&&(this.datatypes=[]),this.findDatatype(e.id)||this.datatypes.push(e))}addViewStyle(e){e.category!==constants.gojs.C_VIEWSTYLE||(null==this.viewstyles&&(this.viewstyles=[]),this.findViewStyle(e.id)||this.viewstyles.push(e))}addGeometry(e){e.category!==constants.gojs.C_GEOMETRY||(null==this.geometries&&(this.geometries=[]),this.findGeometry(e.id)||this.geometries.push(e))}addViewFormat(e){e.category!==constants.gojs.C_VIEWFORMAT||(null==this.viewformats&&(this.viewformats=[]),this.findViewFormat(e.id)||this.viewformats.push(e))}addFieldType(e){e.category!==constants.gojs.C_FIELDTYPE||(null==this.fieldTypes&&(this.fieldTypes=[]),this.findFieldType(e.id)||this.fieldTypes.push(e))}addInputPattern(e){e.category!==constants.gojs.C_INPUTPATTERN||(null==this.inputpatterns&&(this.inputpatterns=[]),this.findInputPattern(e.id)||this.inputpatterns.push(e))}addEnumeration(e){e.category===constants.gojs.C_ENUMERATION&&(null==this.enumerations&&(this.enumerations=[]),this.enumerations.push(e))}addUnit(e){e.category===constants.gojs.C_UNIT&&(null==this.units&&(this.units=[]),this.units.push(e))}addUnitCategory(e){e.category===constants.gojs.C_UNITCATEGORY&&(null==this.categories&&(this.categories=[]),this.categories.push(e))}addProperty(e){if(e&&e.category===constants.gojs.C_PROPERTY){var t;let l=[],o=null===(t=this.properties)||void 0===t?void 0:t.length;if(o){let i=!1;for(let n=0;n<o;n++){let s=this.properties[n];s&&(s.id===e.id?(l.push(e),i=!0):l.push(s))}i||l.push(e)}else l.push(e);this.properties=l}}addMethodType(e){if(e&&e.category===constants.gojs.C_METHODTYPE){var t;let l=[],o=null===(t=this.methodtypes)||void 0===t?void 0:t.length;if(o){let i=!1;for(let n=0;n<o;n++){let s=this.methodtypes[n];s&&(s.id===e.id?(l.push(e),i=!0):l.push(s))}i||l.push(e)}else l.push(e);this.methodtypes=l}}addMethod(e){if(e&&e.category===constants.gojs.C_METHOD){var t;let l=[],o=null===(t=this.methods)||void 0===t?void 0:t.length;if(o){let i=!1;for(let n=0;n<o;n++){let s=this.methods[n];s&&(s.id===e.id?(l.push(e),i=!0):l.push(s))}i||l.push(e)}else l.push(e);this.methods=l}}addObjectType(e){e.category!==constants.gojs.C_OBJECTTYPE||(null==this.objecttypes&&(this.objecttypes=[]),this.findObjectType(e.id)||this.objecttypes.push(e))}addRelationshipType(e){e.category===constants.gojs.C_RELSHIPTYPE&&(null==this.relshiptypes&&(this.relshiptypes=[]),!this.findRelationshipType(e.id)&&(this.relshiptypes.push(e),debug&&console.log("1438 Add reltype",e)))}addObjectTypeView(e){if(e.category===constants.gojs.C_OBJECTTYPEVIEW){if(null==this.objecttypeviews&&(this.objecttypeviews=[]),this.findObjectTypeView(e.id)){let t=this.objecttypeviews.length;for(let l=0;l<t;l++){let o=this.objecttypeviews[l];if(debug&&console.log("1355 objview",o),o.id===e.id){for(let i in e)o[i]=e[i];debug&&console.log("1361 objview",o);return}}}else this.objecttypeviews.push(e)}}addRelationshipTypeView(e){if(e.category===constants.gojs.C_RELSHIPTYPEVIEW){if(null==this.relshiptypeviews&&(this.relshiptypeviews=[]),this.findRelationshipTypeView(e.id)){let t=this.relshiptypeviews.length;for(let l=0;l<t;l++){let o=this.relshiptypeviews[l];if(debug&&console.log("1378 rtview",o),o.id===e.id){for(let i in e)"id"!==i&&"name"!==i&&"data"!==i&&"typeRef"!==i&&(o[i]=e[i],o.data[i]=e[i]);debug&&console.log("1387 rtview",o);break}}}else this.relshiptypeviews.push(e)}}addObjtypeGeo(e){e.category!==constants.gojs.C_OBJECTTYPEGEO||(null==this.objtypegeos&&(this.objtypegeos=[]),this.findObjtypeGeo(e.id)||this.objtypegeos.push(e))}addObject(e){e.category!==constants.gojs.C_OBJECT||(null==this.objects&&(this.objects=[]),this.findObject(e.id)||(debug&&console.log("863 addObject:",e),this.objects.push(e)))}addRelationship(e){e.category!==constants.gojs.C_RELATIONSHIP||(null==this.relships&&(this.relships=[]),this.findRelationship(e.id)||this.relships.push(e))}addObjectView(e){if(e.category===constants.gojs.C_OBJECTVIEW){if(null==this.objectviews&&(this.objectviews=[]),this.findObjectView(e.id)){let t=this.objectviews.length;for(let l=0;l<t;l++){let o=this.objectviews[l];if(debug&&console.log("1355 objview",o),o.id===e.id){for(let i in e)o[i]=e[i];debug&&console.log("1361 objview",o);return}}}else this.objectviews.push(e)}}addRelationshipView(e){e.category!==constants.gojs.C_RELSHIPVIEW||(null==this.relshipviews&&(this.relshipviews=[]),this.findRelationshipView(e.id)||this.relshipviews.push(e))}setGojsModel(e){this.gojsModel=e}getGojsModel(){return this.gojsModel}getMetamodels(){return this.metamodels}getModels(){return this.models}getModelsByMetamodel(e,t){let l=[],o=this.models;for(let i=0;i<o.length;i++){let n=o[i],s=n.metamodel;t||!s||s.isDeleted()||s.id!==e.id||l.push(n)}return l}getModels2(e){if(e||!this.models)return this.models;{let t=[];for(let l=0;l<this.models.length;l++){let o=this.models[l];o.isDeleted()||t.push(o)}return t}}getTemplateModels(){let e=[],t=this.models;if(t){let l=t.length;for(let o=0;o<l;o++){let i=t[o];utils.objExists(i)&&i.getIsTemplate()&&e.push(i)}}return e}getModelViews(){return this.modelviews}getModelViewsByModel(e){let t=[];if(e){let l=this.modelviews;if(l){let o=l.length;for(let i=0;i<o;i++){let n=l[i];if(n){let s=n.getModel();s&&e.getName()===s.getName()&&t.push(n)}}}}return t}getTemplateModelviewByName(e){if(e&&e.length>0){let t=this.modelviews;if(t){let l=t.length;for(let o=0;o<l;o++){let i=t[o];if(i&&i.getName()===e&&i.getIsTemplate())return i}}}return null}getTemplateModelviews(){let e=[],t=this.modelviews;if(t){let l=t.length;for(let o=0;o<l;o++){let i=t[o];i&&i.getIsTemplate()&&e.push(i)}}return e}getDatatypes(){return this.datatypes}getViewFormats(){return this.viewformats}getFieldTypes(){return this.fieldTypes}getInputPatterns(){return this.inputpatterns}getEnumerations(){return this.enumerations}getUnits(){return this.units}getUnitCategories(){return this.categories}getProperties(){return this.properties}getMethodTypes(){return this.methodtypes}getMethods(){return this.methods}getObjectTypes(){return this.objecttypes}getRelationshipTypes(){return this.relshiptypes}getObjectTypeViews(){return this.objecttypeviews}getObjtypeGeos(){return this.objtypegeos}getRelshipTypes(){return this.relshiptypes}getRelationshipTypeViews(){return this.relshiptypeviews}getObjects(){return this.objects}getObjectsByType(e,t){let l=[];if(this.objects)for(let o=0;o<this.objects.length;o++){let i=this.objects[o];if(i&&!i.markedAsDeleted){let n=i.type;n&&n.id===e.id&&l.push(i)}}return l}getRelationships(){return this.relships}getRelationshipsByType(e,t){let l=[];if(this.relships)for(let o=0;o<this.relships.length;o++){let i=this.relships[o];if(i&&!i.markedAsDeleted){let n=i.type;n&&n.id===e.id&&l.push(i)}}return l}getRelationshipsByGeneratedTypeId(e){let t=[];if(this.relships)for(let l=0;l<this.relships.length;l++){let o=this.relships[l];o&&!o.markedAsDeleted&&o.generatedTypeId===e&&t.push(o)}return t}getObjectViews(){return this.objectviews}getObjectViewsByObject(e){let t=this.objectviews,l=[];for(let o=0;o<t.length;o++){let i=t[o];if(i){let n=i.object;n&&n.id===e&&l.push(i)}}return l}getRelationshipViews(){return this.relshipviews}getRelationshipViewsByRelship(e){let t=this.relshipviews,l=[];for(let o=0;o<t.length;o++){let i=t[o];if(i){let n=i.relship;n&&n.id===e&&l.push(i)}}return l}findItem(e,t){let l=null;switch(e){case"metamodels":l=this.findMetamodel(t);break;case"datatypes":l=this.findDatatype(t);break;case"objecttypes":l=this.findObjectType(t);break;case"relationshiptypes":l=this.findRelationshipType(t);break;case"properties":l=this.findProperty(t);break;case"methods":l=this.findMethod(t);break;case"objecttypeviews":l=this.findObjectTypeView(t);break;case"relationshiptypeviews":l=this.findRelationshipTypeView(t);break;case"models":l=this.findModel(t);break;case"objects":l=this.findObject(t);break;case"relationships":l=this.findRelationship(t);break;case"objectviews":l=this.findObjectView(t);break;case"relationshipviews":l=this.findRelationshipView(t)}return l}findDatatype(e){let t=this.getDatatypes();if(t){let l=0;for(;l<t.length;){let o=t[l];if(o&&o.id===e)return o;l++}}return null}findViewStyle(e){let t=this.viewstyles;if(t){let l=0;for(;l<t.length;){let o=t[l];if(o&&o.id===e)return o;l++}}return null}findViewStyleByName(e){let t=this.viewstyles;if(!t)return null;let l=0,o=null;for(;l<t.length;){let i=(o=t[l]).getName();if(i.toLowerCase()===i.toLowerCase())return o;l++}return null}findGeometry(e){let t=this.geometries;if(t){let l=0;for(;l<t.length;){let o=t[l];if(o&&o.id===e)return o;l++}}return null}findGeometryByName(e){let t=this.geometries;if(!t)return null;let l=0,o=null;for(;l<t.length;){let i=(o=t[l]).getName();if(i.toLowerCase()===i.toLowerCase())return o;l++}return null}findViewFormat(e){let t=this.getViewFormats();if(t){let l=0;for(;l<t.length;){let o=t[l];if(o&&o.id===e)return o;l++}}return null}findFieldType(e){let t=this.getFieldTypes();if(t){let l=0;for(;l<t.length;){let o=t[l];if(o&&o.id===e)return o;l++}}return null}findInputPattern(e){let t=this.getInputPatterns();if(t){let l=0;for(;l<t.length;){let o=t[l];if(o&&o.id===e)return o;l++}}return null}findDatatypeByName(e){let t=this.getDatatypes();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l]).getName().toLowerCase()===e.toLowerCase())return o;l++}}return null}findEnumeration(e){let t=this.getEnumerations();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l]).id===e)return o;l++}}return null}findProject(e){let t=this.projects;if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findMetamodel(e){let t=this.getMetamodels();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findMetamodelByName(e){let t=this.getMetamodels();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l]).getName()===e)return o;l++}}return null}findModel(e){let t=this.getModels();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findModelView(e){let t=this.getModelViews();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findModelByName(e){let t=this.getModels();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l]).getName()===e)return o;l++}}return null}findModelsByName(e){let t=[],l=this.getModels();if(!l)return null;{let o=0,i=null;for(;o<t.length;)(i=t[o]).getName()===e&&t.push(i),o++;return t}}findModelByMetamodelAndName(e,t){let l=this.getModels();if(l){let o=0,i=null;for(;o<l.length;){if((i=l[o]).metamodel.id===e.id&&i.getName()===t)return i;o++}}return null}findObjectType(e){let t=this.getObjectTypes();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findObjectTypeByName(e){let t=this.getObjectTypes();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l]).getName()===e)return o;l++}}return null}findObjectTypeView(e){let t=this.getObjectTypeViews();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findObjtypeGeo(e){let t=this.getObjtypeGeos();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findObject(e){let t=this.getObjects();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findObjectByTypeAndName(e,t){let l=this.getObjects();if(l&&utils.objExists(e)){let o=e.id,i=0,n=null;for(;i<l.length;){if(n=l[i],debug&&console.log(n),n){let s=n.getType();if(s&&s.id===o&&n.getName()===t)return n}i++}}return null}findObjectView(e){let t=this.getObjectViews();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findProperty(e){let t=this.getProperties();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findPropertyByName(e){let t=this.getProperties();if(t){let l=0,o=null;for(;l<t.length;)if(!(o=t[l]).isDeleted()){if(o.name===e)return o;l++}}return null}findMethodType(e){let t=this.getMethodTypes();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findMethodTypeByName(e){let t=this.getMethodTypes();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.getName()===e)return o;return null}findMethod(e){let t=this.getMethods();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findMethodByName(e){let t=this.getMethods();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.getName()===e)return o;return null}findRelationshipType(e){let t=this.relshiptypes;if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findRelationshipTypesByName(e){let t=this.getRelshipTypes();if(!t)return null;let l=[],o=0,i=null;for(o=0;o<t.length;o++)(i=t[o]).isDeleted()||i.getName()!==e||l.push(i);return l}findRelationshipTypeByName(e){let t=this.getRelationshipTypes();if(t){let l=0,o=null;for(;l<t.length;)if(!(o=t[l]).isDeleted()){if(o.getName()===e)return o;l++}}return null}findRelationshipTypeByName1(e,t,l){let o=this.getRelationshipTypes();if(o)for(let i=0;i<o.length;i++){let n=o[i];if(!n.isDeleted()&&n.getName()===e){var s,a;if((null===(s=n.fromObjtype)||void 0===s?void 0:s.id)===(null==t?void 0:t.id)&&(null===(a=n.toObjtype)||void 0===a?void 0:a.id)===(null==l?void 0:l.id))return n}}return null}findRelationshipTypeByName2(e,t,l){let o=this.getRelationshipTypes();if(debug&&console.log("2171 types",o.length,o),o){let i=null;for(let n=0;n<o.length;n++)if(i=o[n],debug&&console.log("2178 reltype",i,t,l),!i.isDeleted()&&i.getName()===e&&(debug&&console.log("2181 reltype",i,t,l),i.isAllowedFromType(t,this.objecttypes,this.relshiptypes)&&(debug&&console.log("2183 reltype",i.name,t.name),i.isAllowedToType(l,this.objecttypes,this.relshiptypes))))return debug&&console.log("2185 reltype",i.name,l.name),i}return null}findRelationshipTypeByNames(e,t,l){let o=this.getRelshipTypes();if(!o)return null;let i=0,n=null;for(i=0;i<o.length;i++)if(!(n=o[i]).isDeleted()&&n.getName()===e){let s=n.getFromObjType(),a=n.getToObjType();if(s&&a&&s.getName()===t&&a.getName()===l)return n}return null}findRelationshipTypesBetweenTypes(e,t){if(!e||!t)return null;let l=[],o=this.getRelationshipTypes();if(!o)return null;{let i,n=0;for(n=0;n<o.length;n++)if((i=o[n]).name,i){if(i.isDeleted())continue;debug&&console.log("1528 fromType",e),i.getRelshipKind()!==constants.relkinds.GEN&&(debug&&console.log("1530 reltype",i.name),i.isAllowedFromType(e,this.objecttypes,this.relshiptypes)&&(debug&&console.log("1556 reltype",i.name,e.name),i.isAllowedToType(t,this.objecttypes,this.relshiptypes)&&(debug&&console.log("1558 reltype",i.name,t.name),l.push(i))))}}return l}findRelationshipTypeView(e){let t=this.relshiptypeviews;if(t){let l=0;for(;l<t.length;){let o=t[l];if(o&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findRelationship(e){let t=this.getRelationships();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findRelationshipView(e){let t=this.getRelationshipViews();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findSubMetamodel(e){let t=this.getMetamodels();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l]).id===e)return o;l++}}return null}findUnit(e){let t=this.getUnits();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l]).id===e)return o;l++}}return null}findUnitByName(e){let t=this.getUnits();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l]).getName().toLowerCase()===e.toLowerCase())return o;l++}}return null}findUnitCategory(e){if(utils.isArrayEmpty(this.getUnitCategories()));else{let t=0,l=null,o=this.getUnitCategories();if(o)for(;t<o.length;){if((l=o[t])&&(l.id===e||l.getFirestoreId()===e))return l;t++}}return null}findUnitCategoryByName(e){let t=this.getUnitCategories();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l]).getName().toLowerCase()===e.toLowerCase())return o;l++}}return null}setCurrentModelview(e){this.currentModelview=e}getCurrentModelview(){return this.currentModelview}setCurrentModel(e){this.currentModel=e}getCurrentModel(){return this.currentModel}setCurrentTemplateModel(e){this.currentTemplateModel=e}getCurrentTemplateModel(){return this.currentTemplateModel}setCurrentMetamodel(e){this.currentMetamodel=e,this.currentMetamodelRef=null==e?void 0:e.id}getCurrentMetamodel(){return this.currentMetamodel}setCurrentTargetMetamodel(e){this.currentTargetMetamodel=e,this.currentTargetMetamodelRef=e.id}getcurrentTargetMetamodel(){return this.currentTargetMetamodel}setCurrentTargetModel(e){this.currentTargetModel=e,this.currentTargetModelRef=e.id}getCurrentTargetModel(){return this.currentTargetModel}setCurrentTargetModelview(e){this.currentTargetModelview=e}getCurrentTargetModelview(){return this.currentTargetModelview}setCurrentTaskModel(e){this.currentTaskModel=e,this.currentTaskModelRef=e.id}getCurrentTaskModel(){return this.currentTaskModel}isAdminType(e){return!!e&&("Project"===e.name||"Metamodel"===e.name||"Model"===e.name||"Modelview"===e.name)}constructor(){this.metamodels=null,this.models=null,this.modelviews=null,this.datatypes=null,this.inputpatterns=null,this.viewformats=null,this.fieldTypes=null,this.enumerations=null,this.units=null,this.categories=null,this.properties=null,this.methods=null,this.methodtypes=null,this.objecttypes=null,this.relshiptypes=null,this.objecttypeviews=null,this.objtypegeos=null,this.relshiptypeviews=null,this.objects=null,this.relships=null,this.objectviews=null,this.relshipviews=null,this.gojsModel=null,this.currentProject=null,this.currentMetamodel=null,this.currentMetamodelRef=null,this.currentModel=null,this.currentModelRef=null,this.currentModelview=null,this.currentModelviewRef=null,this.currentTargetMetamodel=null,this.currentTargetModel=null,this.currentTargetModelview=null,this.currentTemplateMetamodel=null,this.currentTemplateModel=null,this.currentTemplateModelview=null,this.currentTaskModel=null,this.selectedData=null,this.pasteViewsOnly=!1,this.deleteViewsOnly=!1,this.pasted=!1,this.modelType="",this.id=utils.createGuid(),this.name="",this.description="",this.viewstyles=[],this.geometries=[],this.category="Metis",this.fromNodes=[]}}class cxMetaObject{getNameId(){let e=this.name;return e.replace(/ /g,"_").replace(/./g,"_"),e}getId(){return this.id?this.id:""}getCategory(){return this.category}setCategory(e){this.category=e}setName(e){this.name=e}getName(){return this.name?this.name:""}setDescription(e){this.description=e}getDescription(){return this.description?this.description:""}setMarkedAsDeleted(e){this.markedAsDeleted=e}getMarkedAsDeleted(){return this.markedAsDeleted}setDeleted(e){this.markedAsDeleted=e}isDeleted(){return this.markedAsDeleted}setModified(){this.modified=!0}clearModified(){this.modified=!1}isModified(){return this.modified}setFirestoreCollection(e){this.fs_collection=e}getFirestoreCollection(){return this.fs_collection}getFirestoreId(){return null}constructor(e,t,l){this.fs_collection="",this.id=e,this.name=t,this.nameId=t,this.category="",this.sourceUri="",this.markedAsDeleted=!1,this.modified=!1,null==t&&(this.name=e),null==l?this.description="":this.description=l}}class cxProject extends cxMetaObject{addMetamodel(e){if(e.category===constants.gojs.C_METAMODEL){if(null==this.metamodels&&(this.metamodels=[]),this.findMetamodel(e.id)){let t=this.metamodels;for(let l=0;l<t.length;l++){let o=t[l];if(o.id===e.id){t[l]=e;break}}}else this.metamodels.push(e)}}addModel(e){e.category!==constants.gojs.C_MODEL||(null==this.models&&(this.models=[]),this.findModel(e.id)||this.models.push(e))}findMetamodel(e){let t=this.metamodels;if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findModel(e){let t=this.models;if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}constructor(e,t,l){super(e,t,l),this.metamodels=null,this.models=null}}class cxDatatype extends cxMetaObject{addAllowedValue(e){let t=0;utils.objExists(this.allowedValues)&&(t=this.allowedValues.length),0==t?(this.allowedValues=[],this.allowedValues.push(e)):utils.nameExistsInNames(this.allowedValues,e)||this.allowedValues.push(e)}getAllowedValues(){return this.allowedValues}setDefaultValue(e){this.defaultValue=e}getDefaultValue(){return this.defaultValue}setValue(e){this.value=e}getValue(){return this.value}setIsOfDatatype(e){this.isOfDatatype=e}getIsOfDatatype(){return this.isOfDatatype}setInputPattern(e){this.inputPattern=e}getInputPattern(){return this.inputPattern}setViewFormat(e){this.viewFormat=e}getViewFormat(){return this.viewFormat}setFieldType(e){this.fieldType=e}getFieldType(){return this.fieldType}setPointerType(e){this.pointerType=e}getPointerType(){return this.pointerType}setPointerCriteria(e){this.pointerCriteria=e}getPointerCriteria(){return this.pointerCriteria}constructor(e,t,l){super(e,t,l),this.fs_collection=constants.fs.FS_C_DATATYPES,this.category=constants.gojs.C_DATATYPE,this.isOfDatatype=null,this.inputPattern="",this.viewFormat="",this.fieldType="text",this.allowedValues=null,this.defaultValue="",this.value="",this.pointerType=null,this.pointerCriteria="",debug&&console.log("1915 datatype: ",this)}}class cxUnitCategory extends cxMetaObject{addUnit(e){e.category===constants.gojs.C_UNIT&&(null==this.units&&(this.units=[]),this.units.push(e))}constructor(e,t,l){super(e,t,l),this.fs_collection=constants.fs.FS_C_CATEGORIES,this.category=constants.gojs.C_UNITCATEGORY,this.units=null}}class cxUnit extends cxMetaObject{setUnitCategory(e){utils.objExists(e)&&e.category===constants.gojs.C_UNITCATEGORY&&(this.unitCategory=e)}getUnitCategory(){return this.unitCategory}constructor(e,t,l){super(e,t,l),this.fs_collection=constants.fs.FS_C_UNITS,this.unitCategory=null}}class cxEnumeration extends cxMetaObject{addEnum(e){utils.objExists(e)&&(null==this.enumvalues&&(this.enumvalues=[]),this.enumvalues.push(e))}enumValueExists(e){if(utils.isArrayEmpty(this.enumvalues));else{let t=0,l=null;for(;t<this.enumvalues.length;){if((l=this.enumvalues[t]).id===e)return!0;t++}}return!1}constructor(e,t,l){super(e,t,l),this.fs_collection=constants.fs.FS_C_ENUMERATIONS,this.category=constants.gojs.C_ENUMERATION,this.enumvalues=null}}class cxMethodType extends cxMetaObject{addProperty(e){if(e&&e.category===constants.gojs.C_PROPERTY){var t;let l=[],o=null===(t=this.properties)||void 0===t?void 0:t.length;if(o){let i=!1;for(let n=0;n<o;n++){let s=this.properties[n];s&&(s.id===e.id?(l.push(e),i=!0):l.push(s))}i||l.push(e)}else l.push(e);this.properties=l}}findProperty(e){let t=this.properties;if(!t)return null;let l=t.length,o=0;for(;o<l;){if(t[o].id===e)return t[o];o++}return null}findPropertyByName(e){let t=this.properties;if(!t)return null;{let l=t.length,o=0;for(;o<l;){var i;if((null===(i=t[o])||void 0===i?void 0:i.name)===e)return t[o];o++}return null}}getProperties(){return this.properties,debug&&console.log("2560 properties",this.properties),this.properties}hasProperties(){return!!this.properties&&!utils.isArrayEmpty(this.properties)}constructor(e,t,l){super(e,t,l),this.category=constants.gojs.C_METHODTYPE,this.properties=null}}class cxMetaModel extends cxMetaObject{clearContent(){this.metamodels=null,this.viewstyle=null,this.viewstyles=[],this.geometries=[],this.containers=null,this.properties=null,this.methods=null,this.methodtypes=null,this.enumerations=null,this.units=null,this.datatypes=null,this.categories=null,this.generatedFromModelRef="",this.isEKA=!1,this.layout="ForceDirected",this.routing="Normal",this.linkcurve="None",this.includeInheritedReltypes=!1,this.includeSystemtypes=!1,this.objecttypes=null,this.objecttypes0=null,this.objtypegeos=null,this.objecttypeviews=null,this.relshiptypes=null,this.relshiptypes0=null,this.relshiptypeviews=null}getLoc(e){let t="";if(utils.objExists(e)){let l=this.objtypegeos;if(l){let o=null;for(let i=0;i<l.length;i++){if((o=l[i])&&o){let n=o.type;if(n&&n.id===e.id){t=o.loc;break}}o||(o=this.setLoc(e,""),t="")}}}return t}setLoc(e,t){let l=null;if(utils.objExists(e)){let o=this.objtypegeos;if(o){for(let i=0;i<o.length;i++)if(l=o[i]){let n=l.type;if(n&&n.id===e.id){l.loc=t;break}}}else l=new cxObjtypeGeo(utils.createGuid(),this,e,t,""),this.addObjtypeGeo(l)}return l}getSize(e){let t="";if(e){let l=this.objtypegeos;if(l){let o=null;for(let i=0;i<l.length;i++)if(o=l[i]){let n=o.type;if(n&&n.id===e.id){t=o.size;break}}}}return t}setSize(e,t){let l=null;if(void 0==t&&(t=""),e){let o=this.objtypegeos;if(o){for(let i=0;i<o.length;i++)if(l=o[i]){let n=l.type;if(n&&n.id===e.id){l.size=t;break}}}else l=new cxObjtypeGeo(utils.createGuid(),this,e,"",t),this.addObjtypeGeo(l)}return l}setGeometries(e){this.geometries=e}close(){this.metamodels=null,this.objecttypes=null,this.properties=null,this.enumerations=null,this.units=null,this.datatypes=null,this.categories=null,this.description="",this.name="",this.id=""}send(){let e="Metamodel<br>";if(e+="id: "+this.id+"<br>name: "+this.name+"<br>",this.description.length>0&&(e+="description: "+this.description+"<br>"),this.objecttypes){let t=this.objecttypes.length;t>0&&(e+="Object types:<br>");for(let l=0;l<t;l++)e+=this.sendItem(this.objecttypes[l])}return e}sendItem(e){let t="    id: "+e.id+"<br>";return t+="    name: "+e.name+"<br>",e.description.length>0&&(t+="    description: "+e.description+"<br>"),t}getCategories(){return this.categories}getDatatypes(){return this.datatypes}getViewStyles(){return this.viewstyles}getGeometries(){return this.geometries}getViewFormats(){return this.viewformats}getFieldTypes(){return this.fieldTypes}getInputPatterns(){return this.inputpatterns}getEnumerations(){return this.enumerations}getObjtypeNames(){let e=[],t=this.getObjectTypes();if(t)for(let l=0;l<t.length;l++){let o=t[l],i=o.getName();utils.nameExistsInNames(e,i)||e.push(i)}return e}getObjectTypes(){return this.objecttypes}getObjectTypes0(){return this.objecttypes0}getObjectTypeViews(){return this.objecttypeviews}getObjtypeGeos(){return this.objtypegeos}getProperties(){return this.properties}getMethods(){return this.methods}getMethodTypes(){return this.methodtypes}getReltypeNames(e){let t=[],l=this.getRelshipTypes();if(l){for(let o=0;o<l.length;o++){let i=l[o];if(e&&i.getRelshipKind()===constants.relkinds.GEN)continue;let n=i.getName();utils.nameExistsInNames(t,n)||t.push(n)}t.sort()}return t}getEkaReltypeNames(){let e=[],t=this.getObjectTypes();if(t){for(let l=0;l<t.length;l++){let o=t[l];if(o.getViewKind()!==constants.viewkinds.REL)continue;let i=o.getName();utils.nameExistsInNames(e,i)||e.push(i)}e.sort()}return e}getRelshipTypes(){return this.relshiptypes}getRelshipTypes0(){return this.relshiptypes0}getRelshipTypeViews(){return this.relshiptypeviews}getSubMetamodels(){return this.metamodels}getMetaContainers(){return this.containers}getUnits(){return this.units}addMetamodel(e){e.category!==constants.gojs.C_METAMODEL||(null==this.metamodels&&(this.metamodels=[]),this.findSubMetamodel(e.id)||this.metamodels.push(e))}addDatatype(e){if(e.category===constants.gojs.C_DATATYPE){if(null==this.datatypes&&(this.datatypes=[]),this.findDatatype(e.id)){let t=this.datatypes;for(let l=0;l<t.length;l++){let o=t[l];if(o.id===e.id){t[l]=e;break}}}else this.datatypes.push(e)}}addViewStyle(e){e.category!==constants.gojs.C_VIEWSTYLE||(this.viewstyle||(this.viewstyle=e),null==this.viewstyles&&(this.viewstyles=[]),this.findViewStyle(e.id)||this.viewstyles.push(e))}addGeometry(e){e.category!==constants.gojs.C_GEOMETRY||(null==this.geometries&&(this.geometries=[]),this.findGeometry(e.id)||this.geometries.push(e))}addViewFormat(e){e.category!==constants.gojs.C_VIEWFORMAT||(null==this.viewformats&&(this.viewformats=[]),this.findViewFormat(e.id)||this.viewformats.push(e))}addFieldType(e){e.category!==constants.gojs.C_FIELDTYPE||(null==this.fieldTypes&&(this.fieldTypes=[]),this.findFieldType(e.id)||this.fieldTypes.push(e))}addInputPattern(e){e.category!==constants.gojs.C_INPUTPATTERN||(null==this.inputpatterns&&(this.inputpatterns=[]),this.findInputPattern(e.id)||this.inputpatterns.push(e))}addEnumeration(e){e.category!==constants.gojs.C_ENUMERATION||(null==this.enumerations&&(this.enumerations=[]),this.findEnumeration(e.id)||this.enumerations.push(e))}addObjectType(e){if(e.category===constants.gojs.C_OBJECTTYPE){if(null==this.objecttypes&&(this.objecttypes=[]),this.findObjectType(e.id)){let t=this.objecttypes;for(let l=0;l<t.length;l++){let o=t[l];if(o.id===e.id){t[l]=e;break}}}else this.objecttypes.push(e)}}addObjectTypeByName(e){if(e.category===constants.gojs.C_OBJECTTYPE){if(null==this.objecttypes&&(this.objecttypes=[]),this.findObjectTypeByName(e.name)){let t=this.objecttypes;for(let l=0;l<t.length;l++){let o=t[l];if(o.name===e.name){t[l]=e;break}}}else this.objecttypes.push(e)}}addObjectType0(e){if(e&&e.category===constants.gojs.C_OBJECTTYPE){if(null==this.objecttypes0&&(this.objecttypes0=[]),this.findObjectType0(e.id)){let t=this.objecttypes0;for(let l=0;l<t.length;l++){let o=t[l];if(o.id===e.id){t[l]=e;break}}}else this.objecttypes0.push(e)}}removeObjectType(e){if(e.category===constants.gojs.C_OBJECTTYPE){let t=[];for(let l=0;l<this.objecttypes.length;l++)this.findObjectType(e.id)||t.push(e);this.objecttypes=t}}addObjectTypeView(e){if(e.category===constants.gojs.C_OBJECTTYPEVIEW){if(null==this.objecttypeviews&&(this.objecttypeviews=[]),this.findObjectTypeView(e.id)){let t=this.objecttypeviews;for(let l=0;l<t.length;l++){let o=t[l];if(o.id===e.id){t[l]=e;break}}}else this.objecttypeviews.push(e)}}addObjtypeGeo(e){if(e.category===constants.gojs.C_OBJECTTYPEGEO){if(null==this.objtypegeos&&(this.objtypegeos=[]),this.findObjtypeGeo(e.id)){let t=this.objtypegeos;for(let l=0;l<t.length;l++){let o=t[l];if(o.id===e.id){t[l]=e;break}}}else this.objtypegeos.push(e)}}addProperty(e){if(e&&e.category===constants.gojs.C_PROPERTY){var t;let l=[],o=null===(t=this.properties)||void 0===t?void 0:t.length;if(o){let i=!1;for(let n=0;n<o;n++){let s=this.properties[n];s&&(s.id===e.id?(l.push(e),i=!0):l.push(s))}i||l.push(e)}else l.push(e);this.properties=l}}addMethod(e){if(e&&e.category===constants.gojs.C_METHOD){var t;let l=[],o=null===(t=this.methods)||void 0===t?void 0:t.length;if(o){let i=!1;for(let n=0;n<o;n++){let s=this.methods[n];s&&(s.id===e.id?(l.push(e),i=!0):l.push(s))}i||l.push(e)}else l.push(e);this.methods=l}}addMethodType(e){if(e&&e.category===constants.gojs.C_METHODTYPE){var t;let l=[],o=null===(t=this.methodtypes)||void 0===t?void 0:t.length;if(o){let i=!1;for(let n=0;n<o;n++){let s=this.methodtypes[n];s&&(s.id===e.id?(l.push(e),i=!0):l.push(s))}i||l.push(e)}else l.push(e);this.methodtypes=l}}addRelationshipType(e){if(e.category===constants.gojs.C_RELSHIPTYPE){if(null==this.relshiptypes&&(this.relshiptypes=[]),this.findRelationshipType(e.id)){let t=this.relshiptypes;for(let l=0;l<t.length;l++){let o=t[l];if(o.id===e.id){t[l]=e;break}}}else this.relshiptypes.push(e),debug&&console.log("3757 Add reltype",e)}}addRelationshipType0(e){if(e.category===constants.gojs.C_RELSHIPTYPE){if(null==this.relshiptypes0&&(this.relshiptypes0=[]),this.findRelationshipType0(e.id)){let t=this.relshiptypes0;for(let l=0;l<t.length;l++){let o=t[l];if(o.id===e.id){t[l]=e;break}}}else this.relshiptypes0.push(e)}}addRelationshipTypeView(e){if(e.category===constants.gojs.C_RELSHIPTYPEVIEW){if(null==this.relshiptypeviews&&(this.relshiptypeviews=[]),this.findRelationshipTypeView(e.id)){let t=this.relshiptypeviews.length;for(let l=0;l<t;l++){let o=this.relshiptypeviews[l];if(debug&&console.log("3687 rtview",o),o.id===e.id){for(let i in e)"id"!==i&&"name"!==i&&"data"!==i&&"typeRef"!==i&&(o[i]=e[i],o.data[i]=e[i]);debug&&console.log("3694 rtview",o);return}}}else this.relshiptypeviews.push(e),debug&&console.log("3682 reltypeview",e)}}addSubMetamodel(e){e.category!==constants.gojs.C_METAMODEL||(null==this.metamodels&&(this.metamodels=[]),this.findSubMetamodel(e.id)||this.metamodels.push(e))}addMetaContainer(e){e.category!==constants.gojs.C_METACONTAINER||(null==this.containers&&(this.containers=[]),this.findMetaContainer(e.id)||this.containers.push(e))}addUnit(e){if(e.category===constants.gojs.C_UNIT){null==this.units&&(this.units=[]);let t=e.getName();for(let l=0;l<this.units.length;l++)if(this.units[l].getName()===t)return;this.units.push(e)}}addUnitCategory(e){e.category!==constants.gojs.C_UNITCATEGORY||(null==this.categories&&(this.categories=[]),this.findUnitCategory(e.id)||this.categories.push(e))}findDatatype(e){let t=this.getDatatypes();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.id===e)return o;return null}findDatatypeByName(e){let t=this.getDatatypes();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.getName()===e)return o;return null}findViewFormat(e){let t=this.getViewFormats();if(t){let l=0;for(;l<t.length;){let o=t[l];if(o&&o.id===e)return o;l++}}return null}findFieldType(e){let t=this.getFieldTypes();if(t){let l=0;for(;l<t.length;){let o=t[l];if(o&&o.id===e)return o;l++}}return null}findInputPattern(e){let t=this.getInputPatterns();if(t){let l=0;for(;l<t.length;){let o=t[l];if(o&&o.id===e)return o;l++}}return null}findEnumeration(e){let t=this.getEnumerations();if(!t)return null;let l=0,o=null;for(;l<t.length;){if((o=t[l]).id===e)return o;l++}return null}findObjectType(e){let t=this.getObjectTypes();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(o=t[l]){if(o.isDeleted())continue;if(o.id===e||o.getFirestoreId()===e)return o}return null}findObjectType0(e){let t=this.getObjectTypes0();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findObjectTypeByName(e){let t=this.getObjectTypes();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.getName()===e)return o;return null}findObjectTypeView(e){let t=this.getObjectTypeViews();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(o=t[l]){if(o.isDeleted())continue;if(o.id===e||o.getFirestoreId()===e)return o}return null}findObjectTypeViewByName(e){let t=this.getObjectTypeViews();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.getName()===e)return o;return null}findObjtypeGeo(e){let t=this.getObjtypeGeos();if(!t)return null;let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}return null}findObjtypeGeoByType(e){let t=this.getObjtypeGeos();if(!t)return null;for(let l=0;l<t.length;l++){let o=t[l];if(o&&o.type&&o.type.id===e.id)return o}return null}findProperty(e){let t=this.getProperties();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if((!(o=t[l])||!o.isDeleted)&&o.id===e)return o;return null}findPropertyByName(e){let t=this.getProperties();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.getName()===e)return o;return null}findMethod(e){let t=this.getMethods();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if((!(o=t[l])||!o.isDeleted)&&o.id===e)return o;return null}findMethodByName(e){let t=this.getMethods();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.getName()===e)return o;return null}findMethodType(e){let t=this.getMethodTypes();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if((!(o=t[l])||!o.isDeleted)&&o.id===e)return o;return null}findMethodTypeByName(e){let t=this.getMethodTypes();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.getName()===e)return o;return null}findRelationshipType(e){let t=this.getRelshipTypes();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(o=t[l]){if(o.isDeleted())continue;if(o.id===e||o.getFirestoreId()===e)return o}return null}findRelationshipType0(e){let t=this.getRelshipTypes0();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(o=t[l]){if(o.isDeleted())continue;if(o.id===e||o.getFirestoreId()===e)return o}return null}findRelationshipTypeByName(e){let t=this.getRelshipTypes();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.getName()===e)return o;return null}findRelationshipTypeByName1(e,t,l){let o=this.getRelshipTypes();if(o)for(let i=0;i<o.length;i++){let n=o[i];if(!n.isDeleted()&&n.getName()===e){var s,a;if((null===(s=n.fromObjtype)||void 0===s?void 0:s.id)===(null==t?void 0:t.id)&&(null===(a=n.toObjtype)||void 0===a?void 0:a.id)===(null==l?void 0:l.id))return n}}return null}findRelationshipTypeByName2(e,t,l){let o=this.getRelshipTypes();if(o)for(let i=0;i<o.length;i++){let n=o[i];if(!n.isDeleted()&&n.getName()===e&&(debug&&console.log("3735 this.objecttypes, this.relshiptypes",this.objecttypes,this.relshiptypes),n.isAllowedFromType(t,this.objecttypes,this.relshiptypes)&&(debug&&console.log("3737 reltype",n,t,l),n.isAllowedToType(l,this.objecttypes,this.relshiptypes))))return debug&&console.log("3739 reltype",n,t,l),n}return null}findRelationshipTypeByNames(e,t,l){let o=this.getRelshipTypes();if(!o)return null;let i=0,n=null;for(i=0;i<o.length;i++)if(!(n=o[i]).isDeleted()&&n.getName()===e){let s=n.getFromObjType(),a=n.getToObjType();if(s&&a&&s.getName()===t&&a.getName()===l)return n}return null}findRelationshipTypesByName(e){let t=this.getRelshipTypes();if(!t)return null;let l=[],o=0,i=null;for(o=0;o<t.length;o++)(i=t[o]).isDeleted()||i.getName()!==e||l.push(i);return l}findEkaRelationshipTypeByName(e){let t=this.getObjectTypes();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.getViewKind()===constants.VIEWKINDS.REL&&o.getName()===e)return o;return null}findRelationshipTypesBetweenTypes(e,t,l){if(!e||!t)return null;let o=this.getRelshipTypes();if(debug&&console.log("2939 reltypes, objtypes",o,this.objecttypes),!o)return null;let i=[],n=0,s=null;for(n=0;n<o.length;n++)if(!(s=o[n]).isDeleted()){if(!s.fromObjtype){let a=this.findObjectType(s.fromobjtypeRef);if(!a)continue;s.fromObjtype=a}if(!s.toObjtype){let r=this.findObjectType(s.toobjtypeRef);if(!r)continue;s.toObjtype=r}l?(debug&&console.log("2948 reltype, fromType",s,e),s.isAllowedFromType(e,this.objecttypes,this.relshiptypes)&&(debug&&console.log("2950 reltype, toType",s,t),s.isAllowedToType(t,this.objecttypes,this.relshiptypes)&&i.push(s))):s.getRelshipKind()!==constants.relkinds.GEN&&s.isAllowedFromType(e,this.objecttypes,this.relshiptypes)&&s.isAllowedToType(t)&&i.push(s)}return i}findRelationshipTypes0BetweenTypes(e,t){if(!e||!t)return null;let l=this.getRelshipTypes0();if(debug&&console.log("2939 reltypes, objtypes",l,this.objecttypes),!l)return null;let o=[],i=0,n=null;for(i=0;i<l.length;i++)if(!(n=l[i]).isDeleted()){if(!n.fromObjtype){let s=this.findObjectType(n.fromobjtypeRef);if(!s)continue;n.fromObjtype=s}if(!n.toObjtype){let a=this.findObjectType(n.toobjtypeRef);if(!a)continue;n.toObjtype=a}n.getRelshipKind()!==constants.relkinds.GEN&&n.isAllowedFromType(e,this.objecttypes,this.relshiptypes)&&n.isAllowedToType(t)&&o.push(n)}return o}findRelationshipTypeView(e){if(!this.relshiptypeviews)return null;let t=0,l=null;for(t=0;t<this.relshiptypeviews.length;t++)if(l=this.relshiptypeviews[t]){if(l.isDeleted())continue;if(l.id===e||l.getFirestoreId()===e)return l}return null}findSubMetamodel(e){let t=this.getSubMetamodels();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.id===e)return o;return null}findMetaContainer(e){let t=this.getMetaContainers();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.id===e)return o;return null}findUnit(e){let t=this.getUnits();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.id===e)return o;return null}findUnitByName(e){let t=this.getUnits();if(!t)return null;let l=0,o=null;for(;l<t.length;){let i=(o=t[l]).getName();if(i.toLowerCase()===i.toLowerCase())return o;l++}return null}findUnitCategory(e){let t=this.getCategories();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.id===e)return o;return null}findViewStyle(e){let t=this.getViewStyles();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.id===e)return o;return null}findViewStyleByName(e){let t=this.getViewStyles();if(!t)return null;let l=0,o=null;for(;l<t.length;){let i=(o=t[l]).getName();if(i.toLowerCase()===i.toLowerCase())return o;l++}return null}findGeometry(e){let t=this.getGeometries();if(!t)return null;let l=0,o=null;for(l=0;l<t.length;l++)if(!(o=t[l]).isDeleted()&&o.id===e)return o;return null}findGeometryByName(e){let t=this.getGeometries();if(!t)return null;let l=0,o=null;for(;l<t.length;){let i=(o=t[l]).getName();if(i.toLowerCase()===i.toLowerCase())return o;l++}return null}setIsEKA(e){this.isEKA=e}getIsEKA(){return this.isEKA}setLayout(e){this.layout=e}getLayout(){return this.layout}setRouting(e){this.routing=e}getRouting(){return this.routing}constructor(e,t,l){super(e,t,l),this.fs_collection=constants.fs.FS_C_METAMODELS,this.category=constants.gojs.C_METAMODEL,this.clearContent()}}class cxMetaContainer extends cxMetaObject{constructor(e,t,l){super(e,t,l),this.category=constants.gojs.C_CONTAINER,this.members=null,this.subcontainers=null}}class cxType extends cxMetaObject{addSupertype(e){if(e.category===constants.gojs.C_OBJECTTYPE||e.category===constants.gojs.C_RELSHIPTYPE){this.supertypes||(this.supertypes=[]);for(let t=0;t<this.supertypes.length;t++){let l=this.supertypes[t];if(l.id===e.id)return}this.supertypes.push(e)}}addProperty(e){if(e&&e.category===constants.gojs.C_PROPERTY){var t;let l=[],o=null===(t=this.properties)||void 0===t?void 0:t.length;if(o){let i=!1;for(let n=0;n<o;n++){let s=this.properties[n];s&&(s.id===e.id?(l.push(e),i=!0):l.push(s))}i||l.push(e)}else l.push(e);this.properties=l}}addProperty2(e,t,l,o){this.properties||(this.properties=[]);let i=new cxProperty(e,t,l);return i.setDescription(l),i.setDatatype(o),this.properties.push(i),i}addAttribute(e){e&&this.attributes.push(e)}addAttribute2(e){let t=new cxAttribute(this,e);t&&this.attributes.push(t)}addMethod(e){if(e&&e.category===constants.gojs.C_METHOD){var t;let l=[],o=null===(t=this.methods)||void 0===t?void 0:t.length;if(o){let i=!1;for(let n=0;n<o;n++){let s=this.methods[n];s&&(s.id===e.id?(l.push(e),i=!0):l.push(s))}i||l.push(e)}else l.push(e);this.methods=l}}addQuery(e){}findAttributeByProperty(e){let t=this.attributes;for(let l=0;l<t.length;l++){let o=t[l];if(o.propRef===e)return o}return null}findProperty(e){let t=this.properties;if(!t)return null;let l=t.length,o=0;for(;o<l;){if(t[o].id===e)return t[o];o++}return null}findPropertyByName(e){let t=this.properties;if(!t)return null;{let l=t.length,o=0;for(;o<l;){var i;if((null===(i=t[o])||void 0===i?void 0:i.name)===e)return t[o];o++}return null}}findPropertyByName2(e,t){debug&&console.log("3488 propname, this",e,this);let l=this.properties;if(l){let o=l.length,i=0;for(;i<o;){if(l[i].name===e)return l[i];i++}}if(t&&(debug&&console.log("3501 supertypes",this.supertypes),this.supertypes)){let n=this.supertypes.length;for(let s=0;s<n;s++){let a=this.supertypes[s];if(debug&&console.log("3490 supertype",a),a){let r=a.properties;for(let d=0;d<(null==r?void 0:r.length);d++){let c=r[d];if(c&&c.name===e)return c}}}}return null}findMethod(e){let t=this.methods;if(!t)return null;let l=t.length,o=0;for(;o<l;){if(t[o].id===e)return t[o];o++}return null}findMethodByName(e){let t=this.methods;if(!t)return null;{let l=t.length,o=0;for(;o<l;){var i;if((null===(i=t[o])||void 0===i?void 0:i.name)===e)return t[o];o++}return null}}findMethodByName2(e,t){debug&&console.log("3740 propname, this",e,this);let l=this.methods;if(l){let o=l.length,i=0;for(;i<o;){if(l[i].name===e)return l[i];i++}}if(t&&(debug&&console.log("3753 supertypes",this.supertypes),this.supertypes)){let n=this.supertypes.length;for(let s=0;s<n;s++){let a=this.supertypes[s];if(debug&&console.log("3758 supertype",a),a){let r=a.methods;for(let d=0;d<(null==r?void 0:r.length);d++){let c=r[d];if(c&&c.name===e)return c}}}}return null}getViewKind(){return utils.objExists(this.viewkind)?this.viewkind:""}setViewKind(e){this.viewkind=e}setRelshipKind(e){this.relshipkind=e}getRelshipKind(){return utils.objExists(this.relshipkind)?this.relshipkind:constants.relkinds.REL}getSupertypes(){return this.supertypes}getProperties(e){if(!e)return this.properties;let t=this.properties;if(e){if(debug&&console.log("3485 superprops",this.supertypes),this.supertypes){let l=this.supertypes.length;for(let o=0;o<l;o++){let i=this.supertypes[o];if(debug&&console.log("3490 supertype",i),i){let n=i.properties;for(let s=0;s<(null==n?void 0:n.length);s++){let a=n[s];if(a){let r=!1;for(let d=0;d<t.length;d++){let c=t[d];if(c&&c.id===a.id){r=!0;break}}r||this.properties.push(a)}}}}}this.removeDuplicateProperties()}return debug&&console.log("3505 properties",this.properties),this.properties}hasProperties(){return!!utils.objExists(this.properties)&&!utils.isArrayEmpty(this.properties)}getPointerProperties(e){let t=this.getProperties(e);if(!t)return t;let l=[];for(let o=0;o<t.length;o++){let i=t[o];i&&i.isPointerProperty()&&l.push(i)}return l}getAttributes(){return this.attributes}getMethods(){return this.methods}hasMethods(){return!utils.isArrayEmpty(this.methods)}getQueries(){return this.queries}hasQueries(){return!utils.isArrayEmpty(this.queries)}setAbstract(e){this.abstract=e}getAbstract(){return!!utils.objExists(this.abstract)&&this.abstract}clearAbstract(){this.abstract=!1}isAbstract(){return this.getAbstract()}setDefaultValueset(e){this.defaultValueset=e}getDefaultTypeView(){return this.typeview}getDefaultValueset(){return this.defaultValueset}removeDuplicateProperties(){let e=[],t=this.properties,l=this.properties;for(let o=0;o<(null==t?void 0:t.length);o++){let i=t[o];for(let n=0;n<l.length;n++){let s=l[n];if(i&&s&&i.name===s.name){if(i.id!==s.id)break;e.push(i);break}}}debug&&console.log("3893 this.properties, props",this.properties,e),this.properties=e}isOfType(e){let t=!1;if(this.name===e)return!0;let l=this.supertypes;for(let o=0;o<(null==l?void 0:l.length);o++){let i=l[o];if((null==i?void 0:i.name)===e)return!0}return t}constructor(e,t,l){super(e,t,l),this.abstract=!1,this.supertypes=[],this.fs_collection="types",this.properties=[],this.attributes=[],this.typeview=null,this.viewkind="",this.relshipkind="",this.defaultValueset=null,this.methods=[],this.queries=[]}}class cxObjectType extends cxType{addInputreltype(e){this.inputreltypes||(this.inputreltypes=[]);let t=this.inputreltypes.length;for(let l=0;l<t;l++){let o=this.inputreltypes[l];if(o.id===e.id)return}this.inputreltypes.push(e)}removeInputreltype(e){if(!this.inputreltypes)return;let t=[],l=this.inputreltypes.length;for(let o=0;o<l;o++){let i=this.inputreltypes[o];i.id!==e.id&&t.push(e)}this.inputreltypes=t}addOutputreltype(e){this.outputreltypes||(this.outputreltypes=[]);let t=this.outputreltypes.length;for(let l=0;l<t;l++){let o=this.outputreltypes[l];if(o.id===e.id)return}this.outputreltypes.push(e)}removeOutputreltype(e){if(!this.outputreltypes)return;let t=[],l=this.outputreltypes.length;for(let o=0;o<l;o++){let i=this.outputreltypes[o];i.id!==e.id&&t.push(i)}this.outputreltypes=t}getOutputReltypes(e){if(!this.outputreltypes)return null;let t=[],l=this.outputreltypes.length;for(let o=0;o<l;o++){let i=this.outputreltypes[o];i.relshipkind===e&&t.push(i)}return t}getLoc(e){if(null==e?void 0:e.objtypegeos){let t=e.objtypegeos;if(t)for(let l=0;l<t.length;l++){let o=t[l];if(o&&o.metamodel&&o.metamodel.id===e.id){let i=o.type;if(i&&i.id==this.id)return o.loc}}}return""}getSize(e){if(null==e?void 0:e.objtypegeos){let t=e.objtypegeos;if(t)for(let l=0;l<t.length;l++){let o=t[l];if(o){let i=o.metamodel;if(i&&i.id===e.id){let n=o.type;if(n&&n.id==this.id)return o.size}}}}return""}getObjtypeGeos(){return this.objtypegeos}addObjtypeGeo(e){null==this.objtypegeos&&(this.objtypegeos=[]),utils.findObjtypeGeo(e.id)||this.objtypegeos.push(e)}setDefaultTypeView(e){let t=e;t&&(this.typeview=t)}getTypeId(){return this.typeid}getDefaultTypeView(){return this.typeview}newDefaultTypeView(e){let t=this.name+"_"+e,l=new cxObjectTypeView(utils.createGuid(),t,this,"");return utils.objExists(l)&&l.setViewKind(this.viewkind),this.typeview=l,this.typeview}isInstantiable(){let e=!0;return this.markedAsDeleted?e=!1:this.abstract&&(e=!1),e}getViewKind(){return utils.objExists(this.viewkind)?this.viewkind:""}setViewKind(e){this.viewkind=e}setRelshipKind(e){this.relshipkind=e}getRelshipKind(){return utils.objExists(this.relshipkind)?this.relshipkind:constants.relkinds.REL}setFromObjtype(e){this.fromObjtype=e}getFromObjType(){return this.fromObjtype}setToObjtype(e){this.toObjtype=e}getToObjType(){return this.toObjtype}setAllObjecttypes(e){this.allObjecttypes=e}getAllObjecttypes(){return this.allObjecttypes}setAllRelationshiptypes(e){this.allRelationshiptypes=e}getAllRelationshiptypes(){return this.allRelationshiptypes}isContainer(){return this.viewkind==constants.viewkinds.CONT}findRelatedObjectTypes(e){let t=[],l=this.allRelationshiptypes;if(debug&&console.log("3414 allReltypes",l),!l)return null;{let o=0,i=null;for(;o<l.length;){if((i=l[o])&&i.getRelshipKind()===e){let n=i.getFromObjType();if(n&&(debug&&console.log("3426 reltype",n.name),i.getFromObjType().id===this.id)){let s=i.getToObjType();debug&&console.log("3429 reltype",s.name),t.push(s)}}o++}}return t}findSupertypes(e){e||(e=0);let t=[],l=this.outputreltypes;if(debug&&console.log("5005 this, rtypes",this,l),l)for(let o=0;o<(null==l?void 0:l.length);o++){let i=l[o];if((null==i?void 0:i.relshipkind)===constants.relkinds.GEN){let n=i.toObjtype;if(n){if(t.push(n),e>5)return t;debug&&console.log("5015 this, supertypes",this,t);let s=n.findSupertypes(++e);if(s){for(let a=0;a<s.length;a++){let r=s[a];t.push(r)}debug&&console.log("5022 this, supertype",this,t)}}}}return t}inherits(e,t){debug&&console.log("3781 this.name, type.name",this.name,e.name);let l=!1;if(this.allRelationshiptypes=t,this.id===e.id)return!0;{let o=this.findRelatedObjectTypes(constants.relkinds.GEN);if(debug&&console.log("3788 this, objtypes",this,o),o)for(let i=0;i<o.length;i++){debug&&console.log("3791 this, objtype",this,e);let n=o[i];if(n){if(this.id===n.id)continue;if(n.id===e.id)return debug&&console.log("3795 Found supertype",n.name),!0;if(debug&&console.log("3798 find supertype of",n,e),l=n.inherits(e,t))return!0}}}return l}findRelshipTypeByKind(e,t){let l=this.findRelshipTypeByKind1(e,t,this.allRelationshiptypes);return l||(l=this.findRelshipTypeByKind2(e,t))?l:l=this.findRelshipTypeByKind3(e,t)}findRelshipTypeByKind1(e,t,l){if(l){let o,i=0;for(;i<l.length;){if((o=l[i])&&o.getRelshipKind()===e){let n=o.getFromObjType();if(n&&n.id===this.id){let s=o.getToObjType();if(s&&s.id===t.id)return o;{let a=constants.relkinds.GEN,r=t.findRelatedObjectTypes(a);if(r)for(let d=0;d<r.length;d++){let c=r[d],p=this.findRelshipTypeByKind1(e,c,l);if(p)return p}}}}i++}}return null}findRelshipTypeByKind2(e,t){let l=this.findRelatedObjectTypes(e);if(l&&l.length>0)for(let o=0;o<l.length;o++){let i=l[o];if(t.inherits(i,this.allRelationshiptypes)){let n=this.findRelshipTypeByKind1(e,i,this.allRelationshiptypes);if(n)return n}else{let s=constants.relkinds.GEN,a=i.findRelatedObjectTypes(s);if(a.length>0)for(let r=0;r<a.length;r++){let d=a[r],c=this.findRelshipTypeByKind2(e,d);if(utils.objExists(c))return c}}}return null}findRelshipTypeByKind3(e,t){let l=constants.relkinds.GEN,o=this.findRelatedObjectTypes(l);if(o&&o.length>0){for(let i=0;i<o.length;i++){let n=o[i],s=n.findRelshipTypeByKind1(e,t,null);if(utils.objExists(s)||(s=n.findRelshipTypeByKind3(e,t),utils.objExists(s)))return s}return null}}numberOfMetamodelsUsage(e){let t=0,l=e.metamodels;for(let o=0;o<l.length;o++){let i=l[o],n=i.objecttypes;for(let s=0;s<n.length;s++){let a=n[s];if(a.id===this.id){t++;break}}}return t}constructor(e,t,l){super(e,t,l),this.fs_collection=constants.fs.FS_C_OBJECTTYPES,this.category=constants.gojs.C_OBJECTTYPE,this.typeid=constants.types.OBJECTTYPE_ID,this.viewkind=constants.viewkinds.OBJ,this.relshipkind="",this.fromObjtype=null,this.toObjtype=null,this.objtypegeos=null,this.inputreltypes=null,this.outputreltypes=null,this.allObjecttypes=null,this.allRelationshiptypes=null,this.markedAsDeleted=!1,debug&&console.log("3268 this",this)}}class cxObjtypeGeo extends cxMetaObject{getMetamodel(){return this.metamodel}setMetamodel(e){utils.objExists(e)&&(this.metamodel=e)}getType(){return this.type}setType(e){e&&(this.type=e)}getLoc(){return this.loc}setLoc(e){this.loc=e}getSize(){return void 0==this.size?"":this.size}setSize(e){void 0==e&&(e=""),this.size=e}constructor(e,t,l,o,i){super(e,"",""),this.fs_collection="objtypegeos",this.category="Object type geo",this.metamodel=t,this.metamodelRef="",this.type=l,this.loc=void 0===o?"":o,this.size=void 0===i?"":i}}class cxRelationshipType extends cxObjectType{setDefaultTypeView(e){this.typeview=e}newDefaultTypeView(e){let t=this.name+"_"+e,l=new cxRelationshipTypeView(utils.createGuid(),t,this,"");return utils.objExists(l)&&(l.setRelshipKind(this.relshipkind),l.setFromArrow2(e),l.setToArrow2(e)),this.typeview=l,this.typeview}getDefaultTypeView(){return this.typeview}setCardinality(e){this.cardinality=e}getCardinality(){return this.cardinality}getCardinalityFrom(){return this.cardinalityFrom}getCardinalityTo(){return this.cardinalityTo}setNameFrom(e){this.nameFrom=e}getNameFrom(){return this.nameFrom}setNameTo(e){this.nameTo=e}getNameTo(){return this.nameTo}isInstantiable(){let e=!0;return this.markedAsDeleted?e=!1:this.abstract&&(e=!1),e}isAllowedFromType(e,t,l){return!!(e&&this.fromObjtype&&(debug&&console.log("3666 objtype",e.name,this.fromObjtype.name),e.inherits(this.fromObjtype,l)))&&(debug&&console.log("3668 inherits, true"),!0)}isAllowedToType(e,t,l){return!!(e&&this.toObjtype&&(debug&&console.log("3340 objtype",e.name,this.toObjtype.name),e.inherits(this.toObjtype,l)))}setFromObjectType(e){this.fromObjtype=e,this.fromobjtypeRef=e.id}setToObjectType(e){this.toObjtype=e,this.toobjtypeRef=e.id}numberOfMetamodelsUsage(e){let t=0,l=e.metamodels;for(let o=0;o<l.length;o++){let i=l[o],n=i.relshiptypes;for(let s=0;s<n.length;s++){let a=n[s];if(a.id===this.id){t++;break}}}return t}constructor(e,t,l,o,i){super(e,t,i),this.fs_collection=constants.fs.FS_C_RELSHIPTYPES,this.category=constants.gojs.C_RELSHIPTYPE,this.typeid=constants.types.RELATIONSHIPTYPE_ID,this.fromObjtype=l,this.fromobjtypeRef=null==l?void 0:l.id,this.toObjtype=o,this.toobjtypeRef=null==o?void 0:o.id,this.relshipkind=constants.relkinds.REL,this.viewkind="",this.cardinality="",this.cardinalityFrom="",this.nameTo="",this.nameFrom="",this.cardinalityTo="",this.markedAsDeleted=!1,debug&&console.log("5422 New reltype",this)}}class cxProperty extends cxMetaObject{setDatatype(e){this.datatype=e}getDatatype(){return this.datatype?this.datatype:null}setMethod(e){this.method=e}getMethod(){return this.method?this.method:null}setUnitCategory(e){this.unitCategory=e}getUnitCategory(){return utils.objExists(this.unitCategory)?this.unitCategory:null}setDefaultValue(e){this.defaultValue=e}getDefaultValue(){return utils.objExists(this.defaultValue)?this.defaultValue:""}isPointerProperty(){let e=this.getDatatype();return null!=e&&!!e.getPointerType()}constructor(e,t,l){super(e,t,l),this.fs_collection=constants.fs.FS_C_PROPERTIES,this.category=constants.gojs.C_PROPERTY,this.datatype=null,this.datatypeRef="",this.method=null,this.methodRef="",this.unitCategory=null,this.unitCategoryRef="",this.defaultValue="",this.inputPattern="",this.viewFormat="",this.example=""}}class cxAttribute{constructor(e,t){t&&e&&(this.typeName=e.name,this.propName=t.name,this.name=this.typeName+"."+this.propName,this.propRef=t.id)}}class cxMethod extends cxMetaObject{setAllProperties(e){this.allProperties=e}getAllProperties(){return this.allProperties}evaluateExpression(expr){let pi=3.14159265;if(expr.length>0)return eval(expr)}constructor(e,t,l){super(e,t,l),this.category=constants.gojs.C_METHOD,this.methodtype=constants.types.MTD_CALCULATEVALUE,this.expression="",this.allProperties=null}}class cxViewStyle extends cxMetaObject{addObjectTypeView(e){e.category!==constants.gojs.C_OBJECTTYPEVIEW||(null==this.objecttypeviews&&(this.objecttypeviews=[]),this.findObjectTypeView(e.id)||this.objecttypeviews.push(e))}findObjectTypeView(e){let t=this.objecttypeviews;if(!t)return null;let l=null;for(let o=0;o<t.length;o++)if((l=t[o]).id===e)return l;return null}addRelationshipTypeView(e){e.category!==constants.gojs.C_RELSHIPTYPEVIEW||(null==this.relshiptypeviews&&(this.relshiptypeviews=[]),this.findRelationshipTypeView(e.id)||this.relshiptypeviews.push(e))}findRelationshipTypeView(e){let t=this.relshiptypeviews;if(!t)return null;let l=null;for(let o=0;o<t.length;o++)if((l=t[o]).id===e)return l;return null}constructor(e,t,l){super(e,t,l),this.relshiptypeviews=null,this.category=constants.gojs.C_VIEWSTYLE,this.objecttypeviews=null,this.relshiptypeviews=null}}class cxObjtypeviewData{constructor(){this.abstract=!1,this.memberscale="1",this.arrowscale="1.3",this.viewkind=constants.viewkinds.OBJ,this.template="textAndIcon",this.figure="",this.geometry="",this.fillcolor="",this.fillcolor2="",this.strokecolor="black",this.strokecolor2="black",this.strokewidth="",this.textcolor="black",this.textscale="",this.icon=""}}class cxObjectTypeView extends cxMetaObject{applyObjectViewParameters(e){if(e){let t;let l=this.data;for(t in l)void 0!=e[t]&&""!==e[t]&&("arrowscale"===t&&(l[t]=e[t]),"memberscale"===t&&(l[t]=e[t]),"template"===t&&(l[t]=e[t]),"geometry"===t&&(l[t]=e[t]),"figure"===t&&(l[t]=e[t]),"fillcolor"===t&&(l[t]=e[t]),"fillcolor2"===t&&(l[t]=e[t]),"strokecolor"===t&&(l[t]=e[t]),"strokecolor2"===t&&(l[t]=e[t]),"strokewidth"===t&&(l[t]=e[t]),"icon"===t&&(l[t]=e[t]));for(t in debug&&console.log("5580 data",l),l)this[t]=l[t];debug&&console.log("5584 this",this)}}setType(e){this.typeRef=null==e?void 0:e.id}getTypeRef(){return this.typeRef}setData(e){this.data=e}getData(){return this.data}setViewKind(e){this.data.viewkind=e}getViewKind(){return utils.objExists(this.data.viewkind)?this.data.viewkind:constants.viewkinds.OBJ}setAbstract(e){this.data.abstract=e}getAbstract(){return this.data.abstract}setTemplate(e){this.data.template=e,this.template=e}getTemplate(){return this.data.template?this.data.template:this.template?this.template:""}setFigure(e){this.data.figure=e,this.figure=e}getFigure(){return this.data.figure?this.data.figure:this.figure?this.figure:""}setGeometry(e){this.data.geometry=e,this.geometry=e}getGeometry(){return this.data.geometry?this.data.geometry:this.geometry?this.geometry:""}setFillcolor(e){this.data.fillcolor=e,this.fillcolor=e}getFillcolor(){return this.data.fillcolor?this.data.fillcolor:this.fillcolor?this.fillcolor:"white"}setFillcolor2(e){this.data.fillcolor2=e,this.fillcolor2=e}getFillcolor2(){return this.data.fillcolor2?this.data.fillcolor2:this.fillcolor2?this.fillcolor2:"white"}setTextcolor(e){this.data.textcolor=e,this.textcolor=e}getTextcolor(){return this.data.textcolor?this.data.textcolor:this.textcolor?this.textcolor:"black"}setTextscale(e){this.data.textscale=e,this.textscale=e}getTextscale(){return this.data.textscale?this.data.textscale:this.textscale?this.textscale:"1"}setStrokecolor(e){this.data.strokecolor=e,this.strokecolor=e}getStrokecolor(){return this.data.strokecolor?this.data.strokecolor:this.strokecolor?this.strokecolor:"black"}setStrokecolor2(e){this.data.strokecolor2=e,this.strokecolor2=e}getStrokecolor2(){return this.data.strokecolor2?this.data.strokecolor2:this.strokecolor2?this.strokecolor2:"black"}setStrokewidth(e){this.strokewidth=e,this.data.strokewidth=e}getStrokewidth(){return this.data.strokewidth?this.data.strokewidth:this.strokewidth?this.strokewidth:"2"}setMemberscale(e){this.memberscale=e,this.data.memberscale=e}getMemberscale(){return this.data.memberscale?this.data.memberscale:this.memberscale?this.memberscale:"1"}setArrowscale(e){this.arrowscale=e,this.data.arrowscale=e}getArrowscale(){return this.data.arrowscale?this.data.arrowscale:this.arrowscale?this.arrowscale:"1.3"}setIcon(e){this.data.icon=e,this.icon=e}getIcon(){return this.data.icon?this.data.icon:this.icon?this.icon:""}constructor(e,t,l,o){if(super(e,t,o),this.fs_collection=constants.fs.FS_C_OBJECTTYPEVIEWS,this.category=constants.gojs.C_OBJECTTYPEVIEW,this.typeRef=null==l?void 0:l.id,this.template="",this.figure="",this.geometry="",this.arrowscale="",this.memberscale="",this.fillcolor="",this.fillcolor2="",this.strokecolor="",this.strokecolor2="",this.strokewidth="",this.textcolor="",this.textscale="",this.viewkind="",this.icon="",this.data=new cxObjtypeviewData,l){let i=l.abstract;i&&(this.data.abstract=i)}}}class cxReltypeviewData{constructor(){this.abstract=!1,this.relshipkind=constants.relkinds.REL,this.template="linkTemplate1",this.strokecolor="black",this.strokewidth="",this.textcolor="black",this.arrowscale="1.3",this.textscale="1",this.dash="None",this.fromArrow="",this.toArrow="OpenTriangle",this.fromArrowColor="",this.toArrowColor="white"}}class cxRelationshipTypeView extends cxMetaObject{applyRelationshipViewParameters(e){if(e){let t;let l=this.data;for(t in l)void 0!=e[t]&&""!==e[t]&&("template"===t&&(l[t]=e[t]),"strokecolor"===t&&(l[t]=e[t]),"strokewidth"===t&&(l[t]=e[t]),"textcolor"===t&&(l[t]=e[t]),"textscale"===t&&(l[t]=e[t]),"dash"===t&&(l[t]=e[t]),"fromArrow"===t&&(l[t]=e[t]),"toArrow"===t&&(l[t]=e[t]),"fromArrowColor"===t&&(l[t]=e[t]),"toArrowColor"===t&&(l[t]=e[t]));for(t in debug&&console.log("5883 data",l),l)this[t]=l[t];debug&&console.log("5887 this",this)}}setType(e){this.typeRef=null==e?void 0:e.id}getTypeRef(){return this.typeRef}setData(e){this.data=e}getData(){return this.data}setAbstract(e){this.data.abstract=e}getAbstract(){return this.data.abstract}setRelshipKind(e){this.data.relshipkind=e,this.setFromArrow2(e),this.setToArrow2(e)}setTemplate(e){this.data.template=e,this.template=e}getTemplate(){return this.template?this.template:this.data.template?this.data.template:"linkTemplate1"}setStrokecolor(e){this.data.strokecolor=e,this.strokecolor=e}getStrokecolor(){return this.strokecolor?this.strokecolor:this.data.strokecolor?this.data.strokecolor:"black"}setTextcolor(e){this.data.textcolor=e,this.textcolor=e}getTextcolor(){return this.textcolor?this.textcolor:this.data.textcolor?this.data.textcolor:"black"}setTextscale(e){this.data.textscale=e,this.textscale=e}getTextscale(){return this.textscale?this.textscale:this.data.textscale?this.data.textscale:"1"}setStrokewidth(e){this.data.strokewidth=e,this.strokewidth=e}getStrokewidth(){return this.strokewidth?this.strokewidth:this.data.strokewidth?this.data.strokewidth:"1"}setDash(e){this.data.dash=e,this.dash=e}getDash(){return this.dash?this.dash:this.data.dash?this.data.dash:""}setFromArrow(e){this.data.fromArrow=e,this.fromArrow=e}getFromArrow(){return this.fromArrow?this.fromArrow:this.data.fromArrow?this.data.fromArrow:""}setToArrow(e){this.data.toArrow=e,this.toArrow=e}setFromArrow2(e){switch(e){case"Composition":this.setFromArrow("StretchedDiamond"),this.setFromArrowColor("black");break;case"Aggregation":this.setFromArrow("StretchedDiamond"),this.setFromArrowColor("white");break;case"Generalization":this.setFromArrow(" "),this.setFromArrowColor(" ")}}setToArrow2(e){"Generalization"===e&&(this.setToArrow("Triangle"),this.setToArrowColor("white"),this.textcolor="black")}getToArrow(){return this.toArrow?this.toArrow:this.data.toArrow?this.data.toArrow:""}setFromArrowColor(e){this.data.fromArrowColor=e,this.fromArrowColor=e}getFromArrowColor(){return this.fromArrowColor?this.fromArrowColor:this.data.fromArrowColor?this.data.fromArrowColor:""}setToArrowColor(e){this.data.toArrowColor=e,this.toArrowColor=e}getToArrowColor(){return this.toArrowColor?this.toArrowColor:this.data.toArrowColor?this.data.toArrowColor:""}constructor(e,t,l,o){for(let i in(""===t||t===e)&&(t=(null==l?void 0:l.name)+"_"+(null==l?void 0:l.relshipkind)),super(e,t,o),this.fs_collection=constants.fs.FS_C_RELSHIPTYPEVIEWS,this.category=constants.gojs.C_RELSHIPTYPEVIEW,this.typeRef=null==l?void 0:l.id,this.data=new cxReltypeviewData,this.data)this[i]=this.data[i];this.setFromArrow2(null==l?void 0:l.relshipkind),this.setToArrow2(null==l?void 0:l.relshipkind)}}class cxModel extends cxMetaObject{clearContent(){this.sourceMetamodelRef="",this.targetMetamodelRef="",this.sourceModelRef="",this.targetModelRef="",this.templates=null,this.isTemplate=!1,this.isMetamodel=!1,this.includeSystemtypes=!0,this.includeRelshipkind=!1,this.layer="Foreground",this.submodels=null,this.objects=null,this.relships=null,this.modelviews=null,this.args1=[]}setMetamodel(e){this.metamodel=e}getMetamodel(){return this.metamodel}addTemplate(e){null==this.templates&&(this.templates=[]),this.findTemplate(e.id)||this.templates.push(e)}findTemplate(e){let t=this.getTemplates();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&o.id===e)return o;l++}}}getTemplates(){return this.templates}setIsTemplate(e){this.isTemplate=e}getIsTemplate(){return this.isTemplate}setIsMetamodel(e){this.isMetamodel=e}getIsMetamodel(){return this.isMetamodel}getModelViews(){return this.modelviews}getObjects(){return this.objects}getObjectsByType(e,t){let l=[];if(this.objects)for(let o=0;o<this.objects.length;o++){let i=this.objects[o];if(i&&!i.markedAsDeleted){let n=i.getType();n&&n.getId()===e.getId()&&l.push(i)}}return l}getObjectsByTypename(e,t){let l=[];if(this.objects)for(let o=0;o<this.objects.length;o++){let i=this.objects[o];if(i&&!i.markedAsDeleted){let n=i.getType();n&&n.name===e&&l.push(i)}}return l}getCopiedFromObject(e){debug&&console.log("5972 this.objects, fromId",this.objects,e);for(let t=0;t<this.objects.length;t++){let l=this.objects[t];if(l.copiedFromId===e)return debug&&console.log("5977 obj, fromId",l,e),l}return null}getRelationships(){return this.relships}getRelationshipsByType(e,t){let l=[];if(this.relships)for(let o=0;o<this.relships.length;o++){let i=this.relships[o];if(i&&!i.markedAsDeleted){let n=i.getType();n&&n.getId()===e.getId()&&l.push(i)}}return l}getRelationshipsByTypeName(e,t){let l=[];if(this.relships)for(let o=0;o<this.relships.length;o++){let i=this.relships[o];i.name!==e||i.markedAsDeleted||i.relshipkind!==t||l.push(i)}return l}getSubmodels(){return this.submodels}addSubmodel(e){null==this.submodels&&(this.submodels=[]),this.findSubmodel(e.id)||this.submodels.push(e)}addModelView(e){null==this.modelviews&&(this.modelviews=[]),this.findModelView(e.id)||this.modelviews.push(e)}addObject(e){if(e.category===constants.gojs.C_OBJECT){if(null==this.objects&&(this.objects=[]),this.findObject(e.id)){let t=this.objects;for(let l=0;l<t.length;l++){let o=t[l];if(o.id===e.id){t[l]=e;break}}}else this.objects.push(e)}}addRelationship(e){if(e.category===constants.gojs.C_RELATIONSHIP){if(null==this.relships&&(this.relships=[]),this.findRelationship(e.id)){let t=this.relships;for(let l=0;l<t.length;l++){let o=t[l];if(o.id===e.id){t[l]=e;break}}}else this.relships.push(e)}}addObjects(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];let o=0;for(;o<t.length;)this.addObject(t[o]),o++}addRelationships(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];let o=0;for(;o<t.length;)this.addRelationship(t[o]),o++}findSubmodel(e){let t=this.getSubmodels();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}}findModelView(e){let t=this.getModelViews();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}}findModelViewByName(e){let t=this.getModelViews();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&o.name===e)return o;l++}}}findObject(e){let t=this.getObjects();if(!t)return null;let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}return null}findObjectByName(e){let t=this.getObjects();if(!t)return null;let l=t.length,o=0;for(;o<l;){if(t[o].getName()===e)return t[o];o++}return null}findObjectByTypeAndName(e,t){let l=this.getObjects();if(!l)return null;let o=l.length,i=0;for(;i<o;){let n=l[i];if(n){let s=n.type;if(s&&s.id===e.id&&n.getName()===t)return n}i++}return null}findRelationship(e){let t=this.getRelationships();if(t){let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}return null}findRelationship1(e,t,l){let o=this.relships;if(o){let i=utils.objExists(o)?o.length:0;for(let n=0;n<i;n++){let s=o[n];if(s){let a=s.getType();if(a){let r=s.getFromObject(),d=s.getToObject();if(r&&d&&a.id===l.id&&r.id===e.id&&d.id===t.id)return s}}}}return null}findRelationship2(e,t,l,o){let i=this.relships;if(i){let n=utils.objExists(i)?i.length:0;for(let s=0;s<n;s++){let a=i[s];if(a&&a.name===l){let r=a.getType();if(r){let d=a.getFromObject(),c=a.getToObject();if(d&&c&&r.id===o.id&&d.id===e.id&&c.id===t.id)return a}}}}return null}findEkaRelationship(e,t,l){if(!utils.objExists(e)||!utils.objExists(t)||!utils.objExists(l))return null;let o=this.objects;if(o){let i=o.length;for(let n=0;n<i;n++){let s=o[n],a=s.getType();if(a){let r=s.getFromObject(),d=s.getToObject();if(r&&d&&a.id===l.id&&r.id===e.id&&d.id===t.id)return s}}}return null}findRelationships(e,t,l){let o=[],i=this.relships;if(i){let n=null==i?void 0:i.length;for(let s=0;s<n;s++){let a=i[s],r=a.type;if(r&&r.id===l.id){let d=a.getFromObject(),c=a.getToObject();d&&c&&d.id===e.id&&c.id===t.id&&o.push(a)}}}return o}findRelationships1(e,t,l){let o=[],i=this.relships;if(i){let n=null==i?void 0:i.length;for(let s=0;s<n;s++){let a=i[s],r=a.getType();if(r&&r.getRelshipKind()===l){let d=a.getFromObject(),c=a.getToObject();d&&c&&d.id===e.id&&c.id===t.id&&o.push(a)}}}return o}deleteObjectViewsWithoutObjects(){let e=this.modelviews;for(let t=0;t<e.length;t++){let l=e[t],o=l.objectviews;for(let i=0;i<o.length;i++){let n=o[i];n.object||(n.markedAsDeleted=!0)}}}constructor(e,t,l,o){super(e,t,o),this.fs_collection=constants.fs.FS_C_MODELS,this.category=constants.gojs.C_MODEL,this.metamodel=l,this.clearContent()}}class cxInstance extends cxMetaObject{setAndGetAllProperties(e){var t;let l=null===(t=this.type)||void 0===t?void 0:t.getProperties(!0),o=null;if(debug&&console.log("5717 this",this),"Method"===this.type.name){let i=this.methodtype;if(i){let n=e.currentMetamodel,s=n.findMethodTypeByName(i);s&&(o=s.properties,debug&&console.log("5725 this",o))}}let a=l.concat(o);return a=a.filter(function(e){return null!=e}),this.allProperties=a,debug&&console.log("5739 properties",a),a}addInputrel(e){this.inputrels||(this.inputrels=[]);let t=this.inputrels.length;for(let l=0;l<t;l++){let o=this.inputrels[l];if(o.id===e.id)return}this.inputrels.push(e)}removeInputrel(e){if(!this.inputrels)return;let t=[],l=this.inputrels.length;for(let o=0;o<l;o++){let i=this.inputrels[o];i.id!==e.id&&t.push(i)}this.inputrels=t}addOutputrel(e){this.outputrels||(this.outputrels=[]);let t=this.outputrels.length;for(let l=0;l<t;l++){let o=this.outputrels[l];if(o.id===e.id)return}this.outputrels.push(e)}removeOutputrel(e){if(!this.outputrels)return;let t=[],l=this.outputrels.length;for(let o=0;o<l;o++){let i=this.outputrels[o];i.id!==e.id&&t.push(i)}this.outputrels=t}setType(e){this.type=e,this.typeName=e.name}getType(){return this.type}getInheritedTypes(){let e=[],t=this.getType(),l=null==t?void 0:t.findSupertypes(0);debug&&console.log("6697 types",l);for(let o=0;o<(null==l?void 0:l.length);o++){var i;let n=null===(i=l[o])||void 0===i?void 0:i.name;"Element"!==n&&e.push(l[o])}return debug&&console.log("6703 typelist",e),e}getInheritedTypeNames(){let e=[],t=this.getType(),l=null==t?void 0:t.findSupertypes(0);for(let o=0;o<(null==l?void 0:l.length);o++){var i;let n=null===(i=l[o])||void 0===i?void 0:i.name;"Element"!==n&&e.push(n)}return e}setFromObject(e){this.fromObject=e}getFromObject(){return this.fromObject}setToObject(e){this.toObject=e}getToObject(){return this.toObject}setRelshipKind(e){this.relshipkind=e}getRelshipKind(){let e=this.relshipkind;if(e||(e=""),0==e.length){let t=this.type;e=t.getRelshipKind(),this.relshipkind=e}return e}setAbstract(e){this.abstract=e}getAbstract(){return this.abstract}setViewKind(e){this.viewkind=e}getViewKind(){return this.viewkind}getValueset(){return this.valueset}getPropertyValues(){return this.getValueset()}addValue(e){"cxPropertyValue"===e.constructor.name&&(null==this.valueset&&(this.valueset=[]),this.valueset.push(e))}addStringValue(e,t,l,o){if("name"===e)this.setName(l);else if("description"===e)this.setDescription(l);else{let i=this.getType();if(i){let n=i.findProperty(e);n&&debug&&console.log("Function 'addStringValue' not yet implemented!")}}}isEkaRelationship(){let e=!1;return this.viewkind===constants.VIEWKINDS.REL&&(e=!0),e}setValue(e,t){if(t.category===constants.gojs.C_PROPVALUE){let l=0;for(this.valueset||(this.valueset=[]);l<this.valueset.length;){let o=this.valueset[l];if(o.getName()===e){this.valueset[l]=t;break}l++}}}setStringValue(e,t){let l=!1,o=null,i=0;for(this.valueset||(this.valueset=[]);i<this.valueset.length;){if((o=this.valueset[i]).getName()===e){o.value=t,l=!0;break}i++}return l}setStringValue2(e,t){let l=this;return l[e]=t,!0}getPropertyValue(e,t){let l;let o=this,i=e.methodRef,n=t.findMethod(i),s=e.name;if(debug&&console.log("6268 prop, method",e,n),n){let a;let r=n.methodtype;switch(r){case constants.types.MTD_AGGREGATEVALUE:{debug&&console.log("6273 method",n);let d=t.findRelationshipTypeByName(n.reltype),c=n.objtype,p=null;"any"!==c&&"null"!==c&&(p=t.findObjectTypeByName(c)),a={myMetis:t,reltype:d,reldir:n.reldir,objtype:p,prop:e},l=_ui_methods__WEBPACK_IMPORTED_MODULE_0__.G4(o,a)}break;case constants.types.MTD_GETCONNECTEDOBJECT:{debug&&console.log("6861 method",n);let h=n.reltype,u=n.reldir,m=null;"any"!==h&&"null"!==h&&(m=t.findRelationshipTypeByName(h)),debug&&console.log("6866 rtypename, reltype",h,m);let g=n.objtype,f=null;"any"!==g&&"null"!==g&&(f=t.findObjectTypeByName(g)),debug&&console.log("6871 otypename, objtype",g,f),a={myMetis:t,reltype:m,reldir:u,objtype:f,prop:e},debug&&console.log("6879 inst, context",o,a);let y=_ui_methods__WEBPACK_IMPORTED_MODULE_0__.Mx(o,a);debug&&console.log("6881 inst, context, obj",o,a,y),l=null==y?void 0:y.name}break;case constants.types.MTD_CALCULATEVALUE:default:debug&&console.log("6290 method",n),a={myMetis:t,prop:e},l=_ui_methods__WEBPACK_IMPORTED_MODULE_0__.Q4(o,a),o[s]=l}}else l=o[s];return l}getStringValue2(e){debug&&console.log("4767 inst",e,this);let t=this[e];return debug&&console.log("4769 inst",e,t,this),t}findInputRelships(e,t){let l=e.relships;if(!l)return null;let o=[];for(let i=0;i<l.length;i++){let n=l[i];if(n){if(n.markedAsDeleted)continue;let s=n.type;if(s){let a=s.relshipkind;if(a.length>0&&a!==t)continue}let r=n.toObject;r&&r.id===this.id&&o.push(n)}}return o}findOutputRelships(e,t){let l=e.relships;if(!l)return null;let o=[];for(let i=0;i<l.length;i++){let n=l[i];if(n){if(n.markedAsDeleted)continue;let s=n.type;if(s){let a=s.relshipkind;if(a.length>0&&a!==t)continue}let r=n.fromObject;r&&r.id===this.id&&o.push(n)}}return o}addJsonValue(e,t){this.valueset||(this.valueset=[]);let l=this.allProperties;for(let o=0;o<l.length;o++){let i=l[o];if(i&&i.id===e){let n=new cxPropertyValue(i,t);n&&(n.value=t,this.valueset.push(n))}}}constructor(e,t,l,o){super(e,t,o),this.id=e,this.type=l,this.typeRef=null==l?void 0:l.id,this.typeName=null==l?void 0:l.name,this.typeDescription=null==l?void 0:l.description,this.typeview=null,this.fromObject=null,this.toObject=null,this.relshipkind="",this.abstract=!1,this.viewkind="",this.generatedTypeId="",this.valueset=null,this.inputrels=null,this.outputrels=null,this.parentModel=null,this.allProperties=null,this.copiedFromId="",this.type&&(this.relshipkind=this.getRelshipKind())}}class cxObject extends cxInstance{addObjectView(e){this.objectviews||(this.objectviews=[]);let t=this.objectviews.length;debug&&console.log("4881 objview",e.markedAsDeleted,e,this.objectviews);for(let l=0;l<t;l++){let o=this.objectviews[l];if(debug&&console.log("4884 objview",o.markedAsDeleted,o),o.id===e.id){for(let i in e)o[i]=e[i];debug&&console.log("4890 objview",o.markedAsDeleted,o);return}}this.objectviews.push(e)}removeObjectView(e){if(debug&&console.log("4893 this.objectviews",this.objectviews),!this.objectviews)return;let t=[],l=this.objectviews.length;for(let o=0;o<l;o++){let i=this.objectviews[o];i.id!==e.id&&t.push(i)}debug&&console.log("4904 objview, objviews",e,t),this.objectviews=t}getObjectType(){return this.type}getInheritanceObjects(e){let t=[],l=this.findOutputRelships(e,constants.relkinds.GEN);if(null==l?void 0:l.length)for(let o=0;o<(null==l?void 0:l.length);o++){let i=l[o];if(i){let n=i.toObject;n&&t.push(n)}}return debug&&console.log("6459 objlist",t),t}getInheritedObjectTypes(e){let t=[],l=this.findOutputRelships(e,constants.relkinds.GEN);for(let o=0;o<(null==l?void 0:l.length);o++){let i=l[o];if(i){let n=i.toObject;n&&n.type&&t.push(n.type)}}let s=this.type,a=null==s?void 0:s.getSupertypes();for(let r=0;r<(null==a?void 0:a.length);r++){let d=a[r];t.push(d)}return debug&&console.log("6472 typelist",t),t}getConnectedObject(e,t){let l=null,o=this,i=e.methodRef,n=t.findMethod(i);if(e.name,debug&&console.log("7083 prop, method",e,n),n){let s=n.methodtype;if(s===constants.types.MTD_GETCONNECTEDOBJECT){let a;debug&&console.log("7087 method",n);let r=n.reltype,d=n.reldir,c=null;"any"!==r&&"null"!==r&&(c=t.findRelationshipTypeByName(r)),debug&&console.log("7093 rtypename, reltype",r,c);let p=n.objtype,h=null;"any"!==p&&"null"!==p&&(h=t.findObjectTypeByName(p)),debug&&console.log("7098 otypename, objtype",p,h),a={myMetis:t,reltype:c,reldir:d,objtype:h,prop:e},l=_ui_methods__WEBPACK_IMPORTED_MODULE_0__.Mx(this,a),debug&&console.log("7107 inst, context, obj",o,a,l)}}return l}getConnectedObjects(e){let t=this.type,l=null==t?void 0:t.properties,o=[];for(let i=0;i<(null==l?void 0:l.length);i++){let n=l[i];if(n){let s=this.getConnectedObject(n,e);s&&o.push(s)}}return o}getConnectedObjects1(e,t){let l=null,o=this,i=e.methodRef,n=t.findMethod(i);if(e.name,debug&&console.log("7307 prop, method",e,n),n){let s=n.methodtype;if(s===constants.types.MTD_GETCONNECTEDOBJECT){let a;debug&&console.log("7312 method",n);let r=n.reltype,d=n.reldir,c=n.objtype,p=null;"any"!==c&&"null"!==c&&(p=t.findObjectTypeByName(c)),debug&&console.log("7319 otypename, objtype",c,p);let h=null;"any"!==r&&"null"!==r&&(h=t.findRelationshipTypeByName2(r,this.type,p)),debug&&console.log("7323 rtypename, reltype",r,h),a={myMetis:t,reltype:h,reldir:d,objtype:p,prop:e},l=_ui_methods__WEBPACK_IMPORTED_MODULE_0__.Bq(this,a),debug&&console.log("7332 inst, context, objects",o,a,l)}}return l}getConnectedObjects2(e){let t=this.type,l=null==t?void 0:t.properties,o=[];for(let i=0;i<(null==l?void 0:l.length);i++){let n=l[i];if(n){let s=this.getConnectedObjects1(n,e);for(let a=0;a<(null==s?void 0:s.length);a++)o.push(s[a])}}return o}getConnectedObjectRoles(e){let t=this.type,l=null==t?void 0:t.properties,o=[];for(let i=0;i<(null==l?void 0:l.length);i++){let n=l[i];if(n){let s=this.getConnectedObjects1(n,e);for(let a=0;a<(null==s?void 0:s.length);a++)o.push(n.name)}}return o}hasInheritedProperties(e){let t=!1,l=this.getInheritedTypes();if((null==l?void 0:l.length)>0)for(let o=0;o<l.length;o++){let i=l[o];if(i.hasProperties())return!0}if((null==(l=this.getInheritedObjectTypes(e))?void 0:l.length)>0)for(let n=0;n<(null==l?void 0:l.length);n++){let s=l[n];if(s.hasProperties())return!0}let a=this.getInheritanceObjects(e);if(debug&&console.log("6496 this, objects",this,a),(null==l?void 0:l.length)>0)for(let r=0;r<(null==a?void 0:a.length);r++){let d=a[r],c=null==d?void 0:d.type;if(null==c?void 0:c.hasProperties())return!0}return t}getInheritedProperties(e){let t=[],l=this.getInheritanceObjects(e);debug&&console.log("7159 inheritanceObjects",l);for(let o=0;o<(null==l?void 0:l.length);o++){let i=l[o],n=null==i?void 0:i.type;if(null==n?void 0:n.hasProperties()){let s=n.properties;for(let a=0;a<s.length;a++){let r=s[a];t.push(r)}}}return debug&&console.log("7171 inherited Properties",t),t}getConnectedProperties(e){let t=[],l=this.getConnectedObjects2(e);for(let o=0;o<(null==l?void 0:l.length);o++){let i=l[o],n=new cxProperty(utils.createGuid(),i.type.name,"");t.push(n)}return t}isOfType(e){let t=!1;if(this.type.name===e)return!0;let l=this.type.supertypes;for(let o=0;o<(null==l?void 0:l.length);o++){let i=l[o];if((null==i?void 0:i.name)===e)return!0}return t}isOfSystemType(e){let t=!1,l=this.type;if(this.name===l.name||l.name===e)return!0;let o=l.supertypes;for(let i=0;i<(null==o?void 0:o.length);i++){let n=o[i];if((null==n?void 0:n.name)===e)return!0}return t}constructor(e,t,l,o){var i;super(e,t,l,o),this.fs_collection=constants.fs.FS_C_OBJECTS,this.category=constants.gojs.C_OBJECT,this.objectviews=null;let n=null===(i=this.type)||void 0===i?void 0:i.properties;for(let s=0;s<(null==n?void 0:n.length);s++){let a=n[s];"id"!==a.name&&a&&(this[a.name]="")}debug&&console.log("4600 obj",this)}}class cxRelationship extends cxInstance{setNameFrom(e){this.nameFrom=e}getNameFrom(){return this.nameFrom}setNameTo(e){this.nameTo=e}getNameTo(){return this.nameTo}addRelationshipView(e){this.relshipviews||(this.relshipviews=[]);let t=this.relshipviews.length;for(let l=0;l<t;l++){let o=this.relshipviews[l];if(o.id===e.id||!o.fromObjview||!o.toObjview)return}this.relshipviews.push(e)}removeRelationshipView(e){if(!this.relshipviews)return;let t=[],l=this.relshipviews.length;for(let o=0;o<l;o++){let i=this.relshipviews[o];i.id!==e.id&&t.push(i)}this.relshipviews=t}getRelationshipViews(){return this.relshipviews}getRelationshipType(){return this.type}getCardinality(){let e=this.cardinality;if(e||(e=""),0==e.length){let t=this.type;e=t.getCardinality(),this.cardinality=e}return e}getCardinalityFrom(){let e=this.cardinalityFrom;if(e||(e=""),0==e.length){let t=this.type;t&&(e=t.getCardinalityFrom(),this.cardinalityFrom=e)}return e}getCardinalityTo(){let e=this.cardinalityTo;if(e||(e=""),0==e.length){let t=this.type;t&&(e=t.getCardinalityTo(),this.cardinalityTo=e)}return e}isSystemRel(){let e=!1,t=this.type;return t&&t.toObjtype&&(t.toObjtype.name===constants.types.AKM_PROPERTY?t.name===constants.types.AKM_HAS_PROPERTY&&(e=!0):t.toObjtype.name===constants.types.AKM_METHOD?t.name===constants.types.AKM_HAS_METHOD&&(e=!0):t.toObjtype.name===constants.types.AKM_INPUTPATTERN?t.name===constants.types.AKM_HAS_INPUTPATTERN&&(e=!0):t.toObjtype.name===constants.types.AKM_VIEWFORMAT?t.name===constants.types.AKM_HAS_VIEWFORMAT&&(e=!0):t.toObjtype.name===constants.types.AKM_FIELDTYPE?t.name===constants.types.AKM_HAS_FIELDTYPE&&(e=!0):t.toObjtype.name===constants.types.AKM_COLLECTION?t.name===constants.types.AKM_HAS_COLLECTION&&(e=!0):t.fromObjtype.name===constants.types.AKM_LABEL&&t.name===constants.types.AKM_ANNOTATES&&(e=!0)),e}constructor(e,t,l,o,i,n){super(e,i,t,n),this.fs_collection=constants.fs.FS_C_RELATIONSHIPS,this.category=constants.gojs.C_RELATIONSHIP,this.fromObject=l,this.toObject=o,this.cardinality="",this.cardinalityFrom="",this.cardinalityTo="",this.nameFrom="",this.nameTo="",this.typeName||(this.typeName=i),this.type&&(this.cardinality=this.getCardinality(),this.cardinalityFrom=this.getCardinalityFrom(),this.cardinalityTo=this.getCardinalityTo()),null==o||o.addInputrel(this),null==l||l.addOutputrel(this)}}class cxPropertyValue{constructor(e,t){this.property=e,this.value=t}}class cxValue extends cxMetaObject{constructor(e,t,l){super(e,t,l),this.value=this.name}}class cxViewFormat extends cxMetaObject{getViewFormat(){return this.viewFormat}setViewFormat(e){this.viewFormat=e}constructor(e,t,l){super(e,t,l),this.viewFormat="%s"}}class cxFieldType extends cxMetaObject{getFieldType(){return this.fieldType}setFieldType(e){this.fieldType=e}constructor(e,t,l){super(e,t,l),this.fieldType="text"}}class cxInputPattern extends cxMetaObject{getInputPattern(){return this.inputPattern}setInputPattern(e){this.inputPattern=e}constructor(e,t,l){super(e,t,l),this.inputPattern=""}}class cxModelView extends cxMetaObject{clearContent(){this.viewstyle=null,this.viewstyles=null,this.objecttypeviews=null,this.relshiptypeviews=null,this.objectviews=null,this.relshipviews=null,this.layout="Tree",this.routing="Normal",this.linkcurve="None",this.showCardinality=!1,this.showRelshipNames=!0,this.askForRelshipName=!1,this.template=null,this.isTemplate=!1,this.diagrams=null}setModel(e){this.model=e}getModel(){return this.model}setViewStyle(e){this.viewstyle=e}getViewStyle(){return this.viewstyle}setViewStyles(e){this.viewstyles=e}getViewStyles(){return this.viewstyles}setLayout(e){this.layout=e}getLayout(){return this.layout}setRouting(e){this.routing=e}getRouting(){return this.routing}setTemplate(e){this.template=e}getTemplate(){return this.template}setIsTemplate(e){this.isTemplate=e}getIsTemplate(){return this.isTemplate}setObjectViews(e){this.objectviews=e}getObjectViews(){return this.objectviews}setObjectTypeViews(e){this.objecttypeviews=e}getObjecTypeViews(){return this.objecttypeviews}setRelationshipViews(e){this.relshipviews=e}getRelationshipViews(){return this.relshipviews}setRelationshipTypeViews(e){this.relshiptypeviews=e}getRelationshipTypeViews(){return this.relshiptypeviews}addObjectTypeView(e){e.category===constants.gojs.C_OBJECTTYPEVIEW&&(null==this.objecttypeviews&&(this.objecttypeviews=[]),this.objecttypeviews.push(e))}addRelationshipTypeView(e){e.category===constants.gojs.C_RELSHIPTYPEVIEW&&(null==this.relshiptypeviews&&(this.relshiptypeviews=[]),this.relshiptypeviews.push(e),debug&&console.log("7870 Add reltypeView",e))}addObjectView(e){if(debug&&console.log("5151 objview",e.markedAsDeleted,e),e.category===constants.gojs.C_OBJECTVIEW){null==this.objectviews&&(this.objectviews=[]);let t=this.findObjectView(e.id);if(t)for(let l in e)e[l]=e[l];else this.objectviews.push(e)}}removeObjectView(e){if(!this.objectviews)return;let t=[],l=this.objectviews.length;for(let o=0;o<l;o++){let i=this.objectviews[o];i.id!==e.id&&t.push(i)}debug&&console.log("5171 objview, objviews",e,t),this.objectviews=t}addRelationshipView(e){e.category===constants.gojs.C_RELSHIPVIEW&&(null==this.relshipviews&&(this.relshipviews=[]),!this.findRelationshipView(e.id))&&e.fromObjview&&e.toObjview&&this.relshipviews.push(e)}findObjectView(e){if(!this.objectviews)return null;let t=0,l=null;for(;t<this.objectviews.length;){if((l=this.objectviews[t])&&(l.id===e||l.getFirestoreId()===e))return l;t++}}findObjectViewByName(e){if(!this.objectviews)return null;let t=0,l=null;for(;t<this.objectviews.length;){if((l=this.objectviews[t]).name===e)return l;t++}}findObjectViewsByObj(e){let t=[],l=this.objectviews;if(!l)return null;for(let o=0;o<l.length;o++){var i;let n=l[o];(null==n?void 0:null===(i=n.object)||void 0===i?void 0:i.id)===e.id&&t.push(n)}return t}findObjectTypeView(e){if(!this.objecttypeviews)return null;let t=0,l=null;for(;t<this.objecttypeviews.length;){if((l=this.objecttypeviews[t])&&(l.id===e||l.getFirestoreId()===e))return l;t++}}findRelationshipView(e){let t=this.relshipviews;if(!t)return null;let l=0,o=null;for(;l<t.length;){if((o=t[l])&&(o.id===e||o.getFirestoreId()===e))return o;l++}}findRelationshipViewsByRel(e){let t=[],l=this.relshipviews;if(!l)return null;for(let o=0;o<l.length;o++){var i;let n=l[o];null!=n&&n.markedAsDeleted||(null==n?void 0:null===(i=n.relship)||void 0===i?void 0:i.id)!==e.id||t.push(n)}return t}findRelationshipViewsByRel2(e,t,l){let o=[];if(t&&l){let i=this.relshipviews;if(!i)return null;for(let n=0;n<i.length;n++){var s,a,r;let d=i[n];null!=d&&d.markedAsDeleted||(null==d?void 0:null===(s=d.relship)||void 0===s?void 0:s.id)!==(null==e?void 0:e.id)||(null===(a=d.fromObjview)||void 0===a?void 0:a.id)!==t.id||(null===(r=d.toObjview)||void 0===r?void 0:r.id)!==l.id||o.push(d)}}return o}findRelationshipTypeView(e){var t;if(!this.relshiptypeviews)return null;let l=0,o=null;for(;l<(null===(t=this.relshiptypeviews)||void 0===t?void 0:t.length);)if(null==(o=this.relshiptypeviews[l])||!o.markedAsDeleted){if(o&&(o.id===e||o.getFirestoreId()===e))return o;l++}return null}constructor(e,t,l,o){super(e,t,o),this.category=constants.gojs.C_MODELVIEW,this.fs_collection=constants.fs.FS_C_MODELVIEWS,this.model=l,this.viewstyle=null,this.viewstyles=null,this.objecttypeviews=null,this.relshiptypeviews=null,this.objectviews=null,this.relshipviews=null,this.scale="1",this.memberscale=constants.params.MEMBERSCALE,this.layout="Tree",this.routing="Normal",this.linkcurve="None",this.showCardinality=!1,this.showRelshipNames=!0,this.askForRelshipName=!1,this.includeInheritedReltypes=null,this.template=null,this.isTemplate=!1,this.diagrams=null}}class cxObjectView extends cxMetaObject{setObject(e){utils.objExists(e)&&(this.object=e)}getObject(){return this.object}getObjectType(){let e=this.getObject();if(e)return e.getType()}setTypeView(e){e&&(this.typeview=e)}getTypeView(){return this.typeview}getDefaultTypeView(){let e=this.getObject();if(e){let t=e.getType();if(t){let l=t.typeview;return l}}return null}setIcon(e){this.icon=e}getIcon(){return this.icon?this.icon:""}setIsGroup(e){this.isGroup=e}getIsGroup(){return!!utils.objExists(this.isGroup)&&this.isGroup}setGroup(e){this.group=e}getGroup(){return utils.objExists(this.group)?this.group:""}setGroupLayout(e){this.groupLayout=e}getGroupLayout(){return utils.objExists(this.groupLayout)?this.groupLayout:""}getParentModelView(e){let t=e.modelviews;for(let l=0;l<t.length;l++){let o=t[l];if(o){let i=o.objectviews;for(let n=0;n<i.length;n++){let s=i[n];if(this.id===s.id)return o}}}return null}getGroupMembers(e){let t=[];if(this.isGroup){let l=this.id,o=e.getObjectViews();for(let i=0;i<(null==o?void 0:o.length);i++){let n=o[i];n.group===l&&t.push(n)}}return t}setParent(e){this.parent=e}getParent(){return utils.objExists(this.parent)?this.parent:""}setTemplate(e){void 0==e&&(e=""),this.template=e}getTemplate(){return void 0==this.template?"":this.template}setFigure(e){void 0==e&&(e=""),this.figure=e}getFigure(){return void 0==this.template?"":this.template}setSize(e){void 0==e&&(e=""),this.size=e}getSize(){return void 0==this.size?"":this.size}setScale(e){void 0==e&&(e="1"),this.scale1=e}getScale(){return void 0==this.scale1?"1":this.scale1}setMemberscale(e){var t;void 0==e&&(this.memberscale=(null===(t=this.typeview)||void 0===t?void 0:t.memberscale)?this.typeview.memberscale:"1"),this.memberscale=e}getMemberscale(){var e;return void 0==this.memberscale?(null===(e=this.typeview)||void 0===e?void 0:e.memberscale)?this.typeview.memberscale:"1":this.memberscale}setArrowscale(e){var t;void 0==e&&(this.arrowscale=(null===(t=this.typeview)||void 0===t?void 0:t.arrowscale)?this.typeview.arrowscale:"1.3"),this.arrowscale=e}getArrowscale(){var e;return void 0==this.arrowscale?(null===(e=this.typeview)||void 0===e?void 0:e.arrowscale)?this.typeview.arrowscale:"1.3":this.arrowscale}setTextscale(e){void 0==e&&(e="1"),this.textscale=e}getTextscale(){return void 0==this.textscale?"1":this.textscale}setLoc(e){this.loc=e}getLoc(){return utils.objExists(this.loc)?this.loc:""}clearViewdata(){let e=this.typeview.data;for(let t in e)"class"!==t&&"abstract"!==t&&"isGroup"!==t&&"group"!==t&&"viewkind"!==t&&(this[t]="")}constructor(e,t,l,o){var i,n,s,a,r;super(e,t,o),this.fs_collection=constants.fs.FS_C_OBJECTVIEWS,this.category=constants.gojs.C_OBJECTVIEW,this.object=l,this.objectRef="",this.typeview=null==l?void 0:null===(i=l.type)||void 0===i?void 0:i.typeview,this.typeviewRef=null===(n=this.typeview)||void 0===n?void 0:n.id,this.group="",this.isGroup=!1,this.groupLayout="",this.parent="",this.isCollapsed=!1,this.text="",this.visible=!0,this.viewkind="",this.loc="",this.size="",this.scale1="1",this.memberscale=(null===(s=this.typeview)||void 0===s?void 0:s.memberscale)?this.typeview.memberscale:"1",this.arrowscale=(null===(a=this.typeview)||void 0===a?void 0:a.arrowscale)?this.typeview.arrowscale:"1.3",this.textscale=(null===(r=this.typeview)||void 0===r?void 0:r.textscale)?this.typeview.textscale:"1",this.template="",this.figure="",this.geometry="",this.fillcolor="",this.fillcolor2="",this.strokecolor="",this.strokecolor2="",this.strokewidth="1",this.textcolor="",this.icon=""}}class cxRelationshipView extends cxMetaObject{getRelationship(){return this.relship}setRelationship(e){e&&(this.relship=e)}setTypeView(e){e&&(this.typeview=e)}getTypeView(){return this.typeview}setFromObjectView(e){utils.objExists(e)&&(this.fromObjview=e)}getFromObjectView(){return this.fromObjview}setToObjectView(e){utils.objExists(e)&&(this.toObjview=e)}getToObjectView(){return this.toObjview}clearViewdata(){let e=this.typeview.data;for(let t in e)"class"!==t&&"abstract"!==t&&"relshipkind"!==t&&(this[t]="")}setTemplate(e){void 0==e&&(e=""),this.template=e}getTemplate(){return void 0==this.template?"":this.template}setTextScale(e){this.textscale=e}getTextScale(){return void 0==this.textscale?"1":this.textscale}setArrowScale(e){this.arrowscale=e}getArrowScale(){return void 0==this.arrowscale?"1":this.arrowscale}setFromArrow(e){this.fromArrow=e}setFromArrowColor(e){this.fromArrowColor=e}setFromArrow2(e){switch(e){case"Composition":this.setFromArrow("StretchedDiamond"),this.setFromArrowColor("black"),this.textcolor="black";break;case"Aggregation":this.setFromArrow("StretchedDiamond"),this.setFromArrowColor("white"),this.textcolor="black";break;case"Generalization":this.setFromArrow(" "),this.setFromArrowColor(" "),this.textcolor="black"}debug&&console.log("5773 fromArrowColor",this.fromArrowColor)}setToArrow(e){this.toArrow=e}setToArrowColor(e){this.toArrowColor=e}setToArrow2(e){switch(e){case"Generalization":this.setToArrow("Triangle"),this.setToArrowColor("white"),this.textcolor="black";break;case"Aggregation":case"Composition":this.setToArrow("OpenTriangle"),this.textcolor="black"}}constructor(e,t,l,o){var i;super(e,t,o),this.fs_collection=constants.fs.FS_C_RELSHIPVIEWS,this.category=constants.gojs.C_RELSHIPVIEW,this.relship=l,this.typeview=null==l?void 0:null===(i=l.type)||void 0===i?void 0:i.typeview,this.fromObjview=null,this.toObjview=null,this.template="",this.textscale="",this.arrowscale="",this.strokecolor="",this.strokewidth="",this.textcolor="",this.dash="",this.fromArrow="",this.toArrow="",this.fromArrowColor="",this.toArrowColor="",this.points=null}}class cxGeometry extends cxMetaObject{setGeometry(e,t,l){this.geometry=e,this.stroke=t,this.fill=l}constructor(e,t,l){super(e,t,l),this.geometry="",this.stroke="",this.fill=""}}class cxDiagram extends cxMetaObject{setModelView(e){this.modelview=e}getModelView(){return this.modelview}setContent(e){this.content=e}getContent(){return this.content}constructor(e,t,l,o){super(e,t,o),this.modelview=l,this.content=null}}class cxIdent{constructor(e,t){this.id=e,this.name=t}}},6433:function(e,t,l){"use strict";l.d(t,{AS:function(){return _},Bc:function(){return m},Cw:function(){return F},D3:function(){return N},EN:function(){return g},GT:function(){return A},Gh:function(){return U},H_:function(){return v},I:function(){return J},IK:function(){return b},KP:function(){return D},Kp:function(){return R},Ne:function(){return V},Pg:function(){return h},Pv:function(){return x},Yw:function(){return w},Zw:function(){return f},b8:function(){return M},dG:function(){return L},dN:function(){return Q},fM:function(){return $},ju:function(){return ee},kk:function(){return W},ly:function(){return z},m:function(){return B},m4:function(){return T},mz:function(){return et},nW:function(){return p},om:function(){return y},qs:function(){return E},rw:function(){return C},s_:function(){return O},v4:function(){return u},wR:function(){return S},yR:function(){return P}});var o=l(3165),i=l(8749),n=l(6575),s=l(6680),a=l(137);let r=!1,d=l(2586),c=l(5523);function p(e,t){if(r&&console.log("22 context, data",t,e),null===e);else{var l,n;let a;let c=t.myMetis,p=t.myModel;t.myMetamodel;let h=t.myModelview,u=t.myGoModel,m=t.myDiagram;r&&console.log("31 createObject",t,e);let g=null===(l=e.objecttype)||void 0===l?void 0:l.id,f=c.findObjectType(g);if(!f)return null;r&&console.log("36 createObject",c,e);let y=e.object;""===y.id&&(y.id=o.createGuid());let v=c.findObject(y.id);v&&(y=v);let b=t.pasted?e.name:"";if(e.parentModel||(b=e.name),r&&console.log("44 context, name",t,b),c.pasteViewsOnly){let w=c.findObject(y.id);if(f.name===d.types.AKM_CONTAINER){let j=o.createGuid();y=new i.e9(j,e.name,f,e.description)}else if(w)y=w;else{let k=y.id;y=new i.e9(k,e.name,f,e.description),c.pasteViewsOnly=!1}}else y=new i.e9(o.createGuid(),b,f,e.description);if(r&&console.log("58 obj, myMetis",y,c),y){c.pasteViewsOnly||(y.objectviews=null,y.inputrels=null,y.outputrels=null),e.object=y,e.category="Object",m.model.setDataProperty(e,"category",e.category),null==p||p.addObject(y),r&&console.log("70 obj, myModel, myMetis",y,p,c),c.addObject(y),r&&console.log("73 obj",y);let O=y.objectviews,M=(null==O?void 0:O.length)>0?O[0]:null;if(a=new i.q6(o.createGuid(),b,y,""),r&&console.log("79 objview",a),a){a.setIsGroup(e.isGroup),a.setLoc(e.loc),a.setSize(e.size),a.setScale(e.scale1),a.setMemberscale(e.memberscale);let D=e.key.substr(0,36),E=null==u?void 0:u.findNode(D);if(!E&&(E=new s.of(D,a))){E.loc=e.loc,r&&console.log("97 node, data",E,e);let x=T(u,E.loc);if(r&&console.log("99 group",x),x){let R=x;E.group=R.key,E.scale1=new String(E.getMyScale(u)),e.scale1=Number(E.scale1)}}r&&console.log("106 data, node, myGoModel",e,E,u),e.objectview=a,y.addObjectView(a),h.addObjectView(a),c.addObjectView(a),r&&console.log("112 data, objview",e,a),m.model.setDataProperty(e,"type",e.name),m.model.setDataProperty(e,"name",b),m.model.setDataProperty(e,"scale",e.scale1),m.model.setDataProperty(e,"objectview",a);let N=null==f?void 0:f.getDefaultTypeView();if(t.pasted){let A=null===(n=e.typeview)||void 0===n?void 0:n.id;N=c.findObjectTypeView(A),r&&console.log("124 objtypeView",N)}if(M){r&&console.log("127 oview0",M);let S=N.data;for(let C in S)M[C]?(a[C]=M[C],m.model.setDataProperty(e,C,a[C])):m.model.setDataProperty(e,C,S[C]);r&&console.log("137 objview",a);let P=new s.of(e.key,a);return u.addNode(P),Y(P,N,m,u),a}if(!N){let I=o.createGuid();N=new i.DG(I,f.name,f,"")}if(N){a.setTypeView(N),N.data;let _=new s.of(e.key,a);r&&console.log("137 createObject",_,e),Y(_,N,m,u),_.isGroup=e.isGroup,_.loc=e.loc,_.size=e.size,_.scale1=e.scale1,_.memberscale=e.memberscale;let L=T(u,a.loc);if(r&&console.log("143 group",L,_),L){L.memberscale=L.typeview.memberscale,_.group=L.key;let V=Number(L.scale1)*Number(L.memberscale);0===V&&(V=1),_.scale1=V.toString(),a.group=L.objectview.id,a.scale1=_.scale1;let F=m.findNodeForKey(e.key);m.model.setDataProperty(F.data,"group",_.group),m.model.setDataProperty(F.data,"memberscale",Number(e.memberscale)),r&&console.log("150 group, node, data",L,_,e),r&&console.log("162 n.data",F.data)}let G=m.findNodeForKey(_.key);m.model.setDataProperty(G.data,"memberscale",Number(e.memberscale)),m.model.setDataProperty(G,"scale",Number(e.scale1)),r&&console.log("167 n.data",G.data),u.addNode(_)}return a}r&&console.log("191 myMetis",c)}}return null}function h(e,t){let l=t.myMetamodel,n=t.myMetis,a=t.myGoMetamodel,c=t.myDiagram;if(e.category===d.gojs.C_OBJECTTYPE){let p;r&&console.log("170 createObjectType",e);let h=e.type,u=e.name;if(h===d.types.OBJECTTYPE_ID){if(u!==d.types.OBJECTTYPE_NAME||u!==d.types.CONTAINERTYPE_NAME){if(p=l.findObjectTypeByName(u)){let m=p.getDefaultTypeView();m||((m=new i.DG(o.createGuid(),p.name,p,"")).setModified(),p.setDefaultTypeView(m),p.setModified(),l.setModified(),l.addObjectTypeView(m),n.addObjectTypeView(m));let g=new i.sS(o.createGuid(),l,p,e.loc,e.size);g&&(l.addObjtypeGeo(g),n.addObjtypeGeo(g)),c.model.setDataProperty(e,"category",d.gojs.C_OBJECTTYPE),c.model.setDataProperty(e,"objecttype",p),Y(e,m,c,a)}else{let f=d.gojs.C_OBJECTTYPE;u="New Type",e.viewkind===d.viewkinds.CONT&&(u="New Container"),p=new i.m2(o.createGuid(),u,"");{p.setModified(),p.setViewKind(e.viewkind),l.addObjectType(p),l.setModified(),n.addObjectType(p);let y=new i.DG(o.createGuid(),p.name,p,"");if(y){y.setModified(),y.setViewKind(e.viewkind);let v=y.getData();for(let b in v)"icon"!==b&&"isGroup"!==b&&"group"!==b&&(v[b]=e[b]);l.objtypegeos||(l.objtypegeos=[]);let w=l.findObjtypeGeoByType(p);w||(w=new i.sS(o.createGuid(),l,p,e.loc,e.size),l.objtypegeos.push(w)),p.setDefaultTypeView(y),l.addObjectTypeView(y),l.setModified(),n.addObjectTypeView(y),c.model.setDataProperty(e,"category",d.gojs.C_OBJECTTYPE),c.model.setDataProperty(e,"objecttype",p),c.model.setDataProperty(e,"name",u),c.model.setDataProperty(e,"typename",f);let j=o.createGuid();e.id=j;let T=new s.Yg(j,p);a.addNode(T),Y(e,y,c,a)}}}}return p}}}function u(e,t,l,o){if(null!==e&&"name"===t&&e.object){let i=o.myMetis,n=e.object,s=e.objectview,a=i.findObject(n.id);return a&&(n=a,s=i.findObjectView(s.id)),n.setName(l),n.setModified(),s&&(s.setName(l),s.setModified(),n.addObjectView(s)),n}}function m(e,t,l,n){if(null!==e&&"name"===t){let s=n.myMetis,a=n.myMetamodel,r=e.objecttype;r=s.findObjectType(r.id);let d=e.name;if(r){if("New Type"===r.name||"New Container"===r.name){let c=s.findObjectTypeByName(d);if(c){let p=r.getId();r=c,o.removeElementFromArray(a.getObjectTypes(),p),a.addObjectType(r),o.removeElementFromArray(s.getObjectTypes(),p),s.addObjectType(r)}else r.setName(d),r.setModified(),a.setModified()}else r.setName(d),r.setModified(),a.setModified();let h=r.getDefaultTypeView();e.typeview=h,h?(r.setName(d),r.setModified(),a.setModified(),h.setName(d),h.setModified()):((h=new i.DG(o.createGuid(),d,r,"")).setModified(),r.setDefaultTypeView(h),r.setModified(),a.setModified(),a.addObjectTypeView(h),s.addObjectTypeView(h)),n.myDiagram.model.setDataProperty(e,"name",l)}n.myDiagram.requestUpdate()}}function g(e,t,l){let o=l.myMetis,i=l.myDiagram;if(t){var n,s;let d=t.getDefaultTypeView(),c=o.findObject(null===(n=e.object)||void 0===n?void 0:n.id);if(c){let p=c.name!==(null===(s=c.type)||void 0===s?void 0:s.name);c.setType(t),c.setModified();let h=o.findObjectView(e.objectview.id);if(h){h.setTypeView(d),h.setModified(),h.setObject(c),p||i.model.setDataProperty(e,"name",t.name),h.template=e.template,h.figure=e.figure,h.fillcolor=e.fillcolor,h.strokecolor=e.strokecolor,h.strokewidth=e.strokewidth,h.icon=e.icon,e.object.type=t,e.objecttype=t,e.typename=t.name,e.typeview=d,Y(e,d,i,o.gojsModel),r&&console.log("394 node",e);let u=new a.kC(h);r&&console.log("397 jsnObjview",u);let m=[];m.push(u),m.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),i.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})})}let g=c&&new a.GZ(c);r&&console.log("407 jsnObject",g);let f=[];return f.push(g),f.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),i.dispatch({type:"UPDATE_OBJECT_PROPERTIES",data:t})}),h}}}function f(e){let t;for(let l in t=new i.e9(o.createGuid(),e.name,e.type,e.description),e)"id"!==l&&"name"!==l&&"description"!==l&&"inputrels"!==l&&"outputrels"!==l&&"objectviews"!==l&&"relshipviews"!==l&&"modified"!==l&&"generatedTypeId"!==l&&(t[l]=e[l]);return t.copiedFromId=e.id,t}function y(e,t,l){r&&console.log("457 fromRel, fromObj, toObj",e,t,l);let n=e.type,s=new i.Uj(o.createGuid(),n,t,l,e.name,e.description);for(let a in r&&console.log("459 toRel",s),s.fromObject=t,s.toObject=l,e)"id"!==a&&"name"!==a&&"description"!==a&&"modified"!==a&&"generatedTypeId"!==a&&"fromObject"!==a&&"toObject"!==a&&"relshipviews"!==a&&(s[a]=e[a]);return s}function v(e,t){e&&(e.markedAsDeleted=t)}function b(e,t,l){let o=l.myMetis,i=l.myMetamodel,n=l.myDiagram;if(n.selection,e.category===d.gojs.C_OBJECTTYPE){let s=l.myGoMetamodel;if(null==s?void 0:s.findNode(e.key)){let a=e.name,c=i.findObjectTypeByName(a);if(c){c.markedAsDeleted=t;let p=c.getDefaultTypeView();p&&(p.markedAsDeleted=t)}}}else if(e.category===d.gojs.C_OBJECT){let h=l.myGoModel,u=null==h?void 0:h.findNode(e.key);if(r&&console.log("469 delete node",u),u){u.markedAsDeleted=t,u.group="";let m=u.objectview;m.markedAsDeleted=t;let g=m.object;if(r&&console.log("477 delete objview",m),u.isGroup){r&&console.log("479 delete container",m);let f=u.getGroupMembers(h);for(let y=0;y<(null==f?void 0:f.length);y++){let v=f[y];b(v,t,l),n.requestUpdate()}}if(o.deleteViewsOnly){g.removeObjectView(m),r&&console.log("490 object, objview",g,m),r&&console.log("491 myMetis",o);return}g&&(g.markedAsDeleted=t,r&&console.log("499 delete object",g)),r&&console.log("518 nodes to delete",n.selection),n.requestUpdate();let w=null==g?void 0:g.inputrels;r&&console.log("521 inputrels",w);for(let j=0;j<(null==w?void 0:w.length);j++){let T=w[j];if(T.markedAsDeleted!==t){T.markedAsDeleted=t,r&&console.log("526 delete relship",T);let k=T.relshipviews;r&&console.log("528 input relviews",k);for(let O=0;O<(null==k?void 0:k.length);O++){let M=k[0];if(M){let D=h.findLinkByViewId(M.id);D&&(D.markedAsDeleted=t,n.model.removeLinkData(D)),M.markedAsDeleted=t,r&&console.log("540 delete relview",M)}}r&&console.log("545 delete rel",T)}}w=null==g?void 0:g.outputrels,r&&console.log("549 outputrels",w);for(let E=0;E<(null==w?void 0:w.length);E++){let x=w[E];if(x.markedAsDeleted!==t){x.markedAsDeleted=t;let R=x.relshipviews;r&&console.log("555 outputrelviews",R);for(let N=0;N<(null==R?void 0:R.length);N++){let A=R[0];if(A){let S=h.findLinkByViewId(A.id);S&&(S.markedAsDeleted=t),A.markedAsDeleted=t,r&&console.log("564 delete relview",A)}}r&&console.log("569 delete rel",x)}}}}}function w(e,t,l){l.myMetamodel;let o=l.myMetis,i=l.myGoModel,n=[];for(let s=0;s<(null==i?void 0:i.links.length);s++){let a=i.links[s];n.push(a)}i.links=n;let d=null==i?void 0:i.findLink(e.key);if(r&&console.log("697 link",d),d){let c=d.relshipview,p=c.relship;if(o.deleteViewsOnly){c.markedAsDeleted=t,null==p||p.removeRelationshipView(c),r&&console.log("707 deleteLink",p,c);return}if(p){p.markedAsDeleted=t,c.markedAsDeleted=t;let h=null==o?void 0:o.getRelationshipViewsByRelship(p.id);if(h)for(let u=0;u<h.length;u++){let m=h[u];r&&console.log("721 rview",m),m.markedAsDeleted||(m.markedAsDeleted=t,r&&console.log("725 rview",m),j(m,t))}}}}function j(e,t){let l=null==e?void 0:e.relship,o=null==l?void 0:l.type,i=null==e?void 0:e.typeview,n=null==o?void 0:o.typeview;i&&n&&i.id!==n.id&&i.markedAsDeleted!==t&&(i.markedAsDeleted=t,r&&console.log("683 delete typeview",i))}function T(e,t){if(!t)return;let l=e.nodes,i=o.removeArrayDuplicates(l);l=i,r&&console.log("nodes, loc ",l,t);let n=[];for(let s=0;s<(null==l?void 0:l.length);s++){let a=l[s];if(r&&console.log("863 node",a),a.isGroup){var d,c;r&&console.log("865 node",a);let p=t.split(" "),h=null===(d=a.loc)||void 0===d?void 0:d.split(" "),u=null===(c=a.size)||void 0===c?void 0:c.split(" ");if(!h)return;let m=parseInt(p[0]),g=parseInt(p[1]),f=parseInt(h[0]),y=parseInt(h[1]),v=parseInt(u[0]),b=parseInt(u[1]),w=Math.sqrt(v*v+b*b);if(r&&console.log("877 loc, node.loc",t,a.loc),r&&console.log("878 nx, gx, gw, ny, gy, gh",m,f,v,g,y,b),m>f&&m<f+v&&g>y&&g<y+b){let j={node:a,size:w};r&&console.log("884 group",j),n.push(j)}}}if(n=i=o.removeArrayDuplicates(n),r&&console.log("889 nodes, groups",l,n),!(n.length>0))return null;{let T=n[0].node,k=n[0].size;for(let O=0;O<n.length;O++){let M=n[O].size;M<k&&(T=n[O].node)}return T}}function k(e,t){var l;let o=null===(l=e.loc)||void 0===l?void 0:l.split(" ");if(!o)return;let i=parseInt(o[0]),n=parseInt(o[1]),s=t.loc.split(" "),a=parseInt(s[0]),d=parseInt(s[1]),c=a-i,p=d-n,h=t.scale1;c*=h,p*=h,a=i+c,d=n+p;let u={x:a,y:d};return r&&console.log("921 node, node.loc, loc",t,t.loc,u),u}function O(e,t,l,o,i,n){if("Object"===e.category){let s;let d=null==o?void 0:o.findNode(e.key);if(d||(d=e),d){r&&console.log("944 data, node, tonode",e,d,l),d.loc=l,d.size=e.size;let c=e.scale1;if(d.scale1=c,d.isGroup){let p=d,h=null==o?void 0:o.nodes;for(let u=0;u<h.length;u++){let m=h[u];if(m.key===p.key)continue;let g=T(o,m.loc);if(g){r&&console.log("960 grp, nod",g,m),m.group=g.key,k(g,m);let f=i.findNodeForKey(m.key);if(null==f?void 0:f.data)try{i.model.setDataProperty(f.data,"group",m.group),r&&console.log("968 n.data",f.data)}catch(y){r&&console.log("970 e",y)}}else m.group="";(s=m.objectview)&&(s.loc=m.loc,s.size=m.size,s.modified=!0,m.group?s.group=g.objectview.id:s.group="")}}let v=new a.kC(s);n.push(v)}return d}}function M(e,t,l){let o=[];r&&console.log("950 groupNode",e);let i=e.objectview,n=i.id;r&&console.log("1035 groupNode, groupId, myObjectviews",e,n,l);for(let s=0;s<(null==l?void 0:l.length);s++){let a=l[s];r&&console.log("1038 oview",a);let d=null==a?void 0:a.loc;if((null==a?void 0:a.group)===n){r&&console.log("1039 oview",a);let c=t.findNodeByViewId(a.id);c&&(c.objectview=a,c.loc=d,o.push(c))}}return r&&console.log("1063 nodes",o),o}function D(e,t,l,o){r&&console.log("1146 node, refloc, toloc, scaleFactor ",e,t,l,o);let i=null==t?void 0:t.split(" ");if(!i)return;let n=parseInt(i[0]),s=parseInt(i[1]),a=null==l?void 0:l.valueOf(),d=null==a?void 0:a.split(" ");if(!d)return;r&&console.log("1154 nodloc, nodeLoc, refloc",a,d,t);let c=parseInt(d[0]),p=parseInt(d[1]),h=(c-n)*o,u=(p-s)*o;r&&console.log("1159 rx, ry, nx, ny, deltaNx, deltaNy",n,s,c,p,h,u),c=n+h,p=s+u;let m={x:c,y:p};return r&&console.log("1163 node, node.loc, loc",e,e.loc,m),m}function E(e,t){let l;r&&console.log("974 createRelationship",e,t);let o=t.myDiagram,i=t.myGoModel,n=t.myMetis,s=n.currentMetamodel;t.myModel;let a=t.myModelview,c=i.findNode(e.from);r&&console.log("980 myMetis",n),r&&console.log("981 fromNode, data.from",c,e.from);let p=o.findNodeForKey(null==c?void 0:c.key),h=i.findNode(e.to),u=o.findNodeForKey(null==h?void 0:h.key);if(r&&console.log("985 createRelationship",i,c,h),null==c||c.object,null==h||h.object,d.types.AKM_GENERIC_REL,!l){var m,g;let f=null==c?void 0:c.objecttype,y=null==h?void 0:h.objecttype;if(f=s.findObjectType(null==f?void 0:f.id),r&&console.log("994 fromType",f),f||(f=s.findObjectType(null==c?void 0:null===(m=c.object)||void 0===m?void 0:m.typeRef)),f&&(f.allObjecttypes=s.objecttypes,f.allRelationshiptypes=s.relshiptypes),y=s.findObjectType(null==y?void 0:y.id),r&&console.log("1001 toType",y),y||(y=s.findObjectType(null==h?void 0:null===(g=h.object)||void 0===g?void 0:g.typeRef)),y&&(y.allObjecttypes=s.objecttypes,y.allRelationshiptypes=s.relshiptypes),r&&console.log("1007 includeInherited",a.includeInheritedReltypes),f&&y){let v=f.name===d.types.AKM_LABEL,b=v?d.types.AKM_ANNOTATES:d.types.AKM_GENERIC_REL,w=!1;a.includeInheritedReltypes&&(w=!0);let j=s.findRelationshipTypesBetweenTypes(f,y,w);if(r&&console.log("1017 reltypes, includeInherited",j,w),j){let T=[];b.length>0&&T.push(b);let k=[];for(let O=0;O<j.length;O++){let M=j[O];M.name!==b&&k.push(M.name)}(k=[...new Set(k)]).sort();let D=T.concat(k),E={data:e,typename:b,fromType:f,toType:y,nodeFrom:p,nodeTo:u,diagramModel:o.diagramModel,context:t},x={what:"selectDropdown",title:"Select Relationship Type",case:"Create Relationship",myDiagram:o,context:t,data:e,typename:b,fromType:f,toType:y,nodeFrom:p,nodeTo:u};r&&console.log("1050 myDiagram, args",o,E),t.handleOpenModal(D,x),r&&console.log("1053 modalContext",x)}}}}function x(e){let t;r&&console.log("1216 createRelshipCallback",e);let l=e.context.myDiagram,o=e.context.myGoModel,i=e.context.myMetis,s=i.currentMetamodel,d=e.context.myModel,c=o.modelView,p=e.data,h=e.typename,u=e.fromType,m=e.toType,g=e.nodeFrom,f=g.data.object,y=e.nodeTo,v=y.data.object,b=e.context,w=s.findRelationshipTypeByName2(h,u,m);if(r&&console.log("1075 reltype",w),!w){alert("Relationship type given does not exist!"),l.model.removeLinkData(p);return}r&&console.log("1081 typename, data, reltype",h,p,w);let j=d.findRelationship2(f,v,w,h);if(j){alert("Relationship already exists!\nOperation is cancelled."),l.model.removeLinkData(p);return}p.relshiptype=w,p.type="";let T=w.typeview;if(r&&console.log("1198 args, data, reltypeview",e,p,T),t=I(p,b),r&&console.log("1200 data, relshipview",p,t),t){t.setTypeView(T);let k=t.relship;k.relshipkind=w.relshipkind,t.setFromArrow2(null==j?void 0:j.relshipkind),t.setToArrow2(null==j?void 0:j.relshipkind),k.addRelationshipView(t),r&&console.log("1337 data",p),l.model.setDataProperty(p,"name",new String(h).valueOf()),r&&console.log("1340 relshipview",t);let O=t.id,M=p.name;b.myModelview.askForRelshipName&&0==(M=prompt("Enter relationship name",M)).length&&(M=" "),(t=C(t)).id=O,t.name=M,k.name=M,p.name=M,r&&console.log("1351 data, relshipview",p,t),r&&console.log("1352 myModelview, relshipview",c,t),Z(p,t.typeview,l,o);let D=o.findLink(p.key);n.kX(D,i,l),c.addRelationshipView(t),i.addRelationshipView(t),d.addRelationship(k),i.addRelationship(k);let E=[],x=new a.cP(k);r&&console.log("1360 jsnRelship",x),E.push(x),E.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),e&&l.dispatch({type:"UPDATE_RELSHIP_PROPERTIES",data:t})});let R=[],N=new a.XB(t);r&&console.log("1369 jsnRelview",N),R.push(N),R.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),r&&console.log("1374 data",t,c),e&&l.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})});let A=[],S=new a.OX(c);A.push(S),A.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),i.myDiagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:t})}),p=(D=l.findLinkForKey(p.key)).data,r&&console.log("1388 data, relshipview",p,t)," "===M?l.model.setDataProperty(p,"name","."):l.model.setDataProperty(p,"name",M),0==D.strokeWidth&&(D.strokeWidth=1),l.model.setDataProperty(p,"category","Relationship"),l.model.setDataProperty(p,"category","Relationship"),r&&console.log("1389 jsnRelship, jsnRelview, jsnModelview",x,N,S)}return r&&console.log("1393 data, relshipview, modelview",p,t,c),l.requestUpdate(),t}function R(e,t,l){let n=l.myDiagram,s=l.myGoModel,a=l.myMetis,d=l.myModel,c=a.currentModelview,p=a.pasteViewsOnly;r&&console.log("1134 pasteViewsOnly",p),r&&console.log("1135 myMetis",a,s),r&&console.log("1136 pasteRelationship",e);let h=e.relshiptype;if(h=a.findRelationshipType(null==h?void 0:h.id),r&&console.log("1142 pasteRelationship",h),!h)return;let u=e.from,m=e.to,g=n.findNodeForKey(u),f=n.findNodeForKey(m);r&&console.log("1151 fromNode, toNode, pasteViewsOnly",g,f,p);let y=null==g?void 0:g.data.objectview,v=null==f?void 0:f.data.objectview,b=e.relshipview.relship,w=e.relshipview.typeview;if(r&&console.log("1156 pasteRelationship",y,v),p)b=a.findRelationship(null==b?void 0:b.id);else{let j=null==y?void 0:y.object;j=a.findObject(null==j?void 0:j.id);let T=null==v?void 0:v.object;T=a.findObject(null==T?void 0:T.id),j&&T&&((b=new i.Uj(o.createGuid(),h,j,T,"","")).setModified(),e.relship=b,b.setName(e.name),a.currentModel.addRelationship(b),a.addRelationship(b))}r&&console.log("1175 relationship",b);let k=new i.IM(o.createGuid(),b.name,b,"");return k&&(k.setTypeView(w),k.setFromObjectView(y),k.setToObjectView(v),k.setModified(),b.addRelationshipView(k),c.addRelationshipView(k),a.addRelationshipView(k)),r&&console.log("1186 relshipview",k,a),r&&console.log("1187 myModel",d),n.requestUpdate(),k}function N(e,t,l,n){let s=n.myMetis,a=n.myMetamodel,c=n.myGoMetamodel,p=n.myDiagram,h=prompt("Enter type name:","typename");if(r&&console.log("1215 typename",h,a),l.key=o.createGuid(),p.model.setDataProperty(l,"name",h),null==l.name){p.model.removeLinkData(l),r&&console.log("1220 data",l);return}if(p.model.setDataProperty(l,"category",d.gojs.C_RELSHIPTYPE),h=l.name,r&&console.log("1225 data",l,c),h&&(r&&console.log("1227 from and to type nodes",e,t),e&&t)){let u=e.objecttype,m=t.objecttype,g=s.findRelationshipTypeByName1(h,u,m);if(r&&console.log("1230 reltype",g),g){let f=g.getRelshipKind(),y=new i.M$(o.createGuid(),g.name,u,m,"");y.setModified(),y.setRelshipKind(f),p.model.setDataProperty(l,"reltype",y),p.model.setDataProperty(l,"category",d.gojs.C_RELSHIPTYPE),a.addRelationshipType(y),s.addRelationshipType(y),r&&console.log("1242 reltype2",y);let v=g.getDefaultTypeView();if(v){let b=o.createGuid(),w=y.name+"_"+f,j=new i.QN(b,w,y,"");r&&console.log("1249 reltypeView2",j),j.setModified(),j.setRelshipKind(f);let T=v.getData();r&&console.log("1253 viewdata",T);let k=j.getData();for(let O in T)k[O]=T[O];r&&console.log("1258 reltypeView2",k,j),y.setDefaultTypeView(j),a.addRelationshipTypeView(j),s.addRelationshipTypeView(j),Z(l,j,p,c),p.model.setDataProperty(l,"typeview",j),p.requestUpdate()}return r&&console.log("1266 reltype2",y,s),y}{r&&console.log("1269 reltype",g);let M=o.createGuid();g=new i.M$(M,l.name,null,null,"");{r&&console.log("1273 reltype",g),p.model.setDataProperty(l,"reltype",g),p.model.setDataProperty(l,"category",d.gojs.C_RELSHIPTYPE),g.setModified(),g.setFromObjtype(u),g.setToObjtype(m),r&&console.log("1279 reltype",g),a.addRelationshipType(g),s.addRelationshipType(g);let D=g.name+"_"+g.getRelshipKind(),E=new i.QN(o.createGuid(),D,g,"");return E&&(r&&console.log("1285 reltypeView",E),E.setModified(),p.model.setDataProperty(l,"typeview",E),g.setDefaultTypeView(E),a.addRelationshipTypeView(E),s.addRelationshipTypeView(E),Z(l,E,p,c),p.requestUpdate(),r&&console.log("1293 myMetamodel",a)),console.log("1295 reltype",g),g}}}return null}function A(e,t,l,n){if(r&&console.log("1305 updateRelationshipType",t,l),null!==e&&"name"===t){let s=n.myMetis,a=n.myMetamodel,d=n.myGoMetamodel,c=n.myDiagram,p=l,h=s.findRelationshipType(e.reltype.id);if(r&&console.log("1316 updateRelationshipType",h),h){if("New Type"===h.name){let u=s.findRelationshipTypeByName(p);if(u){let m=h.getId();h=u,o.removeElementFromArray(a.getRelationshipTypes(),m),a.addRelationshipType(h),o.removeElementFromArray(s.getRelationshipTypes(),m),s.addRelationshipType(h)}else h.setName(p),h.setModified(),a.setModified()}else h.setName(p),h.setModified(),r&&console.log("1341 updateRelationshipType",h),a.setModified();let g=h.getDefaultTypeView();if(!g){let f=p+"_"+h.getRelshipKind();(g=new i.QN(o.createGuid(),f,h,"")).setModified(),h.setDefaultTypeView(g),h.setModified(),a.setModified(),a.addRelationshipTypeView(g),s.addRelationshipTypeView(g)}if(g){let y,v=g.getData();for(y in v)if(y===t){v[y]=l,"abstract"===y&&g.setAbstract(l),"relshipkind"===y&&g.setRelshipKind(l);break}Z(e,g,c,d),c.requestUpdate()}}}}function S(e,t,l){let o=l.myMetis,i=l.myGoMetamodel,n=l.myDiagram;if(t){let s=t.getDefaultTypeView(),d=o.findRelationship(e.relship.id);if(d){let c=e.name,p=c!==d.type.name;r&&console.log("1665 data, nameIsChanged, name, currentRelship",e,p,c,d),d.setType(t),p||(c=t.name,d.setName(c)),d.setModified();let h=o.findRelationshipView(e.relshipview.id);if(h){h.setTypeView(s),h.setName(c),h.setModified(),h.setRelationship(d),e.relshiptype=t,h.strokecolor=s.strokecolor,h.strokewidth=s.strokewidth,h.dash=s.dash,h.fromArrow=s.fromArrow,h.toArrow=s.toArrow,Z(e,s,n,i),n.model.setDataProperty(e,"name",c);let u=new a.XB(h);r&&console.log("1687 SetReltype",u);let m=[];m.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),n.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})})}let g=d&&new a.cP(d),f=[];return f.push(g),f.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),e&&n.dispatch({type:"UPDATE_RELSHIP_PROPERTIES",data:t})}),h}}}function C(e){return e&&(e.textscale||(e.textscale="1"),e.arrowscale||(e.arrowscale="1.3"),e.typeview,""===e.strokewidth&&(e.strokewidth="1")),e}function P(e,t){let l=[];if(e){let o=e.relshipviews;o&&o.map(e=>{e.points=null;let o=new a.XB(e);l.push(o);let i=t.gojsModel,n=i.findLinkByViewId(e.id),s=t.myDiagram.findLinkForKey(n.key);t.myDiagram.model.setDataProperty(s.data,"points",[])}),l.map(e=>{let l=e;l=JSON.parse(JSON.stringify(l)),t.myDiagram.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:l})})}}function I(e,t){r&&console.log("1431 createLink",e,t),e.key||(e.key=o.createGuid());let l=t.myMetis;if(e.category===d.gojs.C_RELSHIPTYPE);else if(e.category===d.gojs.C_RELATIONSHIP){let n;let s=t.myGoModel,a=null,c=e.fromNode,p=1;c||(p=(c=s.findNode(e.from)).scale1);let h=e.toNode;!h&&p>(h=s.findNode(e.to)).scale1&&(p=h.scale1);let u=null==c?void 0:c.objecttype,m=null==h?void 0:h.objecttype;if(r&&console.log("1450 createLink",e.relshiptype.name,u,m),a=l.findRelationshipTypeByName2(e.relshiptype.name,u,m),r&&console.log("1452 reltype",a),a&&a.isInstantiable()){let g=t.myGoModel,f=null==c?void 0:c.objectview,y=null==h?void 0:h.objectview,v=null;f&&(v=f.object,v=l.findObject(null==v?void 0:v.id));let b=null;if(y&&(b=y.object,b=l.findObject(null==b?void 0:b.id)),r&&console.log("1466 createLink",v,b),v&&b){let w=t.myModel,j=w.findRelationship2(v,b,a.name,a);if(r&&console.log("1471 relship",j),j||((j=new i.Uj(o.createGuid(),a,v,b,"","")).setModified(),e.relship=j,j.setName(a.name),w.addRelationship(j),l.addRelationship(j)),r&&console.log("1484 relship",j),j){let T=e.relshiptype.typeview;if(T||(T=a.getDefaultTypeView()),r&&console.log("1487 typeview",T),n=new i.IM(o.createGuid(),j.name,j,""),r&&console.log("1609 relshipview",n),n){let k=t.myModelview,O=t.myDiagram;n.setModified(),e.relshipview=n,n.setName(j.name),n.setTypeView(T),n.setFromObjectView(f),n.setToObjectView(y),n.setTextScale(p),n.strokewidth="",n.textscale="",k.addRelationshipView(n),l.addRelationshipView(n),q(g,n,j,e,O)}r&&console.log("1503 typeview, relshipview",T,n)}}}return n}}function _(e,t,l,o){if("Relationship"===e.category&&t&&l){let i=o.myDiagram,n=o.myMetis,s=o.myGoModel,d=s.findLink(e.key);if(r&&console.log("1746 link",d),d){let c=d.relshipview;c=n.findRelationshipView(c.id);let p=null==c?void 0:c.relship;if(r&&console.log("1751 rel, relview",p,c),p&&c){let h=p.name,u=p.fromObject;(u=n.findObject(u.id)).removeOutputrel(p);let m=p.toObject;(m=n.findObject(m.id)).removeInputrel(p),r&&console.log("1762 fromobj1, toObj1",u,m),d.category=e.category,d.name=h,d.setFromNode(e.from);let g=t.objectview;c.fromObjview=g,p.fromObject=n.findObject(g.object.id),d.setToNode(e.to);let f=l.objectview;c.toObjview=f,p.toObject=n.findObject(f.object.id);let y=p.fromObject;y.addOutputrel(p);let v=p.toObject;v.addInputrel(p),r&&console.log("1777 fromobj2, toObj2",y,v);let b=i.findLinkForKey(d.key);b.category=d.template;let w=new a.XB(c);o.modifiedLinks.push(w);let j=new a.cP(p);o.modifiedRelships.push(j)}}}if("Relationship type"===e.category){let T=o.myGoMetamodel,k=T.findLink(e.key);if(r&&console.log("1559 lnk, link",e,k),k){let O=k.reltype;if(O){r&&console.log("1563 fromNode",t),O&&t&&(k.fromNode=t,O.fromObjtype=t.objecttype,O.fromobjtypeRef=O.fromObjtype.id),r&&console.log("1569 toNode",l),O&&l&&(k.toNode=l,O.toObjtype=l.objecttype,O.toobjtypeRef=O.toObjtype.id);let M=new a.yh(O,!0);o.modifiedTypeLinks.push(M),r&&console.log("1577 jsnReltype",O,M)}}}}function L(e,t){let l=e.objectviews,n=[],d=[];for(let c=0;c<(null==l?void 0:l.length);c++){let p=l[c],h=p.object,u=null==h?void 0:h.outputrels;r&&console.log("1753 obj, outrels",h,u);for(let m=0;m<(null==u?void 0:u.length);m++){let g=u[m];if(g.markedAsDeleted)continue;g=t.findRelationship(g.id);let f=g.relshipviews,y=e.relshipviews;r&&console.log("1759 modelview, mrelviews",e,y);let v=!1;if((null==f?void 0:f.length)>0){for(let b=0;b<(null==f?void 0:f.length);b++){let w=f[b];for(let j=0;j<(null==y?void 0:y.length);j++){let T=y[j];if(T.id===w.id){T.markedAsDeleted||(v=!0);break}}}if(v)continue}r&&console.log("1776 rviews",g,f);let k=g.fromObject,O=k.objectviews;if((null==O?void 0:O.length)==0)continue;r&&console.log("1784 fromObjviews",O);let M=g.toObject,D=M.objectviews;if((null==D?void 0:D.length)==0)continue;r&&console.log("1791 toObjviews",D);let E=new i.IM(o.createGuid(),g.name,g,g.description);if(E.markedAsDeleted)continue;let x=null;for(let R=0;R<(null==O?void 0:O.length);R++){let N=O[R],A=e.objectviews;for(let S=0;S<A.length;S++)if(A[S].id===N.id){x=N;break}}let C=null;for(let P=0;P<(null==D?void 0:D.length);P++){let I=D[P],_=e.objectviews;for(let L=0;L<_.length;L++)if(_[L].id===I.id){C=I;break}}if(x&&C){E.setFromObjectView(x),E.setToObjectView(C),g.addRelationshipView(E),r&&console.log("1682 relview",E),e.addRelationshipView(E);let V=t.gojsModel,F=new s.hX(o.createGuid(),V,E);F.loadLinkContent(V),V.addLink(F),n.push(F),r&&console.log("1690 relview, link",E,F);let G=new a.XB(E);d.push(G)}}}return d.map(e=>{let l=e;l=JSON.parse(JSON.stringify(l)),t.myDiagram.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:l})}),r&&console.log("1702 myMetis",t),n}function V(e,t){for(let l=0;l<(null==e?void 0:e.length);l++){let o=e[l];if(o.id===t.id){e[l]=t;return}}null==e||e.push(t)}function F(e,t){let l=!0;switch("__gohashid"===e&&(l=!1),"allowedValues"===e&&(l=!1),"allProperties"===e&&(l=!1),"cardinality"===e&&(l=!1),"currentTargetModelview"===e&&(l=!1),"category"===e&&(l=!1),"class"===e&&(l=!1),"data"===e&&(l=!1),"defaultValue"===e&&(l=!1),"deleted"===e&&(l=!1),"deleteViewsOnly"===e&&(l=!1),"from"===e&&(l=!1),"fromObject"===e&&(l=!1),"fromobjectRef"===e&&(l=!1),"fromObjview"===e&&(l=!1),"fromObjviewRef"===e&&(l=!1),"fs_collection"===e&&(l=!1),"generatedTypeId"===e&&(l=!1),"group"===e&&(l=!1),"groupLayout"===e&&(l=!1),"inputrels"===e&&(l=!1),"isCollapsed"===e&&(l=!1),"isGroup"===e&&(l=!1),"isMetamodel"===e&&(l=!1),"isTemplate"===e&&(l=!1),"key"===e&&(l=!1),"layer"===e&&(l=!1),"metamodelRef"===e&&(l=!1),"modeltype"===e&&(l=!1),"modified"===e&&(l=!1),"nameId"===e&&(l=!1),"object"===e&&(l=!1),"objectview"===e&&(l=!1),"objectviews"===e&&(l=!1),"objectRef"===e&&(l=!1),"outputrels"===e&&(l=!1),"objecttype"===e&&(l=!1),"parent"===e&&(l=!1),"parentModel"===e&&(l=!1),"pasteViewsOnly"===e&&(l=!1),"points"===e&&(l=!1),"propertyValues"===e&&(l=!1),"relship"===e&&(l=!1),"relshipRef"===e&&(l=!1),"relshipviews"===e&&(l=!1),"size"===e&&(l=!1),"sourceModelRef"===e&&(l=!1),"sourceUri"===e&&(l=!1),"targetMetamodelRef"===e&&(l=!1),"targetModelRef"===e&&(l=!1),"to"===e&&(l=!1),"toObject"===e&&(l=!1),"toobjectRef"===e&&(l=!1),"toObjview"===e&&(l=!1),"toObjviewRef"===e&&(l=!1),"type"===e&&(l=!1),"typeid"===e&&(l=!1),"typeRef"===e&&(l=!1),"toobjtypeRef"===e&&(l=!1),"fromobjtypeRef"===e&&(l=!1),"typeview"===e&&(l=!1),"typeviewRef"===e&&(l=!1),"valueset"===e&&(l=!1),"visible"===e&&(l=!1),(null==t?void 0:t.name)!=="ViewFormat"&&(null==t?void 0:t.name)!=="Datatype"&&(null==t?void 0:t.name)!=="Property"&&"viewFormat"===e&&(l=!1),(null==t?void 0:t.name)!=="InputPattern"&&(null==t?void 0:t.name)!=="Datatype"&&(null==t?void 0:t.name)!=="Property"&&("inputPattern"===e&&(l=!1),"inputExample"===e&&(l=!1)),(null==t?void 0:t.name)!=="FieldType"&&(null==t?void 0:t.name)!=="Datatype"&&"fieldType"===e&&(l=!1),e){case"id":case"name":case"description":case"typeName":case"typeDescription":break;default:try{let o=null==t?void 0:t.getProperties(!0);if((null==o?void 0:o.length)>0){let i=o.find(t=>t.name===e);i||(l=!1)}}catch(n){l=!1}}return l}function G(e,t){let l=e.metamodels;for(let o=0;o<(null==l?void 0:l.length);o++){let i=l[o],n=i.objecttypes;for(let s=0;s<(null==n?void 0:n.length);s++){let a=n[s],r=a.properties;for(let d=0;d<(null==r?void 0:r.length);d++){let c=r[d];if(c.id===t.id)return!0}}}return!1}function K(e){let t=[],l=e.properties;for(let o=0;o<(null==l?void 0:l.length);o++){let i=l[o];G(e,i)&&t.push(i)}e.properties=t;let n=e.metamodels;for(let s=0;s<(null==n?void 0:n.length);s++){let a=n[s],r=[],d=a.properties;for(let c=0;c<(null==d?void 0:d.length);c++){let p=d[c];G(e,p)&&r.push(p)}a.properties=r}}function B(e,t,l){let o=e.metamodels,i=[],n=e.objecttypes;for(let s=0;s<(null==n?void 0:n.length);s++){let d=n[s];d.markedAsDeleted||i.push(d)}e.objecttypes=i;let c=[],p=e.objecttypeviews;for(let h=0;h<(null==p?void 0:p.length);h++){let u=p[h];u.markedAsDeleted||c.push(u)}e.objecttypeviews=c;let m=[],g=e.objtypegeos;for(let f=0;f<(null==g?void 0:g.length);f++){let y=g[f];y.markedAsDeleted||m.push(y)}e.objtypegeos=m;let v=[],b=e.relshiptypes;for(let w=0;w<(null==b?void 0:b.length);w++){let j=b[w];j.markedAsDeleted||v.push(j)}e.relshiptypes=v;let T=[],k=e.relshiptypeviews;for(let O=0;O<(null==k?void 0:k.length);O++){let M=k[O];M.markedAsDeleted||T.push(M)}e.relshiptypeviews=T,e.metamodels=[];for(let D=0;D<(null==o?void 0:o.length);D++){let E=o[D];E.markedAsDeleted||e.metamodels.push(E)}for(let x=0;x<(null==o?void 0:o.length);x++){let R=o[x];if(R.markedAsDeleted)continue;let N=new a.Lu(R,!0),A=JSON.parse(JSON.stringify(N));r&&console.log("2291 data",A),t.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:A})}}function U(e,t){K(e);let l=e.models,o=[],i=[];for(let n=0;n<(null==l?void 0:l.length);n++){let s=l[n],d=null==s?void 0:s.modelviews;for(let c=0;c<(null==d?void 0:d.length);c++){let p=d[c],h=p.objectviews;r&&console.log("2324",h);let u=[];for(let m=0;m<(null==h?void 0:h.length);m++){let g=h[m];g.markedAsDeleted||(u.push(g),o.push(g))}r&&console.log("2332",u),p.objectviews=u;let f=p.relshipviews,y=[];for(let v=0;v<(null==f?void 0:f.length);v++){let b=f[v];b.markedAsDeleted||(y.push(b),i.push(b))}p.relshipviews=y,r&&console.log("2345 mview",p)}let w=s.objects;r&&console.log("2339",w);let j=[];for(let T=0;T<(null==w?void 0:w.length);T++){let k=w[T];k.markedAsDeleted||j.push(k)}r&&console.log("2361",j),s.objects=j;let O=s.relships,M=[];for(let D=0;D<(null==O?void 0:O.length);D++){let E=O[D];E.markedAsDeleted||M.push(E)}s.relships=M,r&&console.log("2373",s)}let x=e.objectviews;for(let R=0;R<(null==x?void 0:x.length);R++){let N=x[R];N.markedAsDeleted||o.push(N)}e.objectviews=o;let A=[],S=e.objects;for(let C=0;C<(null==S?void 0:S.length);C++){let P=S[C];P.markedAsDeleted||A.push(P)}e.objects=A;let I=e.relshipviews;for(let _=0;_<(null==I?void 0:I.length);_++){let L=I[_];L.markedAsDeleted||i.push(L)}e.relshipviews=i;let V=[],F=e.relships;for(let G=0;G<(null==F?void 0:F.length);G++){let B=F[G];B.markedAsDeleted||V.push(B)}e.relships=V;let U=new a.st(e,!0),J={metis:U};J=JSON.parse(JSON.stringify(J)),r&&console.log("2418 jsnMetis",U,e),t.dispatch({type:"LOAD_TOSTORE_PHDATA",data:J})}function J(e,t,l,o,i){var n,s,p,h,u,m,g,f;r&&console.log("2412 verifyAndRepairModel STARTED");let y="%s\n",v="Verification report\n",b=c(y,v);v="First do some initial checks\n";let w=i.metamodels;for(let j=0;j<(null==w?void 0:w.length);j++){let T=w[j],k=T.relshiptypes;for(let O=0;O<(null==k?void 0:k.length);O++){let M=k[O];for(let D=O+1;D<(null==k?void 0:k.length);D++){let E=k[D];(null===(n=M.fromObjtype)||void 0===n?void 0:n.id)===(null===(s=E.fromObjtype)||void 0===s?void 0:s.id)&&(null===(p=M.toObjtype)||void 0===p?void 0:p.id)===(null===(h=E.toObjtype)||void 0===h?void 0:h.id)&&M.name===E.name&&(r&&console.log("Removing duplicate relship type",M,E),v+="A duplicate relship type, '"+E.name+"', has been removed from the metamodel, '"+T.name+"'\n",k.splice(D,1),D--)}}}r&&console.log("2437 metamodels",w),r&&console.log("2439 model, modelviews",e,l,i);for(let x=0;x<(null==l?void 0:l.length);x++){let R=l[x],N=R.objectviews;for(let A=0;A<(null==N?void 0:N.length);A++){let S=N[A];"Container"!==S.viewkind||S.isGroup||(S.isGroup=!0,v+="The container view '"+S.name+"' is now a group (isGroup = true)\n")}}v+="The initial checks are completed\n",b+=c(y,v);let C=null==o?void 0:o.myGoModel,P="Generic",I=e.objects;v="Verifying objects\n";for(let _=0;_<(null==I?void 0:I.length);_++){let L=I[_];if(!L.type){r&&console.log("2434 obj, myMetis",L,i);let V=i.findObjectTypeByName(P);V&&(L.type=V,L.typeRef=V.id,L.typeName=V.name,v+="	Verifying object '"+L.name+"' ( without type )\n	Object type has been set to '"+P+"'\n",r&&console.log("2443 msg",v))}L.inputrels=[],L.outputrels=[];let F=L.typeRef,G=L.typeName;r&&console.log("2450 obj",L,e);let K=t.findObjectType(F);v+="	Verifying object ("+L.name+") of type ("+G+")\n";let B=!1;if(K||(v+="	Object type '"+F+"' ('"+G+"') was not found\n",r&&console.log("2458 Type of object not found:",L),(K=t.findObjectTypeByName(G))||(K=i.findObjectTypeByName(P)),L.type=K,L.typeRef=K.id,L.typeName=K.name,B=!0,v+="	Object type changed to: '"+K.name+"'\n",b+=c(y,v),v=""),K){let U=L.objectviews;for(let J=0;J<(null==U?void 0:U.length);J++){let z=U[J];z.name=L.name,L.markedAsDeleted&&!z.markedAsDeleted&&(z.markedAsDeleted=!0,v+="	Verifying object '"+L.name+"("+L.id+") that is deleted, but objectview is not.\n	Is repaired by deleting object view\n"),z.typeview?B&&(z.fillcolor="red"):(z.typeview=K.typeview,v+="Object typeview of : '"+K.name+"' set to default\n");let H=C.findNodeByViewId(z.id);if(H){H.name=z.name;let W=o.findNodeForKey(null==H?void 0:H.key);W&&(W.data=H)}}o.requestUpdate()}}v+="Verifying objects and object types are completed\n",b+=c(y,v);{v="Verifying object views\n";let X=[];for(let Y=0;Y<(null==l?void 0:l.length);Y++){let Z=l[Y],$=Z.objectviews;X=0==Y?$:null==X?void 0:X.concat($)}let q=[];r&&console.log("2515 objectviews",X);for(let Q=0;Q<(null==X?void 0:X.length);Q++){let ee=X[Q];if(ee){if(!ee.id){v+="	Object view '"+ee.name+"' has no id\n";continue}if(!ee.name){v+="	Object view '"+ee.id+"' has no name\n";continue}if(!ee.typeview){v+="	Object view '"+ee.name+"' has no typeview\n";continue}if(!ee.object){v+="	Object view '"+ee.name+"' has no object\n";continue}q.push(ee)}}X=q,r&&console.log("2515 objectviews",X);for(let et=0;et<(null==X?void 0:X.length);et++){let el=X[et];el&&(el.markedAsDeleted?!el.object&&(el.name?v+="	Verifying object view without object'"+el.name+"' ("+el.id+")\n	Doing nothing\n":el.markedAsDeleted=!0):(r&&console.log("2520 oview, object:",el,el.object),(null===(u=el.object)||void 0===u?void 0:u.markedAsDeleted)?(el.object.markedAsDeleted=!1,v+="	Verifying object view '"+el.name+"' ( with object deleted)\n	Object has been undeleted"):el.object||(el.markedAsDeleted=!0,v+="	Verifying objectview '"+el.name+"NaN"+el.id+" ( without object )\n	Objectview has been deleted")))}i.objectviews=X,v+="Verifying object views is completed\n",b+=c(y,v)}{v="Verifying relationships\n	Checking for duplicate relationships. \n	If found, they are deleted, including their relationship views.\n";let eo=e.relships;if(eo)for(let ei=0;ei<(null==eo?void 0:eo.length);ei++){let en=eo[ei],es=en.fromObject,ea=en.toObject,er=en.type,ed=[];if(er){let ec=e.findRelationships(es,ea,er);for(let ep=0;ep<(null==ec?void 0:ec.length);ep++){let eh=ec[ep];(null==eh?void 0:null===(m=eh.type)||void 0===m?void 0:m.id)===er.id&&eh.name===en.name&&ed.push(eh)}for(let eu=0;eu<ed.length;eu++){if(0==eu)continue;let em=ed[eu];em.markedAsDeleted=!0;let eg=em.relshipviews;for(let ef=0;ef<(null==eg?void 0:eg.length);ef++){let ey=eg[ef];ey.markedAsDeleted=!0}1==eu&&(v+="	Duplicated relationship '"+em.name+"' with views are deleted\n")}}}let ev=d.types.AKM_GENERIC_REL;if(eo)for(let eb=0;eb<(null==eo?void 0:eo.length);eb++){let ew=eo[eb];r&&console.log("2283 rel",ew);let ej=ew.fromObject,eT=ew.toObject,ek=null==ej?void 0:ej.type,eO=null==eT?void 0:eT.type,eM=ew.typeRef,eD=ew.typeName;if(ew.typeName,eD||(eD=ew.name),!ew.type){let eE=i.findRelationshipTypeByName(ev);eE&&(ew.type=eE,ew.typeRef=eE.id,ew.typeName=eE.name,v+="	Verifying relationship '"+ew.name+"' ( without type )\n	Relationship type has been set to '"+ev+"'\n")}eM||(eM=ew.type.id);let ex=t.findRelationshipType(eM);if(r&&console.log("2304 fromType and toType",eM,eD,ek,eO,ex),v+="		Verifying relationship type '"+eD+"' ('"+eM+"')\n",!ex){v+="	Relationship type '"+eD+"' ('"+eM+"') was NOT found\n",r&&console.log("2309 Relationship with unknown type:",eD),"hasProperty"===eD?(eD="has",eO=t.findObjectTypeByName("Property")):"hasValue"===eD?(eD="has",eO=t.findObjectTypeByName("Value")):"hasAllowedValue"===eD?(eD="hasAllowed",eO=t.findObjectTypeByName("Value")):"isOfDatatype"===eD?(eD="isOf",eO=t.findObjectTypeByName("Datatype")):"hasUnittype"===eD&&(eD="has",eO=t.findObjectTypeByName("Unittype"));let eR=t.findRelationshipTypesByName(eD);if(r&&console.log("2331 Relationship type with name:",eD,eR),eR)for(let eN=0;eN<(null==eR?void 0:eR.length);eN++){let eA=eR[eN],eS=ek;eS||(eS=eA.fromObjtype);let eC=eO;if(eC||(eC=eA.toObjtype),r&&console.log("2339 fromType and toType",eD,eS,eC),eS&&eC){r&&console.log("2341 findreltypebyname",eD,eS.name,eC.name);let eP=t.findRelationshipTypeByName2(eD,eS,eC);if(eP){ex=eP,ew.type=ex,ew.name=eD,v+="	Relationship type changed to: '"+eD+"' ( '"+ex.id+"' )\n",r&&console.log("2349 Found relationship type:",ex);break}}}!ex&&(ex=t.findRelationshipTypeByName(ev))&&(ew.type=ex,ew.name=eD,v+="	Verifying relationship '"+(null==ew?void 0:ew.name)+"' ( without type )\n	Relationship type has been set to "+ev+"\n")}let eI=ew.relshipviews;for(let e_=0;e_<(null==eI?void 0:eI.length);e_++){let eL=eI[e_];eL.name=ew.name}}b+=c(y,v)}{v="Verifying Relationship views\n";let eV=e.modelviews;for(let eF=0;eF<(null==eV?void 0:eV.length);eF++){let eG=eV[eF];if(eG){let eK=eG.relshipviews;r&&console.log("2690 modelview",eG);for(let eB=0;eB<(null==eK?void 0:eK.length);eB++){let eU=eK[eB],eJ=eU.relship,ez=eU.fromObjview,eH=eU.toObjview,eW=eG.findRelationshipViewsByRel2(eJ,ez,eH);if(r&&console.log("2697 rel, relviews",eJ,eW),eW.length>1){v+="	Verifying relationship '"+eJ.name+"' with multiple relationshipviews.\n";let eX=0,eY=[];for(let eZ=0;eZ<(null==eW?void 0:eW.length);eZ++){let e$=eW[eZ];!e$.markedAsDeleted&&(eY.push(e$),eX++)}if(r&&console.log("2708 n, rel, rvs",eX,eJ,eY),eX>1)for(let eq=0;eq<(null==eY?void 0:eY.length);eq++){if(0==eq)continue;let eQ=eY[eq];eQ.markedAsDeleted=!0}v+="	Is repaired by deleting all relationship views but the first one\n"}if(r&&console.log("2719 relshipview",eU),eU&&!eU.markedAsDeleted){let e0=eU.relship;if(e0&&e0.type){r&&console.log("2723 relshipview",e0),e0.markedAsDeleted&&!eU.markedAsDeleted&&(eU.markedAsDeleted=!0,v+="	Verifying relationship '"+e0.name+"' that is deleted, but relationship view is not.\n	Is repaired by deleting the relationship view\n"),eU.typeview?v+="	Relationship typeview of '"+(null===(f=e0.type)||void 0===f?void 0:f.name)+"' found\n":(eU.typeview=e0.type.typeview,v+="	Relationship typeview of "+(null===(g=e0.type)||void 0===g?void 0:g.name)+" set to default\n");let e1=C.findLinkByViewId(eU.id);if(e1){e1.name=eU.name;let e2=o.findLinkForKey(null==e1?void 0:e1.key);e2&&(e2.data=e1)}}}}}}v+="\nVerifying relationship views is completed\n",b+=c(y,v)+c(y,v="Verifying relationships is completed\n")}r&&console.log("2825 myMetis",i);let e6=new a.st(i,!0),e5={metis:e6};e5=JSON.parse(JSON.stringify(e5)),r&&console.log("2831 jsnMetis",e6,i),o.dispatch({type:"LOAD_TOSTORE_PHDATA",data:e5}),r&&console.log("2833 data",e5,i),r&&console.log("2834 myGoModel",C),console.log(b+=c(y,v="End Verification\n")),o.requestUpdate(),r&&console.log("2841 verifyAndRepairModel ENDED, myMetis",i)}function z(e,t){r&&console.log("2829 verifyAndRepairMetamodels STARTED");let l="%s\n",o="Verification report\n",i=c(l,o);{let n=e.metamodels;r&&console.log("2837 metamodels",n);for(let s=0;s<(null==n?void 0:n.length);s++){let d=n[s];!d.id&&(r&&console.log("Removing corrupt metamodel",d),n.splice(s,1),o+="A corrupt metamodel has been removed\n",s--)}}X(e),H(e),r&&console.log("2852 myMetis",e);let p=new a.st(e,!0),h={metis:p};h=JSON.parse(JSON.stringify(h)),r&&console.log("2858 jsnMetis",p,e),t.dispatch({type:"LOAD_TOSTORE_PHDATA",data:h}),r&&console.log("2860 data",h,e),console.log(i+=c(l,o)),t.requestUpdate(),r&&console.log("2866 verifyAndRepairMetamodel ENDED, myMetis",e)}function H(e){var t,l,i,n;let s=[];for(let a=0;a<(null===(t=e.metamodels)||void 0===t?void 0:t.length);a++){let d=e.metamodels[a],c=d.relshiptypes;for(let p=0;p<(null==c?void 0:c.length);p++){let h=c[p],u=h.typeview;u&&(u.name=h.name+"_"+h.relshipkind,s.push({metamodel:d,reltype:h,reltypeview:u}))}}r&&console.log("2868 myArray",s);let m=e.relshiptypeviews;for(let g=0;g<(null==m?void 0:m.length);g++){let f=m[g],y=!1;for(let v=0;v<(null==s?void 0:s.length);v++){let b=s[v];if(b.reltypeview.id===f.id){y=!0;break}}y||(f.markedAsDeleted=!0)}{let w=e.relshiptypeviews,j=null===(l=e.relshiptypeviews)||void 0===l?void 0:l.length;for(let T=j-1;T>=0;T--){let k=w[T];k.markedAsDeleted&&w.splice(T,1)}}r&&console.log("2896 myMetis",e);{s=[];let O=e.metamodels;for(let M=0;M<(null===(i=e.relshiptypes)||void 0===i?void 0:i.length);M++){let D=e.relshiptypes[M],E=D.fromobjtypeRef,x=D.toobjtypeRef,R=e.findObjectType(E),N=e.findObjectType(x),A=null;for(let S=0;S<(null==O?void 0:O.length);S++){let C=O[S],P=C.findRelationshipType(D.id);if(P){A=C;break}}if(!A){D.markedAsDeleted=!0;continue}s.push({name:null==R?void 0:R.name,relName:null==D?void 0:D.name,toName:null==N?void 0:N.name,metamodel:A?A.name:null,fromObjtype:R,reltype:D,toObjtype:N})}s.sort(o.compare),r&&console.log("2904 myArray",s)}{let I=e.relshiptypes,_=null===(n=e.relshiptypes)||void 0===n?void 0:n.length;for(let L=_-1;L>=0;L--){let V=I[L];V.markedAsDeleted&&I.splice(L,1)}}}function W(e,t,l){let o=e.relshiptypes;for(let i=0;i<(null==o?void 0:o.length);i++){let n=o[i],s=n.typeview;s&&(s.markedAsDeleted=!0),n.typeview=null}{var d;let c=l.relshiptypeviews,p=null===(d=l.relshiptypeviews)||void 0===d?void 0:d.length;for(let h=p-1;h>=0;h--){let u=c[h];u.markedAsDeleted&&c.splice(h,1)}}let m=new a.st(l,!0),g={metis:m};g=JSON.parse(JSON.stringify(g)),r&&console.log("2858 jsnMetis",m,l),t.dispatch({type:"LOAD_TOSTORE_PHDATA",data:g}),r&&console.log("2860 data",g,l)}function X(e){var t,l;let o=e.metamodels,i=e.relshiptypes;for(let n=0;n<(null==i?void 0:i.length);n++){let s=i[n],a=!1;for(let r=0;r<(null==o?void 0:o.length);r++){let d=o[r],c=d.findRelationshipType(s.id);if(c){a=!0;break}}a||(s.markedAsDeleted=!0)}{let p=null===(t=e.relshiptypes)||void 0===t?void 0:t.length;for(let h=p-1;h>=0;h--){let u=i[h];u.markedAsDeleted&&i.splice(h,1)}}let m=e.objecttypes;for(let g=0;g<(null==m?void 0:m.length);g++){let f=m[g],y=!1;for(let v=0;v<(null==o?void 0:o.length);v++){let b=o[v],w=b.findObjectType(f.id);if(w){y=!0;break}}y||(f.markedAsDeleted=!0)}{let j=null===(l=e.objecttypes)||void 0===l?void 0:l.length;for(let T=j-1;T>=0;T--){let k=m[T];k.markedAsDeleted&&m.splice(T,1)}}}function Y(e,t,l,o){if(r&&console.log("2471 updateNode",e,l),t){let i,n=t.data;for(i in n)"abstract"!==i&&"class"!==i&&"group"!==i&&"isGroup"!==i&&"viewkind"!==i&&(null!=n[i]&&(null==l||l.model.setDataProperty(e,i,n[i])),r&&console.log("2483 prop, node[prop]",i,e[i]));let s=e.objectview;if(s)for(i in r&&console.log("2487 viewdata, objview",n,s),n)s[i]&&""!==s[i]&&l.model.setDataProperty(e,i,s[i]);l.model.setDataProperty(e,"typename",e.typename),o&&(o.updateNode(e),r&&console.log("2500 updateNode",e,o)),r&&console.log("2502 updateNode",e,l),l.requestUpdate()}}function Z(e,t,l,o){let i;if(t){let n=t.getData();if(r&&console.log("3096 data, viewdata",e,n),i=e.relshipview)for(let s in n)"abstract"!==s&&"relshipkind"!==s&&"class"!==s&&"name"!==s&&(i[s]&&""!==i[s]&&(l.model.setDataProperty(e,s,i[s]),r&&console.log("2904 updateLink",s,n[s],i[s])),"toArrow"===s?""===i[s]?n[s]="OpenTriangle":"None"===i[s]&&(n[s]=""):"fromArrow"===s?"None"===n[s]&&(n[s]=""):"strokewidth"!==s||""!==i[s]&&i[s]||i[s],l.model.setDataProperty(e,s,n[s]),r&&console.log("2916 updateLink",s,n[s],i[s]))}if(i){let a=l.findLinkForKey(e.key);a&&(r&&console.log("2854 data, link, relview",e,a,i),i.arrowscale=1.3*i.textscale,l.model.setDataProperty(a.data,"name",i.name),l.model.setDataProperty(a.data,"textscale",i.textscale),l.model.setDataProperty(a.data,"arrowscale",i.arrowscale),l.model.setDataProperty(a.data,"strokewidth",i.strokewidth))}}function $(e,t,l){let o=t.typeview,i=t.textscale;if(r&&console.log("2563 link, relview, reltypeview",e,t,o),o){let n=Number(o.strokewidth)*Number(i);n=n<1?1:n,t.strokewidth=n.toString(),l.model.setDataProperty(e.data,"strokewidth",t.strokewidth)}let s=1.3*Number(i);return t.arrowscale=s.toString(),l.model.setDataProperty(e.data,"textscale",t.textscale),l.model.setDataProperty(e.data,"arrowscale",t.arrowscale),t}function q(e,t,l,o,i){let n=l.getType(),a=t.getTypeView();if(a||(a=null==n?void 0:n.getDefaultTypeView()),a){let r=new s.hX(o.key,e,t);e.addLink(r),Z(o,a,i,e),i.requestUpdate()}return o}function Q(e,t,l){let o=[];if(e){if(t.includeConnected){o.push(e.name);let i=e.getConnectedObjects2(t.myMetis);r&&console.log("3006 connectedObjects",i);for(let n=0;n<(null==i?void 0:i.length);n++){let s=i[n];o.push(null==s?void 0:s.name)}}if(t.includeInherited){o.push("All");try{var a,d;let c=null==e?void 0:e.getInheritedTypes();r&&console.log("3015 inheritedTypes",c);for(let p=0;p<(null==c?void 0:c.length);p++){let h=c[p];l?(null===(d=h.properties)||void 0===d?void 0:d.length)>0&&o.push(h.name):o.push(h.name)}o.push(null===(a=e.type)||void 0===a?void 0:a.name)}catch(u){}let m=[...new Set(o)];m.reverse(),o=m}}return r&&console.log("3031 namelist",o),o}function ee(e,t){let l=t.relshipviews;for(let i=0;i<(null==l?void 0:l.length);i++){let n=l[i];if(n.markedAsDeleted)continue;let a=e.links,d=!1;for(let c=0;c<a.length;c++){let p=a[c],h=p.relshipview;if(h.id===n.id){d=!0;break}}if(!d){let u=new s.hX(o.createGuid(),e,n);e.addLink(u)}}let m=t.objectviews;for(let g=0;g<(null==m?void 0:m.length);g++){let f=m[g];if(f.markedAsDeleted)continue;let y=e.nodes;for(let v=0;v<y.length;v++){let b=y[v];r&&console.log("3073 node",b)}}}function et(e){let t=e.currentMetamodel;return"GENERIC_MM"===t.name}},6575:function(e,t,l){"use strict";l.d(t,{$s:function(){return b},D9:function(){return N},Fd:function(){return w},Gf:function(){return E},HQ:function(){return S},LO:function(){return P},Mv:function(){return C},O3:function(){return m},UH:function(){return f},Ul:function(){return v},VL:function(){return x},Xb:function(){return y},c_:function(){return g},gz:function(){return O},hM:function(){return z},hZ:function(){return H},iC:function(){return W},kX:function(){return A},nv:function(){return M},pY:function(){return R},q7:function(){return D},wo:function(){return u}});var o=l(715),i=l(3165),n=l(6433),s=l(3327),a=l(9803),r=l(8749),d=l(137);let c=!1,p=l(2586),h=l(5523);function u(e,t){let l=prompt("Enter Metamodel name");if(null==l||""==l){alert("Operation was cancelled!");return}{let o=e.findMetamodelByName(l);if(o){alert("Metamodel already exists");return}if(confirm("Create new metamodel '"+l+"' ?"))o=new r.eK(i.createGuid(),l,""),e.addMetamodel(o);else{alert("Operation was cancelled!");return}if(o){let n=new d.Lu(o,!0);c&&console.log("35 New Metamodel",n);let s=[];s.push(n),s.map(e=>{let l=e;c&&console.log("40 data",l),l=JSON.parse(JSON.stringify(l)),t.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:l})})}}}function m(e,t){let l={metamodel:"",metamodels:""},o={myMetis:e,myCurrentMetamodel:e.currentMetamodel,myCurrentModel:e.currentModel,myDiagram:t,case:"Replace Metamodel",title:"Select Metamodel to Use",dispatch:t.dispatch,postOperation:_,args:l};I(o)}function g(e,t){let l={metamodel:"",metamodels:""},o={myMetis:e,myCurrentMetamodel:e.currentMetamodel,myCurrentModel:e.currentModel,myDiagram:t,case:"Add Metamodel",title:"Select Metamodel to Add",dispatch:t.dispatch,postOperation:L,args:l};c&&console.log("88 context",o),I(o)}function f(e,t){let l={metamodel:""},o={myMetis:e,myCurrentMetamodel:e.currentMetamodel,myDiagram:t,case:"Delete Metamodel",title:"Select Metamodel to Delete",dispatch:t.dispatch,postOperation:V,args:l};I(o)}function y(e,t){let l={metamodel:""},o={myMetis:e,myCurrentMetamodel:e.currentMetamodel,myDiagram:t,case:"Clear Metamodel",title:"Select Metamodel to Clear",dispatch:t.dispatch,postOperation:F,args:l};I(o)}function v(e,t){let l={metamodel:e.currentTargetMetamodel},o={myMetis:e,myCurrentMetamodel:e.currentMetamodel,myModel:e.currentModel,myCurrentModelview:e.currentModelview,myDiagram:t,case:"New Model",title:"Select Metamodel",dispatch:t.dispatch,postOperation:G,args:l};I(o)}function b(e,t){let l={model:""},o={myMetis:e,myCurrentModel:e.currentModel,myDiagram:t,case:"Delete Model",title:"Select Model to Delete",dispatch:t.dispatch,postOperation:B,args:l};K(o)}function w(e,t,l){var o;c&&console.log("163 node",e);let i=t.findObjectView(null===(o=e.objectview)||void 0===o?void 0:o.id),n={objectview:i,model:""},s={myMetis:t,myCurrentModel:t.currentModel,myDiagram:l,case:"Export Task Model",title:"Select Model to Export to",dispatch:l.dispatch,postOperation:k,args:n};K(s)}function j(e,t){let l=t.myMetis,o=t.args.model;o=l.findModel(o.id);let i=o.findObjectByTypeAndName(e.type,e.name);if(!i){let s=n.Zw(e);o.addObject(s),l.addObject(s),c&&console.log("189 copiedObj",s)}let a=e.outputrels;for(let r=0;r<(null==a?void 0:a.length);r++){let d=a[r],p=o.getCopiedFromObject(d.fromObject.id),h=o.getCopiedFromObject(d.toObject.id);if(c&&console.log("196 rel, fromObj, toObj",d,p,h),p&&h){let u=o.findRelationships(p,h,d.type);if(!u){let m=n.om(d,p,h);p.addOutputrel(m),h.addInputrel(m),o.addRelationship(m),l.addRelationship(m)}}}}function T(e,t){let l=t.myMetis,o=t.myCurrentModel;o=l.findModel(o.id);let i=t.args.model;i=l.findModel(i.id);let n=e.getParentModelView(o),s=e.getGroupMembers(n);for(let a=0;a<s.length;a++){let r=s[a],d=r.object,c=d.type.name;"Container"===c?T(r,t):("Task"===c||"Role"===c)&&j(d,t)}}function k(e){let t=e.myMetis,l=e.myDiagram;c&&console.log("183 context",e);let o=e.myCurrentModel;o=t.findModel(o.id);let i=e.args.model;i=t.findModel(i.id),t.setCurrentTaskModel(i);let s=e.args.objectview,a=s.getParentModelView(o),r=s.getGroupMembers(a);for(let p=0;p<r.length;p++){let h=r[p],u=h.object,m=u.type.name;"Container"===m?T(h,e):("Task"===m||"Role"===m)&&j(u,e)}c&&console.log("205 toModel",i);for(let g=0;g<r.length;g++){let f=r[g],y=f.object,v=y.type.name;if("Task"===v||"Role"===v){let b=y.outputrels;for(let w=0;w<(null==b?void 0:b.length);w++){let k=b[w],O=i.getCopiedFromObject(k.fromObject.id),M=i.getCopiedFromObject(k.toObject.id);if(c&&console.log("215 rel, fromObj, toObj",k,O,M),O&&M){let D=n.om(k,O,M);O.addOutputrel(D),M.addInputrel(D),i.addRelationship(D),t.addRelationship(D)}}}}c&&console.log("220 toModel",i);let E=new d.st(t,!0);c&&console.log("1402 jsnMetis: ",E);let x={metis:E};x=JSON.parse(JSON.stringify(x)),l.dispatch({type:"LOAD_TOSTORE_PHDATA",data:x}),alert("The task model has been successfully exported!")}function O(e,t){e.currentMetamodel;let l=e.currentModel,o=prompt("Enter Modelview name:","");if(null==o||""===o)alert("New operation was cancelled");else{let n=new r.Nn(i.createGuid(),o,l,"");l.addModelView(n),e.addModelView(n),c&&console.log("102 myMetis",e);let s=new d.qf(l,!0);s=JSON.parse(JSON.stringify(s)),c&&console.log("104 NewModelView",s),t.dispatch({type:"LOAD_TOSTORE_NEWMODELVIEW",data:s})}}function M(e,t,l){e.markedAsDeleted=!0;let o=new d.OX(e),i=e.objectviews;for(let s=0;s<(null==i?void 0:i.length);s++){let a=i[s];a.markedAsDeleted=!0;let r=a.object,p=null==r?void 0:r.objectviews;(null==p?void 0:p.length)==1&&(r.markedAsDeleted=!0)}let h=e.relshipviews;for(let u=0;u<(null==h?void 0:h.length);u++){let m=h[u];m.markedAsDeleted=!0}c&&console.log("1808 myMetis",t);let g=[];g.push(o),g.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),l.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:t})}),n.Gh(t,l)}function D(e,t){if(confirm("Do you really want to delete all invisible objects?")){let l=[],o=e.objects;for(let i=0;i<o.length;i++){let n=o[i],s=null==n?void 0:n.type;if(n.name===(null==s?void 0:s.name)&&null==n.objectviews){n.markedAsDeleted=!0;let a=e.findObject(n.id);a&&(a.markedAsDeleted=!0);let r=new d.GZ(n);l.push(r)}}c&&console.log("156 modifiedObjects",l),l.map(e=>{let l=e;l=JSON.parse(JSON.stringify(l)),t.dispatch({type:"UPDATE_OBJECT_PROPERTIES",data:l})});let p=[],h=e.objectviews;for(let u=0;u<h.length;u++){let m=h[u],g=null==m?void 0:m.object;if(null==g){m.markedAsDeleted=!0;let f=e.findObjectView(m.id);f&&(f.markedAsDeleted=!0);let y=new d.kC(m);p.push(y)}}c&&console.log("175 modifiedObjviews",h,p),p.map(e=>{let l=e;l=JSON.parse(JSON.stringify(l)),t.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:l})}),c&&console.log("180 myMetis",e)}}function E(e,t,l){c&&console.log("417 myMetis",t);let o=s.jw(null==e?void 0:e.icon),i={what:"editObject",title:"Edit Object",icon:o,myDiagram:l};t.currentNode=e,t.myDiagram=l,c&&console.log("427 node, modalContext",e,i),c&&console.log("428 myMetis",t),l.handleOpenModal(e,i)}function x(e,t,l){let o=s.jw(null==e?void 0:e.icon),i={what:"editObjectType",title:"Edit Object Type",icon:o,myDiagram:l};t.currentNode=e,t.myDiagram=l,c&&console.log("230 editObjectType"),l.handleOpenModal(e,i)}function R(e,t,l){c&&console.log("415 selection",l.selection);let o=s.jw(e.icon),i={what:"editObjectview",title:"Edit Object View",icon:o,myDiagram:l};t.currentNode=e,t.myDiagram=l,l.handleOpenModal(e,i)}function N(e,t,l){let o=s.jw(e.icon),i={what:"editTypeview",title:"Edit Typeview",icon:o,myDiagram:l};t.currentNode=e,t.myDiagram=l,l.handleOpenModal(e,i)}function A(e,t,l){let o=l.findNodeForKey(e.key);if(o){let i=t.findObjectView(e.objectview.id),n=i.typeview,s=null==n?void 0:n.data;if(!s)return;for(let a in s)i[a]=s[a],l.model.setDataProperty(o.data,a,i[a]);let r=new d.kC(i),p=[];p.push(r),p.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),l.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})})}let h=l.findLinkForKey(e.key);if(h){c&&console.log("463 inst",e);let u=t.findRelationshipView(e.relshipview.id),m=u.typeview,g=m.data;for(let f in c&&console.log("467 rview, rtview, rtdata",u,m,g),g){switch(f){case"name":case"nameId":case"description":case"fs_collection":case"markedAsDeleted":case"modified":case"sourceUri":case"typeRef":case"abstract":case"class":case"relshipkind":continue}u[f]="",c&&console.log("471 prop, rview[prop]",f,u[f]),l.model.setDataProperty(h.data,f,m[f])}let y=new d.XB(u),v=[];v.push(y),v.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),c&&console.log("494 data",t),l.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})})}}function S(e,t,l){t.myDiagram=l;let o=t.currentModelview;o=t.findModelView(o.id);let i=t.gojsModel,n=null==e?void 0:e.objectview,s="1";s=prompt("Enter no of sublevels to follow",s),c&&console.log("222 objview",n),a.HQ(o,n,null,i,t,s);let r=l.findNodeForKey(null==e?void 0:e.key);c&&console.log("225 gjsNode",r),r.isSelected=!1,r.isHighlighted=!0}function C(e,t){e.findMetamodelByName(p.admin.AKM_ADMIN_MM);let l=e.findModelByName(p.admin.AKM_ADMIN_MODEL),o=e.findObjectTypeByName(p.admin.AKM_PROJECT),n=e.findObjectTypeByName(p.admin.AKM_METAMODEL),s=e.findObjectTypeByName(p.admin.AKM_MODEL),a=e.findObjectTypeByName(p.admin.AKM_MODELVIEW),h=l.getObjectsByType(o),u=h[0];e.name=u.name,e.description=u.description;let m=o.getProperties(!0);for(let g=0;g<m.length;g++){let f=m[g];e[f.name]=u[f.name]}let y=l.getObjectsByType(n);for(let v=0;v<y.length;v++){let b;let w=y[v];if(w.metamodelId&&((b=e.findMetamodel(w.metamodelId)).name=w.name,b.description=w.description),b){let j=n.getProperties(!0);for(let T=0;T<j.length;T++){let k=j[T];b[k.name]=w[k.name]}}else{b=new r.eK(i.createGuid(),w.name,w.description),e.addMetamodel(b);let O=n.getProperties(!0);for(let M=0;M<O.length;M++){let D=O[M];b[D.name]=w[D.name]}}}let E=l.getObjectsByType(s);for(let x=0;x<E.length;x++){let R;let N=E[x];if(N.modelId)(R=e.findModel(N.modelId)).name=N.name,R.description=N.description;else{R=new r.qv(i.createGuid(),N.name,N.description),e.addModel(R);let A=N.outputrels;for(let S=0;S<A.length;S++){let C=A[S];if(C.name===p.admin.AKM_REFERSTO_METAMODEL){let P=C.toObject,I=e.findMetamodel(P.metamodelId);R.metamodel=I;break}}}if(R){let _=s.getProperties(!0);for(let L=0;L<_.length;L++){let V=_[L];R[V.name]=N[V.name]}let F=N.outputrels;for(let G=0;G<F.length;G++){let K=F[G];if(K.name===p.admin.AKM_HAS_MODELVIEW){let B=K.toObject;if(B.type.name===p.admin.AKM_MODELVIEW){let U;if(B.modelviewId?((U=e.findModelView(B.modelviewId)).name=B.name,U.description=B.description):(U=new r.Nn(i.createGuid(),B.name,N,B.description),R.addModelView(U),e.addModelView(U)),U){let J=a.getProperties(!0);for(let z=0;z<J.length;z++){let H=J[z];U[H.name]=B[H.name]}}}}}}}let W=new d.st(e,!0),X={metis:W};X=JSON.parse(JSON.stringify(X)),t.dispatch({type:"LOAD_TOSTORE_PHDATA",data:X}),c&&console.log("362 myMetis, data",e,X)}function P(e,t,l,o){let n=[],s=o.findNodeForKey(e.key).findLinksOutOf();c&&console.log("596 links",s);for(let a=null==s?void 0:s.iterator;null==a?void 0:a.next();){let r=a.value,d=r.data.name;n.push(d)}c&&console.log("603 linktypeNames",n);let p=i.removeArrayDuplicates(n);n=p;let h=[],u=l.currentMetamodel;c&&console.log("608 myMetamodel",u);let m=[],g=[],f=e.objecttype;f=l.findObjectType(f.id);for(let y=t.iterator;null==y?void 0:y.next();){let v=y.value;v.data.key!==e.key&&v.data.objecttype&&(g.push(v.data.objecttype),m.push(v.data.objecttype.name))}m=p=i.removeArrayDuplicates(m),g=p=i.removeArrayDuplicates(g),c&&console.log("626 objtypenames, objtypes",m,g),c&&console.log("627 myMetis",l);let b=l.currentModelview,w=b.includeInheritedReltypes,j=[];for(let T=0;T<g.length;T++){let k=g[T];k=l.findObjectType(k.id),c&&console.log("632 fromType, toType",f,k);let O=u.findRelationshipTypesBetweenTypes(f,k,w);if(0==T)j=O,c&&console.log("637 reltypes",j);else{let M=i.getIntersection(j,O);c&&console.log("641 reltypes, rtypes, types",j,O,M),j=M}for(let D=0;D<j.length;D++){let E=j[D].name;h.push(E)}}return c&&console.log("648 reltypeNames",h),h.length>0&&(h=(h=p=i.removeArrayDuplicates(h)).filter(e=>!n.includes(e))).sort(),c&&console.log("655 reltypeNames",h),h}function I(e){c&&console.log("750 context",e);let t=e.myMetis,l=e.myCurrentMetamodel,o=e.myDiagram,i=[],n=t.metamodels;c&&console.log("756 allMetaModels",n,l);for(let s=0;s<n.length;s++){let a=n[s];if(a&&!a.markedAsDeleted&&a.name!==p.admin.AKM_ADMIN_MM){if(l&&a.id===(null==l?void 0:l.id)&&"New Model"!==e.case)continue;switch(e.case){case"Add Metamodel":case"Delete Metamodel":case"Clear Metamodel":case"Replace Metamodel":case"Generate Target Metamodel":if(a.id===(null==l?void 0:l.id))continue}i.push(a)}}e.args.metamodels=i;let r={what:"selectDropdown",title:e.title,case:e.case,myDiagram:o,context:e};c&&console.log("790 modalContext",r);let d=i.map(e=>e&&e.nameId);o.handleOpenModal(d,r)}function _(e){var t,l,o,i,n,s;e.myCurrentMetamodel;let a=e.args.metamodel,r=e.myMetis,h=e.myCurrentModel,u=e.myDiagram,m=r.findObjectTypeByName(p.types.AKM_GENERIC),g=r.findRelationshipTypeByName(p.types.AKM_GENERIC_REL);c&&console.log("634 context",e),h.metamodel=a;let f=h.objects;for(let y=0;y<(null==f?void 0:f.length);y++){let v;let b=f[y];if(!b)continue;let w=null===(t=b.type)||void 0===t?void 0:t.name,j=a.findObjectTypeByName(w);j?(b.type=j,b.typeRef=j.id):(b.type=m,b.typeRef=m.id),v=j?j.typeview:b.type.typeview;let T=b.objectviews;for(let k=0;k<(null==T?void 0:T.length);k++){let O=T[k];O.typeview=v,O.typeviewRef=v.id}}let M=h.relships;for(let D=0;D<(null==M?void 0:M.length);D++){let E=M[D];if(!E)continue;let x=null===(l=E.toObject)||void 0===l?void 0:null===(o=l.type)||void 0===o?void 0:o.name,R=null===(i=E.fromObject)||void 0===i?void 0:null===(n=i.type)||void 0===n?void 0:n.name,N=null===(s=E.type)||void 0===s?void 0:s.name,A=a.findRelationshipTypeByNames(N,x,R);A?(E.type=A,E.typeRef=A.id):(A=g,E.type=A,E.typeRef=A.id);let S=A.typeview,C=E.relshipviews;for(let P=0;P<(null==C?void 0:C.length);P++){let I=C[P];I.typeview=S}}c&&console.log("685 newMetamodel",a);let _=[],L=new d.Lu(a,!0);c&&console.log("688 jsnMetaModel",L),_.push(L),_.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),u.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:t})});let V=[],F=new d.qf(h,!0);c&&console.log("697 jsnModel",F),V.push(F),V.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),u.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:t})}),c&&console.log("703 myMetis",r)}function L(e){let t=e.myCurrentMetamodel,l=e.args.metamodel,o=e.myMetis,i=e.myDiagram;c&&console.log("271 currentMetamodel, metamodel",t,l);let n=l.objecttypes;for(let s=0;s<(null==n?void 0:n.length);s++){let a=n[s];if(a){if(t.findObjectType(a.id))continue;t.addObjectType(a)}}let r=l.relshiptypes;c&&console.log("894 relshiptypes",r);for(let p=0;p<(null==r?void 0:r.length);p++){let h=r[p];if(h){if(t.findRelationshipType(h.id))continue;t.addRelationshipType(h)}}let u=l.objecttypes0;for(let m=0;m<(null==u?void 0:u.length);m++){let g=u[m];if(g){if(t.findObjectType0(g.id))continue;t.addObjectType0(g)}}let f=l.relshiptypes0;for(let y=0;y<(null==f?void 0:f.length);y++){let v=f[y];if(v){if(t.findRelationshipType0(v.id))continue;t.addRelationshipType0(v)}}let b=new d.Lu(t,!0);c&&console.log("293 jsnMetamodel",b);let w=[];w.push(b),w.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),i.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:t})}),c&&console.log("302 myMetis",o),alert("The metamodel has been successfully added!")}function V(e){let t=e.args.metamodel,l=e.myMetis,o=e.myDiagram;c&&console.log("271 metamodel, myMetis",t,l);let i=l.getModelsByMetamodel(t,!1);c&&console.log("274 models",i);let s=!1;if(i.length>0){let a="There are models based on the metamodel '"+t.name+"'.\n";a+="The models will also be deleted!\nDo you still want to continue?",s=confirm(a)}else s=confirm("Do you really want to delete the metamodel '"+t.name+"'?");if(!s)return;{for(let r=0;r<i.length;r++){let p=i[r];U(p,l,o)}t.markedAsDeleted=!0;let h=l.getMetamodels(),u=t.relshiptypes;for(let m=0;m<(null==u?void 0:u.length);m++){let g=u[m],f=!1;for(let y=0;y<h.length;y++){let v=h[y];if(!v.markedAsDeleted&&v.findRelationshipType(g.id)){f=!0;break}}f||(g.markedAsDeleted=!0)}let b=t.relshiptypeviews;for(let w=0;w<(null==b?void 0:b.length);w++){let j=b[w],T=!1;for(let k=0;k<h.length;k++){let O=h[k];if(!O.markedAsDeleted&&O.findRelationshipTypeView(j.id)){T=!0;break}}T||(j.markedAsDeleted=!0)}let M=t.objecttypes;for(let D=0;D<(null==M?void 0:M.length);D++){let E=M[D],x=!1;for(let R=0;R<h.length;R++){let N=h[R];if(!N.markedAsDeleted&&N.findObjectType(E.id)){x=!0;break}}x||(E.markedAsDeleted=!0)}let A=t.objecttypeviews;for(let S=0;S<(null==A?void 0:A.length);S++){let C=A[S],P=!1;for(let I=0;I<h.length;I++){let _=h[I];if(!_.markedAsDeleted&&_.findObjectTypeView(C.id)){P=!0;break}}P||(C.markedAsDeleted=!0)}let L=l.findModel(t.generatedFromModelRef);if(L){let V=L.objects;for(let F=0;F<(null==V?void 0:V.length);F++){let G=V[F];G.generatedTypeId=""}let K=L.relationships;for(let B=0;B<(null==K?void 0:K.length);B++){let J=K[B];J.generatedTypeId=""}let z=new d.qf(L,!1),H=JSON.parse(JSON.stringify(z));o.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:H})}}let W=new d.Lu(t,!0),X=JSON.parse(JSON.stringify(W));o.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:X}),n.m(l,o),c&&console.log("302 myMetis",l)}function F(e){let t=e.myMetis,l=e.args.metamodel;l=t.findMetamodel(l.id);let o=e.myDiagram;c&&console.log("271 metamodel, myMetis",l,t);let i=t.getModelsByMetamodel(l,!1);c&&console.log("274 models",i);let s=!1;if(i.length>0){let a="There are models based on the metamodel '"+l.name+"'.\n";(s=confirm("Do you really want to clear the metamodel '"+l.name+"'?"))&&(a+="Do you want to clear the models as well?",a=((s=confirm(a))?"The models will be cleared!\n":"The models will be kept, but their metamodel will be cleared.\n")+"Do you still want to continue?",s=confirm(a))}else s=confirm("Do you really want to clear the metamodel '"+l.name+"'?");if(s){{l.clearContent();let r=new d.Lu(l,!0);c&&console.log("654 jsnMetamodel",r);let p=JSON.parse(JSON.stringify(r));o.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:p}),n.m(t,o)}c&&console.log("302 myMetis",t)}}function G(e){let t,l,o,n;let s=e.args.metamodel;if(c&&console.log("51 Metamodel chosen: ",s),!s)return;let a=e.myMetis,h=e.myDiagram;if(s.name===p.admin.AKM_ADMIN_MM){if(l=p.admin.AKM_ADMIN_MODEL,n=p.admin.AKM_ADMIN_MODELVIEW,(t=a.findModelByName(l))||(t=new r.qv(i.createGuid(),l,s,""),a.addModel(t)),t){(o=t.findModelViewByName(n))||(o=new r.Nn(i.createGuid(),n,t,""),t.addModelView(modelView),a.addModelView(modelView));let u=new d.qf(t,!0);c&&console.log("35 jsnModel",u),u=JSON.parse(JSON.stringify(u)),h.dispatch({type:"LOAD_TOSTORE_NEWMODELVIEW",data:u});return}}else if(null==(l=prompt("Enter Model name:",""))||""===l)alert("New operation was cancelled");else{let m=new r.qv(i.createGuid(),l,s,"");a.addModel(m);let g=prompt("Enter Modelview name:","Main");if(null==g||""===g)alert("New operation was cancelled");else{let f=new r.Nn(i.createGuid(),g,m,"");(null==s?void 0:s.viewstyle)&&(f.viewstyle=s.viewstyle),m.addModelView(f),a.addModelView(f);let y=new d.qf(m,!0);c&&console.log("35 jsnModel",y),y=JSON.parse(JSON.stringify(y)),h.dispatch({type:"LOAD_TOSTORE_NEWMODELVIEW",data:y})}}}function K(e){c&&console.log("348 context",e);let t=e.myMetis,l=e.myCurrentModel,o=e.myDiagram,i={what:"selectDropdown",title:e.title,case:e.case,myDiagram:o,context:e},n=[],s=t.models;for(let a=0;a<(null==s?void 0:s.length);a++){let r=s[a];if(r.name!==p.admin.AKM_ADMIN_MODEL&&!r.markedAsDeleted){if("Delete Model"===e.case&&r.id===l.id)continue;n.push(r)}}let d=n.map(e=>e&&e.nameId);c&&console.log("372",d,i,e),o.handleOpenModal(d,i)}function B(e){let t=e.args.model;if(t){if(!confirm("Do you really want to delete '"+t.name+"'?"))return;let l=e.myMetis,o=e.myDiagram;c&&console.log("367 model, myMetis",t,l),U(t,l,o)}}function U(e,t,l){c&&console.log("372 model, myMetis",e,t);let o=[];e.markedAsDeleted=!0;let i=new d.qf(e,!0);c&&console.log("376 jsnModel",i),o.push(i),o.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),l.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:t})}),alert("The model '"+e.name+"' has been deleted!"),n.Gh(t,l)}o.bx.make;let J=(e,t)=>{let l="";for(let o=0,i=0;o<e.length;o++)i>=t&&" "===e[o]?(i=0,l+="\n"):(i++,l+=e[o]);return l};function z(e,t){c&&console.log("1035 nodeInfo",e,e.object),c&&console.log("1136 nodeInfo",t.gojsModel.findNode(e.group));let l="%-10s: %s\n",o="";if(o+=h(l,"Name",e.name)+h(l,"Descr.",J(e.object.description,64))+h(l,"Type",e.object.type.name),e.group){let i=t.gojsModel.findNode(e.group);o+="------parent-------\n"+h(l,"Name",i.name)+h(l,"Type",i.typename)+"\n"}return c&&console.log("1133 nodeInfo",o),o}function H(e,t){var l;c&&console.log("551 linkInfo",e,e.relshiptype);let o=null===(l=e.relshiptype)||void 0===l?void 0:l.name,i=t.findRelationshipTypeByName(o),n=e.fromNode,s=null==n?void 0:n.object;i.getFromObjType();let a=e.toNode,r=null==a?void 0:a.object;i.getToObjType(),c&&console.log("560 linkInfo",e);let d=" %-10s: %s\n",p="%-8s: %s\n";return"Relationship:\n"+("Attributes:\n---------------------\n"+h(d,"-Name",e.name)+h(d,"-Title",e.relship.title)+h(d,"-Description",J(e.relship.description,64))+h(p,"-from",null==s?void 0:s.name))+h(d,"-to   ",null==r?void 0:r.name)}function W(e){return c&&console.log("451 diagramInfo",e),"Model:\n"+(e.nodeDataArray.length+" nodes, "+e.linkDataArray.length)+" links"}},2706:function(e,t,l){"use strict";l.d(t,{Aq:function(){return h},UH:function(){return g},Vw:function(){return r},z9:function(){return f}});var o=l(3165),i=l(8749),n=l(137);let s=!1,a=l(2586);function r(e,t){let l=e.myMetis,n=e.myMetamodel,r=l.metamodels;s&&console.log("17 ui_generateTypes",e);let d="";for(let c=0;c<r.length;c++){let p=r[c];p.name!==a.admin.AKM_ADMIN_MM&&(0==c?d="'"+p.name+"'":d+=",'"+p.name+"'")}let h="";if(null==(h=t?prompt("Enter Metamodel name"):prompt("Enter Metamodel as one of "+d,n.name))||""==h){alert("Operation was cancelled!");return}{let u=l.findMetamodelByName(h);if(t&&u){alert("Metamodel already exists");return}if(s&&console.log("41 askForMetamodel",l),!u){if(confirm("Create new metamodel '"+h+"' ?"))u=new i.eK(o.createGuid(),h,""),l.addMetamodel(u);else{alert("Operation was cancelled!");return}}return s&&console.log("51 myMetis",l),u}}function d(e,t,l){var r,d;let c;if(s&&console.log("59 object, objview: ",e,t),!e)return;let p=l.myDiagram,h=l.myMetis,u=l.myTargetMetamodel,m=e.generatedTypeId;s&&console.log("67 typid",m,m.length),s&&console.log("68 myTargetMetamodel",u);let g=h.currentMetamodel,f=l.myModel,y=[],v=[],b=h.findObject(e.id),w=null;s&&console.log("76 object, currentObj, objview",e,b,t),s&&console.log("77 context",l);let j=e.name,k="";j=o.camelize(j);let M=j=o.capitalizeFirstLetter(j);if(s&&console.log("83 newName",j),m?(c=h.findObjectType(m))&&(k=c.getName(),c.setName(j),c.setDescription(e.description),c.setViewKind(b.getViewKind()),c.setAbstract(b.getAbstract()),c.markedAsDeleted=e.markedAsDeleted,null==u||u.addObjectType(c)):((c=h.findObjectTypeByName(b.name))&&(c.setViewKind(b.getViewKind()),c.setAbstract(b.getAbstract())),s&&console.log("102 obj, objtype",b,c)),s&&console.log("104 newName",j),c){c.setModified();let D=c.typeview;s&&console.log("185 objview, typeview",t,D),null==D||D.applyObjectViewParameters(t),s&&console.log("187 typeview",D)}else{let E;let x=["EntityType"];for(let R=0;R<x.length;R++){let N=x[R],A=g.findObjectTypeByName(N);if(A){E=N;break}}if(s&&console.log("117 metaObjectName",E),b.type.name===E||b.isOfSystemType(E)){let S=M,C=b.getInheritanceObjects(f);s&&console.log("124 inheritanceObjects",C),(c=new i.m2(o.createGuid(),S,b.description)).abstract=b.abstract,c.viewkind=b.viewkind;{let P=null===(r=b.type)||void 0===r?void 0:r.getProperties(!0);null!=P&&P.length>0?c.properties=P:c.properties=[];let I=b.getInheritedProperties(f);for(let _=0;_<(null==I?void 0:I.length);_++){let L=I[_];c.properties.push(L)}c.attributes=[],I&&I.length&&I.forEach(e=>{let t=e,l=c.findAttributeByProperty(t.id);l||(l=new i.u4(c,t),c.addAttribute(l))})}null==u||u.addObjectType(c),h.addObjectType(c),e.generatedTypeId=c.getId();let V=new n.GZ(e);y.push(V),s&&console.log("160 object, jsnObject: ",e,V),s&&console.log("161 objtype",c);{let F=o.createGuid(),G=new i.DG(F,c.name,c,b.description);G.applyObjectViewParameters(t),s&&console.log("138 objtype, objtypeview",c,G),c.typeview=G,c.setModified(),h.addObjectTypeView(G)}if(u){u.objtypegeos||(u.objtypegeos=[]);let K=new i.sS(o.createGuid(),u,c,"0 0","100 50");u.addObjtypeGeo(K),s&&console.log("177 myTargetMetamodel",u)}s&&console.log("179 myMetis",h),s&&console.log("180 objtype, myMetis",c,h)}}if(!c)return null;{let B=null;if(c&&(c.setModified(),B||(B=b.type),s&&console.log("198 myMetis",h),w=u.findRelationshipTypeByName2(a.types.AKM_IS,c,B),s&&console.log("202 objtype, parentType, parentRelType",c,B,w),!w&&(w=new i.M$(o.createGuid(),a.types.AKM_IS,c,B,""),c.addOutputreltype(w),B.addInputreltype(w),w.setModified(),w.setRelshipKind("Generalization"),u.addRelationshipType(w),h.addRelationshipType(w),s&&console.log("211 objtype, parentType, parentRelType",c,B,w)),s&&console.log("213 objtype, parentType, parentRelType",c,B,w),s&&console.log("214 generateObjectType",h),w)){let U=[],J=new n.yh(w,!0);s&&console.log("218 Generate Relationship Type",w,J),U.push(J),U.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),p.dispatch({type:"UPDATE_TARGETRELSHIPTYPE_PROPERTIES",data:t})})}}s&&console.log("228 objtype, myTargetMetamodel",c,u),s&&console.log("229 objtype, myMetis",c,h);{let z="EntityType",H=h.findObjectTypeByName(z),W=h.findObjectTypeByName(a.types.AKM_METHOD),X=h.findRelationshipTypeByName2(a.types.AKM_HAS_METHOD,H,W),Y=[],Z=b.outputrels;for(let $=0;$<(null==Z?void 0:Z.length);$++){let q=Z[$];if((null==q?void 0:null===(d=q.type)||void 0===d?void 0:d.id)===(null==X?void 0:X.id)){let Q=q.toObject;if(Q){let ee=u.findMethodByName(Q.name);ee&&Y.push(ee)}}}c.methods=Y,s&&console.log("250 objtype",c)}{c.properties=[],c.description=b.description;let et=[];T(e,et,f),s&&console.log("255 objtype, object, proptypes",c,e,et),O(c,et,l),s&&console.log("257 objtype",c);let el=new n.vM(c,!0);s&&console.log("259 jsnObjectType",el);let eo=[];eo.push(el),eo.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),s&&console.log("265 ui-gen... data",t),p.dispatch({type:"UPDATE_TARGETOBJECTTYPE_PROPERTIES",data:t})}),s&&console.log("268 modifiedTypeNodes",eo,h)}{let ei=c.typeview;if(ei){let en=new n.XA(ei);s&&console.log("278 typeview, jsnObjTypeview",ei,en),v.push(en),null==v||v.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),p.dispatch({type:"UPDATE_TARGETOBJECTTYPEVIEW_PROPERTIES",data:t})})}s&&console.log("286 modifiedTypeViews",v)}{let es=u.findObjtypeGeoByType(c);if(es){let ea=new n.tI(es);s&&console.log("288 Generate Object Type",ea,h);let er=[];er.push(ea),null==er||er.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),p.dispatch({type:"UPDATE_TARGETOBJECTTYPEGEOS_PROPERTIES",data:t})}),s&&console.log("296 myMetis",er,h)}}return null==y||y.map(e=>{let t=e&&e;s&&console.log("266 data",t),t=JSON.parse(JSON.stringify(t)),p.dispatch({type:"UPDATE_OBJECT_PROPERTIES",data:t})}),s&&console.log("270 objtype",c),c}function c(e,t,l){let n,r;if(s&&console.log("316 relship, relview: ",e,t),!e)return;l.myDiagram;let d=l.myMetis,c=l.myTargetMetamodel;s&&console.log("327 myTargetMetamodel",c);let p=d.findRelationship(e.id);s&&console.log("330 currentRel: ",p);let h=null==p?void 0:p.getFromObject(),u=null==h?void 0:h.name;u=o.camelize(u),u=o.capitalizeFirstLetter(u);let m=null==c?void 0:c.findObjectTypeByName(u),g=null==p?void 0:p.getToObject(),f=null==g?void 0:g.name;f=o.camelize(f),f=o.capitalizeFirstLetter(f);let y=null==c?void 0:c.findObjectTypeByName(f);s&&console.log("341 fromObj, toObj: ",h,g),s&&console.log("342 fromtype, totype, toname ",m,y,f);let v=null==p?void 0:p.getName(),b="";(v=o.camelize(v))!==a.types.AKM_IS&&(v=o.uncapitalizeFirstLetter(v));let w=v,j=null==p?void 0:p.generatedTypeId;if(s&&console.log("345 currentRel, typeid, length, newName",p,j,j.length,v),j?(n=d.findRelationshipType(j),s&&console.log("349 reltype, myMetis: ",n,d),n&&(b=null==n?void 0:n.getName(),n.setName(v)),s&&console.log("367 reltype: ",n),n&&(n.markedAsDeleted=e.markedAsDeleted,null==c||c.addRelationshipType(n))):(n=d.findRelationshipTypeByName2(w,m,y))&&(n.markedAsDeleted=e.markedAsDeleted,null==c||c.addRelationshipType(n),n.relshipkind=e.relshipkind,n.cardinality=e.cardinality),s&&console.log("385 reltype, relname, fromtype, totype: ",n,w,m,y),!n&&w&&m&&y){s&&console.log("384 relname, fromtype, totype: ",w,m,y),n=new i.M$(o.createGuid(),w,m,y,p.description),s&&console.log("386 reltype: ",n),n.relshipkind=e.relshipkind,n.cardinality=e.cardinality;{var T;let k=null===(T=p.type)||void 0===T?void 0:T.getProperties(!0);null!=k&&k.length>0?n.properties=k:n.properties=[];for(let O=0;O<(null==k?void 0:k.length);O++){let M=k[O];n.properties.push(M)}}null==c||c.addRelationshipType(n),d.addRelationshipType(n),p.generatedTypeId=n.id,s&&console.log("400 currentRel, reltype",p,n)}if(n){if(r=n.typeview,s&&console.log("421 reltype, typeview: ",n,n.typeview),r){let D=n.name+"_"+n.getRelshipKind();r.name=D,r.applyRelationshipViewParameters(t),r.setRelshipKind(n.relshipkind),n.setModified(),s&&console.log("442 reltype, reltypeview",n,r)}else{let E=o.createGuid(),x=n.name+"_"+n.getRelshipKind();(r=new i.QN(E,x,n,"")).applyRelationshipViewParameters(t),r.setRelshipKind(n.relshipkind),n.typeview=r,n.setModified(),null==c||c.addRelationshipTypeView(r),d.addRelationshipTypeView(r),s&&console.log("432 reltype, reltypeview",n,r)}s&&console.log("443 reltype, reltypeview, relview",n,r,t),s&&console.log("444 relview, reltypeview",t,r),s&&console.log("445 reltypeview",r)}return s&&console.log("468 reltype",n),n}function p(e,t,l,a){if(!e)return;let r=a.myDiagram,d=a.myMetis,c=a.myTargetMetamodel,p=a.myModel,h=[],u=e.name,m=new i.M$(o.createGuid(),u,t,l,e.description);null==c||c.addRelationshipType(m),d.addRelationshipType(m);{let g=[];j(e,g,p),s&&console.log("435 proptypes, myMetis",g,d),O(m,g,a),s&&console.log("437 reltype",m);let f=new n.yh(m,!0);s&&console.log("439 Generate Relationship Type",m,f),h.push(f)}return null==h||h.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),r.dispatch({type:"UPDATE_TARGETRELSHIPTYPE_PROPERTIES",data:t})}),m}function h(e,t){let l=t.myMetis,r=t.myModel,d=t.myDiagram,c=l.findObject(e.id),p=c.name,h=c.description,u=t.myTargetMetamodel;if(!u)return null;let m=null==u?void 0:u.findDatatypeByName(p);if(!m){s&&console.log("464 datatype name:",p);let g=l.findDatatypeByName(p);s&&console.log("466 dtype:",g),g?u.addDatatype(g):(m=new i.ZJ(o.createGuid(),p,h),u.addDatatype(m),l.addDatatype(m))}if(s&&console.log("475 datatype",m,u),m){let f=c.findOutputRelships(r,a.relkinds.REL);if(f){s&&console.log("480 rels",f);let y=[];for(let v=0;v<f.length;v++){let b=f[v],w=b.toObject;s&&console.log("485 parentObj",w);let j=w.type;if(s&&console.log("487 parentType",j),j.name===a.types.AKM_DATATYPE){s&&console.log("489 rel",b);let T=l.findDatatypeByName(w.name);s&&console.log("491 dtype",T),m.setIsOfDatatype(T),m.setInputPattern(null==T?void 0:T.inputPattern),m.setViewFormat(null==T?void 0:T.viewFormat),m.setFieldType(null==T?void 0:T.fieldType)}}s&&console.log("500 rels",f);for(let k=0;k<f.length;k++){let O=f[k];if(O.name===a.types.AKM_HAS_ALLOWED_VALUE){let M=O.toObject;for(let D=0;D<y.length;D++)if(M.name===y[D].value)continue;y.push(M.getName()),s&&console.log("511 rels",f)}else if(O.getName()===a.types.AKM_IS_DEFAULTVALUE){let E=O.toObject;m.setDefaultValue(E.name),s&&console.log("516 defaultValue",E.name),y.push(E.getName())}for(let x=0;x<y.length;x++)m.addAllowedValue(y[x]),s&&console.log("520 allowedValue",y[x]);y.length>0&&"text"===m.getFieldType()&&m.setFieldType("radio")}for(let R=0;R<f.length;R++){let N=f[R];if(N.getName()===a.types.AKM_HAS_INPUTPATTERN){let A=N.getToObject();if(A.type.name===a.types.AKM_INPUTPATTERN){let S=A;S.pattern&&m.setInputPattern(S.pattern)}}if(N.getName()===a.types.AKM_HAS_VIEWFORMAT){let C=N.getToObject();if(C.type.name===a.types.AKM_VIEWFORMAT){let P=C;P.viewFormat&&m.setViewFormat(P.viewFormat)}}if(N.getName()===a.types.AKM_HAS_FIELDTYPE){let I=N.getToObject();if(I.type.name===a.types.AKM_FIELDTYPE){let _=I;_.fieldType&&m.setFieldType(_.fieldType)}}s&&console.log("551 datatype",m),u.addDatatype(m);let L=new n.WN(m),V=[];return V.push(L),s&&console.log("557 ui_generateTypes",L,V),V.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),d.dispatch({type:"UPDATE_DATATYPE_PROPERTIES",data:t})}),s&&console.log("564 generateDatatype",m,l),m}}}}function u(e,t){let l=t.myMetis,a=t.myModel,r=t.myDiagram,d=l.findObject(e.id),c=d.name,p=d.description,h=t.myTargetMetamodel;if(!h)return null;let u=null==h?void 0:h.findMethodTypeByName(c);if(!u){s&&console.log("582 mtdtype name:",c);let m=l.findMethodTypeByName(c);s&&console.log("584 dtype:",m),m?h.addMethodType(m):(u=new i.Az(o.createGuid(),c,p),h.addMethodType(u),l.addMethodType(u))}if(s&&console.log("593 mtdtype",u,h),u){let g=[];j(e,g,a),s&&console.log("598 proptypes, myMetis",g,l),O(u,g,t),s&&console.log("600 mtdtype",u);let f=new n.yp(u);s&&console.log("602 jsnMtdType",f);let y=[];y.push(f),y.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),r.dispatch({type:"UPDATE_METHODTYPE_PROPERTIES",data:t})})}}function m(e,t){let l=t.myMetis;t.myModel;let a=t.myDiagram,r=l.findObject(e.id),d=r.name,c=r.description,p=t.myMetamodel,h=t.myTargetMetamodel,u=null==h?void 0:h.findMethodByName(d);!u&&(s&&console.log("695 method name:",d),(u=l.findMethodByName(d))||(u=new i.ho(o.createGuid(),d,c)),h.addMethod(u),l.addMethod(u),s&&console.log("702 method:",u));let m=r.methodtype,g=p.findMethodTypeByName(m);if(s&&console.log("706 methodType",g),u&&g){u.methodtype=g.name;let f=g.properties;for(let y=0;y<(null==f?void 0:f.length);y++){let v=f[y].name;u[v]=r[v]}s&&console.log("714 method",u)}s&&console.log("717 method",u,p);let b=new n.Hl(u);if(g){let w=g.properties;for(let j=0;j<(null==w?void 0:w.length);j++){let T=w[j].name;b[T]=u[T]}}let k=[];return k.push(b),s&&console.log("729 jsnMethod, myMetis",b,l),k.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),s&&console.log("734 data",t),a.dispatch({type:"UPDATE_TARGETMETHOD_PROPERTIES",data:t})}),s&&console.log("736 method, myMetis",u,l),u}function g(e,t,l){confirm("Do you want to EXCLUDE system types?")?t.currentModel.includeSystemtypes=!1:t.currentModel.includeSystemtypes=!0;let o={metamodel:t.currentTargetMetamodel,modelview:t.currentModelview,node:t.currentNode},i={myMetis:t,myMetamodel:t.currentMetamodel,myModel:t.currentModel,myGoModel:t.gojsModel,myCurrentModelview:t.currentModelview,myCurrentNode:t.currentNode,myDiagram:l,case:"Generate Target Metamodel",title:"Select Target Metamodel",dispatch:l.dispatch,postOperation:b,args:o};s&&console.log("753 context",i),f(i)}function f(e){let t=e.myMetis,l=e.myMetamodel,o=e.myMetis.currentModelview,i=e.myDiagram,n={what:"selectDropdown",title:e.title,case:e.case,modelview:o,myDiagram:i,context:e},r=t.metamodels,d=[];for(let c=0;c<r.length;c++){let p=r[c];p.name!==a.admin.AKM_ADMIN_MM&&p.id!==l.id&&d.push(p.nameId)}s&&console.log("724",d,n,e),i.handleOpenModal(d,n)}function y(e){var t,l;let n=e.myCurrentModelview,r=e.myModel,d=[],c=[],p=n.objectviews;for(let h=0;h<(null==p?void 0:p.length);h++){let u=p[h],m=u.object;s&&console.log("822 model, obj, objview",r,m,u),m&&(m=r.findObject(m.id),d.push(m),v(r,m,d,c))}let g=[...new Set(d)];d=g;let f=n.relshipviews;for(let y=0;y<(null==f?void 0:f.length);y++){let b=f[y];s&&console.log("830 relview",b);let w=b.relship;w&&c.push(w)}s&&console.log("841 rellist",c),c=g=[...new Set(c)],s&&console.log("844 objlist, rellist",d,c);let j=new i.Nn(o.createGuid(),"_TEMPVIEW",r,"Temporary modelview");for(let T=0;T<d.length;T++){let k;let O=d[T];if(!O)continue;let M=null===(t=O.objectviews)||void 0===t?void 0:t.length;k=M>0?O.objectviews[0]:new i.q6(o.createGuid(),O.name,O,""),O.addObjectView(k),j.addObjectView(k)}for(let D=0;D<c.length;D++){let E=c[D];if(!E)continue;let x=E.fromObject,R=E.toObject;if(x&&R){let N;let A=null===(l=E.relshipviews)||void 0===l?void 0:l.length;A>0?((N=E.relshipviews[0]).category=a.gojs.C_RELSHIPVIEW,s&&console.log("862 relview",N)):(N=new i.IM(o.createGuid(),E.name,E,""),s&&console.log("865 relview",N));let S=null==x?void 0:x.objectviews[0],C=null==R?void 0:R.objectviews[0];N.setFromObjectView(S),N.setToObjectView(C),j.addRelationshipView(N),s&&console.log("877 relview",N)}}return s&&console.log("880 tempModelview",j),j}function v(e,t,l,o){if(!t)return;let i=t.findOutputRelships(e,a.relkinds.GEN);if(null==i?void 0:i.length)for(let n=0;n<(null==i?void 0:i.length);n++){let s=i[n];if(s){let r=s.toObject;r&&(l.push(r),o.push(s))}}}function b(e){s&&console.log("893 context",e);let t=y(e);s&&console.log("895 sourcemodelview",t),e.args;let l=e.myTargetMetamodel;if(e.myModel,s&&console.log("899 metamodel, modelview, context",l,t,e),!l||!t)return!1;let o=e.myMetis,i=e.myCurrentNode;s&&console.log("740 myMetis",o);let n=t.objectviews,a=t.relshipviews;return i&&(s&&console.log("744 currentNode, myGoModel",i,e.myGoModel),n=(i=e.myGoModel.findNode(i.key)).getGroupMembers2(e.myGoModel),a=i.getGroupLinkMembers2(e.myGoModel)),s&&console.log("749 objviews, relviews",n,a,e),w(n,a,e),s&&console.log("785 myMetis",o),!0}function w(e,t,l){var r,g,f,y,v;let b,w,k,M;s&&console.log("965 objectviews, relshipviews, context",e,t,l);let D=l.myMetis,E=l.myMetamodel,x=l.myModel,R=l.myTargetMetamodel,N=l.myDiagram,A=[],S=[],C=[],P=[];if(!R)return null;x.targetMetamodelRef=R.id,R.generatedFromModelRef=x.id,R.includeSystemtypes=!0;let I=R.name,_=I+"_Viewstyle",L=R.viewstyle;L||(L=new i.Dw(o.createGuid(),_,""),R.viewstyle=L,R.addViewStyle(L),D.addViewStyle(L));let V=null==x?void 0:x.getObjectsByTypename("Datatype",!1);if(V)for(let F=0;F<V.length;F++){let G=V[F];G&&!G.markedAsDeleted&&h(G,l)}let K=E.methodtypes;if(K&&(R.methodtypes=K),V=null==x?void 0:x.getObjectsByTypename("MethodType",!1))for(let B=0;B<V.length;B++){let U=V[B];U&&!U.markedAsDeleted&&u(U,l)}if(V=null==x?void 0:x.getObjectsByTypename("Method",!1)){s&&console.log("1316 methods",V);for(let J=0;J<V.length;J++){let z=V[J];if(z&&!z.markedAsDeleted){let H=m(z,l),W=new n.Hl(H);s&&console.log("1322 method, jsnMethod",H,W);let X=H.methodtype,Y=E.findMethodTypeByName(X);if(s&&console.log("1325 methodType",Y),H&&Y){H.methodtype=Y.name;let Z=Y.properties;for(let $=0;$<(null==Z?void 0:Z.length);$++){let q=Z[$].name;W[q]=z[q]}s&&console.log("1334 method",H)}A.push(W),s&&console.log("1337 method, jsnMethod",H,W)}}}let Q=["cardinality","viewkind","relshipkind","fieldtype","layout","routing","linkcurve","integer","string","number","boolean","date","reldir","actiontype"];if(x.includeSystemtypes)b=E.datatypes;else{b=[];for(let ee=0;ee<Q.length;ee++){let et=Q[ee],el=E.findDatatypeByName(et);b.push(el)}}for(let eo=0;eo<b.length;eo++){let ei=b[eo];ei&&R.addDatatype(ei)}let en=["Datatype","Value","FieldType","InputPattern","ViewFormat"];if(x.includeSystemtypes)w=E.objecttypes,R.includeInheritedReltypes=!0;else{w=[];let es=E.objecttypes;for(let ea=0;ea<es.length;ea++){let er=es[ea];er=D.findObjectType(er.id);let ed=er.name;if(o.nameExistsInNames(en,ed)||er.isOfType("Property")||er.isOfType("Method")||er.isOfType("MethodType")||er.isOfType("RelshipType"))continue;let ec=E.findObjectTypeByName(ed);w.push(ec)}}s&&console.log("1082 objecttypes",w);for(let ep=0;ep<w.length;ep++){let eh=null===(r=w[ep])||void 0===r?void 0:r.name,eu=E.findObjectTypeByName(eh);if(s&&console.log("1076 typename, objtype",eh,eu),eu){R.addObjectTypeByName(eu),R.addObjectTypeView(eu.typeview);let em=new i.sS(o.createGuid(),R,eu,"","");R.addObjtypeGeo(em);let eg=new n.tI(em);s&&console.log("1083 Generate Object Type",eg,D),S.push(eg)}}if(s&&console.log("1098 objtypes, metamodel",w,R),x.includeSystemtypes)k=E.relshiptypes,s&&console.log("1092 reltypes",k);else{s&&console.log("1105 reltypes",E.relshiptypes),k=[];let ef=E.relshiptypes;for(let ey=0;ey<ef.length;ey++){let ev=ef[ey];(ev=D.findRelationshipType(ev.id)).name;let eb=R.objecttypes,ew=ev.fromObjtype,ej=ev.toObjtype,eT=!1,ek=!1;for(let eO=0;eO<eb.length;eO++){let eM=eb[eO];eM.id===ew.id&&(eT=!0),eM.id===ej.id&&(ek=!0)}eT&&ek&&(k.push(ev),s&&console.log("1120 rtype, rtype.name, fromtype, totype",ev,ev.name,ew.name,ej.name))}}s&&console.log("1125 reltypes",k);for(let eD=0;eD<k.length;eD++){let eE=k[eD];eE&&(R.addRelationshipType(eE),s&&console.log("1130 metamodel, reltype",R,eE))}s&&console.log("1133 reltypes, metamodel",k,R),s&&console.log("1134 system relship types completed",D);{let ex=["EntityType"];for(let eR=0;eR<ex.length;eR++){let eN=ex[eR],eA=E.findObjectTypeByName(eN);if(eA){M=eN;break}}if(s&&console.log("1092 objectviews",e),e){s&&console.log("1094 objectviews",e);for(let eS=0;eS<e.length;eS++){let eC=e[eS];if(!eC)continue;let eP=eC.object;if(!eP)continue;switch(eP.type.name){case"Property":case"Datatype":case"Value":case"FieldType":case"InputPattern":case"ViewFormat":case"MethodType":case"Method":case"Label":continue;default:if((eP=D.findObject(eP.id)).isOfType("Property"))continue}let eI=[];eP.name===eP.type.name&&eI.push(eP.type.name),eI.push(M);for(let e_=0;e_<eI.length;e_++){s&&console.log("945 i, obj, type",e_,eP,eI[e_]);let eL=E.findObjectTypeByName(eI[e_]);if(s&&console.log("947 type, obj",eL,eP),eL&&eP&&eP.type){let eV;if(eL.markedAsDeleted)continue;if(eP.type.name===M){s&&console.log("953 obj",eP.name,eP),s&&console.log("956 obj, objview",eP,eC),eV=d(eP,eC,l),s&&console.log("958 objtype",eV),eV&&R.addObjectType(eV),eV&&eV.name!==a.types.AKM_ENTITY_TYPE&&R.addObjectType0(eV);let eF=null==eV?void 0:eV.typeview;eF&&(R.addObjectTypeView(eF),L.addObjectTypeView(eF),R.addViewStyle(L)),s&&console.log("966 metamodel ",R)}}}}}s&&console.log("1170 metamodel ",R)}if(t){s&&console.log("1205 relshipviews",t);for(let eG=0;eG<t.length;eG++){let eK=t[eG];if(s&&console.log("1208 relview",eK),!eK)continue;let eB=eK.relship;if(eB.isSystemRel()){s&&console.log("1184 rel",eB);continue}let eU=eK.fromObjview;if(!eU)continue;let eJ=null==eU?void 0:eU.object,ez=eK.toObjview;if(!ez)continue;let eH=null==ez?void 0:ez.object;if(eB.name===a.types.AKM_IS)for(let eW=0;eW<w.length;eW++){let eX=w[eW];if((null==eJ?void 0:eJ.id)===(null==eX?void 0:eX.id))for(let eY=0;eY<w.length;eY++){let eZ=w[eW];if((null==eH?void 0:eH.id)===(null==eZ?void 0:eZ.id))continue}}if(s&&console.log("1248 fromObj, toObj",eJ,eH),(null==eJ?void 0:eJ.isOfSystemType(M))&&(null==eH?void 0:eH.isOfSystemType(M))){let e$=R.findRelationshipTypeByNames(eB.name,eJ.name,eH.name);if(e$?s&&console.log("1253 rel, metamodel.reltype, typeview",eB.name,e$,null==e$?void 0:e$.typeview):(e$=D.findRelationshipTypeByNames(eB.name,eJ.name,eH.name),s&&console.log("1256 rel, myMetis.reltype, typeview",eB.name,e$,null==e$?void 0:e$.typeview)),!e$&&(e$=c(eB,eK,l),s&&console.log("1260 rel, generated.reltype, typeview",eB.name,e$,null==e$?void 0:e$.typeview)),e$){R.addRelationshipType(e$),R.addRelationshipType0(e$);let eq=new n.yh(e$,!0);s&&console.log("1257 Generate Relationship Type",e$,eq);let eQ=[];eQ.push(eq);let e0=e$.typeview;if(e0){D.addRelationshipTypeView(e0);let e1=new n.Ug(e0);s&&console.log("1265 Generate Reltypeview",e1),P.push(e1)}}}}}s&&console.log("1299 metamodel ",R);for(let e2=0;e2<(null==e?void 0:e.length);e2++){let e6,e5,e3,e4;let e8=e[e2],e9=e8.object;if(!e9)continue;let e7=e9.type;if("RelshipType"!==e7.name)continue;let te=e9.name,tt=e9.findOutputRelships(x,a.relkinds.REL);for(let tl=0;tl<tt.length;tl++){let to=tt[tl];if("from"===to.type.name){e6=to.toObject;let ti=null==e6?void 0:e6.name;e3=R.findObjectTypeByName(ti)}else if("to"===to.type.name){e5=to.toObject;let tn=null==e5?void 0:e5.name;e4=R.findObjectTypeByName(tn)}}s&&console.log("1284 rtypename, fromObjType, toObjType",te,e3,e4);let ts=D.findRelationshipTypeByName1(te,e3,e4);if(!ts&&(ts=p(e9,e3,e4,l),s&&console.log("1290 reltype",ts),ts)){R.addRelationshipType(ts);let ta=new n.yh(ts,!0);s&&console.log("1229 Generate Relationship Type",ts,ta);let tr=[];tr.push(ta);let td=ts.typeview;if(td){R.addRelationshipTypeView(td);let tc=new n.Ug(td);s&&console.log("1301 Generate Reltypeview",tc),P.push(tc)}}{let tp=[];T(e9,tp,l),j(e9,tp,x),s&&console.log("1309 proptypes, myMetis",tp,D),O(ts,tp,l),s&&console.log("1311 reltype",ts);let th=new n.yh(ts,!0);s&&console.log("1313 Generate Relationship Type",ts,th),C.push(th)}}{let tu=null==x?void 0:x.getRelationshipsByTypeName("Is",a.relkinds.GEN);if(s&&console.log("1346 model, rels",x,tu),tu)for(let tm=0;tm<tu.length;tm++){let tg=tu[tm],tf=tg.fromObject,ty=tg.toObject;if(tf&&ty){let tv=R.findObjectTypeByName(tf.name),tb=R.findObjectTypeByName(ty.name);if(tv&&tb){let tw=!1,tj=R.findRelationshipTypesBetweenTypes(tv,tb,!1);if(s&&console.log("1360 metamodel, reltypes",R,tj),tj)for(let tT=0;tT<tj.length;tT++){let tk=tj[tT];if("Is"===tk.name){tw=!0;break}}if(!tw){let tO=new i.M$(o.createGuid(),"Is",tv,tb,"");tO.relshipkind=a.relkinds.GEN,tv.addOutputreltype(tO),s&&console.log("1374 fromType, toType, reltype",tv,tb,tO),R.addRelationshipType(tO),D.addRelationshipType(tO)}}}}}R.includeInheritedReltypes=x.includeSystemtypes,D.currentTargetMetamodel=R,D.currentTargetModel=x,s&&console.log("1419 metamodel ",R);{let tM=R.relshiptypes;for(let tD=0;tD<(null==tM?void 0:tM.length);tD++){let tE=tM[tD];for(let tx=tD+1;tx<(null==tM?void 0:tM.length);tx++){let tR=tM[tx];(null===(g=tE.fromObjtype)||void 0===g?void 0:g.id)===(null===(f=tR.fromObjtype)||void 0===f?void 0:f.id)&&(null===(y=tE.toObjtype)||void 0===y?void 0:y.id)===(null===(v=tR.toObjtype)||void 0===v?void 0:v.id)&&tE.name===tR.name&&(s&&console.log("Removing duplicate relship type",tE,tR),tM.splice(tx,1),tx--)}}s&&console.log("1420 metamodel",R),D.addMetamodel(R);let tN=new n.st(D,!0);s&&console.log("1424 jsnMetis: ",tN);let tA={metis:tN};tA=JSON.parse(JSON.stringify(tA)),N.dispatch({type:"LOAD_TOSTORE_PHDATA",data:tA})}return alert("Target metamodel has been successfully generated!"),R}function j(e,t,l){let o=null==e?void 0:e.findOutputRelships(l,a.relkinds.GEN);if(o)for(let i=0;i<o.length;i++){let n=o[i],r=null==n?void 0:n.toObject;r&&(s&&console.log("1162 toObj",r),j(r,t,l))}T(e,t,l)}function T(e,t,l){let o=null==e?void 0:e.findOutputRelships(l,a.relkinds.REL);for(let i=0;i<(null==o?void 0:o.length);i++){var n,r,d,c,p,h,u;let m=o[i],g=null==m?void 0:m.getToObject();if(s&&console.log("1186 obj, rel, toObj",e,m,g),(null===(n=g.type)||void 0===n?void 0:n.name)===a.types.AKM_PROPERTY){let f=null==m?void 0:m.getToObject();for(let y=0;y<t.length;y++)if(f.name===t[y].name)continue;s&&console.log("1194 proptype",f),t.push(f)}if((null==m?void 0:null===(r=m.type)||void 0===r?void 0:r.name)===a.types.AKM_HAS_COLLECTION&&(null===(c=g.type)||void 0===c?void 0:c.name)===a.types.AKM_COLLECTION){let v=g.outputrels;for(let b=0;b<(null==v?void 0:v.length);b++){let w=v[b];if((null==w?void 0:null===(p=w.type)||void 0===p?void 0:p.name)===a.types.AKM_CONTAINS){let j=w.toObject;(null==j?void 0:null===(h=j.type)||void 0===h?void 0:h.name)===a.types.AKM_PROPERTY&&t.push(j)}}}if((null==m?void 0:null===(d=m.type)||void 0===d?void 0:d.name)===a.types.AKM_HAS_PROPERTIES&&((null===(u=g.type)||void 0===u?void 0:u.name)===a.types.AKM_CONTAINER||g.type.viewkind===a.viewkinds.CONT)){let T=g.objectviews;for(let O=0;O<T.length;O++){let M=T[O],D=M.id;k(D,t,l)}}}return t}function k(e,t,l){let o=l.getObjects();for(let i=0;i<(null==o?void 0:o.length);i++){var n;let s=o[i];if((null==s?void 0:null===(n=s.type)||void 0===n?void 0:n.name)!==a.types.AKM_PROPERTY)continue;let r=null==s?void 0:s.objectviews;for(let d=0;d<(null==r?void 0:r.length);d++){let c=r[d];c&&c.group===e&&t.push(s)}}return t}function O(e,t,l){let r=l.myMetis,d=l.myModel,c=l.myTargetMetamodel,p=l.myDiagram;e.properties=[];for(let h=0;h<t.length;h++){let u=t[h],m=e.findPropertyByName(u.name);if(s&&console.log("1212 proptype, prop",u,m),m)m=r.findProperty(m.id),e.addProperty(m);else{m=new i.cY(o.createGuid(),u.name,u.description);let g=r.findDatatypeByName("string");m.setDatatype(g),e.addProperty(m),c.addProperty(m),r.addProperty(m),s&&console.log("1221 prop",m)}if(s&&console.log("1227 objtype, prop, targetMetamodel",e,m,c),m){let f=r.findProperty(m.id);m=f||m;let y=u.findOutputRelships(d,a.relkinds.REL);if(s&&console.log("1233 rels",y),m&&y)for(let v=0;v<y.length;v++){let b=y[v];if(!b.markedAsDeleted&&b.name===a.types.AKM_IS_OF_DATATYPE){let w=b.toObject;if(w){let j=r.findDatatypeByName(w.name);s&&console.log("1242 datatype",j),j&&m.setDatatype(j)}}s&&console.log("1256 property",m),e.addProperty(m),null==c||c.addProperty(m),r.addProperty(m)}if(y=u.findOutputRelships(d,a.relkinds.REL),s&&console.log("1264 rels",y),m&&y)for(let T=0;T<y.length;T++){let k=y[T];if(!k.markedAsDeleted&&k.name===a.types.AKM_HAS_METHOD){s&&console.log("1270 rel",k);let O=k.toObject;if(s&&console.log("1272 toObj",O),O.type.name===a.types.AKM_METHOD){s&&console.log("1274 mtdname",O.name);let M=O;if(M){let D=r.findMethodByName(M.name);s&&console.log("1277 method",D),D&&m.setMethod(D)}}}}}}s&&console.log("1290 type",e);let E=null==e?void 0:e.properties,x=[];for(let R=0;R<(null==E?void 0:E.length);R++){let N=new n.kA(E[R]);s&&console.log("1296 prop, jsnProperty",E[R],N),x.push(N)}(null==x?void 0:x.length)>0&&(x.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),p.dispatch({type:"UPDATE_PROPERTY_PROPERTIES",data:t})}),s&&console.log("1305 modifiedProps",x))}},6680:function(e,t,l){"use strict";l.d(t,{SP:function(){return s},Yg:function(){return c},fx:function(){return g},hX:function(){return h},of:function(){return d},zV:function(){return u}});var o=l(3165);let i=!1,n=l(2586);l(5854);class s{getModelView(){return this.modelView}getModel(){if(this.modelView)return this.modelView.model}getMetamodel(){return this.metamodel}setMetamodel(e){this.metamodel=e}addNode(e){var t;e.setParentModelRef(this);let l=[];for(let o=0;o<(null===(t=this.nodes)||void 0===t?void 0:t.length);o++){let i=this.nodes[o];i.key!==e.key&&l.push(i)}l.push(e),this.nodes=l}addLink(e){let t=[];for(let l=0;l<this.links.length;l++){let o=this.links[l];t.push(o)}t.push(e),this.links=t}findNodeByViewId(e){let t=null;if(!o.isArrayEmpty(this.nodes)){var l;let i=0;for(;i<(null===(l=this.nodes)||void 0===l?void 0:l.length);){let n=this.nodes[i],s=n,a=s.objectview;if(a&&a.id===e)return s;i++}}return t}findNodeByObjectId(e){let t=null;if(!o.isArrayEmpty(this.nodes)){var l;let i=0;for(;i<(null===(l=this.nodes)||void 0===l?void 0:l.length);){let n=this.nodes[i],s=n;if(s.object&&s.object.id===e)return s;i++}}return t}findNode(e){let t=null;if(!o.isArrayEmpty(this.nodes)){var l;let i=0;for(;i<(null===(l=this.nodes)||void 0===l?void 0:l.length);){let n=this.nodes[i];if(n.getKey()===e)return n;i++}}return t}findTypeNode(e){let t=null;if(!o.isArrayEmpty(this.nodes)){var l;let i=0;for(;i<(null===(l=this.nodes)||void 0===l?void 0:l.length);){let n=this.nodes[i];if(n.objecttype.id===e){t=n;break}i++}}return t}findGroup(e){let t=this.nodes,l=null==t?void 0:t.length;for(let o=0;o<l;o++){let i=t[o],n=i;if(!n.isGroup)continue;let s=n.objectview;if(s&&s.id===e)return n}return null}findLink(e){let t=null;if(!o.isArrayEmpty(this.links)){let l=0;for(;l<this.links.length;){let i=this.links[l];if(i.key===e)return i;l++}}return t}findLinkByViewId(e){let t=null;if(!o.isArrayEmpty(this.links)){let l=0;for(;l<this.links.length;){let i=this.links[l],n=i;if(n.relshipview&&n.relshipview.id===e)return n;l++}}return t}updateNode(e){let t=this.nodes;for(let l=0;l<t.length;l++){let o=t[l];if(o.key===e.key){for(let i in o)"string"==typeof i&&e[i]!==o[i]&&(o[i]=e[i]);break}}}updateTypeNode(e){let t=this.nodes;for(let l=0;l<t.length;l++){let o=t[l];if(o.key===e.key){t[l]=e;break}}}updateLink(e){let t=this.links;for(let l=0;l<t.length;l++){let o=t[l];if(o.key===e.key){t[l]=e;break}}}updateTypeLink(e){let t=this.links;for(let l=0;l<t.length;l++){let o=t[l];if(o.key===e.key){t[l]=e;break}}}loadMetamodel(e){if(o.objExists(e)&&(this.metamodel=e,e.objecttypes)){let t=new s(o.createGuid(),e.getName(),this.modelView),l=e.getObjectTypes();if(l){let i=0,n=l.length;for(i=0;i<n;i++){let a=l[i];if(o.objExists(a)&&!a.getMarkedAsDeleted()){let r=new c(o.createGuid(),a);r.loadNodeContent(e),t.addNode(r)}}let d=e.getRelshipTypes();if(d)for(i=0,n=d?d.length:0,i=0;i<n;i++){let p=d[i];if(p&&!p.getMarkedAsDeleted()){let h=o.createGuid(),m=new u(h,t,p);m.loadLinkContent()&&t.addLink(m)}}}}}constructor(e,t,l){var o,s;this.key=e,this.name=t,this.modelView=l,this.nodes=[],this.links=[],this.model=l?l.model:null,this.metamodel=l&&l.model?l.model.metamodel:null,this.layout="",this.layer=null===(o=this.model)||void 0===o?void 0:o.layer,this.visible="Admin"!==this.layer,this.args1=null===(s=this.model)||void 0===s?void 0:s.args1,i&&console.log("41 constants",n,this)}}class a{getClass(){return this.class}getParentModelRef(){return this.parentModelRef}setParentModelRef(e){this.parentModelRef=null==e?void 0:e.key}getKey(){return this.key}setType(e){this.type=e}getType(){return this.type}setName(e){this.name=e}getName(){return this.name}addData(e){m(this,e)}getData(){return this.data}constructor(e){this.parentModelRef="",this.key=e,this.category="default",this.type=null,this.name="",this.data=[]}}class r extends a{setLoc(e){this.loc=e}getLoc(){return this.loc}setSize(e){this.size=e}getSize(){return this.size}setScale(e){this.scale=e,this.scale1=e}getScale(){return this.scale}getScale1(){return this.scale1}setViewkind(e){this.viewkind=e}getViewkind(){return this.viewkind}constructor(e,t){super(e),this.parentModelRef=null==t?void 0:t.key,this.text="",this.loc="",this.size="",this.scale="",this.scale1="",this.memberscale="",this.strokecolor="",this.strokecolor2="",this.fillcolor="",this.fillcolor2="",this.viewkind="",this.markedAsDeleted=!1}}class d extends r{getObjectViewId(e){return this.objectview?this.objectview.getId():""}loadNodeContent(e){if(this.typeview){let t=this.typeview,l=t.getData();if(this.addData(l),this.objectview){let o=this.objectview;for(let n in l)o[n]&&""!==o[n]&&(this[n]=o[n]),"scale1"===n&&(""===o.scale1&&(this[n]="1"),this[n]=Number(this[n]));let s=this.objectview.group;if(""!==s){let a=this.getGroupFromObjviewId(s,e);""!==a&&(this.group=a)}return this.objectview.isGroup&&(this.isGroup=!0),this.setName(this.objectview.getName()),this.setLoc(this.objectview.getLoc()),this.setSize(this.objectview.getSize()),this.setScale(this.objectview.getScale()),i&&console.log("415 goObjectNode",this),!0}}return!1}updateNode(e,t){if(this.typeview){let l;let o=this.typeview.getData(),i=o;for(l in i)null!=i[l]&&t.model.setDataProperty(i,l,i[l])}}getParentNode(e){let t=this.group;if(""!==t){let l=e.nodes;for(let o=0;o<(null==l?void 0:l.length);o++){let i=l[o];if(i.key===t)return i}}return null}getTopNode(e){let t=this.getParentNode(e);if(t){if(t.key===this.key);else{let l=t.getTopNode(e);if(l)return l}}return this}getMyScale(e){this.scale1;let t=this.getParentNode(e);return t?t.typeview.memberscale*t.getMyScale(e):1}getActualScale(e){let t=this.scale1,l=this.getParentNode(e);if(i&&console.log("597 node",l),l&&l.key!==this.key){let o=l.getActualScale(e);t*=o,i&&console.log("601 scale, scale1",o,t)}return t}getGroupFromObjviewId(e,t){let l=t.nodes;for(let o=0;o<(null==l?void 0:l.length);o++){let i=l[o],n=i.objectview;if(n&&n.id===e)return i.key}return""}getGroupMembers(e){if(!this.isGroup)return null;let t=[],l=this.key,o=e.nodes;for(let i=0;i<o.length;i++){let n=o[i];n.group===l&&t.push(n)}return t}getGroupMembers2(e){if(!this.isGroup)return null;let t=[],l=this.key,o=e.nodes;for(let i=0;i<o.length;i++){let n=o[i];n.group===l&&t.push(n.objectview)}return t}getGroupLinkMembers(e){if(!this.isGroup)return null;let t=this.key,l=[],o=e.links;for(let n=0;n<o.length;n++){let s=o[n],a=s.fromNode,r=s.toNode;i&&console.log("488 groupId, nodes",t,a,r),a.group===t&&r.group===t&&l.push(s)}return l}getGroupLinkMembers2(e){if(!this.isGroup)return null;let t=this.key,l=[],o=e.links;for(let n=0;n<o.length;n++){let s=o[n],a=s.fromNode,r=s.toNode;if(i&&console.log("501 groupId, nodes",t,a,r),(null==a?void 0:a.group)===t&&(null==r?void 0:r.group)===t){let d=s.relshipview;l.push(d)}}return l}constructor(e,t){if(super(e,null),this.category=n.gojs.C_OBJECT,this.objectview=t,this.object=null,this.objecttype=null,this.typename="",this.typedescription="",this.template=t.template,this.figure=t.figure,this.geometry=t.geometry,this.fillcolor=t.fillcolor,this.fillcolor2=t.fillcolor2,this.strokecolor=t.strokecolor,this.strokecolor2=t.strokecolor2,this.strokewidth=t.strokewidth,this.textcolor=t.textcolor,this.textscale=t.textscale,this.icon=t.icon,this.isGroup=t.isGroup,this.scale1=t.scale1,this.memberscale=t.memberscale,this.isCollapsed=t.isCollapsed,this.groupLayout="Tree",this.group=t.group,this.parent="",t){var l,o,i;let s=t.getObject();s&&(this.object=s,this.name=s.getName(),s.getType()?(this.objecttype=s.getType(),this.typename=this.objecttype.getName(),this.typedescription=this.objecttype.getDescription()):(this.objecttype=null,this.typename="",this.typedescription="")),this.typeview=t.getTypeView(),this.template||(this.template=null===(l=this.typeview)||void 0===l?void 0:l.template),this.geometry||(this.geometry=null===(o=this.typeview)||void 0===o?void 0:o.geometry),this.figure||(this.figure=null===(i=this.typeview)||void 0===i?void 0:i.figure)}}}class c extends r{getObjectTypeId(){return this.objecttype?this.objecttype.getId():""}loadNodeContent(e){if(this.objecttype){let t=this.objecttype,l=this.typeview;if(l){let o=l.getData();if(this.addData(o),this.setName(t.getName()),this.setType(n.gojs.C_OBJECTTYPE),this.setViewkind(t.getViewKind()),e){let s=t.getLoc(e);this.setLoc(s);let a=t.getSize(e);this.setSize(a)}}return i&&console.log("671 loadNodeContent",this),!0}return!1}updateNode(e,t){if(this.typeview){let l;let o=this.typeview.getData(),i=o;for(l in i)null!=i[l]&&t.model.setDataProperty(i,l,i[l])}}constructor(e,t){if(super(e,null),this.category=n.gojs.C_OBJECTTYPE,this.objecttype=t,this.typeview=null,this.typename=n.gojs.C_OBJECTTYPE,this.typedescription="",i&&console.log("416 this",this),t){this.setName(t.getName()),this.setType(n.gojs.C_OBJECTTYPE);let l=t.getDefaultTypeView();l&&(this.typeview=l)}}}class p extends a{constructor(e,t){super(e),this.parentModelRef=t.key,this.markedAsDeleted=!1}}class h extends p{getRelshipView(){return this.relshipview}getFromNode(){return this.fromNode}setFromNode(e){this.from=e}getToNode(){return this.toNode}setToNode(e){this.to=e}getRelshipKind(){let e=this.typeview;return e?e.getRelshipKind():this.relshipkind}setRelshipKind(e){this.relshipkind=e}loadLinkContent(e){let t=this.relshipview,l=this.typeview,o=e.modelView;if(i&&console.log("722 typeview, relview: ",l,t),t&&l){if(!t.markedAsDeleted&&this.toNode&&this.fromNode){let n=l.data;for(let s in l.data,this.setName(t.name),this.points=t.points,n)"abstract"!==s&&"class"!==s&&"category"!==s&&(t[s]&&""!==t[s]&&void 0!=t[s]?this[s]=t[s]:this[s]=n[s])}i&&console.log("744 goRelshipLink, typeview, relview: ",this,l,t)}if(this.routing=o.routing,this.curve=o.linkcurve,o.showCardinality){var a,r;this.cardinalityFrom=null===(a=t.relship)||void 0===a?void 0:a.getCardinalityFrom(),this.cardinalityTo=null===(r=t.relship)||void 0===r?void 0:r.getCardinalityTo()}else this.cardinalityFrom="",this.cardinalityTo="";this.fromArrow||this.toArrow||(this.toArrow="OpenTriangle"),this.toArrow&&"None"===this.toArrow&&(this.toArrow=""),i&&console.log("764 goRelshipLink, this: ",this)}updateLink(e,t){if(this.typeview){let l;let o=this.typeview.getData(),i=o;for(l in i)null!=i[l]&&t.model.setDataProperty(i,l,i[l])}}constructor(e,t,l){if(super(e,t),this.category=n.gojs.C_RELATIONSHIP,this.relshipview=l,this.relship=null,this.relshiptype=null,this.typename="",this.typeview=null,this.fromNode=null,this.toNode=null,this.from="",this.to="",this.template=null==l?void 0:l.template,this.arrowscale=null==l?void 0:l.arrowscale,this.strokecolor=null==l?void 0:l.strokecolor,this.strokewidth=null==l?void 0:l.strokewidth,this.textcolor=null==l?void 0:l.textcolor,this.textscale=null==l?void 0:l.textscale,this.fromArrow=null==l?void 0:l.fromArrow,this.fromArrowColor=null==l?void 0:l.fromArrowColor,this.toArrow=null==l?void 0:l.toArrow,this.toArrowColor=null==l?void 0:l.toArrowColor,this.routing="",this.curve="",this.points=null,this.relshipkind="",this.cardinality="",this.cardinalityFrom="",this.cardinalityTo="",this.nameFrom="",this.nameTo="",l){var o,s;let a=l.getRelationship();a&&(this.relship=a,this.relshiptype=a.type,this.type=this.typename,this.name=this.relship.name,0==this.name.length&&(this.name=this.typename),this.cardinalityFrom=this.relship.cardinalityFrom,this.cardinalityTo=this.relship.cardinalityTo,this.nameFrom=this.relship.nameFrom,this.nameTo=this.relship.nameTo,i&&console.log("629 relshipLink",this)),this.typeview=l.getTypeView(),this.relshipkind=null===(o=this.relshiptype)||void 0===o?void 0:o.getRelshipKind(),this.template||(this.template=null===(s=this.typeview)||void 0===s?void 0:s.template);let r=l.getFromObjectView();if(r){let d=null==t?void 0:t.findNodeByViewId(r.id);if(i&&console.log("635 fromNode",d),d){this.fromNode=d,this.from=d.key;let c=l.getToObjectView();c&&(d=null==t?void 0:t.findNodeByViewId(c.id),i&&console.log("642 toNode",d),d&&(this.toNode=d,this.to=d.key))}}i&&console.log("650 relshipLink",this)}}}class u extends p{getTypeView(){return this.typeview}getFromNode(){return this.fromNode}getToNode(){return this.toNode}loadLinkContent(){if(this.reltype&&!1===this.reltype.markedAsDeleted&&this.toNode&&this.fromNode){let e=this.typeview;if(e){let t=e.getData();return this.addData(t),this.setName(this.reltype.getName()),this.strokwidth||(this.strokewidth="1"),this.strokecolor||(this.strokecolor="black"),!0}}return!1}updateLink(e,t){if(this.typeview){let l;let o=this.typeview.getData();for(l in o)null!=o[l]&&t.model.setDataProperty(e,l,o[l])}}constructor(e,t,l){if(super(e,t),this.category=n.gojs.C_RELSHIPTYPE,this.reltype=l,this.typeview=null,this.fromNode=null,this.toNode=null,this.from="",this.to="",this.template="",this.relshipkind="",this.cardinality="",this.cardinalityFrom="",this.cardinalityTo="",this.nameFrom="",this.nameTo="",this.points=null,l){this.setName(l.getName()),this.setType(n.gojs.C_RELSHIPTYPE),this.relshipkind=this.reltype.relshipkind,this.cardinalityFrom=this.reltype.cardinalityFrom,this.cardinalityTo=this.reltype.cardinalityTo,this.nameFrom=this.reltype.nameFrom,this.nameTo=this.reltype.nameTo;let o=l.getDefaultTypeView();if(o){this.typeview=o;let i=o.getData();this.addData(i);let s=l.getFromObjType();if(s){var a,r;this.fromNode=t.findTypeNode(s.id),this.from=null===(a=this.fromNode)||void 0===a?void 0:a.key;let d=l.getToObjType();d&&(this.toNode=t.findTypeNode(d.id),this.to=null===(r=this.toNode)||void 0===r?void 0:r.key)}}}}}function m(e,t){let l;for(l in t)"class"!==l&&(e[l]=t[l])}class g{constructor(e,t,l,o,i){this.key=e,this.type=t,this.category=l,this.viewkind="Object",this.abstract=!1,this.name=o,this.description=i,this.isGroup=!1,this.template="",this.figure="",this.geometry="",this.fillcolor="lightyellow",this.strokecolor="black",this.strokewidth="1",this.icon=""}}},137:function(e,t,l){"use strict";l.d(t,{GZ:function(){return j},Hl:function(){return b},Lu:function(){return r},OX:function(){return O},Ug:function(){return g},WN:function(){return p},XA:function(){return u},XB:function(){return D},cP:function(){return T},kA:function(){return f},kC:function(){return M},qf:function(){return w},st:function(){return n},tI:function(){return m},vM:function(){return d},yh:function(){return c},yp:function(){return v}}),l(8749);let o=!1,i=l(3165);l(2586);class n{addMetamodel(e,t){if(e){let l=new r(e,t);this.metamodels.push(l)}}addModel(e,t){if(e&&e.metamodel){let l=new w(e,t);this.models.push(l)}}constructor(e,t){if(this.name=e.name,this.description=e.description,this.metamodels=[],this.models=[],this.currentMetamodelRef="",this.currentModelRef="",this.currentModelviewRef="",this.currentTemplateModelRef="",this.currentTargetMetamodelRef="",this.currentTargetModelRef="",this.currentTargetModelviewRef="",this.currentTaskModelRef="",e){let l=e.getMetamodels();if(l){let o=l.length;for(let i=0;i<o;i++){let n=l[i];this.addMetamodel(n,t)}}let s=e.getModels();if(s){let a=s.length;for(let r=0;r<a;r++){let d=s[r];this.addModel(d,t)}}e.currentMetamodel&&(this.currentMetamodelRef=e.currentMetamodel.id),e.currentModel&&(this.currentModelRef=e.currentModel.id),e.currentModelview&&(this.currentModelviewRef=e.currentModelview.id),e.currentTargetMetamodel&&(this.currentTargetMetamodelRef=e.currentTargetMetamodel.id),e.currentTargetModel&&(this.currentTargetModelRef=e.currentTargetModel.id),e.currentTargetModelview&&(this.currentTargetModelviewRef=e.currentTargetModelview.id),e.currentTemplateModel&&(this.currentTemplateModelRef=e.currentTemplateModel.id),e.currentTaskModel&&(this.currentTaskModelRef=e.currentTaskModel.id)}}}class s{constructor(e){this.id=e.id,this.name=e.name,this.description="",this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified,e.description&&(this.description=e.description)}}class a{constructor(e){this.id=e.id,this.name=e.name,this.description="",this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified,e.description&&(this.description=e.description)}}class r{addMetamodel(e){e&&this.metamodelRefs.push(e.id)}addObjectType(e,t){if(i.objExists(e)&&!e.isDeleted()){let l=new d(e,t);this.objecttypes.push(l)}}addObjectType0(e,t){if(i.objExists(e)&&!e.isDeleted()){let l=new d(e,t);this.objecttypes0.push(l)}}addRelationshipType(e,t){if(i.objExists(e)&&!e.isDeleted()&&i.objExists(e.fromObjtype)&&i.objExists(e.toObjtype)){let l=new c(e,t);this.relshiptypes.push(l)}}addRelationshipType0(e,t){if(i.objExists(e)&&!e.isDeleted()&&i.objExists(e.fromObjtype)&&i.objExists(e.toObjtype)){let l=new c(e,t);this.relshiptypes0.push(l)}}addDataType(e){if(i.objExists(e)&&!e.isDeleted()){let t=new p(e);this.datatypes.push(t)}}addProperty(e){if(i.objExists(e)&&!e.isDeleted()){let t=new f(e);this.properties.push(t)}}addMethodType(e){if(e&&!e.isDeleted()){let t=new v(e);this.methodtypes.push(t)}}addMethod(e){if(i.objExists(e)&&!e.isDeleted()){let t=new b(e);this.methods.push(t)}}addUnit(e){if(i.objExists(e)){let t=new h(e);this.units.push(t)}}addViewStyle(e){if(e&&!e.isDeleted()){let t=new s(e);this.viewstyles.push(t)}}addGeometry(e){if(e&&!e.isDeleted()){let t=new a(e);this.geometries.push(t)}}addObjectTypeView(e){if(e&&!e.isDeleted()&&e.typeRef){let t=new u(e);this.objecttypeviews.push(t)}}addObjtypeGeo(e){if(e){let t=new m(e);this.objtypegeos.push(t)}}addRelshipTypeView(e){if(e&&!e.isDeleted()&&e.typeRef){let t=new g(e);this.relshiptypeviews.push(t)}}findObjectType(e){let t=this.objecttypes;for(let l=0;l<t.length;l++){let o=t[l];if(o.id===e)return o}return null}findRelationshipType(e){let t=this.relshiptypes;for(let l=0;l<t.length;l++){let o=t[l];if(o.id===e)return o}return null}findRelationshipType0(e){let t=this.relshiptypes0;for(let l=0;l<t.length;l++){let o=t[l];if(o.id===e)return o}return null}findMethod(e){let t=this.methods;for(let l=0;l<(null==t?void 0:t.length);l++){let o=t[l];if(o.id===e)return o}return null}updateMethods(e){let t=e.methods,l=null;for(let i=0;i<(null==t?void 0:t.length);i++){let n=t[i];if(n){let s=this.findMethod(n.id),a=n.methodtype;if(a){let r=e.findMethodTypeByName(a);if(r){l=r.properties,o&&console.log("359 this",l);for(let d=0;d<(null==l?void 0:l.length);d++){let c=l[d];s[c.name]=n[c.name]}}}}}}constructor(e,t){this.id=e.id,this.name=e.name,this.description=e.description?e.description:"",this.metamodelRefs=[],this.viewstyles=[],this.geometries=[],this.objecttypes=[],this.relshiptypes=[],this.objecttypes0=[],this.relshiptypes0=[],this.properties=[],this.datatypes=[],this.methodtypes=[],this.methods=[],this.units=[],this.objecttypeviews=[],this.objtypegeos=[],this.relshiptypeviews=[],this.generatedFromModelRef=e.generatedFromModelRef,this.includeInheritedReltypes=e.includeInheritedReltypes,this.includeSystemtypes=e.includeSystemtypes,this.layout=e.layout,this.routing=e.routing,this.linkcurve=e.linkcurve,this.markedAsDeleted=e.markedAsDeleted,this.modified=!1;let l=e.getSubMetamodels();if(l){let i=l.length;for(let n=0;n<i;n++){let s=l[n];this.metamodelRefs.push(s.id)}}let a=e.getObjectTypes();if(a){let r=a.length;for(let d=0;d<r;d++){let c=a[d];this.addObjectType(c,t)}}let p=e.getObjectTypes0();if(p){let h=p.length;for(let u=0;u<h;u++){let m=p[u];this.addObjectType0(m,t)}}let g=e.getRelshipTypes();if(g){o&&console.log("195 reltypes",g);let f=g.length;for(let y=0;y<f;y++){let v=g[y];if(!v.fromObjtype&&v.fromobjtypeRef){let b=e.findObjectType(v.fromobjtypeRef);v.fromObjtype=b}if(!v.toObjtype&&v.toobjtypeRef){let w=e.findObjectType(v.toobjtypeRef);v.toObjtype=w}this.addRelationshipType(v,t)}o&&console.log("200 jsnMetaModel",this)}let j=e.getRelshipTypes0();if(j){o&&console.log("195 reltypes0",j);let T=j.length;for(let k=0;k<T;k++){let O=g[k];if(O){if(!O.fromObjtype&&O.fromobjtypeRef){let M=e.findObjectType(O.fromobjtypeRef);O.fromObjtype=M}if(!(null==O?void 0:O.toObjtype)&&(null==O?void 0:O.toobjtypeRef)){let D=e.findObjectType(O.toobjtypeRef);O.toObjtype=D}this.addRelationshipType0(O,t)}}o&&console.log("200 jsnMetaModel",this)}let E=e.getDatatypes();if(E){let x=E.length;for(let R=0;R<x;R++){let N=E[R];this.addDataType(N)}}let A=e.getProperties();if(A){let S=A.length;for(let C=0;C<S;C++){let P=A[C];this.addProperty(P)}}let I=e.getMethodTypes();if(I){let _=I.length;for(let L=0;L<_;L++){let V=I[L];this.addMethodType(V)}}let F=e.getMethods();if(F){let G=F.length;for(let K=0;K<G;K++){let B=F[K];this.addMethod(B)}}if(this.updateMethods(e),t){let U=e.getViewStyles();if(U){let J=U.length;for(let z=0;z<J;z++){let H=U[z];this.addViewStyle(H)}}let W=e.getGeometries();if(W){let X=W.length;for(let Y=0;Y<X;Y++){let Z=W[Y];this.addGeometry(Z)}}let $=e.getObjectTypeViews();if($){let q=$.length;for(let Q=0;Q<q;Q++){let ee=$[Q];this.addObjectTypeView(ee)}}let et=e.getObjtypeGeos();if(et){let el=et.length;for(let eo=0;eo<el;eo++){let ei=et[eo];this.addObjtypeGeo(ei)}}let en=e.getRelshipTypeViews();if(en){let es=en.length;for(let ea=0;ea<es;ea++){let er=en[ea];this.addRelshipTypeView(er)}}}}}class d{addProperty(e){if(e){let t=new f(e);o&&console.log("465 prop, gProperty",e,t),this.properties.push(t)}}addMethod(e){if(e){let t=new b(e);o&&console.log("352 mtd, gProperty",e,t),this.methods.push(t)}}addAttribute(e){if(e){let t=new y(e);o&&console.log("479 jAttr, jAttr",e,t),this.attributes.push(t)}}constructor(e,t){this.id=e.id,this.name=e.name,this.abstract=e.abstract,this.viewkind=e.viewkind,this.typename="Object type",this.typedescription="",this.typeviewRef=e.typeview?e.typeview.id:"",this.description=e.description?e.description:"",this.properties=[],this.attributes=[],this.methods=[],this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified;let l=e.getProperties(!1),i=null==l?void 0:l.length;for(let n=0;n<i;n++){let s=l[n];this.addProperty(s)}let a=e.getAttributes();i=null==a?void 0:a.length;for(let r=0;r<i;r++){let d=a[r];this.addAttribute(d)}o&&console.log("345 objtype, props, this",e,l,this);let c=e.getMethods();i=null==c?void 0:c.length;for(let p=0;p<i;p++){let h=c[p];this.addMethod(h)}o&&console.log("345 objtype, props, this",e,l,this)}}class c{addProperty(e){if(i.objExists(e)){let t=new f(e);this.properties.push(t)}}constructor(e,t){var l,o;this.id=e.id,this.name=e.name,this.relshipkind=e.relshipkind,this.viewkind=e.viewkind,this.fromobjtypeRef=e.fromobjtypeRef?e.fromobjtypeRef:null===(l=e.fromObjtype)||void 0===l?void 0:l.id,this.toobjtypeRef=e.toobjtypeRef?e.toobjtypeRef:null===(o=e.toObjtype)||void 0===o?void 0:o.id,this.typeviewRef="",this.description=e.description?e.description:"",this.properties=[],this.cardinality=e.cardinality,this.cardinalityFrom=e.cardinalityFrom,this.cardinalityTo=e.cardinalityTo,this.nameFrom=e.nameFrom,this.nameTo=e.nameTo,this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified,t&&(this.typeviewRef=e.typeview?e.typeview.id:"");let i=e.getProperties(!0),n=null==i?void 0:i.length;for(let s=0;s<n;s++){let a=i[s];this.addProperty(a)}}}class p{constructor(e){this.id=e.id,this.name=e.name,this.description="",this.datatypeRef=i.objExists(e.isOfDatatype)?e.id:"",this.allowedValues=e.allowedValues,this.defaultValue=e.defaultValue,this.value=e.value,this.inputPattern=e.inputPattern,this.viewFormat=e.viewFormat,this.fieldType=e.fieldType,this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified,i.objExists(e.description)&&(this.description=e.description)}}class h{constructor(e){this.id=e.id,this.name=e.name,this.description="",this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified,i.objExists(e.description)&&(this.description=e.description)}}class u{constructor(e){this.id=e.id,this.name=e.name,this.description="",this.typeRef=e.typeRef,this.viewkind=e.getViewKind(),this.template=e.getTemplate(),this.figure=e.getFigure(),this.geometry=e.getGeometry(),this.fillcolor=e.getFillcolor(),this.strokecolor=e.getStrokecolor(),this.strokecolor1=this.strokecolor,this.strokecolor2=e.getStrokecolor2(),this.strokewidth=e.getStrokewidth(),this.textcolor=e.getTextcolor(),this.textscale=e.getTextscale(),this.memberscale=e.getMemberscale(),this.icon=e.getIcon(),this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified,e.description&&(this.description=e.description)}}class m{constructor(e){this.id=e.id,this.name=e.name,this.typeRef=e.type?e.type.id:"",this.metamodelRef=e.metamodel?e.metamodel.id:"",this.loc=e.getLoc(),this.size=e.getSize(),this.description=e.description?e.description:"",this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified}}class g{constructor(e){this.id=e.id,this.name=e.name,this.description=e.description?e.description:"",this.typeRef=e.getTypeRef(),this.template=e.getTemplate(),this.strokecolor=e.getStrokecolor(),this.strokecolor1=this.strokecolor1,this.strokewidth=e.getStrokewidth(),this.textcolor=e.getTextcolor(),this.textscale=e.getTextscale(),this.dash=e.getDash(),this.fromArrow=e.getFromArrow(),this.toArrow=e.getToArrow(),this.fromArrowColor=e.getFromArrowColor(),this.toArrowColor=e.getToArrowColor(),this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified}}class f{constructor(e){this.id=e.id,this.name=e.name,this.defaultValue="",this.inputPattern="",this.viewFormat="",this.example="",this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified,this.description=e.description?e.description:"",e.datatype?this.datatypeRef=e.datatype.id:this.datatypeRef=e.datatypeRef,e.method?this.methodRef=e.method.id:this.methodRef=e.methodRef,e.unitCategory?this.unitCategoryRef=e.unitCategory.id:this.unitCategoryRef=e.unitCategoryRef,e.unitCategory?this.unitCategoryRef=e.unitCategory.id:this.unitCategoryRef=e.unitCategoryRef,e.defaultValue&&(this.description=e.defaultValue),o&&console.log("612 this",this)}}class y{constructor(e){this.typeName=e.typeName,this.propName=e.propName,this.name=e.name,this.propRef=e.propRef}}class v{constructor(e){this.id=e.id,this.name=e.name,this.description=e.description?e.description:"",this.properties=e.properties,this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified}}class b{constructor(e){this.id=e.id,this.name=e.name,this.methodtype=e.methodtype?e.methodtype:"",this.expression=e.expression,this.description=e.description?e.description:"",this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified}}class w{addModelView(e){if(o&&console.log("569 addModelView",e),e&&!e.isDeleted()){let t=new O(e);this.modelviews.push(t),o&&console.log("572 addModelView",this.modelviews);let l=null==e?void 0:e.objecttypeviews;if(l){let i=l.length;for(let n=0;n<i;n++){let s=l[n];t.addObjectTypeView(s)}}let a=null==e?void 0:e.relshiptypeviews;if(a){let r=a.length;for(let d=0;d<r;d++){let c=a[d];t.addRelshipTypeView(c)}}if(0==t.objectviews.length){let p=null==e?void 0:e.getObjectViews();if(p){let h=p.length;for(let u=0;u<h;u++){let m=p[u];t.addObjectView(m)}}}if(0==t.relshipviews.length){let g=null==e?void 0:e.getRelationshipViews();if(g){let f=g.length;for(let y=0;y<f;y++){let v=g[y];t.addRelshipView(v)}}}o&&console.log("613 addModelView",t)}}addObject(e){if(e&&e.type){let t=new j(e);this.objects.push(t)}}addRelationship(e){if(e&&e.type&&e.fromObject&&e.toObject){let t=new T(e);this.relships.push(t)}}addTemplate(e){if(e){let t=new O(e);this.templates.push(t)}}constructor(e,t){var l;this.id=e.id,this.name=e.name,this.description=e.description?e.description:"",this.metamodelRef=null===(l=e.metamodel)||void 0===l?void 0:l.id,this.sourceMetamodelRef=e.sourceMetamodelRef,this.targetMetamodelRef=e.targetMetamodelRef,this.sourceModelRef=e.sourceModelRef,this.targetModelRef=e.targetModelRef,this.includeSystemtypes=e.includeSystemtypes,this.includeRelshipkind=e.includeRelshipkind,this.isTemplate=e.isTemplate,this.templates=[],this.objects=[],this.relships=[],this.modelviews=[],this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified,this.args1=e.args1,e.description&&(this.description=e.description);let o=e.getObjects();if(o){let i=o.length;for(let n=0;n<i;n++){let s=o[n];s&&s.type&&this.addObject(s)}}let a=e.getRelationships();if(a){let r=a.length;for(let d=0;d<r;d++){let c=a[d];c&&c.type&&this.addRelationship(c)}}let p=e.getTemplates();if(p){let h=p.length;for(let u=0;u<h;u++){let m=p[u];m&&this.addTemplate(m)}}if(t){let g=e.getModelViews();if(g){let f=g.length;for(let y=0;y<f;y++){let v=g[y];this.addModelView(v)}}}}}class j{constructor(e){for(let t in this.id=e.id,this.name=e.name,this.description=e.description?e.description:"",this.abstract=e.abstract,this.viewkind=e.viewkind,this.typeRef=e.type?e.type.id:"",this.typeName=e.type?e.type.name:"",this.typeDescription=e.type?e.type.description:"",this.propertyValues=[],this.markedAsDeleted=e.markedAsDeleted,this.generatedTypeId=e.generatedTypeId,this.modified=e.modified,o&&console.log("876 this, object",this,e),e){switch(t){case"id":case"name":case"description":case"abstract":case"viewkind":case"allProperties":case"fromObject":case"fs_collection":case"parentModel":case"propertyValues":case"toObject":case"type":case"typeview":case"typeName":case"typeRef":case"generatedTypeId":case"markedAsDeleted":case"modified":case"inputrels":case"outputrels":case"objectviews":continue}this[t]=e[t]}let l=e.allProperties;o&&console.log("879 object, properties",e,l);for(let i=0;i<(null==l?void 0:l.length);i++){let n=l[i];if(!n)continue;let s=n.name,a=e.getStringValue2(s);o&&console.log("885 propname, value",s,a),this[s]=a}o&&console.log("888 this",this)}}class T{addPropertyValue(e){if(i.objExists(e)){let t=new k(e);this.propvalues.push(t)}}constructor(e){if(this.id=e.id,this.name=e.name,this.description=e.description,this.relshipkind=e.relshipkind,this.fromobjectRef=e.fromObject?e.fromObject.id:"",this.toobjectRef=e.toObject?e.toObject.id:"",this.typeRef="",this.propvalues=[],this.cardinality=e.cardinality,this.cardinalityFrom=e.cardinalityFrom,this.cardinalityTo=e.cardinalityTo,this.nameFrom=e.nameFrom,this.nameTo=e.nameTo,this.markedAsDeleted=e.markedAsDeleted,this.generatedTypeId=e.generatedTypeId,this.modified=e.modified,e){e.description&&(this.description=e.description);let t=e.type;t&&(this.typeRef=t.id),e.fromObject,e.toObject;let l=e.valueset;if(l){let o=l.length;for(let i=0;i<o;i++){let n=l[i];this.addPropertyValue(n)}}}}}class k{constructor(e){this.property=e.property,this.value=e.value}}class O{addObjectView(e){if(e){let t=new M(e);this.objectviews.push(t)}}addRelshipView(e){if(e&&e.relship&&e.fromObjview&&e.toObjview){let t=new D(e);this.relshipviews.push(t)}}addObjectTypeView(e){if(e){let t=new u(e);this.objecttypeviews.push(t)}}addRelshipTypeView(e){if(e){let t=new g(e);this.relshiptypeviews.push(t)}}constructor(e){var t,l,o,i;this.id=null==e?void 0:e.id,this.name=null==e?void 0:e.getName(),this.description=null==e?void 0:e.description,this.layout=null==e?void 0:e.layout,this.routing=null==e?void 0:e.routing,this.linkcurve=null==e?void 0:e.linkcurve,this.modelRef=null===(t=null==e?void 0:e.getModel())||void 0===t?void 0:t.id,this.showCardinality=null==e?void 0:e.showCardinality,this.showRelshipNames=null==e?void 0:e.showRelshipNames,this.askForRelshipName=null==e?void 0:e.askForRelshipName,this.includeInheritedReltypes=null==e?void 0:e.includeInheritedReltypes,this.UseUMLrelshipkinds=null===(l=null==e?void 0:e.getModel())||void 0===l?void 0:l.includeRelshipkind,this.viewstyleRef=null===(o=null==e?void 0:e.getViewStyle())||void 0===o?void 0:o.getId(),this.objectviews=[],this.relshipviews=[],this.objecttypeviews=[],this.relshiptypeviews=[],this.markedAsDeleted=null==e?void 0:e.markedAsDeleted,this.modified=null==e?void 0:e.modified,this.viewstyleRef=null===(i=null==e?void 0:e.getViewStyle())||void 0===i?void 0:i.getId();let n=null==e?void 0:e.getObjectViews();if(n){let s=n.length;for(let a=0;a<s;a++){let r=n[a];this.addObjectView(r)}}let d=null==e?void 0:e.getRelationshipViews();if(d){let c=d.length;for(let p=0;p<c;p++){let h=d[p];this.addRelshipView(h)}}let u=null==e?void 0:e.objecttypeviews;if(u){let m=u.length;for(let g=0;g<m;g++){let f=u[g];this.addObjectTypeView(f)}}let y=null==e?void 0:e.relshiptypeviews;if(y){let v=y.length;for(let b=0;b<v;b++){let w=y[b];this.addRelshipTypeView(w)}}}}class M{constructor(e){var t,l;this.id=null==e?void 0:e.id,this.name=null==e?void 0:e.name,this.description=null==e?void 0:e.description,this.objectRef=null==e?void 0:null===(t=e.object)||void 0===t?void 0:t.id,this.typeviewRef=null==e?void 0:null===(l=e.typeview)||void 0===l?void 0:l.id,this.group=null==e?void 0:e.group,this.viewkind=null==e?void 0:e.viewkind,this.isGroup=null==e?void 0:e.isGroup,this.isCollapsed=null==e?void 0:e.isCollapsed,this.loc=null==e?void 0:e.loc,this.template=null==e?void 0:e.template,this.figure=null==e?void 0:e.figure,this.geometry=null==e?void 0:e.geometry,this.fillcolor=null==e?void 0:e.fillcolor,this.fillcolor2=null==e?void 0:e.fillcolor2,this.strokecolor=null==e?void 0:e.strokecolor,this.strokecolor2=null==e?void 0:e.strokecolor2,this.strokewidth=null==e?void 0:e.strokewidth,this.textcolor=null==e?void 0:e.textcolor,this.textscale=null==e?void 0:e.textscale,this.icon=null==e?void 0:e.icon,this.size=null==e?void 0:e.size,this.scale=Number(null==e?void 0:e.scale1),this.memberscale=Number(null==e?void 0:e.memberscale),this.markedAsDeleted=null==e?void 0:e.markedAsDeleted,this.modified=null==e?void 0:e.modified}}class D{constructor(e){this.id=null==e?void 0:e.id,this.name=null==e?void 0:e.name,this.description="",this.relshipRef="",this.typeviewRef="",this.template=null==e?void 0:e.template,this.arrowscale=null==e?void 0:e.arrowscale,this.strokecolor=null==e?void 0:e.strokecolor,this.strokewidth=null==e?void 0:e.strokewidth,this.textcolor=null==e?void 0:e.textcolor,this.textscale=null==e?void 0:e.textscale,this.dash=null==e?void 0:e.dash,this.fromArrow=null==e?void 0:e.fromArrow,this.toArrow=null==e?void 0:e.toArrow,this.fromArrowColor=null==e?void 0:e.fromArrowColor,this.toArrowColor=null==e?void 0:e.toArrowColor,this.fromobjviewRef=e&&e.fromObjview?e.fromObjview.id:"",this.toobjviewRef=e&&e.toObjview?e.toObjview.id:"",this.points=null==e?void 0:e.points,this.markedAsDeleted=null==e?void 0:e.markedAsDeleted,this.modified=null==e?void 0:e.modified,(null==e?void 0:e.description)&&(this.description=e.description),(null==e?void 0:e.relship)&&(this.relshipRef=e.relship.id),(null==e?void 0:e.typeview)&&(this.typeviewRef=e.typeview.id)}}},9803:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Bq:function(){return getConnectedObjects},G4:function(){return aggregateValue},HQ:function(){return addConnectedObjects},Mx:function(){return getConnectedObject},Q4:function(){return calculateValue},Rb:function(){return askForMethod},xw:function(){return executeMethod}});var _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8749),_akmm_ui_gojs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6680),_ui_json__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(137),_akmm_utilities__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3165),_akmm_constants__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2586);let debug=!1,RegexParser=__webpack_require__(9350);function addConnectedObjects(e,t,l,o,i,n){if(n<1)return;let s=[],a=i.myDiagram,r=[],d=[];if(t){let c=t.loc.split(" "),p=parseInt(c[0]),h=parseInt(c[1]),u=t.object;(u=i.findObject(u.id)).type.isContainer()&&(t.viewkind=_akmm_constants__WEBPACK_IMPORTED_MODULE_4__.viewkinds.CONT);for(let m=0;m<2;m++){let g=m?u.inputrels:u.outputrels;if(g){let f=0;for(let y=0;y<g.length;y++){let v,b,w=g[y];if(w.markedAsDeleted||(w=i.findRelationship(w.id),v=m?w.fromObject:w.toObject,debug&&console.log("46 toObj",v),!(v=i.findObject(v.id))||v.markedAsDeleted||l&&v.type.id!==l.id))continue;let j=v.type,T=j.typeview,k=T.data,O=v.objectviews;debug&&console.log("57 toObjtypeview, toObjviews",T,O);let M=e.findObjectViewsByObj(v);if((null==M?void 0:M.length)>0){let D;for(let E=0;E<M.length;E++){let x=M[E];!x.markedAsDeleted&&(j.isContainer()&&(x.viewkind=_akmm_constants__WEBPACK_IMPORTED_MODULE_4__.viewkinds.CONT),debug&&console.log("1625 Create relship views to objviews",u,M))}m?0==(D=e.findRelationshipViewsByRel2(w,b,t)).length&&y++:(null==(D=e.findRelationshipViewsByRel2(w,t,b))?void 0:D.length)==0&&y++,debug&&console.log("1637 rel, relview",w,D)}else{f++,debug&&console.log("86 Create an object view and a relship view",u);let R=_akmm_utilities__WEBPACK_IMPORTED_MODULE_3__.createGuid();b=new _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_0__.q6(R,v.name,v,""),v.addObjectView(b),e.addObjectView(b),i.addObjectView(b),debug&&console.log("92 toObjview",v,b);let N=new _akmm_ui_gojs__WEBPACK_IMPORTED_MODULE_1__.of(_akmm_utilities__WEBPACK_IMPORTED_MODULE_3__.createGuid(),b);if(O){let A=O[0];for(let S in k)""!==A[S]?(b[S]=A[S],a.model.setDataProperty(N,S,A[S])):a.model.setDataProperty(N,S,k[S])}else for(let C in k)a.model.setDataProperty(N,C,k[C]);let P=100,I=m?p-300:p+300,_=h-P+100*f,L=I+" "+_;b.loc=L,N.loc=L,debug&&console.log("114 goNode",N),o.addNode(N),a.model.addNodeData(N);let V=a.findNodeForKey(null==N?void 0:N.key);V.isSelected=!0;let F=new _ui_json__WEBPACK_IMPORTED_MODULE_2__.kC(b);r.push(F)}b&&s.push(b);let G=m?b:t,K=m?t:b,B=e.findRelationshipViewsByRel2(w,G,K);if(!B||(null==B?void 0:B.length)==0){let U=_akmm_utilities__WEBPACK_IMPORTED_MODULE_3__.createGuid(),J=new _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_0__.IM(U,w.name,w,"");J.fromObjview=G,J.toObjview=K,w.addRelationshipView(J),e.addRelationshipView(J),i.addRelationshipView(J);let z=new _ui_json__WEBPACK_IMPORTED_MODULE_2__.XB(J);d.push(z),debug&&console.log("137 relview",J);let H=new _akmm_ui_gojs__WEBPACK_IMPORTED_MODULE_1__.hX(_akmm_utilities__WEBPACK_IMPORTED_MODULE_3__.createGuid(),o,J);H.loadLinkContent(o),o.addLink(H),a.model.addLinkData(H),debug&&console.log("142 goModel",o)}}}}a.requestUpdate()}if(r.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),a.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})}),d.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),a.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})}),debug&&console.log("156 objectviews",s),n>1){n--;for(let W=0;W<(null==s?void 0:s.length);W++){let X=s[W];addConnectedObjects(e,X,null,o,i,n)}}}function conditionIsFulfilled(object,context){let retval=!0,myMetis=context.myMetis,myMetamodel=context.myMetamodel,method=context.args.method,typecondition=method.typecondition,valuecondition=method.valuecondition,objtype=typecondition?myMetamodel.findObjectTypeByName(typecondition):null,otype=null==object?void 0:object.type;if(objtype&&otype&&otype.id!==objtype.id&&(retval=!1),retval&&valuecondition){let expression=substitutePropnamesInExpression(object,valuecondition,myMetis);try{retval=eval(expression)}catch(e){e instanceof SyntaxError&&alert(e.message),retval=!1}}return retval}function traverse(e,t){let l;let o=t.myMetis,i=t.myMetamodel,n=t.args.method,s=t.objects,a=t.relships,r=n.reldir,d=n.reltype,c=n.preaction,p=n.postaction;if(debug&&console.log("211 objects, relships",s,a),conditionIsFulfilled(e,t)&&c&&(t.mode="preaction",t.action=c,execMethod(e,t)),d)try{l=i.findRelationshipTypeByName(d)}catch(h){l=o.findRelationshipTypeByName(d)}let u="in"===r,m=u?e.inputrels:e.outputrels;if(m||(m=e.inputrels),m?m.concat(e.outputrels):m=e.outputrels,m){debug&&console.log("226 rels",m);let g=!1;for(let f=0;f<m.length;f++){let y;let v=m[f];if(l&&(null==v?void 0:v.type.id)!==(null==l?void 0:l.id))continue;for(let b=0;b<a.length;b++){let w=a[b];if(v.id===w.id){g=!0;break}}g||a.push(v),v.toObject.id===e.id?(y=v.fromObject,debug&&console.log("260 useinp: toObj",y)):v.fromObject.id===e.id&&(y=v.toObject,debug&&console.log("263 useoutp: toObj",y)),debug&&console.log("265 rel, toObj",v,y);let j=!1;if(y)for(let T=0;T<s.length;T++){let k=s[T];if(k.id===y.id){j=!0;break}}!j&&y&&s.push(y),debug&&console.log("282 toObj, objects, relships",y,s,a),!j&&y&&(traverse(y,t),conditionIsFulfilled(y,t)&&p&&(t.mode="postaction",t.action=p,execMethod(y,t)))}}}function generateosduId(e){let t;let l=e.myObject,o=e.myDiagram,i=e.myModel,n=e.args.method,s=n.reltype,a=i.metamodel,r=a.findRelationshipTypesByName(s),d=n.reldir,c="in"===d,p=c?l.outputrels:l.inputrels;if(p)for(let h=0;h<p.length;h++){let u=p[h];for(let m=0;m<r.length;m++){let g=r[m];if((null==u?void 0:u.type.name)===(null==g?void 0:g.name)){t=c?u.toObject:u.fromObject,debug&&console.log("215 parent",t);break}}}let f="";t&&(f=t.getStringValue2(n.propname)),debug&&console.log("275 parentUid: ",f);let y=l.name;f&&f.length>0&&(y=f+"|"+l.name),l.setStringValue2(n.propname,y),debug&&console.log("280 osduId: ",y);let v=new _ui_json__WEBPACK_IMPORTED_MODULE_2__.GZ(l),b=[];b.push(v),null==b||b.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),o.dispatch({type:"UPDATE_OBJECT_PROPERTIES",data:t})})}function hasChildren(e,t){let l=!1,o=t.reltype,i=t.reldir,n="in"===i,s=n?e.inputrels:e.outputrels;for(let a=0;a<(null==s?void 0:s.length);a++){let r=s[a];if(!o||(null==r?void 0:r.type.id)==o.id){l=!0;break}}return l}function getChildren(e,t){debug&&console.log("369 object, context",e,t);let l=[],o=t.reltype,i=t.reldir,n=t.objtype,s=!!i&&"in"===i,a=s?e.inputrels:e.outputrels;debug&&console.log("375 object, rels",e,a),a||(a=e.inputrels),a?a.concat(e.outputrels):a=e.outputrels,debug&&console.log("382 object, rels",e,a);for(let r=0;r<(null==a?void 0:a.length);r++){let d;let c=a[r];if(o){var p;if((null==c?void 0:null===(p=c.type)||void 0===p?void 0:p.id)!==(null==o?void 0:o.id))continue}d=s?c.fromObject:c.toObject,debug&&console.log("395 child",d),d&&d.type.id===(null==n?void 0:n.id)&&l.push(d),debug&&console.log("400 child",d)}return l}function calculateValue(e,t){let l=t.myMetis,o=t.prop,i=expandPropScript(e,o,l);return _akmm_utilities__WEBPACK_IMPORTED_MODULE_3__.isNumeric(i)?Number(i):i}function aggregateValue(e,t){let l=0,o=getChildren(e,t);for(let i=0;i<(null==o?void 0:o.length);i++){let n;let s=o[i];l+=Number(n=hasChildren(s,t)?aggregateValue(s,t):calculateValue(s,t))}return l}function getConnectedObject(e,t){let l=t.myMetis,o=t.prop,i=getChildren(e,t);debug&&console.log("431 children",i);for(let n=0;n<(null==i?void 0:i.length);n++){let s=i[n],a=expandPropScript(s,o,l);if(debug&&console.log("435 test, child, prop",a,s,o),a)return s}return null}function getConnectedObjects(e,t){let l=t.myMetis,o=t.prop,i=[],n=getChildren(e,t);debug&&console.log("431 children",n);for(let s=0;s<(null==n?void 0:n.length);s++){let a=n[s],r=expandPropScript(a,o,l);debug&&console.log("435 test, child, prop",r,a,o),r&&i.push(a)}return i}function expandPropScript(object,prop,myMetis){let retval="";if(!prop)return retval;let pi=3.14159265,mtd=prop.method;mtd||(mtd=myMetis.findMethod(prop.methodRef));let expression=null==mtd?void 0:mtd.expression;if(expression){let type=object.type;expression=substitutePropnamesInExpression(object,expression,myMetis),debug&&console.log("455 expression",expression);try{retval=eval(expression),retval||(retval=expression)}catch(e){retval=expression}debug&&console.log("464 retval",retval)}else retval=object[prop.name],debug&&console.log("467 retval",retval);return retval}function substitutePropnamesInExpression(e,t,l){let o=e.type,i=o.properties;debug&&console.log("472 props",i);for(let n=0;n<i.length;n++){let s=i[n];if(-1==t.indexOf(s.name)){debug&&console.log("475 expression, prop",t,s);continue}debug&&console.log("478 prop",s);let a=s.name.length,r=e.getPropertyValue(s,l),d=[],c=0,p=0,h=0,u=0;d.push(c);for(let m=0;m<t.length;m++){let g=t.substring(u);if(-1==(p=g.indexOf(s.name)))break;0==m?c=p:c+=p+1,h+=p+1,d.push(c),u=c+1}debug&&console.log("500 pos",d);let f=d.length;debug&&console.log("503 siz",f);for(let y=f-1;y>0;y--){let v=d[y]+a,b=t.substring(v);t=t.substring(0,d[y])+r+b}}return debug&&console.log("511 expression",t),t}function askForMethod(e){debug&&console.log("433 context",e);let t=e.myObject.type,l=e.myDiagram,o={what:"selectDropdown",title:e.title,case:e.case,myDiagram:l,context:e},i=[],n=t.methods;for(let s=0;s<(null==n?void 0:n.length);s++){let a=n[s];a.markedAsDeleted||i.push(a)}let r=i.map(e=>e&&e.nameId);debug&&console.log("452",r,o,e),l.handleOpenModal(r,o)}function executeMethod(e){let t=e.myObject,l=e.objects;e.objects||(e.objects=[]),e.relships||(e.relships=[]),(null==l?void 0:l.length)>10||(debug&&console.log("501 context",e),traverse(t,e))}function execMethod(e,t){debug&&console.log("462: Calling execMethod '"+t.action+"': on "+e.name);let l=t.myDiagram,o=t.myMetis;debug&&console.log("465 myMetis",o);let i=o.gojsModel,n=i.findNodeByObjectId(e.id);debug&&console.log("468 node",n);let s=l.findNodeForKey(null==n?void 0:n.key);switch(t.action){case"Highlight":s&&(s.isHighlighted=!0);break;case"Select":s&&(s.isSelected=!0);break;case"generateosduId":t.myObject=e,generateosduId(t)}}},5506:function(e,t,l){"use strict";l.d(t,{HS:function(){return u},Lo:function(){return h},jC:function(){return p}});var o=l(8749),i=l(137),n=l(6433),s=l(6680),a=l(2586);let r=!1,d=l(3165),c=l(9350);function p(e,t,l){var o,i,n,s;let d,c,p,h,u,m;r&&console.log("16 ui_modal: props, value",t,l);let g=t.id;t.type;let f=t.obj,y=t.context;if(t.pattern,r&&console.log("22 obj, context:",f,y),r&&console.log("23 propname, value:",g,l),f.category===a.gojs.C_OBJECTTYPE){let v=f;r&&console.log("27 node",v),d=v.objecttype,p=v.typeview,(null==y?void 0:y.what)==="editType"?m=d:(null==y?void 0:y.what)==="editTypeview"&&(m=p,r&&console.log("37 editTypeview",m));try{m[g]=l}catch(b){}r&&console.log("45 myItem",m)}if(f.category===a.gojs.C_OBJECT){let w=f;if(d=w.object?w.object:w,c=w.objectview,(h=e.findObject(d.id))||(h=f),u=e.findObjectView(null==c?void 0:c.id),p=null==d?void 0:null===(o=d.type)||void 0===o?void 0:o.typeview,u)for(let j in null==p?void 0:p.data)u[j]=f[j];r&&console.log("68 inst, myInst",d,h),(null==y?void 0:y.what)==="editObjectview"?m=u:(null==y?void 0:y.what)==="editTypeview"?(m=null===(i=h.type)||void 0===i?void 0:i.typeview,r&&console.log("73 editTypeview",p,m)):m=h,r&&console.log("77 myItem, propname, value",m,g,l);try{m[g]=l}catch(T){}}if(r&&console.log("84 myItem",m),f.category===a.gojs.C_RELSHIPTYPE){let k=f;r&&console.log("89 link",k),d=k.reltype,p=k.reltype,(null==y?void 0:y.what)==="editType"?m=d:(null==y?void 0:y.what)==="editTypeview"&&(m=p,r&&console.log("97 editTypeview",p));try{m[g]=l}catch(O){}}if(f.category===a.gojs.C_RELATIONSHIP){let M=f;d=M.relship,h=e.findRelationship(null==d?void 0:d.id),c=M.relshipview,u=e.findRelationshipView(null==c?void 0:c.id),r&&console.log("112 myInst",h,u),(null==y?void 0:y.what)==="editRelshipview"?m=u:(null==y?void 0:y.what)==="editTypeview"?(r&&console.log("109 myInst",h),m=null==h?void 0:null===(n=h.type)||void 0===n?void 0:null===(s=n.typeview)||void 0===s?void 0:s.data):m=h,m&&(m[g]=l),r&&console.log("120 myItem",m)}r&&console.log("122 myMetis",e)}function h(e,t){var l,o,s;let p=t.myDiagram,h=t.myMetis,u=t.myMetamodel,m=t.myGoModel,g=t.myModel,f=t.myModelview,y=t.modalContext;y.selected=e,y.myMetamodel=u;let v=e.value;switch(r&&console.log("133 selected, context:",e,t),r&&console.log("134 modalContext",y),y.case){case"Change Object type":{let b;r&&console.log("133 selection",p.selection);let w=v&&v,j=h.findObjectTypeByName(w);r&&console.log("136 objtype",j),p.selection.each(function(e){let l=e.data;if(l.category===a.gojs.C_OBJECT){b=m.findNode(l.key),r&&console.log("142 node",b);let o=j&&n.EN(b,j,t);r&&console.log("144 objview",o,b,h);let i=h.myDiagram.findNodeForKey(b.key),s=i.data;h.myDiagram.model.setDataProperty(s,"typename",w),h.myDiagram.requestUpdate()}});break}case"Connect to Selected":{let T=t.myMetamodel,k=y.args.nodeFrom,O=y.args.nodesTo,M=[];for(let D=0;D<O.length;D++){let E=O[D];if(E){let x=k.objecttype;x=h.findObjectType(x.id);let R=E.objecttype;if(!R)continue;R=h.findObjectType(R.id);let N=v&&v,A=T.findRelationshipTypeByName2(N,x,R);r&&console.log("166 fromType, toType, reltype",x,R,A);let S={key:d.createGuid(),from:p.model.getKeyForNodeData(k),to:p.model.getKeyForNodeData(E),name:N},C=null==A?void 0:null===(l=A.typeview)||void 0===l?void 0:l.data;for(let P in C)"id"!==P&&"name"!==P&&"abstract"!==P&&"class"!==P&&"relshipkind"!==P&&(S[P]=C[P]);M.push(S),r&&console.log("189 linkdata",S),p.model.addLinkData(S)}}r&&console.log("193 links",M),y.links=M;break}case"Change Icon":{let I;let _=v&&v;p.selection.each(function(e){let t=e.data;if(t.category===a.gojs.C_OBJECT){I=m.findNode(t.key),r&&console.log("208 node",I);let l=I.objectview;r&&console.log("210 objview",l,I,h);let o=p.findNodeForKey(I.key),n=o.data;if(p.model.setDataProperty(n,"icon",_),p.requestUpdate(),l){(l=h.findObjectView(l.id)).icon=_;let s=new i.kC(l),d=[];d.push(s),d.map(e=>{let t=e;r&&console.log("223 data",t),t=JSON.parse(JSON.stringify(t)),r&&console.log("225 data, jsnObjview",t,s),h.myDiagram.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})})}}else if(t.category===a.gojs.C_OBJECTTYPE){let c=h.currentNode,u=p.findNodeForKey(c.key),g=u.data;p.model.setDataProperty(g,"icon",_),p.requestUpdate(),r&&console.log("236 node, data",c,g);let f=c.typeview;if(f=h.findObjectTypeView(null==f?void 0:f.id),r&&console.log("239 objtypeview",f),p.model.setDataProperty(c,"icon",_),r&&console.log("241 objtypeview",f),f){f.icon=_,f.data.icon=_,r&&console.log("245 objtypeview, icon",f,_);let y=new i.XA(f),v=[];v.push(y),v.map(e=>{let t=e;r&&console.log("251 data",t),t=JSON.parse(JSON.stringify(t)),r&&console.log("253 data, jsnObjtypeview",t,y),p.dispatch({type:"UPDATE_OBJECTTYPEVIEW_PROPERTIES",data:t})})}p.requestUpdate()}});break}case"Set Layout Scheme":{let L=f,V="Metamodelling"===h.modelType;if(V&&(L=u),!L)break;let F=v&&v;if(V){u.layout=F;let G=[],K=new i.Lu(u,!0);G.push(K),G.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),h.myDiagram.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:t})}),r&&console.log("151 jsnMetamodel",K)}else{f.layout=F;let B=[],U=new i.OX(f);B.push(U),B.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),h.myDiagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:t})}),r&&console.log("141 jsnModelview",U)}break}case"Set Routing Scheme":{let J=f,z="Metamodelling"===h.modelType;if(z&&(J=u),!J)break;let H=v&&v;if(r&&console.log("163 link routing",H),z){u.routing=H;let W=[],X=new i.Lu(u,!0);W.push(X),W.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),h.myDiagram.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:t})}),r&&console.log("183 jsnMetamodel",X)}else{f.routing=H;let Y=[],Z=new i.OX(f);Y.push(Z),Y.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),h.myDiagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:t})}),r&&console.log("173 jsnModelview",Z)}break}case"Set Link Curve":{let $=f,q="Metamodelling"===h.modelType;if(q&&($=u),!$)break;let Q=v&&v;if(r&&console.log("196 link curve",Q),q){u.linkcurve=Q;let ee=[],et=new i.Lu(u,!0);ee.push(et),ee.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),h.myDiagram.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:t})}),r&&console.log("216 jsnMetamodel",et)}else{f.linkcurve=Q;let el=[],eo=new i.OX(f);el.push(eo),el.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),h.myDiagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:t})}),r&&console.log("206 jsnModelview",eo)}break}case"New Model":{r&&console.log("222",e);let ei=v&&v,en=h.findMetamodelByName(ei);r&&console.log("228 Diagram",en,h);break}case"Set Target Model":{let es=v&&v,ea=h.findModelByName(es);h.currentTargetModel=ea,h.currentModel.targetModelRef=ea.id,r&&console.log("240 Diagram",ea,h);let er=new i.qf(h.currentModel,!0);er=JSON.parse(JSON.stringify(er)),r&&console.log("242 Diagram",er),h.myDiagram.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:er});break}case"Set Target Metamodel":case"Generate Target Metamodel":{let ed=v&&v,ec=h.findMetamodelByName(ed);h.currentModel.targetMetamodelRef=ec.id,r&&console.log("253 Diagram",ec,h);let ep=new i.qf(h.currentModel,!0);ep=JSON.parse(JSON.stringify(ep)),r&&console.log("255 Diagram",ep),h.myDiagram.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:ep});break}case"Change Relationship type":{let eh;r&&console.log("369 selection",p.selection);let eu=v&&v;p.selection.each(function(e){let l=e.data;if(l.category===a.gojs.C_RELATIONSHIP){if(!(eh=m.findLink(l.key)))return;let o=eh.relship;o=g.findRelationship(o.id);let i=eh.relshipview;i=f.findRelationshipView(i.id);let s=null==m?void 0:m.findNode(eh.from),d=null==m?void 0:m.findNode(eh.to);r&&console.log("381 myGoModel, link, from and toNode: ",m,eh,s,d);let c=null==s?void 0:s.objecttype,p=null==d?void 0:d.objecttype;c=h.findObjectType(null==c?void 0:c.id),p=h.findObjectType(null==p?void 0:p.id),r&&console.log("386 link",c,p);let u=h.findRelationshipTypeByName2(eu,c,p),y=u.relshipkind;switch(o.setRelshipKind(y),y){case"Composition":case"Aggregation":o.cardinalityFrom=u.cardinalityFrom,o.cardinalityTo=u.cardinalityTo}r&&console.log("398 reltype",u,c,p);let v=u&&n.wR(eh,u,t);r&&console.log("400 relview",v),h.myDiagram.requestUpdate()}});break}case"Edit Attribute":{let em=e.value;if(r&&console.log("281 propname",em),em&&em.length>0){let eg=h.currentNode,ef=h.currentLink,ey=null,ev="";if(eg?ey=null==eg?void 0:eg.object:(ey=null==ef?void 0:ef.relship)||(ey=null==ef?void 0:ef.reltype),!ey)break;ev=ey[em];let eb=prompt("Enter value of "+em,ev);if(eb)switch(r&&console.log("300",em,eb),"description"===em?ey.description=eb:(console.log("304 prop, value",em,eb),ey[em]=eb),ey.category){case"Relationship":(ey=h.findRelationship(ey.id))[em]=eb,r&&console.log("311 inst",ey);let ew=[],ej=new i.cP(ey);r&&console.log("314 inst, jsnRel",ey,ej),ew.push(ej),null==ew||ew.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),h.myDiagram.dispatch({type:"UPDATE_RELSHIP_PROPERTIES",data:t})});break;case"Relationship type":if(ey=h.findRelationshipType(ey.id),"cardinalityFrom"===em||"cardinalityTo"===em){let eT="\\b(n|[0-9])\\b[-]\\b(n|[1-9])\\b",ek=new c(eT);if(console.log("326 regex:",ek,eb),!ek.test(eb)){alert("Value: "+eb+" IS NOT valid");break}}ey[em]=eb,r&&console.log("333 inst",ey);let eO=[],eM=new i.yh(ey,!0);r&&console.log("336 inst, jsnRel",ey,eM),eO.push(eM),null==eO||eO.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),h.myDiagram.dispatch({type:"UPDATE_RELSHIPTYPE_PROPERTIES",data:t})})}}break}case"Create Relationship":{r&&console.log("349 context",t);let eD=t.myMetamodel,eE=t.myGoModel,ex=t.myDiagram,eR=t.modalContext,eN=eR.data,eA=e.value;eR.selected=e,r&&console.log("358 typename",eA);let eS=eE.findNode(eR.data.from),eC=eE.findNode(eR.data.to),eP=null==eS?void 0:eS.objecttype,eI=null==eC?void 0:eC.objecttype;eP=eD.findObjectType(null==eP?void 0:eP.id),r&&console.log("366 fromType",eP),eP||(eP=eD.findObjectType(null==eS?void 0:null===(o=eS.object)||void 0===o?void 0:o.typeRef)),eP&&(eP.allObjecttypes=eD.objecttypes,eP.allRelationshiptypes=eD.relshiptypes),eI=eD.findObjectType(null==eI?void 0:eI.id),r&&console.log("373 toType",eI),eI||(eI=eD.findObjectType(null==eC?void 0:null===(s=eC.object)||void 0===s?void 0:s.typeRef)),eI&&(eI.allObjecttypes=eD.objecttypes,eI.allRelationshiptypes=eD.relshiptypes);let e_=t.myMetamodel.findRelationshipTypeByName2(eA,eP,eI);if(r&&console.log("380 reltype",e_,eP,eI),!e_){alert("Relationship type given does not exist!"),ex.model.removeLinkData(eN);return}if(e_){r&&console.log("912 reltype",e_);let eL=e_.typeview;if(eL){let eV=[],eF=new i.Ug(eL);eV.push(eF),r&&console.log("920 jsnTypeView",eF),null==eV||eV.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),ex.dispatch({type:"UPDATE_RELSHIPTYPEVIEW_PROPERTIES",data:t})})}}r&&console.log("387 data, reltype",eN,e_),eN.relshiptype=e_}}}function u(e,t,l){var p,h,u,m,g,f,y,v,b,w,j,T,k,O,M,D;r&&console.log("540 selectedData, props, modalContext: ",e,t,l),r&&console.log("541 selectedData.objecttype: ",e.objecttype),r&&console.log("542 props.nodedataArray[0].objecttype: ",t.nodeDataArray[0].objecttype);let E=l.what,x=l.myDiagram;x&&l.context&&(x=l.context.myDiagram);let R=x.selection;r&&console.log("547 selection",R);let N=t.myMetis;r&&console.log("549 myMetis",N);let A=N.currentMetamodel,S=N.currentModel,C=N.currentModelview,P=N.gojsModel,I=[],_=[],L=[],V=[],F=[],G=[],K=[];switch(E){case"editObjectType":{let B=e;r&&console.log("588 selObj",B);let U=B;U=x.findNodeForKey(U.key);let J=B.objecttype;J=N.findObjectType(J.id),r&&console.log("594 selObj",B,J);let z=U.data;for(let H in r&&console.log("596 node, type",z,J),J)"id"!==H&&"object"!=typeof J[H]&&"function"!=typeof J[H]&&n.Cw(H,J)&&(J[H]=B[H],r&&console.log("603 k, selObj[k]",H,B[H]),x.model.setDataProperty(z,H,J[H]));let W=new i.vM(J,!0);r&&console.log("608 jsnObjtype",W),I.push(W),I.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),x.dispatch({type:"UPDATE_OBJECTTYPE_PROPERTIES",data:t})}),r&&console.log("615 type, selObj",J,B);break}case"editRelationshipType":{let X=e;r&&console.log("446 selObj",X);let Y=X,Z=Y.data,$=Y.reltype;if($||($=Z.reltype),!(Y=x.findLinkForKey(Y.key)))break;$=N.findRelationshipType(null==$?void 0:$.id);let q=null==$?void 0:$.typeview;if($){let Q=$.getCardinalityFrom(),ee=$.getCardinalityTo();r&&console.log("461 cardinalities",Q,ee),$.cardinalityFrom=Q,$.cardinalityTo=ee,q&&(q.setRelshipKind($.relshipkind),q.setTemplate(Z.template)),r&&console.log("467 link",Y,$),r&&console.log("468 link, type",Z,$)}else break;for(let et in X)"object"!=typeof $[et]&&"function"!=typeof $[et]&&n.Cw(et,$)&&($[et]=X[et],x.model.setDataProperty(Y.data,et,$[et]),r&&console.log("478 type",$));let el=new i.yh($,!0);r&&console.log("482 jsnReltype",$,el),_.push(el),_.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),x.dispatch({type:"UPDATE_RELSHIPTYPE_PROPERTIES",data:t})}),r&&console.log("488 selObj",X);break}case"editObject":{let eo,ei;let en=e;r&&console.log("576 selObj",en,N);let es=N.findObjectView(en.objectview.id);es.group=null===(p=en.objectview)||void 0===p?void 0:p.group,N.addObjectView(es);let ea=en;if(en.object?(eo=en.object,eo=N.findObject(null==eo?void 0:eo.id)):eo=en,!eo)break;let er=null==eo?void 0:eo.type;if(r&&console.log("589 selObj, obj, type",en,eo,er),(null==er?void 0:er.name)==="Method")ei=eo.setAndGetAllProperties(N);else if((null==er?void 0:er.name)==="Modelview"){let ed=N.findModelView(eo.modelviewId);if(ed){ei=null==er?void 0:er.getProperties(!1),r&&console.log("700 type, properties",er,ei);for(let ec=0;ec<(null==ei?void 0:ei.length);ec++){let ep=ei[ec];if(ep)switch(ep.name){case"layout":case"link curve":case"link routing":case"askForRelshipName":case"includeInheritedReltypes":case"UseUMLrelshipkinds":ed[ep.name]=eo[ep.name]}}r&&console.log("715 mv",ed);let eh=new i.OX(ed);K.push(eh),K.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),N.myDiagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:t})})}}else ei=null==er?void 0:er.getProperties(!1);r&&console.log("597 properties",ei);let eu=new i.GZ(eo);eu.text=eo.text,r&&console.log("600 obj, jsnObject",eo,eu);for(let em=0;em<(null==ei?void 0:ei.length);em++){let eg=ei[em];if(!eg)continue;let ef=eg.datatypeRef,ey=N.findDatatype(ef);if(ey&&"boolean"!==ey.name){let ev=ey.inputPattern,eb=eo[eg.name];if(ev&&eb){let ew=new c(ev);if(r&&console.log("643 regex:",ew),!ew.test(eb)){let ej="Value: '"+eb+"' of '"+eg.name+"' IS NOT valid";alert(ej);return}}}let eT=eo.getPropertyValue(eg,N);eo[eg.name]=eT,eu[eg.name]=eT}r&&console.log("625 obj, jsnObject, node",eo,eu,ea);let ek=x.findNodeForKey(ea.key),eO=ek?ek.data:ea.data;for(let eM in r&&console.log("628 node",ea),eO)"object"!=typeof eo[eM]&&"function"!=typeof eo[eM]&&n.Cw(eM,er)&&("abstract"===eM&&(eo[eM]=en[eM]),"viewkind"===eM&&(eo[eM]=en[eM]),r&&console.log("635 prop",eM),r&&console.log("636 node",ea,eO,eo),x.model.setDataProperty(eO,eM,eo[eM]));eu&&G.push(eu),r&&console.log("696 selObj",en);break}case"editRelationship":{let eD=e,eE=eD.type,ex=x.findLinkForKey(eD.key);if(!ex)break;r&&console.log("705 rel, link",eD,ex);let eR=ex.data;r&&console.log("707 data",eR);let eN=eR.relship;for(let eA in(eN=N.findRelationship(eN.id)).cardinalityFrom=eN.getCardinalityFrom(),eN.cardinalityTo=eN.getCardinalityTo(),""===eN.name&&(eN.name=" "),r&&console.log("713 relship, rel",eN,eD),eD)"object"!=typeof eD[eA]&&"function"!=typeof eD[eA]&&n.Cw(eA,eE)&&x.model.setDataProperty(eR,eA,eN[eA]);let eS=ex.data.relshipview;eS=N.findRelationshipView(eS.id),eN.relshipkind!==a.relkinds.REL&&(eS.setFromArrow2(eN.relshipkind),eS.setToArrow2(eN.relshipkind),eS.fromArrow,eS.toArrow,x.model.setDataProperty(eR,"fromArrow",eS.fromArrow),x.model.setDataProperty(eR,"toArrow",eS.toArrow),x.model.setDataProperty(eR,"fromArrowColor",eS.fromArrowColor),x.model.setDataProperty(eR,"toArrowColor",eS.toArrowColor)),r&&console.log("742 relship, relview",eN,eS),C.showCardinality?(x.model.setDataProperty(eR,"cardinalityFrom",eN.getCardinalityFrom()),x.model.setDataProperty(eR,"cardinalityTo",eN.getCardinalityTo()),r&&console.log("746 myModelview",C)):(x.model.setDataProperty(eR,"cardinalityFrom",""),x.model.setDataProperty(eR,"cardinalityTo",""));break}case"editObjectview":{let eC=e;r&&console.log("766 selObj",eC,N);let eP=N.findObjectView(eC.objectview.id);if(!eP)break;eP.group=null===(h=eC.objectview)||void 0===h?void 0:h.group,N.addObjectView(eP);let eI=eP.typeview;x.selection.each(function(e){r&&console.log("789 sel, sel.data",e,e.data);let t=e.data.objectview;if(t){for(let l in t=N.findObjectView(t.id),r&&console.log("796 objview, objtypeview",t,eI),null==eI?void 0:eI.data)if("group"!==l&&"isGroup"!==l){try{t[l]=eC[l]}catch(o){}r&&console.log("803 prop, objview",l,t),N.addObjectView(t)}let i=t.object;i&&(i.viewkind=t.viewkind)}let n=x.findNodeForKey(e.data.key);if(n){let s=n.data;for(let a in r&&console.log("789 objview, data, node",t,s,n),null==eI?void 0:eI.data)x.model.setDataProperty(s,a,t[a]),"template"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]),"geometry"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]),"figure"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]),"fillcolor"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]),"fillcolor2"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]),"strokecolor"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]),"strokecolor2"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]),"strokewidth"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]),"textcolor"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]),"textscale"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]);r&&console.log("806 data",s)}x.requestUpdate});break}case"selectDropdown":if("Select Icon"===l.title){if(e.category===a.gojs.C_OBJECT){let e_=e,eL=x.findNodeForKey(e_.key);r&&console.log("747 node",eL);let eV=eL.data,eF=eV.objectview;if(eF){eF.icon=eV.icon;let eG=new i.kC(eV.objectview),eK=[];eK.push(eG),eK.map(e=>{let t=e;r&&console.log("769 data",t),t=JSON.parse(JSON.stringify(t)),r&&console.log("771 data, jsnObjview",t,eG),x.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})})}for(let eB in null==eF?void 0:eF.data)"icon"===eB&&""!==eF[eB]&&x.model.setDataProperty(eV,eB,eF[eB])}else if(e.category===a.gojs.C_OBJECTTYPE){let eU=e;r&&console.log("834 node",eU);let eJ=eU.objecttype;eJ=N.findObjectType(eJ.id);let ez=eJ.typeview;ez.icon=eU.icon,ez.data.icon=eU.icon;let eH=new i.XA(ez);r&&console.log("841 jsnObjtypeview",ez,eH),L.push(eH),L.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),x.dispatch({type:"UPDATE_OBJECTTYPEVIEW_PROPERTIES",data:t})})}}else if("New Model"===l.case){let eW=null===(u=l.selected)||void 0===u?void 0:u.value;r&&console.log("853 selected: ",l.selectedValue);let eX=N.findMetamodelByName(eW),eY=l.context;eY.args.metamodel=eX,l.context.postOperation(eY)}else if("Generate Target Metamodel"===l.case){let eZ=l.context,e$=null===(m=l.selected)||void 0===m?void 0:m.value;r&&console.log("862 selected: ",l.selectedValue);let eq=N.findMetamodelByName(e$);if(!eq){alert("Metamodel not found");return}eZ.myTargetMetamodel=eq,eZ.myCurrentModelview=N.currentModelview,N.currentModel.targetMetamodelRef=eq.id,r&&console.log("874 context",eZ),l.context.postOperation(eZ)}else if("Add Metamodel"===l.case){r&&console.log("950 modalContext",l);let eQ=l.context,e0=null===(g=l.selected)||void 0===g?void 0:g.value,e1=N.findMetamodelByName(e0),e2=eQ.args.metamodels;for(let e6=0;e6<(null==e2?void 0:e2.length);e6++){let e5=e2[e6];e5.name===e0&&(e1=e5)}r&&console.log("960 metamodel, modalContext: ",e1,l),eQ.args.metamodel=e1,l.context.postOperation(eQ);break}else if("Replace Metamodel"===l.case){r&&console.log("821 modalContext",l);let e3=l.context,e4=null===(f=l.selected)||void 0===f?void 0:f.value,e8=N.findMetamodelByName(e4),e9=e3.args.metamodels;for(let e7=0;e7<(null==e9?void 0:e9.length);e7++){let te=e9[e7];te.name===e4&&(e8=te)}r&&console.log("872 metamodel, modalContext: ",e8,l),e3.args.metamodel=e8,l.context.postOperation(e3);break}else if("Delete Metamodel"===l.case){let tt=null===(y=l.selected)||void 0===y?void 0:y.value,tl=N.findMetamodelByName(tt);r&&console.log("881 metamodel, modalContext: ",tl,l);let to=l.context;to.args.metamodel=tl,l.context.postOperation(to);break}else if("Clear Metamodel"===l.case){let ti=null===(v=l.selected)||void 0===v?void 0:v.value,tn=N.findMetamodelByName(ti);r&&console.log("881 metamodel, modalContext: ",tn,l);let ts=l.context;ts.args.metamodel=tn,l.context.postOperation(ts);break}else if("Delete Model"===l.case){let ta=null===(b=l.selected)||void 0===b?void 0:b.value,tr=N.findModelByName(ta);r&&console.log("890 model, modalContext: ",tr,l);let td=l.context;td.args.model=tr,l.context.postOperation(td);break}else if("Generate Method"===l.case){let tc=l.context.myMetamodel,tp=null===(w=l.selected)||void 0===w?void 0:w.value,th=tc.findMethodTypeByName(tp);r&&console.log("900 methodType, modalContext: ",th,l);let tu=l.context;tu.methodType=th,l.context.postOperation(tu);break}else if("Execute Method"===l.case){let tm=l.context.myMetamodel,tg=null===(j=l.selected)||void 0===j?void 0:j.value,tf=tm.findMethodByName(tg);r&&console.log("910 method, modalContext: ",tf,l);let ty=l.context;ty.args.method=tf,l.context.postOperation(ty);break}else if("Export Task Model"===l.case){let tv=l.context,tb=null===(T=l.selected)||void 0===T?void 0:T.value,tw=N.findModelByName(tb),tj=tv.args.objectview;tv.args.objectview=tj,tv.args.model=tw,l.context.postOperation(tv);break}case"editRelshipview":{let tT=e;if(!tT.relshipview)break;let tk=tT.relshipview.typeview;r&&console.log("982 reltypeview",tk);let tO=N.findRelationshipTypeView(tk.id);tO&&(tk=tO),r&&console.log("984 reltypeview",tk),x.selection.each(function(e){let t=e.data.relshipview;if(t){for(let l in t=N.findRelationshipView(t.id),null==tk?void 0:tk.data)if("class"!==l){try{t[l]=tT[l]}catch(o){}r&&console.log("803 prop, relview",l,t),N.addRelationshipView(t)}}let n=x.findLinkForKey(e.data.key);if(r&&console.log("977 link",n,e.data),n){let s=n.data;for(let a in r&&console.log("979 data, relview",s,t),null==tk?void 0:tk.data){if("template"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]),"strokecolor"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]),"strokewidth"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]),"textcolor"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]),"textscale"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]),"dash"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]),"fromArrow"===a){let d=t[a];"None"===t[a]&&(d=""),x.model.setDataProperty(s,a,d)}if("fromArrowColor"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a]),"toArrow"===a){let c=t[a];""===t[a]&&(c=tk.data[a]),"None"===t[a]&&(c=""),x.model.setDataProperty(s,a,c)}"toArrowColor"===a&&""!==t[a]&&x.model.setDataProperty(s,a,t[a])}}let p=new i.XB(t);r&&console.log("1006 data, jsnRelview",n,li,t,p),F.push(p),F.map(e=>{let t=e;x.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})});let h=new i.Ug(tk);r&&console.log("1013 data, gqlReltypeview",n,li,h),V.push(h),V.map(e=>{let t=e;x.dispatch({type:"UPDATE_RELSHIPTYPEVIEW_PROPERTIES",data:t})})});break}case"editTypeview":{let tM,tD,tE,tx;let tR=e;if(r&&console.log("918 selObj",tR),r&&console.log("919 selObj",tR,N),(tR.category===a.gojs.C_OBJECT||tR.category===a.gojs.C_OBJECTTYPE)&&tR.objectview){let tN=N.findObjectView(tR.objectview.id);tN.group=null===(k=tR.objectview)||void 0===k?void 0:k.group,N.addObjectView(tN)}if(tR.category===a.gojs.C_OBJECTTYPE){let tA=N.currentNode;for(let tS in tM=(tA=x.findNodeForKey(tA.key)).data,r&&console.log("933 node, data",tA,tM),tE=tM.typeview,tD=N.findObjectTypeView(null==tE?void 0:tE.id),r&&console.log("936 objtypeview, typeview",tE,tD),null==tE?void 0:tE.data)"id"!==tS&&"name"!==tS&&"abstract"!==tS&&"category"!==tS&&"class"!==tS&&("fromArrow"===tS&&"None"===tR[tS]&&(tR[tS]=""),"toArrow"===tS&&"None"===tR[tS]&&(tR[tS]=""),tD[tS]=tR[tS],tD.data[tS]=tR[tS],x.model.setDataProperty(tM,tS,tR[tS]));r&&console.log("1051 typeview, objtypeview",tD,tE);let tC=new i.XA(tD);r&&console.log("1049 jsnObjtypeview",tC),L.push(tC),L.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),x.dispatch({type:"UPDATE_OBJECTTYPEVIEW_PROPERTIES",data:t})})}if(tR.category===a.gojs.C_OBJECT){let tP=x.findNodeForKey(tR.key),tI=(tM=tP.data).objectview;tI=N.findObjectView(null==tI?void 0:tI.id),tE=null===(O=tM.objectview)||void 0===O?void 0:O.typeview,r&&console.log("950 objtypeview, data, objview",tE,tM,tI);let t_=N.objecttypeviews;for(let tL=0;tL<t_.length;tL++){let tV=t_[tL];if(tV.id===(null==tE?void 0:tE.id))for(let tF in tM.typeview.data)tI[tF]=tM.objectview[tF],tV.data[tF]=tR[tF],r&&console.log("958 typeview",tV)}r&&console.log("962 data, objtypeview",tM,tE)}if(tR.category===a.gojs.C_RELSHIPTYPE){let tG=x.findLinkForKey(tR.key);tM=tG.data,r&&console.log("1035 data, link, myMetis",tM,tG,N);let tK=tM.reltype;if((tK=N.findRelationshipType(tK.id))?(tD=tK.typeview,tD=N.findRelationshipTypeView(tD.id),tK.typeview=tD):(tx=tM.typeview,tD=N.findRelationshipTypeView(tx.id)),r&&console.log("1123 selObj, reltype, typeview",tR,tK,tD),tD){for(let tB in tD.setFromArrow2(tR.relshipkind),tD.setToArrow2(tR.relshipkind),tD.data)"key"!==tB&&"category"!==tB&&"abstract"!==tB&&"class"!==tB&&"relshipkind"!==tB&&(tD[tB]=tR[tB],tD.data[tB]=tR[tB],x.model.setDataProperty(tM,tB,tR[tB]));r&&console.log("1047 typeview",tD,tM),A.addRelationshipTypeView(tD)}x.clearSelection()}if(tR.category===a.gojs.C_RELATIONSHIP){let tU=x.findLinkForKey(tR.key);tx=null===(M=(tM=tU.data).relshipview)||void 0===M?void 0:M.typeview;let tJ=tM.relshipview,tz=N.relshiptypeviews;for(let tH=0;tH<tz.length;tH++){let tW=tz[tH];if(tW.id===(null==tx?void 0:tx.id)){for(let tX in null===(D=tM.typeview)||void 0===D?void 0:D.data)tW[tX]=tR[tX],tW.data[tX]=tR[tX];r&&console.log("1019 reltypeview, data",tW,tM),r&&console.log("1020 typeview",tW),N.addRelationshipTypeView(tW);let tY=new i.Ug(tW);r&&console.log("1024 jsnReltypeview",tY),V.push(tY),V.map(e=>{let t=e;x.dispatch({type:"UPDATE_RELSHIPTYPEVIEW_PROPERTIES",data:t})})}}tJ=n.rw(tJ);let tZ=new i.XB(tJ);r&&console.log("1036 data, elview, , jsnRelview",tM,tJ,tZ),F.push(tZ),F.map(e=>{let t=e;x.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})}),x.clearSelection();return}break}case"editModelview":break;case"connectToSelected":{r&&console.log("1131 modalContext",l);let t$=l.selected.value,tq=l.args.nodeFrom;tq=x.findNodeForKey(tq.key);let tQ=l.links;r&&console.log("1135 links",tQ);let t0=tq.data.object;t0=N.findObject(t0.id);let t1=tq.data.objectview;t1=N.findObjectView(t1.id);let t2=tq.data.objecttype;t2=N.findObjectType(t2.id),l.args.nodesTo,r&&console.log("1138 objFrom, objfromView: ",t0,t1);for(let t6=0;t6<tQ.length;t6++){let t5=tQ[t6],t3=x.findNodeForKey(t5.to),t4=t3.data.objectview;t4=N.findObjectView(t4.id);let t8=t3.data.object;t8=N.findObject(t8.id);let t9=t3.data.objecttype;t9=N.findObjectType(t9.id);let t7=A.findRelationshipTypeByName2(t$,t2,t9);if(t7){let le=new o.Uj(d.createGuid(),t7,t0,t8,t$,"");S.addRelationship(le),N.addRelationship(le);let lt=new o.IM(d.createGuid(),le.name,le,"");r&&console.log("1152 rel, relview",le,lt),lt.fromObjview=t1,lt.toObjview=t4,le.addRelationshipView(lt),C.addRelationshipView(lt),r&&console.log("1162 myModelview, relview",C,lt),N.addRelationshipView(lt),r&&console.log("1159 myMetis, myGoModel",N,P);let ll=new s.hX(t5.key,P,lt);ll.loadLinkContent(P),r&&console.log("1160 gjslink",ll),x.model.removeLinkData(t5),x.model.addLinkData(ll)}}}}let lo=new i.st(N,!0),li={metis:lo};li=JSON.parse(JSON.stringify(li)),r&&console.log("1321 myMetis, data",N,li),x.dispatch({type:"LOAD_TOSTORE_PHDATA",data:li}),x.clearSelection()}},3327:function(e,t,l){"use strict";l.d(t,{$m:function(){return f},Cg:function(){return x},OT:function(){return k},Sn:function(){return M},dW:function(){return g},dY:function(){return D},g9:function(){return c},jw:function(){return E},qi:function(){return m}});var o=l(715),i=l(6575);let n=!1;l(2586),l(5523);let s=o.bx.make;function a(e){switch(e){case"Normal":default:return o.rU.Normal;case"Orthogonal":return o.rU.Orthogonal;case"AvoidsNodes":return o.rU.AvoidsNodes}}function r(e){switch(e){case"Bezier":return o.rU.Bezier;case"JumpOver":return o.rU.JumpOver;case"JumpGap":return o.rU.JumpGap;default:return""}}l(4518),o.bn.defineFigureGenerator("Annotation",function(e,t,l){var i=Math.min(t,10),n=Math.max(t,10);return new o.ZX().add(new o.zS(i,0).add(new o.IL(o.IL.Line,0,0)).add(new o.IL(o.IL.Line,0,l)).add(new o.IL(o.IL.Line,i,l)).add(new o.IL(o.IL.Move,n-i,0)).add(new o.IL(o.IL.Line,n,0)).add(new o.IL(o.IL.Line,n,l)).add(new o.IL(o.IL.Line,n-i,l)))});let d=["Circle","Diamond","Ellipse","Gear","Help","Hexagon","LineH","LineV","MinusLine","PlusLine","XLine","Pentagon","Rectangle","RoundedRectangle","Square","FivePointedStar","ThinX","ThickX","ThinCross","ThickCross","Triangle","TriangleRight","TriangleLeft","TriangleUp","TriangleDown"];function c(){return d}let p=[],h=[],u=[];function m(){return p}function g(){return h}function f(){return u}s(o.BD,"Linear",{0:"LightGoldenRodYellow",1:"#FFFF66"}),s(o.BD,"Linear",{0:"#E0FEE0",1:"PaleGreen"});let y=s(o.BD,"Linear",{0:"White",1:"#DADADA"}),v=42,b=y;function w(e){if(0==p.length){p.push(e);return}let t=[...new Set(p)];for(let l=0;l<(null==t?void 0:t.length);l++){let o=t[l];if(o!=e){t.push(e);break}}let i=[...new Set(t)];p=i}function j(e){if(0==u.length){u.push(e);return}let t=[...new Set(u)];for(let l=0;l<(null==t?void 0:t.length);l++){let o=t[l];if(o!=e){t.push(e);break}}let i=[...new Set(t)];u=i}function T(e){if(0==h.length){h.push(e);return}let t=[...new Set(h)];for(let l=0;l<(null==t?void 0:t.length);l++){let o=t[l];if(o!=e){t.push(e);break}}let i=[...new Set(t)];h=i,n&&console.log("216 linkTemplateNames: ",h)}function k(e,t,l){let a=s(o.NB,"Auto",new o.KX("stroke","strokecolor"),new o.KX("layerName","layer"),new o.KX("deletable"),new o.KX("location","loc",o.E9.parse).makeTwoWay(o.E9.stringify),new o.KX("scale","scale1").makeTwoWay(),{selectionObjectName:"SHAPE",resizable:!1,resizeObjectName:"SHAPE"},s(o.bn,"RoundedRectangle",{cursor:"alias",name:"SHAPE",fill:"yellow",stroke:"#fff",strokeWidth:2,margin:new o.Zt(1,1,1,1),shadowVisible:!0,minSize:new o.$u(160,70),portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new o.KX("desiredSize","size",o.$u.parse).makeTwoWay(o.$u.stringify),new o.KX("fill","fillcolor"),new o.KX("stroke","strokecolor"),new o.KX("stroke","isHighlighted",function(e,t){return e?"lightblue":t.part.data.strokecolor||"black"}).ofObject(),{contextMenu:t}),s(o.bn,"RoundedRectangle",{cursor:"move",fill:"transparent",stroke:"transparent",strokeWidth:10,margin:new o.Zt(1,1,1,1),shadowVisible:!1,desiredSize:new o.$u(136,60)}),s(o.s_,"Table",s(o.jE,{column:1,width:4}),s(o.s_,"Horizontal",{defaultAlignment:o.z6.Center},s(o.s_,"Table",{contextMenu:t,cursor:"move"},{defaultRowSeparatorStroke:"black",desiredSize:new o.$u(136,60),maxSize:new o.$u(136,66),defaultAlignment:o.z6.Center},{toolTip:s(o.uz,"Auto",s(o.bn,{fill:"lightyellow"}),s(o.al,{margin:8},new o.KX("text","",function(e){let t=i.hM(e,l);return n&&console.log("234 tooltip",t),t})))},s(o.al,x(),{isMultiline:!1,editable:!0,row:0,column:0,columnSpan:6,font:"bold 10pt Segoe UI,sans-serif",minSize:new o.$u(120,36),textAlign:"center",height:46,verticalAlignment:o.z6.Center,margin:new o.Zt(0,2,0,0),name:"name"},new o.KX("text","name").makeTwoWay(),new o.KX("stroke","textcolor").makeTwoWay()),s(o.al,x(),{row:1,column:1,columnSpan:6,editable:!1,isMultiline:!1,margin:new o.Zt(2,0,1,0),alignment:o.z6.Center},new o.KX("text","typename"))))));e.add("",a),e.add("textOnly",a),w("textOnly");let r=s(o.NB,"Auto",new o.KX("stroke","strokecolor"),new o.KX("layerName","layer"),new o.KX("deletable"),new o.KX("location","loc",o.E9.parse).makeTwoWay(o.E9.stringify),new o.KX("scale","scale1").makeTwoWay(),{toolTip:s(o.uz,"Auto",s(o.bn,{fill:"lightyellow"}),s(o.al,{margin:8},new o.KX("text","",function(e){return i.hM(e,l)})))},{selectionObjectName:"SHAPE",resizable:!0,resizeObjectName:"SHAPE"},s(o.bn,"RoundedRectangle",{cursor:"alias",name:"SHAPE",fill:"red",stroke:"#fff",strokeWidth:2,margin:new o.Zt(1,1,1,1),shadowVisible:!0,minSize:new o.$u(158,68),desiredSize:new o.$u(158,68),portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new o.KX("desiredSize","size",o.$u.parse).makeTwoWay(o.$u.stringify),new o.KX("fill","fillcolor"),new o.KX("stroke","strokecolor"),new o.KX("stroke","isHighlighted",function(e,t){return e?"lightblue":t.part.data.strokecolor||"black"}).ofObject(),{contextMenu:t}),s(o.bn,"RoundedRectangle",{name:"SHAPE",cursor:"move",fill:"transparent",stroke:"transparent",strokeWidth:10,margin:new o.Zt(1,1,1,1),shadowVisible:!1,desiredSize:new o.$u(136,48)}),s(o.s_,"Table",{defaultAlignment:o.z6.Left,margin:2,cursor:"move"},s(o.jE,{column:1,width:4}),s(o.s_,"Horizontal",{defaultAlignment:o.z6.Center},s(o.s_,"Table",{contextMenu:t,cursor:"move"},{defaultRowSeparatorStroke:"black",defaultAlignment:o.z6.Center},s(o.al,x(),{isMultiline:!1,editable:!0,row:0,column:0,columnSpan:6,font:"bold 10pt Segoe UI,sans-serif",minSize:new o.$u(120,36),desiredSize:new o.$u(800,60),textAlign:"center",height:46,verticalAlignment:o.z6.Center,margin:new o.Zt(2,2,2,2),name:"name"},new o.KX("text","name").makeTwoWay(),new o.KX("stroke","textcolor").makeTwoWay()),s(o.al,x(),{row:1,column:1,columnSpan:6,stretch:o.bx.Fill,editable:!1,isMultiline:!1,minSize:new o.$u(10,4),margin:new o.Zt(0,0,0,2),textAlign:"center"},new o.KX("text","typename"))))));e.add("textOnly1",r),w("textOnly1");let d=s(o.NB,"Auto",new o.KX("stroke","strokecolor"),new o.KX("layerName","layer"),new o.KX("deletable"),new o.KX("location","loc",o.E9.parse).makeTwoWay(o.E9.stringify),new o.KX("scale","scale1").makeTwoWay(),{toolTip:s(o.uz,"Auto",s(o.bn,{fill:"lightyellow"}),s(o.al,{margin:8},new o.KX("text","",function(e){return i.hM(e,l)})))},{selectionObjectName:"SHAPE",resizable:!0,resizeObjectName:"SHAPE"},s(o.bn,"RoundedRectangle",{cursor:"alias",name:"SHAPE",fill:"red",stroke:"#fff",strokeWidth:2,margin:new o.Zt(1,1,1,1),shadowVisible:!0,minSize:new o.$u(158,68),desiredSize:new o.$u(158,68),portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new o.KX("desiredSize","size",o.$u.parse).makeTwoWay(o.$u.stringify),new o.KX("fill","fillcolor"),new o.KX("stroke","strokecolor"),new o.KX("stroke","isHighlighted",function(e,t){return e?"lightblue":t.part.data.strokecolor||"black"}).ofObject(),{contextMenu:t}),s(o.bn,"RoundedRectangle",{name:"SHAPE",cursor:"move",fill:"transparent",stroke:"transparent",strokeWidth:10,margin:new o.Zt(1,1,1,1),shadowVisible:!1,desiredSize:new o.$u(136,48)}),s(o.s_,"Table",{defaultAlignment:o.z6.Left,margin:2,cursor:"move"},s(o.jE,{column:1,width:4}),s(o.s_,"Horizontal",{defaultAlignment:o.z6.Center},s(o.s_,"Table",{contextMenu:t,cursor:"move"},{defaultRowSeparatorStroke:"black",defaultAlignment:o.z6.Center},s(o.al,x(),{isMultiline:!1,editable:!0,row:0,column:0,columnSpan:6,font:"bold 10pt Segoe UI,sans-serif",minSize:new o.$u(120,36),desiredSize:new o.$u(800,60),textAlign:"center",height:46,verticalAlignment:o.z6.Center,margin:new o.Zt(2,2,2,2),name:"name"},new o.KX("text","name").makeTwoWay(),new o.KX("stroke","textcolor").makeTwoWay())))));e.add("textOnly2",d),w("textOnly2"),e.add("textAndIcon",s(o.NB,"Auto",new o.KX("stroke","strokecolor"),new o.KX("layerName","layer"),new o.KX("deletable"),new o.KX("location","loc",o.E9.parse).makeTwoWay(o.E9.stringify),new o.KX("scale","scale1").makeTwoWay(),{contextMenu:t},{toolTip:s(o.uz,"Auto",s(o.bn,{fill:"lightyellow"}),s(o.al,{margin:8},new o.KX("text","",i.hM)))},s(o.bn,"RoundedRectangle",{cursor:"alias",name:"SHAPE",fill:"red",stroke:"#fff",strokeWidth:2,margin:new o.Zt(1,1,1,1),shadowVisible:!0,desiredSize:new o.$u(198,68),portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new o.KX("fill","fillcolor"),new o.KX("stroke","strokecolor"),new o.KX("stroke","isHighlighted",function(e,t){return e?"lightblue":t.part.data.strokecolor||"black"}).ofObject()),s(o.bn,"RoundedRectangle",{cursor:"move",fill:"transparent",stroke:"transparent",strokeWidth:10,margin:new o.Zt(1,1,1,1),shadowVisible:!1,desiredSize:new o.$u(136,48)}),s(o.s_,"Table",{defaultAlignment:o.z6.Left,margin:2,cursor:"move"},s(o.jE,{column:1,width:4}),s(o.s_,"Horizontal",{defaultAlignment:o.z6.Center},s(o.s_,"Vertical",{contextMenu:t,cursor:"move"},s(o.s_,"Spot",{contextMenu:t,cursor:"move"},s(o.bn,{fill:"white",stroke:"#ddd",opacity:.4,desiredSize:new o.$u(56,56),margin:new o.Zt(0,2,0,8)},new o.KX("fill","isHighlighted",function(e){return e?"lightblue":"white"}).ofObject(),new o.KX("stroke","isHighlighted",function(e){return e?"black":"white"}).ofObject(),new o.KX("template")),s(o.t,{name:"Picture",desiredSize:new o.$u(48,48)},new o.KX("source","icon",E)))),s(o.s_,"Table",{contextMenu:t,cursor:"move"},{defaultRowSeparatorStroke:"black",desiredSize:new o.$u(136,60),maxSize:new o.$u(136,66),defaultAlignment:o.z6.Center},s(o.al,x(),{isMultiline:!1,editable:!0,row:0,column:0,columnSpan:6,font:"bold 10pt Segoe UI,sans-serif",minSize:new o.$u(120,36),textAlign:"center",height:46,verticalAlignment:o.z6.Center,margin:new o.Zt(0,2,0,0),name:"name"},new o.KX("text","name").makeTwoWay(),new o.KX("stroke","textcolor").makeTwoWay()),s(o.al,x(),{row:1,column:1,columnSpan:6,editable:!1,isMultiline:!1,minSize:new o.$u(10,4),margin:new o.Zt(0,0,0,2),textAlign:"center"},new o.KX("text","typename"))))))),w("textAndIcon"),e.add("textAndGeometry",s(o.NB,"Auto",new o.KX("stroke","strokecolor"),new o.KX("layerName","layer"),new o.KX("deletable"),new o.KX("location","loc",o.E9.parse).makeTwoWay(o.E9.stringify),new o.KX("scale","scale1").makeTwoWay(),{toolTip:s(o.uz,"Auto",s(o.bn,{fill:"lightyellow"}),s(o.al,{margin:8},new o.KX("text","",i.hM)))},s(o.bn,"RoundedRectangle",{cursor:"alias",name:"SHAPE",fill:"red",stroke:"#000",strokeWidth:2,margin:new o.Zt(1,1,1,1),shadowVisible:!0,desiredSize:new o.$u(198,68),portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new o.KX("fill","fillcolor"),new o.KX("stroke","strokecolor"),new o.KX("stroke","isHighlighted",function(e,t){return e?"lightblue":t.part.data.strokecolor||"black"}).ofObject(),{contextMenu:t}),s(o.bn,"RoundedRectangle",{cursor:"move",fill:"transparent",stroke:"transparent",strokeWidth:10,margin:new o.Zt(1,1,1,1),shadowVisible:!1,desiredSize:new o.$u(136,48)}),s(o.s_,"Table",{defaultAlignment:o.z6.Left,margin:2,cursor:"move"},s(o.jE,{column:1,width:4}),s(o.s_,"Horizontal",{defaultAlignment:o.z6.Center},s(o.s_,"Vertical",{contextMenu:t,cursor:"move"},s(o.bn,new o.KX("stroke","strokecolor2"),new o.KX("template"),new o.KX("geometryString","geometry"),{name:"SHAPE",strokeWidth:2,stroke:"blue",fill:"lightyellow",cursor:"alias",margin:new o.Zt(1,1,1,1),shadowVisible:!0,desiredSize:new o.$u(48,48)})),s(o.s_,"Table",{contextMenu:t,cursor:"move"},{defaultRowSeparatorStroke:"black",desiredSize:new o.$u(136,60),maxSize:new o.$u(140,66),defaultAlignment:o.z6.Center},s(o.al,x(),{isMultiline:!1,editable:!0,row:0,column:0,columnSpan:6,font:"bold 10pt Segoe UI,sans-serif",minSize:new o.$u(120,36),textAlign:"center",height:46,verticalAlignment:o.z6.Center,margin:new o.Zt(0,2,0,0),name:"name"},new o.KX("text","name").makeTwoWay(),new o.KX("stroke","textcolor").makeTwoWay()),s(o.al,x(),{row:1,column:1,columnSpan:6,editable:!1,isMultiline:!1,margin:new o.Zt(2,0,1,0),alignment:o.z6.Center},new o.KX("text","typename"))))))),w("textAndGeometry"),e.add("textAndFigure",s(o.NB,"Auto",new o.KX("layerName","layer"),new o.KX("deletable"),new o.KX("location","loc",o.E9.parse).makeTwoWay(o.E9.stringify),new o.KX("scale","scale1").makeTwoWay(),{toolTip:s(o.uz,"Auto",s(o.bn,{fill:"lightyellow"}),s(o.al,{margin:8},new o.KX("text","",i.hM)))},s(o.bn,"RoundedRectangle",{cursor:"alias",name:"SHAPE",fill:"red",stroke:"#000",strokeWidth:2,margin:new o.Zt(1,1,1,1),shadowVisible:!0,desiredSize:new o.$u(198,68),portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new o.KX("fill","fillcolor"),new o.KX("stroke","isHighlighted",function(e,t){return e?"lightblue":t.part.data.strokecolor||"black"}).ofObject(),{contextMenu:t}),s(o.bn,"RoundedRectangle",{cursor:"move",fill:"transparent",stroke:"transparent",strokeWidth:10,margin:new o.Zt(1,1,1,1),shadowVisible:!1,desiredSize:new o.$u(136,48)}),s(o.s_,"Table",{defaultAlignment:o.z6.Left,margin:2,cursor:"move"},s(o.jE,{column:1,width:4}),s(o.s_,"Horizontal",{defaultAlignment:o.z6.Center},s(o.s_,"Vertical",{contextMenu:t,cursor:"move"},s(o.bn,{name:"SHAPE",strokeWidth:2,stroke:"blue",fill:"lightyellow",cursor:"alias",margin:new o.Zt(1,1,1,1),shadowVisible:!0,desiredSize:new o.$u(48,48)},new o.KX("stroke","strokecolor2"),new o.KX("fill","fillcolor2"),new o.KX("figure","figure"))),s(o.s_,"Table",{contextMenu:t,cursor:"move"},{defaultRowSeparatorStroke:"black",desiredSize:new o.$u(136,60),maxSize:new o.$u(140,66),defaultAlignment:o.z6.Center},s(o.al,x(),{isMultiline:!1,editable:!0,row:0,column:0,columnSpan:6,font:"bold 10pt Segoe UI,sans-serif",minSize:new o.$u(120,36),textAlign:"center",height:46,verticalAlignment:o.z6.Center,margin:new o.Zt(0,2,0,0),name:"name"},new o.KX("text","name").makeTwoWay(),new o.KX("stroke","textcolor").makeTwoWay()),s(o.al,x(),{row:1,column:1,columnSpan:6,editable:!1,isMultiline:!1,margin:new o.Zt(2,0,1,0),alignment:o.z6.Center},new o.KX("text","typename"))))))),w("textAndFigure"),e.add("label",s(o.NB,"Auto",new o.KX("layerName","layer"),new o.KX("deletable"),new o.KX("location","loc",o.E9.parse).makeTwoWay(o.E9.stringify),{contextMenu:t},{selectionObjectName:"SHAPE",resizable:!0,resizeObjectName:"SHAPE"},s(o.bn,{name:"SHAPE",strokeWidth:2,geometryString:"F M0 0 L80 0 B-90 90 80 20 20 20 L100 100 20 100 B90 90 20 80 20 20z",cursor:"alias",margin:new o.Zt(1,1,1,1),shadowVisible:!0,minSize:new o.$u(150,60),desiredSize:new o.$u(150,60),portId:"",toLinkable:!0,toLinkableSelfNode:!1,toLinkableDuplicates:!1},new o.KX("desiredSize","size",o.$u.parse).makeTwoWay(o.$u.stringify),new o.KX("fill","fillcolor"),new o.KX("stroke","strokecolor2")),s(o.bn,"RoundedRectangle",{cursor:"move",fill:"transparent",stroke:"transparent",strokeWidth:10,margin:new o.Zt(1,1,1,1),shadowVisible:!1,desiredSize:new o.$u(136,48)}),s(o.s_,"Table",{defaultAlignment:o.z6.Left,margin:4,cursor:"pointer"},s(o.jE,{column:1,width:4}),s(o.s_,"Horizontal",{defaultAlignment:o.z6.Center},s(o.s_,"Table",{defaultRowSeparatorStroke:"black",defaultAlignment:o.z6.Center},s(o.al,x(),{stretch:o.bx.Fill,alignment:o.z6.Center,isMultiline:!0,editable:!0,font:"bold 10pt Segoe UI,sans-serif",textAlign:"left",wrap:o.al.WrapBreakAll,overflow:o.al.OverflowClip,margin:10,text:"label"},new o.KX("text","text").makeTwoWay())))))),e.add("Annotation",s(o.NB,"Auto",new o.KX("layerName","layer"),new o.KX("deletable"),{contextMenu:t},{background:"transparent",locationSpot:o.z6.Center},new o.KX("location","loc",o.E9.parse).makeTwoWay(o.E9.stringify),s(o.bn,"Annotation",{portId:"",fromLinkable:!0,toLinkable:!0,toLinkableSelfNode:!1,toLinkableDuplicates:!1,cursor:"alias",fromSpot:o.z6.AllSides,strokeWidth:2},new o.KX("fill","fillcolor"),new o.KX("background","fillcolor")),s(o.al,{margin:5,cursor:"move",editable:!0,text:"Annotation",alignment:o.z6.Left,scale:1},new o.KX("text","text").makeTwoWay(),new o.KX("scale","textscale").makeTwoWay(),new o.KX("stroke","strokecolor")))),w("Annotation"),e.add("ActivityNode",s(o.NB,"Spot",new o.KX("layerName","layer"),new o.KX("deletable"),new o.KX("location","loc",o.E9.parse).makeTwoWay(o.E9.stringify),new o.KX("scale","scale1").makeTwoWay(),{contextMenu:t},{toolTip:s(o.uz,"Auto",s(o.bn,{fill:"lightyellow"}),s(o.al,{margin:8},new o.KX("text","",function(e){return i.hM(e,l)})))},{locationObjectName:"SHAPE",locationSpot:o.z6.Center,resizable:!0,resizeObjectName:"PANEL",selectionAdorned:!1},s(o.s_,"Auto",{name:"PANEL",minSize:new o.$u(160,100),desiredSize:new o.$u(160,100)},new o.KX("desiredSize","size",o.$u.parse).makeTwoWay(o.$u.stringify),s(o.s_,"Spot",s(o.bn,"RoundedRectangle",{cursor:"alias",name:"SHAPE",fill:s(o.BD,"Linear",{0:"OldLace",1:"PapayaWhip"}),stroke:"#CDAA7D",parameter1:10,portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new o.KX("fill","fillcolor"),new o.KX("stroke","strokecolor")))),s(o.s_,"Auto",s(o.bn,"Rectangle",{fill:"transparent",stroke:null,strokeWidth:0,cursor:"move",desiredSize:new o.$u(75,50)})),s(o.al,{alignment:o.z6.Center,cursor:"move",textAlign:"center",margin:2,editable:!0},new o.KX("text","name").makeTwoWay()))),w("ActivityNode"),e.add("EventNode",s(o.NB,"Vertical",new o.KX("layerName","layer"),new o.KX("deletable"),new o.KX("location","loc",o.E9.parse).makeTwoWay(o.E9.stringify),{contextMenu:t},{selectionObjectName:"SHAPE",resizable:!0,resizeObjectName:"SHAPE"},{toolTip:s(o.uz,"Auto",s(o.bn,{fill:"lightyellow"}),s(o.al,{margin:8},new o.KX("text","",function(e){let t=i.hM(e,l);return n&&console.log("234 tooltip",t),t})))},s(o.s_,"Spot",s(o.bn,{figure:"Circle",fill:"white",stroke:"blue",strokeWidth:4,cursor:"alias",minSize:new o.$u(60,60),desiredSize:new o.$u(60,60),portId:"",fromLinkable:!0,fromSpot:o.z6.RightSide,toLinkable:!0,toSpot:o.z6.LeftSide,toLinkableSelfNode:!1,toLinkableDuplicates:!1},new o.KX("fill","fillcolor"),new o.KX("stroke","strokecolor")),s(o.bn,{figure:"Circle",fill:"transparent",stroke:"transparent",strokeWidth:1,cursor:"move",minSize:new o.$u(40,40),desiredSize:new o.$u(40,40)})),s(o.al,x(),{margin:0,isMultiline:!0,editable:!0},new o.KX("text","name").makeTwoWay(),new o.KX("stroke","textcolor").makeTwoWay()))),w("EventNode"),e.add("GatewayNode",s(o.NB,"Vertical",new o.KX("layerName","layer"),new o.KX("deletable"),new o.KX("location","loc",o.E9.parse).makeTwoWay(o.E9.stringify),{contextMenu:t},{selectionObjectName:"SHAPE",resizable:!0,resizeObjectName:"SHAPE"},{toolTip:s(o.uz,"Auto",s(o.bn,{fill:"lightyellow"}),s(o.al,{margin:8},new o.KX("text","",function(e){let t=i.hM(e,l);return n&&console.log("234 tooltip",t),t})))},s(o.s_,"Spot",s(o.bn,{figure:"Diamond",stroke:"black",strokeWidth:1,cursor:"alias",minSize:new o.$u(70,70),desiredSize:new o.$u(70,70),portId:"",fromLinkable:!0,toLinkable:!0,fromSpot:o.z6.NotLeftSide,toSpot:o.z6.NotRightSide,toLinkableSelfNode:!0,toLinkableDuplicates:!1},new o.KX("fill","fillcolor"),new o.KX("stroke","strokecolor")),s(o.bn,{cursor:"move",figure:"XLine",fill:"transparent",stroke:"black",strokeWidth:3,minSize:new o.$u(25,25),desiredSize:new o.$u(25,25)},new o.KX("stroke","strokecolor"),new o.KX("figure","figure")),s(o.bn,{figure:"Diamond",fill:"transparent",stroke:"transparent",strokeWidth:1,cursor:"move",minSize:new o.$u(50,50),desiredSize:new o.$u(50,50)})),s(o.al,x(),{margin:-16,isMultiline:!0,editable:!0},new o.KX("text","name").makeTwoWay(),new o.KX("stroke","textcolor").makeTwoWay()))),w("GatewayNode"),e.add("DataObjectNode",s(o.NB,"Vertical",new o.KX("location","loc",o.E9.parse).makeTwoWay(o.E9.stringify),s(o.bn,"File",{name:"SHAPE",portId:"",fromLinkable:!0,toLinkable:!0,cursor:"alias",fill:b,desiredSize:new o.$u(.8*v,v)}),{contextMenu:t},{locationObjectName:"SHAPE",locationSpot:o.z6.Center},{toolTip:s(o.uz,"Auto",s(o.bn,{fill:"lightyellow"}),s(o.al,{margin:8},new o.KX("text","",function(e){let t=i.hM(e,l);return n&&console.log("234 tooltip",t),t})))},{locationObjectName:"SHAPE",locationSpot:o.z6.Center,resizable:!0,resizeObjectName:"PANEL",selectionAdorned:!1},s(o.s_,"Spot",s(o.bn,"Rectangle",{fill:"transparent",stroke:null,strokeWidth:0,cursor:"move",desiredSize:new o.$u(75,5)})),s(o.al,{alignment:o.z6.Center,cursor:"move",textAlign:"center",margin:2,editable:!0},new o.KX("text","name").makeTwoWay()))),w("DataObjectNode"),e.add("DataStoreNode",s(o.NB,"Vertical",{locationObjectName:"SHAPE",locationSpot:o.z6.Center},new o.KX("location","loc",o.E9.parse).makeTwoWay(o.E9.stringify),s(o.bn,"Database",{name:"SHAPE",portId:"",fromLinkable:!0,toLinkable:!0,cursor:"alias",fill:b,desiredSize:new o.$u(v,v)}),{contextMenu:t},{toolTip:s(o.uz,"Auto",s(o.bn,{fill:"lightyellow"}),s(o.al,{margin:8},new o.KX("text","",function(e){let t=i.hM(e,l);return n&&console.log("234 tooltip",t),t})))},s(o.al,{alignment:o.z6.Center,cursor:"move",textAlign:"center",margin:2,editable:!0},new o.KX("text","name").makeTwoWay()),s(o.s_,"Auto",s(o.bn,"Rectangle",{fill:"transparent",stroke:null,strokeWidth:0,cursor:"move",desiredSize:new o.$u(75,5)})))),w("DataStoreNode")}function O(e,t,l){let n=s(o.rU,new o.KX("deletable"),{selectable:!0},{toShortLength:3,relinkableFrom:!0,relinkableTo:!0,reshapable:!0,resegmentable:!0},{routing:o.rU.Normal,corner:10},new o.KX("routing","routing",function(e){return a(e)}),new o.KX("curve","curve",function(e){return r(e)}),new o.KX("points").makeTwoWay(),{contextMenu:t},s(o.bn,{stroke:"black",strokeWidth:1,strokeDashArray:null,shadowVisible:!0},new o.KX("stroke","strokecolor"),new o.KX("strokeWidth","strokewidth"),new o.KX("strokeDashArray","dash",function(e){return N(e)})),s(o.bn,{fromArrow:""},{scale:1.3,fill:""},new o.KX("fromArrow","fromArrow"),new o.KX("fill","fromArrowColor"),new o.KX("stroke","strokecolor"),new o.KX("scale","arrowscale").makeTwoWay()),s(o.bn,{toArrow:""},{scale:1.3,fill:"white"},new o.KX("toArrow","toArrow"),new o.KX("fill","toArrowColor"),new o.KX("stroke","strokecolor"),new o.KX("scale","arrowscale").makeTwoWay()),s(o.al,"",{segmentIndex:NaN,segmentFraction:.15},{segmentOffset:new o.E9(0,10)},new o.KX("text","cardinalityFrom"),new o.KX("scale","textscale").makeTwoWay()),s(o.al,"",{segmentIndex:NaN,segmentFraction:.85},{segmentOffset:new o.E9(0,-10)},new o.KX("text","cardinalityTo"),new o.KX("scale","textscale").makeTwoWay()),s(o.al,"",{isMultiline:!1,editable:!0},{segmentOffset:new o.E9(0,10)},new o.KX("text","name").makeTwoWay(),new o.KX("stroke","textcolor").makeTwoWay(),new o.KX("scale","textscale").makeTwoWay()),{toolTip:s(o.uz,"Auto",{background:"transparent"},s(o.bn,{fill:"#FFFFCC"}),s(o.al,{margin:4},new o.KX("text","",function(e){return i.hZ(e,l)})))});return n}function M(e,t,l){let a=O("",t,l);e.add("linkTemplate1",a),T("linkTemplate1");let r=s(o.rU,new o.KX("deletable"),{contextMenu:t},{selectable:!0},{toShortLength:3,relinkableFrom:!0,relinkableTo:!0,reshapable:!0,resegmentable:!0},{routing:o.rU.AvoidsNodes,curve:o.rU.JumpGap,corner:10,reshapable:!0,relinkableFrom:!0,relinkableTo:!0,toEndSegmentLength:20},new o.KX("points").makeTwoWay(),s(o.bn,{stroke:"black",strokeWidth:1,strokeDashArray:null,shadowVisible:!0},new o.KX("stroke","strokecolor"),new o.KX("strokeWidth","strokewidth"),new o.KX("strokeDashArray","dash",function(e){return N(e)})),s(o.bn,{fromArrow:""},{scale:1.3,fill:""},new o.KX("fromArrow","fromArrow"),new o.KX("fill","fromArrowColor"),new o.KX("stroke","strokecolor"),new o.KX("scale","arrowscale").makeTwoWay()),s(o.bn,{toArrow:""},{scale:1.3,fill:"white"},new o.KX("toArrow","toArrow"),new o.KX("fill","toArrowColor"),new o.KX("stroke","strokecolor"),new o.KX("scale","arrowscale").makeTwoWay()),s(o.al,"",{segmentIndex:NaN,segmentFraction:.15},{segmentOffset:new o.E9(0,10)},new o.KX("text","cardinalityFrom"),new o.KX("scale","textscale").makeTwoWay()),s(o.al,"",{segmentIndex:NaN,segmentFraction:.85},{segmentOffset:new o.E9(0,-10)},new o.KX("text","cardinalityTo"),new o.KX("scale","textscale").makeTwoWay()),new o.KX("segmentOffset","isDefault",function(e){return e?new o.E9(5,0):new o.E9(0,0)}),s(o.al,"",{isMultiline:!0,editable:!0},{segmentOffset:new o.E9(-10,-10)},new o.KX("text","name").makeTwoWay(),new o.KX("stroke","textcolor").makeTwoWay(),new o.KX("scale","textscale").makeTwoWay()),{toolTip:s(o.uz,"Auto",{background:"transparent"},s(o.bn,{fill:"#FFFFCC"}),s(o.al,{margin:4},new o.KX("text","",function(e){return i.hZ(e,l)})))});e.add("linkTemplate2",r),T("linkTemplate2");let d=s(o.rU,{reshapable:!0,relinkableFrom:!0,relinkableTo:!0,fromSpot:o.z6.AllSides,toSpot:o.z6.AllSides,toEndSegmentLength:20,fromEndSegmentLength:40},{contextMenu:t},new o.KX("points").makeTwoWay(),s(o.bn,{stroke:"black",strokeWidth:1,strokeDashArray:[1,3]}),s(o.bn,{toArrow:"OpenTriangle",scale:1,stroke:"black"}),{segmentOffset:new o.E9(-10,-10)},new o.KX("stroke","textcolor").makeTwoWay(),new o.KX("scale","textscale").makeTwoWay());e.add("AnnotationLink",d),T("AnnotationLink"),n&&console.log("1514 linkTemplateMap, linkTemplateNames",e,h)}function D(e,t,l){let n=s(o.ZA,"Auto",new o.KX("location","loc",o.E9.parse).makeTwoWay(o.E9.stringify),new o.KX("visible"),{contextMenu:t},{locationObjectName:"SHAPE",resizable:!0,resizeObjectName:"SHAPE",subGraphExpandedChanged:function(e){var t=e.resizeObject;e.diagram.undoManager.isUndoingRedoing||(e.isSubGraphExpanded?t.fill="white":t.fill="transparent")}},{background:"transparent",ungroupable:!0,mouseDragEnter:function(e,t,l){R(e,t,!0)},mouseDragLeave:function(e,t,l){R(e,t,!1)},computesBoundsAfterDrag:!0,handlesDragDropForMembers:!0},new o.KX("scale","scale1").makeTwoWay(),new o.KX("background","isHighlighted",function(e){return e?"rgba(255,0,0,0.2)":"transparent"}).ofObject(),{toolTip:s(o.uz,"Auto",s(o.bn,{fill:"lightyellow"}),s(o.al,{margin:8},new o.KX("text","",function(e){return i.hM(e,l)})))},s(o.bn,"RoundedRectangle",{cursor:"alias",fill:"transparent",shadowVisible:!0,minSize:new o.$u(150,75),portId:"",fromLinkable:!0,fromLinkableSelfNode:!1,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!1,toLinkableDuplicates:!0},new o.KX("fill","fillcolor"),new o.KX("stroke","strokecolor")),s(o.s_,new o.KX("source","icon",E)),s(o.s_,"Vertical",{name:"HEADER",defaultAlignment:o.z6.TopLeft},s(o.s_,"Horizontal",{defaultAlignment:o.z6.Top},s("SubGraphExpanderButton",{margin:new o.Zt(1,2,1,4),scale:1.5}),s(o.al,{font:"Bold 16pt Sans-Serif",margin:new o.Zt(4,0,0,2),editable:!0,isMultiline:!1,name:"name"},new o.KX("fill","fillcolor"),new o.KX("text","name").makeTwoWay(),new o.KX("stroke","textcolor").makeTwoWay()),s(o.al,{row:1,column:1,columnSpan:6,textAlign:"end",editable:!1,isMultiline:!1,minSize:new o.$u(10,4),margin:new o.Zt(2,0,0,2)})),s(o.bn,{name:"SHAPE",fill:"white",opacity:.95,minSize:new o.$u(150,75),margin:new o.Zt(0,1,1,4),cursor:"move"},new o.KX("desiredSize","size",o.$u.parse).makeTwoWay(o.$u.stringify),new o.KX("isSubGraphExpanded").makeTwoWay())));e.add("",n),e.add("Container1",n),j("Container1");{let a=s(o.ZA,"Auto",new o.KX("location","loc",o.E9.parse).makeTwoWay(o.E9.stringify),new o.KX("visible"),{contextMenu:t},{locationObjectName:"SHAPE",resizable:!0,resizeObjectName:"SHAPE",subGraphExpandedChanged:function(e){var t=e.resizeObject;e.diagram.undoManager.isUndoingRedoing||(e.isSubGraphExpanded?t.fill="lightyellow":t.fill="transparent")}},{background:"transparent",ungroupable:!0,mouseDragEnter:function(e,t,l){R(e,t,!0)},mouseDragLeave:function(e,t,l){R(e,t,!1)},computesBoundsAfterDrag:!0,handlesDragDropForMembers:!0},new o.KX("scale","scale1").makeTwoWay(),new o.KX("background","isHighlighted",function(e){return e?"rgba(255,0,0,0.2)":"transparent"}).ofObject(),{toolTip:s(o.uz,"Auto",s(o.bn,{fill:"lightyellow"}),s(o.al,{margin:8},new o.KX("text","",function(e){return i.hM(e,l)})))},s(o.bn,"RoundedRectangle",{cursor:"alias",fill:"transparent",shadowVisible:!0,minSize:new o.$u(150,75),portId:"",fromLinkable:!0,fromLinkableSelfNode:!1,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!1,toLinkableDuplicates:!0},new o.KX("fill","fillcolor"),new o.KX("stroke","strokecolor")),s(o.s_,"Vertical",{name:"HEADER",defaultAlignment:o.z6.TopLeft},s(o.s_,"Horizontal",{defaultAlignment:o.z6.Top},s("SubGraphExpanderButton",{margin:new o.Zt(1,2,1,4),scale:1.5}),s(o.al,{font:"Bold 16pt Sans-Serif",margin:new o.Zt(4,0,0,2),editable:!0,isMultiline:!1,name:"name"},new o.KX("fill","fillcolor"),new o.KX("text","name").makeTwoWay(),new o.KX("stroke","textcolor").makeTwoWay())),s(o.bn,{name:"SHAPE",fill:"lightyellow",opacity:.95,minSize:new o.$u(150,75),margin:new o.Zt(0,1,1,4),cursor:"move"},new o.KX("desiredSize","size",o.$u.parse).makeTwoWay(o.$u.stringify),new o.KX("isSubGraphExpanded").makeTwoWay())));e.add("Container2",a),j("Container2")}{let r=s(o.ZA,"Auto",new o.KX("location","loc",o.E9.parse).makeTwoWay(o.E9.stringify),new o.KX("visible"),{contextMenu:t},{locationObjectName:"SHAPE",resizable:!0,resizeObjectName:"SHAPE",subGraphExpandedChanged:function(e){var t=e.resizeObject;e.diagram.undoManager.isUndoingRedoing||(e.isSubGraphExpanded?t.fill="lightyellow":t.fill="transparent")}},{background:"transparent",ungroupable:!0,mouseDragEnter:function(e,t,l){R(e,t,!0)},mouseDragLeave:function(e,t,l){R(e,t,!1)},computesBoundsAfterDrag:!0,handlesDragDropForMembers:!0},new o.KX("scale","scale1").makeTwoWay(),new o.KX("background","isHighlighted",function(e){return e?"rgba(255,0,0,0.2)":"transparent"}).ofObject(),{toolTip:s(o.uz,"Auto",s(o.bn,{fill:"lightyellow"}),s(o.al,{margin:8},new o.KX("text","",function(e){return i.hM(e,l)})))},s(o.bn,"RoundedRectangle",{cursor:"alias",fill:"transparent",shadowVisible:!0,minSize:new o.$u(150,75),portId:"",fromLinkable:!0,fromLinkableSelfNode:!1,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!1,toLinkableDuplicates:!0},new o.KX("fill","fillcolor"),new o.KX("stroke","strokecolor")),s(o.s_,"Vertical",{name:"HEADER",defaultAlignment:o.z6.TopLeft},s(o.s_,"Horizontal",{defaultAlignment:o.z6.Top},s(o.al,{font:"Bold 16pt Sans-Serif",margin:new o.Zt(4,0,0,2),editable:!0,isMultiline:!1,name:"name"},new o.KX("fill","fillcolor"),new o.KX("text","name").makeTwoWay(),new o.KX("stroke","textcolor").makeTwoWay())),s(o.bn,{name:"SHAPE",fill:"lightyellow",opacity:.95,minSize:new o.$u(150,75),margin:new o.Zt(0,1,1,4),cursor:"move",stroke:"transparent"},new o.KX("fill","fillcolor"),new o.KX("desiredSize","size",o.$u.parse).makeTwoWay(o.$u.stringify),new o.KX("isSubGraphExpanded").makeTwoWay())));e.add("Container3",r),j("Container3")}}function E(e){if(n&&console.log("2561 findImage: "+e),!e)return"";if(e.includes("//"))return n&&console.log("2563 Diagram",e),e;if(e.includes("/"))return n&&console.log("2566 Diagram",e),e;if(!1===e.includes(".")){let t=e.substring(0,1),l=e.substring(1,2);n&&console.log("2571 Diagram",t,l)}else{if(!e.includes("<svg"))return n&&console.log("2586 Diagram",e),"./../images/"+e;let o={image:"data:image/svg+xml;charset=UTF-8,image"};return n&&console.log("2585",o),o}return""}function x(){return{font:"9pt  Segoe UI,sans-serif",stroke:"black"}}function R(e,t,l){if(t){if(e.handled=!0,l){var o=t.diagram.toolManager.draggingTool,i=o.draggedParts||o.copiedParts;if(t.canAddMembers(i.toKeySet())){t.isHighlighted=!0;return}}t.isHighlighted=!1}}function N(e){let t=[3,3],l=[5,5];switch(e){case"dotted":case"Dotted":case"Dotted Line":return t;case"dashed":case"Dashed":case"Dashed Line":return l;default:return null}}},3165:function(e,t,l){"use strict";l.r(t),l.d(t,{S4:function(){return h},camelize:function(){return f},capitalizeFirstLetter:function(){return y},compare:function(){return w},createGuid:function(){return u},delay:function(){return T},findFromObjects:function(){return E},findObjectByName:function(){return M},findObjectByTitle:function(){return D},findObjectsByType:function(){return O},findRelshipByFromIdToIdAndType:function(){return A},findRelshipByToIdAndType:function(){return N},findToObjects:function(){return x},findTopLevelObject:function(){return R},getIntersection:function(){return g},getShowAdminModel:function(){return a},isAdminType:function(){return r},isArrayEmpty:function(){return d},isNumeric:function(){return j},nameExistsInNames:function(){return c},objExists:function(){return p},readKeyValueArrays:function(){return k},removeArrayDuplicates:function(){return b},removeElementFromArray:function(){return m},toggleAdminModel:function(){return s},uncapitalizeFirstLetter:function(){return v}});let o=!1,i=l(2586),n=!1;function s(){return n=!n}function a(){return n}function r(e){return e.name===i.admin.AKM_PROJECT||e.name===i.admin.AKM_METAMODEL||e.name===i.admin.AKM_MODEL||e.name===i.admin.AKM_MODELVIEW}let d=e=>{let t=!1;return null==e?t=!0:0==e.length&&(t=!0),t},c=(e,t)=>{for(let l=0;l<e.length;l++){let o=e[l];if(o===t)return!0}return!1},p=e=>{let t=!0;return null==e?t=!1:""===e&&(t=!1),t},h=()=>((1+Math.random())*65536|0).toString(16).substring(1),u=()=>(h()+h()+"-"+h()+"-4"+h().substr(0,3)+"-"+h()+"-"+h()+h()+h()).toLowerCase(),m=(e,t)=>{for(let l=0;l<e.length;l++){let o=e[l];if(p(o)){let i=null==o?void 0:o.id;if(i||(i=null==o?void 0:o.key),i===t){e.splice(l,1);break}}}};function g(e,t){let l=new Set(e),o=new Set(t),i=[...l].filter(e=>o.has(e));return i}function f(e){return null==e?void 0:e.replace(/\W+(.)/g,function(e,t){return t.toUpperCase()})}function y(e){return(null==e?void 0:e.charAt(0).toUpperCase())+(null==e?void 0:e.slice(1))}function v(e){return(null==e?void 0:e.charAt(0).toLowerCase())+(null==e?void 0:e.slice(1))}function b(e){let t=new Set(e),l=[...t];return l}function w(e,t){return e.name<t.name?-1:e.name>t.name?1:0}function j(e){return"number"==typeof e}function T(e){return new Promise(t=>setTimeout(t,e))}let k=e=>{let t=e;d(t)||t.forEach(function(e){Object.keys(e).forEach(function(t){console.log("key: "+t+" value "+e[t]);let l=t,o=e[t];console.log(l+": "+o)})})};function O(e,t,l){let i=t.find(e=>e.name===l&&e);return o&&console.log("109 ",t,e,l,i.id),o&&console.log("111 ",t.filter(e=>e.name===l&&e),e.filter(e=>e.typeRef===i.id&&e)),e.filter(e=>e.typeRef===(null==i?void 0:i.id)&&e)}function M(e,t,l){return e.find(e=>e.name===l&&e)}function D(e,t,l){return e.find(e=>e.name===l&&e)}function E(e,t,l){o&&console.log("120 findFromObjects",e,t,l);let i=null==l?void 0:l.map(e=>null==t?void 0:t.find(t=>t.id===e.fromobjectRef));return o&&console.log("124 ",l,i),i}function x(e,t,l){o&&console.log("120 findToObjects",e,t,l);let i=null==l?void 0:l.map(e=>null==t?void 0:t.find(t=>t.id===e.toobjectRef));return o&&console.log("124 ",l,i),i}function R(e,t,l,i){o&&console.log("133 ",e.name);let n=null==i?void 0:i.filter(t=>t.toobjectRef===e.id&&t),s=null==l?void 0:l.find(e=>{var t;return e.id===(null===(t=n[0])||void 0===t?void 0:t.fromobjectRef)});o&&console.log("135 ",s,n,n[0]);let a=null==i?void 0:i.filter(e=>e.toobjectRef===(null==s?void 0:s.id)&&e);o&&console.log("139 ",a);let r=a[0]&&(null==l?void 0:l.find(e=>e.id===a[0].fromobjectRef)),d=s||r;return o&&console.log("140 ",s,r,d),d}function N(e,t,l){o&&console.log("151 ",e,t,l);let i=t?null==e?void 0:e.find(e=>e.toobjectRef===t&&e.typeRef===l):null;return i}function A(e,t,l){o&&console.log("151 ",e,t,l);let i=t&&fromObjId?null==e?void 0:e.find(e=>e.fromobjectRef===fromObjId&&e.toobjectRef===t&&e.typeRef===l):null;return i}},5854:function(e,t,l){"use strict";l.r(t),l.d(t,{viewkinds:function(){return o}});let o={OBJ:"Object",AKM:"AkmObject",CONT:"Container",TREE:"Tree",IMAGE:"Image",REL:"Relationship"}},843:function(e,t,l){"use strict";l.d(t,{sY:function(){return i},xZ:function(){return n}});var o=l(5893);let i=()=>[{value:"https://img.icons8.com/color/2x/object.png",label:"Object"},{value:"https://img.icons8.com/clouds/2x/services.png",label:"Services"},{value:"https://img.icons8.com/color/2x/important-property.png",label:"Important-property"},{value:"https://img.icons8.com/color/2x/urgent-property.png",label:"Urgent-property"},{value:"https://img.icons8.com/color/2x/add-property-1.png",label:"Property"},{value:"https://img.icons8.com/color/2x/information.png",label:"Info"},{value:"https://img.icons8.com/color/2x/admin-settings-male.png",label:"Role"},{value:"https://img.icons8.com/color/2x/task.png",label:"Task"},{value:"https://img.icons8.com/color/2x/view-file.png",label:"View"},{value:"https://img.icons8.com/cotton/72/tear-off-calendar.png",label:"Event"},{value:"https://img.icons8.com/color/2x/rules-book.png",label:"Rule"},{value:"https://img.icons8.com/color/2x/approve.png",label:"Decision"},{value:"https://img.icons8.com/color/2x/energy-meter.png",label:"Unittype"},{value:"https://img.icons8.com/color/2x/data-.png",label:"Datatype"},{value:"https://img.icons8.com/color/2x/variable.png",label:"Datavalue"},{value:"https://img.icons8.com/color/2x/person-male.png",label:"Person"},{value:"https://img.icons8.com/color/search",label:"Search"},{value:"analyse.png",label:"Analyse.png"},{value:"automated.jfif",label:"Inclusive.png"},{value:"book.png",label:"Book.png"},{value:"carpark.png",label:"Carpark.png"},{value:"car.png",label:"Car.png"},{value:"default.png",label:"Default.png"},{value:"E-Scooter.png",label:"E-Scooter.png"},{value:"exclusive.png",label:"Exclusive.png"},{value:"inclusive.png",label:"Inclusive.png"},{value:"info.svg",label:"Info.svg"},{value:"parallel.png",label:"Parallel.png"},{value:"task1.jfif",label:"Task1.jfif"},{value:"tiger.svg",label:"tiger.svg"},{value:"file-earmark-image.svg",label:"file-earmark-image.svg"},{value:"bug.svg",label:"bug.svg"},{value:"ui-checks.svg",label:"ui-checks.svg"},{value:"youtube.svg",label:"youtube.svg"},{value:"speedometer.svg",label:"speedometer.svg"},{value:"person-square.svg",label:"person-square.svg"},{value:"palette.svg",label:"palette.svg"},{value:"layers.svg",label:"layers.svg"},{value:"inboxes.svg",label:"inboxes.svg"},{value:"house-door.svg",label:"house-door.svg"},{value:"hand-thumbs-up.svg",label:"hands-thumbs-up.svg"},{value:"folder-check.svg",label:"folder-check.svg"},{value:"exclamation-triangle.svg",label:"exclamation-triangle.svg"},{value:"chat-square-text.svg",label:"chat-square-text.svg"},{value:"check-square-fill.svg",label:"check-square-fill.svg"},{value:"check-square.svg",label:"check-square.svg"},{value:"braces.svg",label:"braces.svg"},{value:"bug.svg",label:"bug.svg"},{value:"bullseye.svg",label:"bullseye.svg"}],n=(e,t,l,i,n)=>(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"field d-flex mr-1 float-right",children:[(0,o.jsxs)("label",{className:"label mt-1",htmlFor:"name",children:["icon",(0,o.jsxs)("select",{className:"selectpicker ml-1",value:l,onChange:n,children:[(0,o.jsx)("option",{value:"https://img.icons8.com/color/2x/object.png",children:"Object"}),(0,o.jsx)("option",{value:"https://img.icons8.com/clouds/2x/services.png",children:"Services"}),(0,o.jsx)("option",{value:"https://img.icons8.com/color/2x/important-property.png",children:"Important-property"}),(0,o.jsx)("option",{value:"https://img.icons8.com/color/2x/urgent-property.png",children:"Urgent-property"}),(0,o.jsx)("option",{value:"https://img.icons8.com/color/2x/add-property-1.png",children:"Property"}),(0,o.jsx)("option",{value:"https://img.icons8.com/color/2x/information.png",children:"Info"}),(0,o.jsx)("option",{value:"https://img.icons8.com/color/2x/admin-settings-male.png",children:"Role"}),(0,o.jsx)("option",{value:"https://img.icons8.com/color/2x/task.png",children:"Task"}),(0,o.jsx)("option",{value:"https://img.icons8.com/color/2x/view-file.png",children:"View"}),(0,o.jsx)("option",{value:"https://img.icons8.com/cotton/72/tear-off-calendar.png",children:"Event"}),(0,o.jsx)("option",{value:"https://img.icons8.com/color/2x/rules-book.png",children:"Rule"}),(0,o.jsx)("option",{value:"https://img.icons8.com/color/2x/approve.png",children:"Decision"}),(0,o.jsx)("option",{value:"https://img.icons8.com/color/2x/energy-meter.png",children:"Unittype"}),(0,o.jsx)("option",{value:"https://img.icons8.com/color/2x/data-.png",children:"Datatype"}),(0,o.jsx)("option",{value:"https://img.icons8.com/color/2x/variable.png",children:"Datavalue"}),(0,o.jsx)("option",{value:"https://img.icons8.com/color/2x/person-male.png",children:"Person"}),(0,o.jsx)("option",{value:"https://img.icons8.com/color/search",children:"Search"}),(0,o.jsx)("option",{value:"analyse.png",children:"Analyse.png"}),(0,o.jsx)("option",{value:"automated.jfif",children:"Inclusive.png"}),(0,o.jsx)("option",{value:"book.png",children:"Book.png"}),(0,o.jsx)("option",{value:"car.png",children:"Car.png"}),(0,o.jsx)("option",{value:"default.png",children:"Default.png"}),(0,o.jsx)("option",{value:"exclusive.png",children:"Exclusive.png"}),(0,o.jsx)("option",{value:"inclusive.png",children:"Inclusive.png"}),(0,o.jsx)("option",{value:"info.svg",children:"Info.svg"}),(0,o.jsx)("option",{value:"parallel.png",children:"Parallel.png"}),(0,o.jsx)("option",{value:"task1.jfif",children:"Task1.jfif"}),(0,o.jsx)("option",{value:"tiger.svg",children:"tiger.svg"})]})," Url :"]}),(0,o.jsx)("input",{className:"input pt-0 mt-1 mb-3",style:{width:"360px"},onChange:n,type:"text",id:"".concat(e.id,"+").concat(t),name:"".concat(t),value:l,ref:i({required:!1})})]},e.id+t)})},8753:function(){"use strict";function e(){go.Link.call(this),this.layerName="Background",this._base=10}go.Diagram.inherit(e,go.Link),e.prototype.cloneProtected=function(e){go.Link.prototype.cloneProtected.call(this,e),e._base=this._base},Object.defineProperty(e.prototype,"base",{get:function(){return this._base},set:function(e){this._base=e}}),e.prototype.makeGeometry=function(){var e=this.fromNode.actualBounds,t=this.toNode.actualBounds,l=this.pointsCount,o=e.center,i=this.getPoint(l-1);e.intersectsRect(t)&&(i=t.center);var n=this.routeBounds,s=i.directionPoint(o),a=new go.Point(this.base,0).rotate(s-90).add(o),r=new go.Point(this.base,0).rotate(s+90).add(o);this.getLinkPointFromPoint(this.fromNode,this.fromNode,a,i,!0,a),this.getLinkPointFromPoint(this.fromNode,this.fromNode,r,i,!0,r);var d=new go.PathFigure(i.x-n.x,i.y-n.y,!0);d.add(new go.PathSegment(go.PathSegment.Line,r.x-n.x,r.y-n.y));var c=0;return a.y>=e.bottom||r.y>=e.bottom?c=2:a.x<=e.x&&r.x<=e.x?c=1:a.x>=e.right&&r.x>=e.right&&(c=3),this.pathToCorner(c,e,d,n,a,r),this.pathToCorner(c+1,e,d,n,a,r),this.pathToCorner(c+2,e,d,n,a,r),this.pathToCorner(c+3,e,d,n,a,r),d.add(new go.PathSegment(go.PathSegment.Line,a.x-n.x,a.y-n.y).close()),new go.Geometry().add(d)},e.prototype.pathToCorner=function(e,t,l,o,i,n){switch(e%4){case 0:i.y<=t.y&&n.x<=t.x||l.add(new go.PathSegment(go.PathSegment.Line,t.x-o.x,t.y-o.y));break;case 1:i.x<=t.x&&n.y>=t.bottom||l.add(new go.PathSegment(go.PathSegment.Line,t.x-o.x,t.bottom-o.y));break;case 2:i.y>=t.bottom&&n.x>=t.right||l.add(new go.PathSegment(go.PathSegment.Line,t.right-o.x,t.bottom-o.y));break;case 3:i.x>=t.right&&n.y<=t.y||l.add(new go.PathSegment(go.PathSegment.Line,t.right-o.x,t.y-o.y))}}},162:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return DiagramWrapper}});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5893),styled_jsx_style__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1857),styled_jsx_style__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(styled_jsx_style__WEBPACK_IMPORTED_MODULE_1__),gojs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(715),immer__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(2902),gojs_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(8726),react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(7294),react_select__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(7896),react_select__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(8692),reactstrap__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(6571),reactstrap__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(7975),reactstrap__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(2701),reactstrap__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(684),reactstrap__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(6396),reactstrap__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(3999),reactstrap__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(8008),reactstrap__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(7243),reactstrap__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(9393),reactstrap__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(8829),classnames__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(4184),classnames__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_5__),_components_SelectionInspector__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(8809),_akmm_metamodeller__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(8749),_akmm_ui_gojs__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(6680),_akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(137),_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(6433),_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(6575),_akmm_ui_modal__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(5506),_akmm_ui_templates__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(3327),_akmm_ui_methods__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(9803),_akmm_ui_generateTypes__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(2706),_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(3165),_akmm_constants__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(2586),_forms_selectIcons__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(843),_BalloonLink_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(8753),_BalloonLink_js__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(_BalloonLink_js__WEBPACK_IMPORTED_MODULE_19__);let debug=!1,linkToLink=!1,printf=__webpack_require__(5523),RegexParser=__webpack_require__(9350),AllowTopLevel=!0;class DiagramWrapper extends react__WEBPACK_IMPORTED_MODULE_4__.Component{componentDidMount(){var e,t;if(!this.diagramRef.current)return;let l=null===(e=this.diagramRef)||void 0===e?void 0:null===(t=e.current)||void 0===t?void 0:t.getDiagram();l instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.S0&&(l.addDiagramListener("TextEdited",this.props.onDiagramEvent),l.addDiagramListener("SelectionMoved",this.props.onDiagramEvent),l.addDiagramListener("SelectionCopied",this.props.onDiagramEvent),l.addDiagramListener("SelectionDeleting",this.props.onDiagramEvent),l.addDiagramListener("ExternalObjectsDropped",this.props.onDiagramEvent),l.addDiagramListener("LinkDrawn",this.props.onDiagramEvent),l.addDiagramListener("LinkRelinked",this.props.onDiagramEvent),l.addDiagramListener("LinkReshaped",this.props.onDiagramEvent),l.addDiagramListener("SelectionDeleted",this.props.onDiagramEvent),l.addDiagramListener("ClipboardChanged",this.props.onDiagramEvent),l.addDiagramListener("ClipboardPasted",this.props.onDiagramEvent),l.addDiagramListener("ObjectSingleClicked",this.props.onDiagramEvent),l.addDiagramListener("ObjectDoubleClicked",this.props.onDiagramEvent),l.addDiagramListener("ObjectContextClicked",this.props.onDiagramEvent),l.addDiagramListener("PartResized",this.props.onDiagramEvent),l.addDiagramListener("BackgroundSingleClicked",this.props.onDiagramEvent),l.addDiagramListener("BackgroundDoubleClicked",this.props.onDiagramEvent),l.addModelChangedListener(this.props.onModelChange))}componentWillUnmount(){if(!this.diagramRef.current)return;let e=this.diagramRef.current.getDiagram();e instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.S0&&(e.removeDiagramListener("TextEdited",this.props.onDiagramEvent),e.removeDiagramListener("SelectionMoved",this.props.onDiagramEvent),e.removeDiagramListener("SelectionCopied",this.props.onDiagramEvent),e.removeDiagramListener("SelectionDeleting",this.props.onDiagramEvent),e.removeDiagramListener("ExternalObjectsDropped",this.props.onDiagramEvent),e.removeDiagramListener("LinkDrawn",this.props.onDiagramEvent),e.removeDiagramListener("LinkRelinked",this.props.onDiagramEvent),e.removeDiagramListener("LinkReshaped",this.props.onDiagramEvent),e.removeDiagramListener("SelectionDeleted",this.props.onDiagramEvent),e.removeDiagramListener("ClipboardChanged",this.props.onDiagramEvent),e.removeDiagramListener("ClipboardPasted",this.props.onDiagramEvent),e.removeDiagramListener("ObjectSingleClicked",this.props.onDiagramEvent),e.removeDiagramListener("ObjectDoubleClicked",this.props.onDiagramEvent),e.removeDiagramListener("ObjectContextClicked",this.props.onDiagramEvent),e.removeDiagramListener("PartResized",this.props.onDiagramEvent),e.removeDiagramListener("BackgroundDoubleClicked",this.props.onDiagramEvent),e.removeDiagramListener("BackgroundSingleClicked",this.props.onDiagramEvent),e.removeChangedListener(this.props.onModelChange))}handleOpenModal(e,t){this.setState({selectedData:e,modalContext:t,selectedOption:null,showModal:!0,currentActiveTab:"0"}),debug&&console.log("181 this.state",this.state)}handleCloseModal(e){let t=this.state.modalContext;debug&&console.log("218 modalContext:",t);let l=t.myDiagram,o=t.data;if(debug&&console.log("221 state",o),"x"===e){debug&&console.log("223 x:",e);let i=t.links;for(let n=0;n<(null==i?void 0:i.length);n++){let s=i[n];l.model.removeLinkData(s)}this.setState({showModal:!1,selectedData:null,modalContext:null});return}let a=this.props;debug&&console.log("233 state",this.state),"Connect to Selected"===t.case&&(t.what="connectToSelected"),_akmm_ui_modal__WEBPACK_IMPORTED_MODULE_12__.HS(this.state.selectedData,a,t),this.setState({showModal:!1})}handleInputChange(e,t,l){debug&&console.log("215 Diagram: props, value, isBlur: ",e,t,l);let o=e.id;e.type;let i=e.obj,n=e.context;e.pattern,debug&&console.log("221 propname, value, obj, context, isBlur:",o,t,i,n,l),debug&&console.log("222 this.state",this.state),debug&&console.log("223 obj",i),this.setState((0,immer__WEBPACK_IMPORTED_MODULE_20__.Uy)(e=>{let n=e.selectedData;if(debug&&console.log("227 data",n,this),n[o]=t,debug&&console.log("233 data, value, isBlur: ",n[o],t,l),l){let s=n.key;if(debug&&console.log("236 key",s),i.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let a=this.mapNodeKeyIdx.get(s);void 0!==a&&(e.nodeDataArray[a]=n,e.skipsDiagramUpdate=!1)}if(i.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP){let r=this.mapLinkKeyIdx.get(s);void 0!==r&&(e.linkDataArray[r]=n,e.skipsDiagramUpdate=!1)}if(i.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECTTYPE){let d=this.mapNodeKeyIdx.get(s);void 0!==d&&(e.nodeDataArray[d]=n,e.skipsDiagramUpdate=!1)}if(i.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELSHIPTYPE){let c=this.mapLinkKeyIdx.get(s);void 0!==c&&(e.linkDataArray[c]=n,e.skipsDiagramUpdate=!1)}}})),debug&&console.log("268 obj, context",i,n),debug&&console.log("269 Diagram: props, propname, value, isBlur:",e,o,t,l),_akmm_ui_modal__WEBPACK_IMPORTED_MODULE_12__.jC(this.myMetis,e,t)}initDiagram(){let myDiagram;gojs__WEBPACK_IMPORTED_MODULE_2__.S0.licenseKey="73f944e5b16131b700ca0d2b113f69ee1bb37b609e861ea35e5141a3ef5f68402bc9ec7e03d48f95d4ff4ffd1d74c6db8ec66d7cc34d0639e039da8c16e782aee13773b1150b42ddf40a71c18bea2cf5ac7071f295e023abd87e8dfae2a1c79d55bcf7d44cc80eb92e7d0463057cab4fe4a9da2cfe57c44c797d9ef2aaefaf1baa6d65949de5548bf0516edd",debug&&console.log("282 this",this),null===(_this_diagramRef_current=this.diagramRef.current)||void 0===_this_diagramRef_current||_this_diagramRef_current.clear();let $=gojs__WEBPACK_IMPORTED_MODULE_2__.bx.make,defPattern="",myMetis=this.myMetis;function nodeInfo(e){return _akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.hM(e,myMetis)}function linkInfo(e){return _akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.hZ(e,myMetis)}function diagramInfo(e){return _akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.iC(e)}myMetis&&(myMetis.deleteViewsOnly=!1,myMetis.pasteViewsOnly=!1),myDiagram=$(gojs__WEBPACK_IMPORTED_MODULE_2__.S0,{initialContentAlignment:gojs__WEBPACK_IMPORTED_MODULE_2__.z6.Center,initialAutoScale:gojs__WEBPACK_IMPORTED_MODULE_2__.S0.Uniform,"contextMenuTool.standardMouseSelect":function(){this.diagram.lastInput.shift=!0,gojs__WEBPACK_IMPORTED_MODULE_2__.zE.prototype.standardMouseSelect.call(this)},"toolManager.mouseWheelBehavior":gojs__WEBPACK_IMPORTED_MODULE_2__.ku.WheelZoom,scrollMode:gojs__WEBPACK_IMPORTED_MODULE_2__.S0.InfiniteScroll,LinkDrawn:maybeChangeLinkCategory,LinkRelinked:maybeChangeLinkCategory,"draggingTool.isGridSnapEnabled":!0,"linkingTool.portGravity":0,"linkingTool.archetypeLinkData":{key:_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.createGuid(),category:"Relationship",type:_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_GENERIC_REL,name:"",description:"",relshipkind:_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.relkinds.REL},"linkingTool.isUnconnectedLinkValid":!1,"relinkingTool.isUnconnectedLinkValid":!1,"relinkingTool.portGravity":20,"relinkingTool.fromHandleArchetype":$(gojs__WEBPACK_IMPORTED_MODULE_2__.bn,"Diamond",{segmentIndex:0,cursor:"pointer",desiredSize:new gojs__WEBPACK_IMPORTED_MODULE_2__.$u(8,8),fill:"tomato",stroke:"darkred"}),"relinkingTool.toHandleArchetype":$(gojs__WEBPACK_IMPORTED_MODULE_2__.bn,"Diamond",{segmentIndex:-1,cursor:"pointer",desiredSize:new gojs__WEBPACK_IMPORTED_MODULE_2__.$u(8,8),fill:"darkred",stroke:"tomato"}),"linkReshapingTool.handleArchetype":$(gojs__WEBPACK_IMPORTED_MODULE_2__.bn,"Diamond",{desiredSize:new gojs__WEBPACK_IMPORTED_MODULE_2__.$u(7,7),fill:"lightblue",stroke:"deepskyblue"}),allowDrop:!0,grid:$(gojs__WEBPACK_IMPORTED_MODULE_2__.s_,"Grid",$(gojs__WEBPACK_IMPORTED_MODULE_2__.bn,"LineH",{stroke:"lightgray",strokeWidth:.5}),$(gojs__WEBPACK_IMPORTED_MODULE_2__.bn,"LineH",{stroke:"gray",strokeWidth:.5,interval:10}),$(gojs__WEBPACK_IMPORTED_MODULE_2__.bn,"LineV",{stroke:"lightgray",strokeWidth:.5}),$(gojs__WEBPACK_IMPORTED_MODULE_2__.bn,"LineV",{stroke:"gray",strokeWidth:.5,interval:10})),model:$(gojs__WEBPACK_IMPORTED_MODULE_2__.FJ,{nodeCategoryProperty:"template",linkCategoryProperty:"template",linkLabelKeysProperty:"labelKeys",linkKeyProperty:"key"})}),myDiagram.click=function(e){e.diagram.commit(function(e){e.clearHighlighteds()},"no highlighteds")},myDiagram.myGoModel=this.myGoModel,myDiagram.myGoMetamodel=this.myGoMetamodel,myDiagram.dispatch=null===(_this_myMetis=this.myMetis)||void 0===_this_myMetis?void 0:_this_myMetis.dispatch,myDiagram.handleOpenModal=this.handleOpenModal,myDiagram.handleCloseModal=this.handleCloseModal,myDiagram.selectedOption=this.state.selectedOption,myDiagram.routing=gojs__WEBPACK_IMPORTED_MODULE_2__.rU.Normal,myDiagram.state=this.state,myDiagram.toolTip=$("ToolTip",{margin:4},$(gojs__WEBPACK_IMPORTED_MODULE_2__.al,new gojs__WEBPACK_IMPORTED_MODULE_2__.KX("text","",diagramInfo),{font:"bold arial 72px sans-serif"})),myDiagram.grid.visible=!0,myDiagram.toolManager.draggingTool.isGridSnapEnabled=!0,myDiagram.toolManager.resizingTool.isGridSnapEnabled=!0,myMetis.myDiagram=myDiagram,(null===(_myMetis_currentModelview=myMetis.currentModelview)||void 0===_myMetis_currentModelview?void 0:_myMetis_currentModelview.name)===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.admin.AKM_ADMIN_MODELVIEW&&setLayout(myDiagram,null===(_myMetis_currentModelview=myMetis.currentModelview)||void 0===_myMetis_currentModelview?void 0:_myMetis_currentModelview.layout);var _this_diagramRef_current,_this_myMetis,_myMetis_currentModelview,partContextMenu=$(gojs__WEBPACK_IMPORTED_MODULE_2__.uz,"Vertical",makeButton("Copy",function(e,t){let l=e.diagram.selection;debug&&console.log("420 selection",l);let o=[];for(let i=l.iterator;null==i?void 0:i.next();){let n=i.value;n instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.NB&&n&&(debug&&console.log("425 n.data",n.data),addFromNode(o,n))}debug&&console.log("430 myFromNodes",o);let s=myMetis.currentModel;s.args1=o;let a=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.qf(s,!0),r=[];r.push(a),r.map(t=>{let l=t;l=JSON.parse(JSON.stringify(l)),e.diagram.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:l})}),l=[],e.diagram.selection.each(function(e){let t=e.data.key;e.data.fromNode=getFromNode(o,t),debug&&console.log("457 sel.data",e.data),l.push(e.data)}),myMetis.currentSelection=l,debug&&console.log("438 myMetis",myMetis),e.diagram.commandHandler.copySelection()},function(e){let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT)return e.diagram.commandHandler.canCopySelection()}),makeButton("Paste",function(e,t){debug&&console.log("473 myMetis",myMetis),myMetis.currentModel,myMetis.pasteViewsOnly=!1;let l=e.diagram.toolManager.contextMenuTool.mouseDownPoint;e.diagram.commandHandler.pasteSelection(l)},function(e){return e.diagram.commandHandler.canPasteSelection()}),makeButton("Paste View",function(e,t){debug&&console.log("484 myMetis",myMetis),myMetis.currentModel,myMetis.pasteViewsOnly=!0;let l=e.diagram.toolManager.contextMenuTool.mouseDownPoint;e.diagram.commandHandler.pasteSelection(l),debug&&console.log("560 Paste View",myMetis)},function(e){return e.diagram.commandHandler.canPasteSelection()}),makeButton("----------"),makeButton("Edit Attribute",function(e,t){let l=t.part.data;if(l.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let o=l.object;if(!o)return;o=myMetis.findObject(o.id);let i=null==o?void 0:o.type;if(i){let n=[];n.push("description"),"ViewFormat"===i.name&&n.push("viewFormat"),"InputPattern"===i.name&&n.push("inputPattern");let s=i.properties;for(let a=0;a<(null==s?void 0:s.length);a++){let r=s[a];n.push(r.name)}let d="";n.length>0&&(d=n[0]);let c={what:"selectDropdown",title:"Select Property",case:"Edit Attribute",myDiagram:myDiagram};myMetis.currentNode=l,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(n,c)}}},function(e){return!1}),makeButton("Edit Object",function(e,t){let l=t.part.data;debug&&console.log("529 node",l),_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.Gf(l,myMetis,myDiagram)},function(e){let t=e.part.data;return debug&&console.log("570 node",t),t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT}),makeButton("Edit Objectview",function(e,t){let l=t.part.data;debug&&console.log("542 node",l),_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.pY(l,myMetis,myDiagram)},function(e){let t=e.part.data;return t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT}),makeButton("Connect to Selected",function(e,t){let l=t.part.data,o=l.objecttype;o=myMetis.findObjectType(o.id);let i=[],n=myDiagram.selection;for(let s=n.iterator;null==s?void 0:s.next();){let a=s.value;a.data.key!==l.key&&i.push(a.data)}debug&&console.log("559 node. nodes",l,i),debug&&console.log("560 selection",n);let r=_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.LO(l,n,myMetis,myDiagram),d={fromType:o,nodeFrom:l,nodesTo:i,typeNames:r},c={what:"selectDropdown",title:"Select Relationship Type",case:"Connect to Selected",myDiagram:myDiagram,args:d};myMetis.currentNode=l,myMetis.myDiagram=myDiagram,debug&&console.log("607 modalContext",c),myDiagram.handleOpenModal(l,c)},function(e){let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let l=myDiagram.selection;if(l.count>1)return!0}return!1}),makeButton("Add Connected Objects",function(e,t){let l=t.part.data;_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.HQ(l,myMetis,myDiagram)},function(e){let t=e.part.data;return t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT}),makeButton("Change Icon",function(e,t){let l=e.diagram.selection.first().data,o=(0,_forms_selectIcons__WEBPACK_IMPORTED_MODULE_18__.sY)(),i=o.map(e=>e&&e.label);debug&&console.log("719",i,o);let n={what:"selectDropdown",title:"Select Icon",case:"Change Icon",iconList:(0,_forms_selectIcons__WEBPACK_IMPORTED_MODULE_18__.sY)(),myDiagram:myDiagram};myMetis.currentNode=l,myMetis.myDiagram=myDiagram,debug&&console.log("655 myMetis",myMetis),myDiagram.handleOpenModal(l,n)},function(e){let t=e.part.data;return t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT}),makeButton("Test InputPattern",function(e,t){let l=t.part.data;if(l.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let o=l.object;null==(o=myMetis.findObject(o.id))||o.type;let i=defPattern;if((i=prompt("Enter input pattern",defPattern)).length>0){defPattern=i;let n=new RegexParser(i);console.log("710 regex:",n);let s=prompt("Value to check");console.log("710 regex:",n),n.test(s)?alert("Value: "+s+" IS valid"):alert("Value: "+s+" IS NOT valid")}}},function(e){let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let l=t.object;if(!l)return;l=myMetis.findObject(l.id);let o=null==l?void 0:l.type;if((null==o?void 0:o.name)==="InputPattern"||(null==o?void 0:o.name)==="Datatype")return!0}return!1}),makeButton("Test Eval",function(e,obj){let node=obj.part.data;if(node.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let object=node.object;object=myMetis.findObject(object.id);let context={myMetis:myMetis,reltype:"hasPart",reldir:"out",objtype:null,propname:"Cost"},result=eval('context.reldir === "out"');alert(result)}},function(e){return!1}),makeButton("Cut",function(e,t){e.diagram.commandHandler.cutSelection()},function(e){let t=e.part.data;return t.category!==_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT&&e.diagram.commandHandler.canCutSelection()}),makeButton("Delete",function(e,t){if(confirm("Do you really want to delete the current selection?")){let l=myMetis.gojsModel;myMetis.currentModel,myMetis.deleteViewsOnly=!1,myDiagram.selection.each(function(e){let t=e.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let o=l.findNode(t.key);if(debug&&console.log("1375 node",o),null==o?void 0:o.isGroup){let i=o.getGroupMembers(l);for(let n=0;n<(null==i?void 0:i.length);n++){let s=i[n];myDiagram.findNodeForKey(null==s?void 0:s.key)}}let a=myDiagram.findNodeForKey(null==o?void 0:o.key);a&&a.findLinksConnected().each(function(e){e.isSelected=!0})}if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECTTYPE){let r=myDiagram.findNodeForKey(t.key);r.findLinksConnected().each(function(e){e.isSelected=!0})}}),e.diagram.commandHandler.deleteSelection()}},function(e){return e.diagram.commandHandler.canDeleteSelection()}),makeButton("Delete View",function(e,t){if(confirm("Do you really want to delete the current selection?")){let l=myMetis.currentModel;myMetis.deleteViewsOnly=!0;let o=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.qf(l,!0),i=[];i.push(o),i.map(t=>{let l=t;l=JSON.parse(JSON.stringify(l)),e.diagram.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:l})}),debug&&console.log("603 Delete View",o,myMetis),e.diagram.commandHandler.deleteSelection()}},function(e){let t=e.part.data;return t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT&&e.diagram.commandHandler.canDeleteSelection()}),makeButton("----------"),makeButton("Export Task Model",function(e,t){let l=e.diagram.selection.first().data;_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.Fd(l,myMetis,myDiagram)},function(e){if(debug&&console.log("1991 myMetis",myMetis),"Modelling"==myMetis.modelType){let t=e.part.data,l=t.object,o=null==l?void 0:l.type;return(null==o?void 0:o.name)===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_CONTAINER}}),makeButton("Generate Metamodel",function(e,t){debug&&console.log("1958 obj, myMetis, myDiagram",t,myMetis,myDiagram);let l=e.diagram.selection.first().data;myMetis.currentNode=l,_akmm_ui_generateTypes__WEBPACK_IMPORTED_MODULE_15__.UH(t,myMetis,myDiagram)},function(e){if(debug&&console.log("1991 myMetis",myMetis),"Modelling"!=myMetis.modelType)return!1;{let t=e.part.data.object,l=null==t?void 0:t.type;null==l||l.name,_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_CONTAINER}return!0}),makeButton("Generate Datatype",function(e,t){let l={myMetis:myMetis,myMetamodel:myMetis.currentMetamodel,myTargetMetamodel:myMetis.currentTargetMetamodel,myModel:myMetis.currentModel,myModelview:myMetis.currentModelview,myDiagram:e.diagram,dispatch:e.diagram.dispatch};myMetis.currentTargetMetamodel||(myMetis.currentTargetMetamodel=myMetis.currentMetamodel);let o=t.part,i=o.adornedPart,n=i.data.object;l.myTargetMetamodel=_akmm_ui_generateTypes__WEBPACK_IMPORTED_MODULE_15__.Vw(l,!0),myMetis.currentModel.targetMetamodelRef=l.myTargetMetamodel.id,debug&&console.log("369 Diagram",myMetis.currentModel.targetMetamodelRef);let s=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.qf(l.myModel,!0),a=[];a.push(s),a.map(t=>{let l=t;l=JSON.parse(JSON.stringify(l)),e.diagram.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:l})});let r=_akmm_ui_generateTypes__WEBPACK_IMPORTED_MODULE_15__.Aq(n,l);if(r){let d=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.WN(r),c=[];c.push(d),c.map(t=>{let l=t;l=JSON.parse(JSON.stringify(l)),e.diagram.dispatch({type:"UPDATE_DATATYPE_PROPERTIES",data:l})}),debug&&console.log("467 jsnDatatype",d)}},function(e){let t=e.part.data.object,l=null==t?void 0:t.type;return(null==l?void 0:l.name)===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_DATATYPE}),makeButton("Edit Object Type",function(e,t){let l=t.part.data,o=_akmm_ui_templates__WEBPACK_IMPORTED_MODULE_13__.jw(l.icon),i={what:"editObjectType",title:"Edit Object Type",icon:o,myDiagram:myDiagram};myMetis.currentNode=l,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(l,i)},function(e){let t=e.part.data;return t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECTTYPE}),makeButton("Change Object Type",function(e,t){let l=e.diagram.selection.first().data;l.objecttype,debug&&console.log("273 node",l);let o=myMetis.currentMetamodel,i=o.getObjectTypes();if(debug&&console.log("275 Set object type",i),i){l.choices=[],l.choices.push("Generic");for(let n=0;n<i.length;n++){let s=i[n];if(!s.markedAsDeleted&&!s.abstract){if("Generic"===s.name)continue;l.choices.push(s.name)}}}let a={what:"selectDropdown",title:"Select Object Type",case:"Change Object type",myDiagram:myDiagram};myMetis.currentNode=l,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(l.choices,a),debug&&console.log("511 myMetis",l.choices,myMetis)},function(e){let t=e.part.data;return t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT}),makeButton("Edit Typeview",function(e,t){let l=t.part.data;_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.D9(l,myMetis,myDiagram)},function(e){let t=e.part.data;return t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT||t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECTTYPE}),makeButton("Reset to Typeview",function(e,t){let l=myMetis.gojsModel;myDiagram.selection.each(function(e){let t=e.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let o=l.findNode(t.key);_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.kX(o,myMetis,myDiagram)}})},function(e){let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT)return!0}),makeButton("Change Icon",function(e,t){let l=e.diagram.selection.first().data;debug&&console.log("1503 node",l);let o=(0,_forms_selectIcons__WEBPACK_IMPORTED_MODULE_18__.sY)();o.map(e=>e&&e.label);let i={what:"selectDropdown",title:"Select Icon",case:"Change Icon",iconList:(0,_forms_selectIcons__WEBPACK_IMPORTED_MODULE_18__.sY)(),myDiagram:myDiagram};myMetis.currentNode=l,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(l,i),debug&&console.log("511 myMetis",myMetis)},function(e){let t=e.part.data;return t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECTTYPE}),makeButton("----------"),makeButton("Generate Target Object Type",function(e,t){let l={myMetis:myMetis,myMetamodel:myMetis.currentMetamodel,myTargetMetamodel:myMetis.currentTargetMetamodel,myModel:myMetis.currentModel,myCurrentModelview:myMetis.currentModelview,myDiagram:e.diagram,dispatch:e.diagram.dispatch};debug&&console.log("441 myMetis",myMetis);let o=t.part,i=o.adornedPart;i.data.object,l.myTargetMetamodel=myMetis.currentTargetMetamodel,debug&&console.log("446 context",l),_akmm_ui_generateTypes__WEBPACK_IMPORTED_MODULE_15__.z9(l)},function(e){return e.part.data.object.type.name!==_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_INFORMATION&&!1}),makeButton("----------"),makeButton("Select all objects of this type",function(e,t){var l;let o=t.part.data;debug&&console.log("1400 node",o);let i=myMetis.findObject(null===(l=o.object)||void 0===l?void 0:l.id),n=null==i?void 0:i.type,s=myMetis.currentModel,a=myMetis.gojsModel,r=s.getObjectsByType(n,!1);for(let d=0;d<r.length;d++){let c=r[d];if(c){let p=c.objectviews;if(p)for(let h=0;h<p.length;h++){let u=p[h];if(u){let m=a.findNodeByViewId(null==u?void 0:u.id),g=myDiagram.findNodeForKey(null==m?void 0:m.key);g&&(g.isSelected=!0)}}}}},function(e){return!0}),makeButton("Select connected objects",function(e,t){let l=t.part.data;if(l.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let o=l.object;if(!o)return;o=myMetis.findObject(o.id);let i=[];i.push(o);let n=[],s=new _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_7__.ho(_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.createGuid(),"selectConnected","");s.reltype="",s.reldir="",s.typecondition=null,s.valuecondition=null,s.preaction="",s.postaction="Select",s.propname="";let a={method:s},r={myMetis:myMetis,myModel:myMetis.currentModel,myDiagram:myDiagram,myObject:o,args:a,objects:i,relships:n};s.reldir="in",_akmm_ui_methods__WEBPACK_IMPORTED_MODULE_14__.xw(r),s.reldir="out",_akmm_ui_methods__WEBPACK_IMPORTED_MODULE_14__.xw(r)}},function(e){return!0}),makeButton("Generate osduIds",function(e,t){let l=t.part.data;if(l.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let o=l.object;if(!o)return;o=myMetis.findObject(o.id);let i=new _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_7__.ho(_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.createGuid(),"generateosduId","");i.reldir="out",i.reltype="hasPart",i.typecondition=null,i.valuecondition=null,i.preaction="generateosduId",i.propname="osduId";let n={method:i},s={myMetis:myMetis,myModel:myMetis.currentModel,myDiagram:myDiagram,myObject:o,args:n};_akmm_ui_methods__WEBPACK_IMPORTED_MODULE_14__.xw(s)}},function(e){let t=e.part.data;if(debug&&console.log("1066 node",t),t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let l=t.object,o=l.type;o=myMetis.findObjectType(o.id);let i="osduId";if(debug&&console.log("1070 type",o),o.findPropertyByName2(i,!0))return debug&&console.log("1074 type, propname",o,i),!0}return!1}),makeButton("Execute Method",function(e,t){let l=t.part.data;if(l.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let o=l.object;if(!o)return;o=myMetis.findObject(o.id);let i=[];i.push(o);let n={method:""},s={myMetis:myMetis,myMetamodel:myMetis.currentMetamodel,myObject:o,objects:i,myDiagram:myDiagram,case:"Execute Method",title:"Select Method",dispatch:myDiagram.dispatch,postOperation:_akmm_ui_methods__WEBPACK_IMPORTED_MODULE_14__.xw,args:n};_akmm_ui_methods__WEBPACK_IMPORTED_MODULE_14__.Rb(s)}},function(e){let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){var l;let o=t.object,i=null==o?void 0:null===(l=o.type)||void 0===l?void 0:l.methods;if((null==i?void 0:i.length)>0)return!0}return!1}),makeButton("Undo",function(e,t){e.diagram.commandHandler.undo()},function(e){return e.diagram.commandHandler.canUndo()}),makeButton("Redo",function(e,t){e.diagram.commandHandler.redo()},function(e){return e.diagram.commandHandler.canRedo()}),makeButton("Get My Scale",function(e,t){let l=myMetis.gojsModel,o=t.part.data,i=l.findNode(o.key),n=i.getMyScale(l),s="My Scale is: "+n;alert(s)},function(e){return e.part.data,!1})),linkContextMenu=$(gojs__WEBPACK_IMPORTED_MODULE_2__.uz,"Vertical",makeButton("Edit Relationship",function(e,t){let l=t.part.data,o={what:"editRelationship",title:"Edit Relationship",myDiagram:myDiagram};myMetis.currentLink=l,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(l,o)},function(e){let t=e.part.data;return debug&&console.log("1265 node",t),t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP}),makeButton("Edit Relationship View",function(e,t){let l=t.part.data,o={what:"editRelshipview",title:"Edit Relationship View",myDiagram:myDiagram};myMetis.currentLink=l,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(l,o)},function(e){let t=e.part.data;return t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP}),makeButton("Cut",function(e,t){e.diagram.commandHandler.cutSelection()},function(e){return!1}),makeButton("Delete",function(e,t){confirm("Do you really want to delete the current selection?")&&(myMetis.deleteViewsOnly=!1,e.diagram.commandHandler.deleteSelection())},function(e){return e.diagram.commandHandler.canDeleteSelection()}),makeButton("Delete View",function(e,t){confirm("Do you really want to delete the current selection?")&&(myMetis.deleteViewsOnly=!0,e.diagram.commandHandler.deleteSelection())},function(e){let t=e.part.data;return t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP&&e.diagram.commandHandler.canDeleteSelection()}),makeButton("----------"),makeButton("TEST",function(e,t){e.diagram;let l=t.part;console.log("1157 link",l),console.log("1159 data",l.data)},function(e){return!!debug}),makeButton("New Typeview",function(e,t){let l=t.part.data;if(l.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP){var o,i;let n=myMetis.findRelationship(null===(o=l.relship)||void 0===o?void 0:o.id),s=myMetis.findRelationshipView(null===(i=l.relshipview)||void 0===i?void 0:i.id);if(n&&s){let a=myMetis.currentMetamodel,r=n.type,d=s.typeview,c=r.typeview;if(debug&&console.log("701 link",r,c,d),!d||d.id===c.id){let p=_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.createGuid(),h=r.name+"_"+r.getRelshipKind();(d=new _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_7__.QN(p,h,r,"")).data=c.data,d.data.strokecolor="red",d.nameId=void 0,d.modified=!0,s.typeview=d;let u=d.data;for(let m in console.log("796 viewdata",d.data),d.data)myDiagram.model.setDataProperty(l,m,u[m]);l.typeview=d,myDiagram.requestUpdate(),a.addRelationshipTypeView(d),myMetis.addRelationshipTypeView(d),debug&&console.log("712 myMetis",s,d,myMetis);let g=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.Ug(d);debug&&console.log("715 jsnReltypeView",g);let f=[];f.push(g),f.map(t=>{let l=t;l=JSON.parse(JSON.stringify(l)),e.diagram.dispatch({type:"UPDATE_RELSHIPTYPEVIEW_PROPERTIES",data:l})});let y=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.XB(s);debug&&console.log("723 jsnRelView",y);let v=[];v.push(y),v.map(t=>{let l=t;l=JSON.parse(JSON.stringify(l)),e.diagram.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:l})})}}}},function(e){return!1}),makeButton("Edit Relationship Type",function(e,t){let l=t.part.data;debug&&console.log("1259 link",l);let o={what:"editRelationshipType",title:"Edit Relationship Type",myDiagram:myDiagram};myMetis.currentLink=l,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(l,o)},function(e){let t=e.part.data;return t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELSHIPTYPE}),makeButton("Change Relationship Type",function(e,t){let l=myMetis.gojsModel,o=myMetis.currentModelview,i=o.includeInheritedReltypes,n=t.part.data;debug&&console.log("1440 link",n,myDiagram,l);let s=null==l?void 0:l.findNode(n.from),a=null==l?void 0:l.findNode(n.to);debug&&console.log("1443 from and toNode",s,a);let r=null==s?void 0:s.objecttype,d=null==a?void 0:a.objecttype;r=myMetis.findObjectType(null==r?void 0:r.id),d=myMetis.findObjectType(null==d?void 0:d.id),"Label"===r.name||d.name,debug&&console.log("1449 link",r,d);let c=myMetis.currentMetamodel,p=c.findRelationshipTypesBetweenTypes(r,d,i);if(n.choices=[],debug&&console.log("1456 reltypes, fromType, toType",p,r,d),p){for(let h=0;h<p.length;h++){let u=p[h];u.name!==_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_GENERIC_REL&&n.choices.push(u.name)}let m=_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.removeArrayDuplicates(n.choices);n.choices=m}let g={typeNames:n.choices},f={what:"selectDropdown",title:"Select Relationship Type",case:"Change Relationship type",myDiagram:myDiagram,args:g};myMetis.currentLink=n,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(n.choices,f),debug&&console.log("1478 myMetis",myMetis)},function(e){let t=e.part.data;return t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP}),makeButton("Edit Typeview",function(e,t){let l=t.part.data,o={what:"editTypeview",title:"Edit Typeview",myDiagram:myDiagram};myMetis.currentLink=l,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(l,o)},function(e){{let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP||t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELSHIPTYPE)return!0}return!1}),makeButton("Reset Typeview",function(e,t){let l=t.part.data;if(l.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP){let o=myMetis.findRelationship(l.relship.id),i=myMetis.findRelationshipView(l.relshipview.id);if(o&&i){myMetis.currentMetamodel;let n=o.type,s=i.typeview,a=n.typeview;for(let r in i.typeview=a,debug&&console.log("856 viewdata",s.data),a.data,a.data)myDiagram.model.setDataProperty(l,r,a[r]);l.typeview=a,myDiagram.requestUpdate();let d=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.XB(i);debug&&console.log("798 jsnRelView",d);let c=[];c.push(d),c.map(t=>{let l=t;l=JSON.parse(JSON.stringify(l)),e.diagram.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:l})})}}},function(e){return!1}),makeButton("Edit Attribute",function(e,t){let l=t.part.data;if(l.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP){let o=l.relship,i=null==o?void 0:o.type;if(i){let n=[];n.push("description");let s=i.properties;for(let a=0;a<(null==s?void 0:s.length);a++){let r=s[a];n.push(r.name)}let d="";n.length>0&&(d=n[0]);let c={what:"selectDropdown",title:"Select Attribute",case:"Edit Attribute",myDiagram:myDiagram};myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(n,c)}}else if(l.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELSHIPTYPE){let p=[];p.push("description"),p.push("cardinality");let h="";p.length>0&&(h=p[0]);let u={what:"selectDropdown",title:"Select Attribute",case:"Edit Attribute",myDiagram:myDiagram};myMetis.currentLink=l,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(p,u)}},function(e){return!1}),makeButton("Reset to Typeview",function(e,t){let l=myMetis.gojsModel;myDiagram.selection.each(function(e){let t=e.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP){let o=l.findLink(t.key);_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.kX(o,myMetis,myDiagram)}})},function(e){let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP)return!0}),makeButton("----------"),makeButton("Generate Relationship Type",function(e,t){let l={myMetis:myMetis,myMetamodel:myMetis.currentMetamodel,myTargetMetamodel:myMetis.currentTargetMetamodel,myModel:myMetis.currentModel,myCurrentModelview:myMetis.currentModelview,myDiagram:e.diagram,dispatch:e.diagram.dispatch};debug&&console.log("935 myMetis",myMetis);let o=t.part,i=o.adornedPart,n=i.data.relship;l.myTargetMetamodel=myMetis.currentTargetMetamodel,debug&&console.log("940 context",n,l),_akmm_ui_generateTypes__WEBPACK_IMPORTED_MODULE_15__.z9(l)},function(e){let t=e.part.data.relship,l=t.fromObject,o=t.toObject;return t.type,l.type.name===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_INFORMATION&&(o.type.name===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_INFORMATION||void 0)}),makeButton("----------"),makeButton("Select all views of this relationship",function(e,t){let l=t.part.data,o=myMetis.gojsModel,i=myMetis.findRelationship(l.relship.id),n=i.relshipviews;if(n)for(let s=0;s<n.length;s++){let a=n[s];if(a){let r=o.findLinkByViewId(null==a?void 0:a.id),d=myDiagram.findLinkForKey(null==r?void 0:r.key);d&&(d.isSelected=!0)}}},function(e){let t=e.part.data,l=myMetis.gojsModel,o=myMetis.findRelationship(t.relship.id),i=o.relshipviews;if((null==i?void 0:i.length)>1){let n=0;for(let s=0;s<i.length;s++){let a=i[s];if(a){let r=l.findLinkByViewId(null==a?void 0:a.id);if(r){let d=myDiagram.findLinkForKey(null==r?void 0:r.key);d&&n++}}}if(n>1)return!0}return!1}),makeButton("Select all relationships of this type",function(e,t){let l=t.part.data;debug&&console.log("984 link",l);let o=myMetis.findRelationship(l.relship.id),i=null==o?void 0:o.type,n=myMetis.currentModel,s=myMetis.gojsModel,a=n.getRelationshipsByType(i,!1);for(let r=0;r<a.length;r++){let d=a[r];if(d){let c=d.relshipviews;if(c)for(let p=0;p<c.length;p++){let h=c[p];if(h){let u=s.findLinkByViewId(null==h?void 0:h.id),m=myDiagram.findLinkForKey(null==u?void 0:u.key);m&&(m.isSelected=!0)}}}}},function(e){return!0}),makeButton("Clear Breakpoints",function(e,t){let l=myMetis.gojsModel,o=[];myDiagram.selection.each(function(e){let t=e.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP){let i=l.findLink(t.key),n=myMetis.myDiagram.findLinkForKey(i.key);n.points=[],myDiagram.model.setDataProperty(n,"points",[]);let s=i.relshipview;s.points=[];let a=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.XB(s);o.push(a)}}),o.map(t=>{let l=t;l=JSON.parse(JSON.stringify(l)),e.diagram.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:l})})},function(e){let t=e.part.data;return!!t.points}),makeButton("Undo",function(e,t){e.diagram.commandHandler.undo()},function(e){return e.diagram.commandHandler.canUndo()}),makeButton("Redo",function(e,t){e.diagram.commandHandler.redo()},function(e){return e.diagram.commandHandler.canRedo()}));myDiagram.contextMenu=$(gojs__WEBPACK_IMPORTED_MODULE_2__.uz,"Vertical",makeButton("Paste",function(e,t){debug&&console.log("1811 myMetis",myMetis),myMetis.pasteViewsOnly=!1;let l=[];e.diagram.selection.each(function(e){l.push(e.data)}),myMetis.currentSelection=l,debug&&console.log("1685 mySelection",l);let o=e.diagram.toolManager.contextMenuTool.mouseDownPoint;e.diagram.commandHandler.pasteSelection(o)},function(e){return e.diagram.commandHandler.canPasteSelection()}),makeButton("Paste View",function(e,t){debug&&console.log("1827 myMetis",myMetis),myMetis.pasteViewsOnly=!0;let l=[];e.diagram.selection.each(function(e){l.push(e.data)}),myMetis.currentSelection=l;let o=e.diagram.toolManager.contextMenuTool.mouseDownPoint;e.diagram.commandHandler.pasteSelection(o)},function(e){return e.diagram.commandHandler.canPasteSelection()}),makeButton("----------",function(e,t){console.log("TEST")},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("New Model",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.Ul(myMetis,myDiagram)},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("New Modelview",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.gz(myMetis,myDiagram)},function(e){if("Metamodelling"===myMetis.modelType)return!1;let t=myMetis.adminModel,l=myMetis.currentModel;return l.id!==t.id}),makeButton("Set Modelview as Template",function(e,t){let l=myMetis.currentModelview,o=myMetis.currentModel;o.addTemplate(l),l.setIsTemplate(!0),o.setIsTemplate(!0),debug&&console.log("935 myMetis",myMetis),alert("Current modelview has been set as template")},function(e){return!1}),makeButton("Delete Model",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.$s(myMetis,myDiagram)},function(e){if("Metamodelling"===myMetis.modelType)return!1;let t=0,l=myMetis.models;for(let o=0;o<l.length;o++){let i=l[o];!i.markedAsDeleted&&t++}return t>1}),makeButton("Delete Current Modelview",function(e,t){if(confirm("Do you really want to delete the current modelview?")){myMetis.currentModel;let l=myMetis.currentModelview;_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.nv(l,myMetis,myDiagram)}},function(e){if("Metamodelling"===myMetis.modelType)return!1;let t=myMetis.currentModel,l=0,o=t.modelviews;for(let i=0;i<o.length;i++){let n=o[i];!n.markedAsDeleted&&l++}return l>1}),makeButton("New Target Model",function(e,t){let l;let o=myMetis.currentTargetMetamodel;debug&&console.log("819 Diagram",myMetis);let i=prompt("Enter Target Model name:","");if(null==i||""===i)alert("New operation was cancelled");else{l=new _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_7__.qv(_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.createGuid(),i,o,""),debug&&console.log("824 Diagram",o,l),myMetis.addModel(l);let n=prompt("Enter Modelview name:",l.name);if(null==n||""===n)alert("New operation was cancelled");else{let s=myMetis.currentModel,a=new _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_7__.Nn(_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.createGuid(),n,s,"");l.addModelView(a),myMetis.addModelView(a);let r=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.qf(l,!0);debug&&console.log("593 Diagram",r),r=JSON.parse(JSON.stringify(r)),e.diagram.dispatch({type:"LOAD_TOSTORE_NEWMODELVIEW",data:r})}}},function(e){return!1}),makeButton("Set Target Model",function(e,t){myMetis.currentMetamodel,myMetis.currentModel,myMetis.currentModelview,myMetis.currentTargetMetamodel,e.diagram;let l={what:"selectDropdown",title:"Select Target Model",case:"Set Target Model",myDiagram:myDiagram},o=myMetis.models.map(e=>e&&e.nameId);debug&&console.log("2194",o,l),myDiagram.handleOpenModal(o,l)},function(e){return!1}),makeButton("----------",function(e,t){},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Edit Project",function(e,t){let l=myMetis.name,o=prompt("Enter Project name:",l);(null==o?void 0:o.length)>0&&(myMetis.name=o);let i=myMetis.description,n=prompt("Enter Project description:",i);(null==n?void 0:n.length)>0&&(myMetis.description=n);let s={name:myMetis.name,description:myMetis.description},a=[];a.push(s),null==a||a.map(t=>{var l;let o=t&&t;o=JSON.parse(JSON.stringify(o)),null===(l=e.diagram)||void 0===l||l.dispatch({type:"UPDATE_PROJECT_PROPERTIES",data:o})})},function(e){if("Metamodelling"===myMetis.modelType)return!1;let t=myMetis.adminModel,l=myMetis.currentModel;return l.id!==t.id}),makeButton("Edit Metamodel",function(e,t){let l=myMetis.currentMetamodel,o=l.name,i=prompt("Enter Metamodel name:",o);(null==i?void 0:i.length)>0&&(l.name=i);let n=l.description,s=prompt("Enter Metamodel description:",n);(null==s?void 0:s.length)>0&&(l.description=s),o!==i&&(l.id=_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.createGuid());let a=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.st(myMetis,!0),r={metis:a};r=JSON.parse(JSON.stringify(r)),myDiagram.dispatch({type:"LOAD_TOSTORE_PHDATA",data:r})},function(e){if("Metamodelling"===myMetis.modelType)return!0}),makeButton("Edit Model",function(e,t){let l=myMetis.currentModel,o=l.name,i=prompt("Enter Model name:",o);(null==i?void 0:i.length)>0&&(l.name=i);let n=l.description,s=prompt("Enter Model description:",n);(null==s?void 0:s.length)>0&&(l.description=s);let a=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.qf(l,!0),r=[];r.push(a),null==r||r.map(t=>{var l;let o=t&&t;o=JSON.parse(JSON.stringify(o)),debug&&console.log("1906 model",o),null===(l=e.diagram)||void 0===l||l.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:o})})},function(e){if("Metamodelling"===myMetis.modelType)return!1;let t=myMetis.adminModel,l=myMetis.currentModel;return l.id!==t.id}),makeButton("Edit Modelview",function(e,t){{let l=myMetis.currentModelview,o=l.name,i=prompt("Enter Modelview name:",o);(null==i?void 0:i.length)>0&&(l.name=i);let n=l.description,s=prompt("Enter Modelview description:",n);(null==s?void 0:s.length)>0&&(l.description=s);let a=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.OX(l),r=[];r.push(a),null==r||r.map(t=>{var l;let o=t&&t;o=JSON.parse(JSON.stringify(o)),debug&&console.log("1942 modelview",o),null===(l=e.diagram)||void 0===l||l.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:o})})}},function(e){if("Metamodelling"===myMetis.modelType)return!1;let t=myMetis.adminModel,l=myMetis.currentModel;return l.id!==t.id}),makeButton("Update Project from AdminModel",function(e,t){myMetis.adminModel&&_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.Mv(myMetis,myDiagram)},function(e){if("Metamodelling"===myMetis.modelType)return!1;let t=myMetis.adminModel,l=myMetis.currentModel;return l.id===t.id}),makeButton("----------",function(e,t){},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("New Metamodel",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.wo(myMetis,myDiagram)},function(e){return"Metamodelling"!==myMetis.modelType&&!_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.mz(myMetis)}),makeButton("Generate Metamodel",function(e,t){debug&&console.log("1958 obj, myMetis, myDiagram",t,myMetis,myDiagram),_akmm_ui_generateTypes__WEBPACK_IMPORTED_MODULE_15__.UH(t,myMetis,myDiagram)},function(e){return debug&&console.log("1991 myMetis",myMetis),"Metamodelling"!==myMetis.modelType&&!_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.mz(myMetis)}),makeButton("Replace Current Metamodel",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.O3(myMetis,myDiagram)},function(e){return"Metamodelling"!==myMetis.modelType&&!_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.mz(myMetis)}),makeButton("Add Metamodel",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.c_(myMetis,myDiagram)},function(e){if("Metamodelling"===myMetis.modelType||_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.mz(myMetis))return!1;{let t=myMetis.metamodels.length;return t>=2}}),makeButton("Delete Metamodel",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.UH(myMetis,myDiagram)},function(e){if("Metamodelling"===myMetis.modelType||_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.mz(myMetis))return!1;let t=0,l=myMetis.metamodels;for(let o=0;o<l.length;o++){let i=l[o];!i.markedAsDeleted&&t++}return t>1}),makeButton("Clear Metamodel Content",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.Xb(myMetis,myDiagram)},function(e){if("Metamodelling"===myMetis.modelType||_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.mz(myMetis))return!1;let t=0,l=myMetis.metamodels;for(let o=0;o<l.length;o++){let i=l[o];!i.markedAsDeleted&&t++}return t>1}),makeButton("Undo",function(e,t){e.diagram.commandHandler.undo()},function(e){return e.diagram.commandHandler.canUndo()}),makeButton("Redo",function(e,t){e.diagram.commandHandler.redo()},function(e){return e.diagram.commandHandler.canRedo()}),makeButton("----------",function(e,t){},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Add Missing Relationship Views",function(e,t){let l=myMetis.currentModelview,o=_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.dG(l,myMetis);debug&&console.log("2092 links",o);for(let i=0;i<o.length;i++){let n=o[i];myDiagram.model.addLinkData(n)}},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Clear Relationship Breakpoints",function(e,t){let l=myMetis.currentModelview;_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.yR(l,myMetis)},function(e){return"Modelling"===myMetis.modelType}),makeButton("Delete Invisible Objects",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.q7(myMetis,myDiagram)},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Undelete Selection",function(e,t){if(confirm("Do you really want to undelete the current selection?")){myDiagram.selection.each(function(e){debug&&console.log("1435 sel",e.data);let t=e.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let l=t.objectview;if(l){(l=myMetis.findObjectView(l.id)).markedAsDeleted=!1,l.typeview?l.strokecolor=l.typeview.strokecolor:l.strokecolor="black";let o=l.object;o&&(o.markedAsDeleted=!1)}debug&&console.log("2345 objview",l)}if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP){let i=e.data.relshipview;if(i){(i=myMetis.findRelationshipView(i.id)).markedAsDeleted=!1,i.typeview?i.strokecolor=i.typeview.strokecolor:i.strokecolor="black";let n=i.relship;n&&(n.markedAsDeleted=!1)}}}),debug&&console.log("1455 myMetis",myMetis);let l=myMetis.currentModel,o=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.qf(l,!0),i=[];i.push(o),i.map(t=>{let l=t;l=JSON.parse(JSON.stringify(l)),e.diagram.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:l})})}},function(e){return e.part.data,myDiagram.selection.count>0}),makeButton("Select all objects of type",function(e,t){let l=myMetis.currentModel;myMetis.currentModelview;let o=myMetis.gojsModel,i=prompt("Enter object type name",""),n=l.getObjectsByTypename(i,!1),s=!0;for(let a=0;a<n.length;a++){let r=n[a];if(r){let d=r.objectviews;if(d)for(let c=0;c<d.length;c++){let p=d[c];if(p){let h=o.findNodeByViewId(null==p?void 0:p.id),u=myDiagram.findNodeForKey(null==h?void 0:h.key);u&&(s?(myDiagram.select(u),s=!1):u.isSelected=!0)}}}}},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Select by Object Name",function(e,t){let l=prompt("Enter name ","");RegExp(l,"i");let o=myDiagram.findNodesByExample({name:l});debug&&console.log("2288 results",l,o);let i=o.iterator;for(;i.next();){let n=i.value,s=myDiagram.findNodeForKey(null==n?void 0:n.key);s&&(s.isSelected=!0)}},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("----------",function(e,t){},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Toggle Admin layer",function(e,t){_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.toggleAdminModel()},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("----------",function(e,t){},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Set Layout Scheme",function(e,t){let l=()=>[{value:"Circular",label:"Circular Layout"},{value:"Grid",label:"Grid Layout"},{value:"Tree",label:"Tree Layout"},{value:"ForceDirected",label:"ForceDirected Layout"},{value:"LayeredDigraph",label:"LayeredDigraph Layout"},{value:"Manual",label:"Manual Layout"}],o=l();debug&&console.log("3020 layoutList",o);let i=o.map(e=>e&&e.label);debug&&console.log("3076",i,o);let n={what:"selectDropdown",title:"Set Layout Scheme",case:"Set Layout Scheme",layoutList:l(),myDiagram:myDiagram};myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(myDiagram,n),debug&&console.log("3087 myMetis",myMetis)},function(e){return!0}),makeButton("Do Layout",function(e,t){var l,o;let i=myMetis.gojsModel,n=null===(l=i.modelView)||void 0===l?void 0:l.layout;"Metamodelling"===myMetis.modelType&&(n=null===(o=i.metamodel)||void 0===o?void 0:o.layout),setLayout(myDiagram,n)},function(e){return!0}),makeButton("Set Link Routing",function(e,t){let l=()=>[{value:"Normal",label:"Normal"},{value:"Orthogonal",label:"Orthogonal"},{value:"AvoidsNodes",label:"Avoids Nodes"}],o=l();debug&&console.log("3143 routingList",o);let i=o.map(e=>e&&e.label);debug&&console.log("3145",i,o);let n={what:"selectDropdown",title:"Set Routing Scheme",case:"Set Routing Scheme",routingList:l(),myDiagram:myDiagram};myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(myDiagram,n),debug&&console.log("3155 myMetis",myMetis)},function(e){return!0}),makeButton("Set Link Curve",function(e,t){let l=()=>[{value:"None",label:"None"},{value:"Bezier",label:"Bezier"},{value:"JumpOver",label:"Jump Over"},{value:"JumpGap",label:"Jump Gap"}],o=l();debug&&console.log("3171 curveList",o);let i=o.map(e=>e&&e.label);debug&&console.log("3173",i,o);let n={what:"selectDropdown",title:"Set Link Curve",case:"Set Link Curve",curveList:l(),myDiagram:myDiagram};myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(myDiagram,n),debug&&console.log("3183 myMetis",myMetis)},function(e){return!0}),makeButton("Toggle Cardinality On/Off",function(e,t){let l=myMetis.currentModelview;void 0==l.showCardinality&&(l.showCardinality=!0),l.showCardinality=!l.showCardinality,l.showCardinality?alert("Cardinality on relationships WILL be shown!"):alert("Cardinality on relationships will NOT be shown!"),debug&&console.log("3234 showCardinality",l.showCardinality);let o=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.OX(l);debug&&console.log("3236 jsnModelview",o);let i=[];i.push(o),i.map(t=>{let l=t;l=JSON.parse(JSON.stringify(l)),e.diagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:l})})},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Toggle 'Include Relationship Kind' On/Off",function(e,t){let l=myMetis.currentModel,o=l.includeRelshipkind;l.includeRelshipkind=!o,l.includeRelshipkind?alert("Setting 'Relationship Kind' WILL be allowed!"):alert("Setting 'Relationship Kind' will NOT be allowed!");let i=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.qf(l,!0),n=[];n.push(i),n.map(t=>{let l=t;l=JSON.parse(JSON.stringify(l)),e.diagram.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:l})})},function(e){return!0}),makeButton("Toggle Show Relationship Names On/Off",function(e,t){let l=myMetis.currentModelview;void 0==l.showRelshipNames&&(l.showRelshipNames=!0),l.showRelshipNames=!l.showRelshipNames,l.showRelshipNames?alert("Relationship Names will be shown!"):alert("Relationship Names will NOT be shown!"),debug&&console.log("2612 showRelshipNames",l.showRelshipNames);let o=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.OX(l);debug&&console.log("2614 jsnModelview",o);let i=[];i.push(o),i.map(t=>{let l=t;l=JSON.parse(JSON.stringify(l)),e.diagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:l})})},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Toggle 'Ask for Relationship Name' On/Off",function(e,t){let l=myMetis.currentModelview;void 0==l.askForRelshipName&&(l.askForRelshipName=!1),l.askForRelshipName=!l.askForRelshipName,l.askForRelshipName?alert("Relationship names WILL be asked for!"):alert("Relationship names will NOT be asked for!");let o=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.OX(l);debug&&console.log("3236 jsnModelview",o);let i=[];i.push(o),i.map(t=>{let l=t;l=JSON.parse(JSON.stringify(l)),e.diagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:l})})},function(e){return!0}),makeButton("Toggle 'Include Inherited Relshiptypes' On/Off",function(e,t){let l=myMetis.currentModelview;void 0==l.includeInheritedReltypes&&(l.includeInheritedReltypes=!1),l.includeInheritedReltypes=!l.includeInheritedReltypes,l.includeInheritedReltypes?alert("Inherited Relationship types are included!"):alert("Inherited Relationship types are NOT included!");let o=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.st(myMetis,!0),i={metis:o};i=JSON.parse(JSON.stringify(i)),debug&&console.log("2398 jsnMetis",o,metis),e.diagram.dispatch({type:"LOAD_TOSTORE_PHDATA",data:i})},function(e){return!0}),makeButton("Zoom All",function(e,t){e.diagram.commandHandler.zoomToFit()},function(e){return!0}),makeButton("Zoom Selection",function(e,t){myDiagram.selection;let l=0,o=0,i=0,n=0,s=0,a=0;myDiagram.selection.each(function(e){0==l&&(l=e.actualBounds.x),0==o&&(o=e.actualBounds.y),0==s&&(s=e.actualBounds.width),0==a&&(a=e.actualBounds.height),i=l+s,n=o+a;let t=e.actualBounds.x;t<l&&(l=t);let r=e.actualBounds.y;r<o&&(o=r);let d=e.actualBounds.width,c=t+d,p=e.actualBounds.height,h=r+p;c>i&&(i=c),h>n&&(n=h),s=i-l,a=n-o});let r=new gojs__WEBPACK_IMPORTED_MODULE_2__.UL(l,o,s,a);myDiagram.zoomToRect(r)},function(e){return myDiagram.selection.count>0}),makeButton("Make Diagram",function(e,t){myDiagram.makeImage({scale:1,background:"AntiqueWhite",type:"image/jpeg"})},function(e){return!1}),makeButton("----------",function(e,t){},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Verify and Repair Model",function(e,t){debug&&console.log("2767 myMetis",myMetis);let l=myMetis.currentModel,o=l.modelviews,i=myMetis.currentModelview,n=myMetis.currentMetamodel,s=myMetis.gojsModel;debug&&console.log("2773 myMetis",myMetis),myDiagram.myGoModel=s,debug&&console.log("2775 model, metamodel",i,l,n,myDiagram.myGoModel),_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.I(l,n,o,myDiagram,myMetis),debug&&console.log("2777 myMetis",myMetis),alert("The current model has been repaired")},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Verify and Repair Metamodels",function(e,t){debug&&console.log("2788 myMetis",myMetis),_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.ly(myMetis,myDiagram),alert("The metamodels have been repaired")},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Clear RelationshipTypeViews",function(e,t){debug&&console.log("2767 myMetis",myMetis);let l=myMetis.currentMetamodel;_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.kk(l,myDiagram,myMetis),debug&&console.log("2777 myMetis",myMetis),alert("The relshiptypeviews has been cleared")},function(e){return"Metamodelling"===myMetis.modelType}),makeButton("!!! PURGE DELETED !!!",function(e,t){confirm("Do you really want to permamently delete all instances marked as deleted?")&&(debug&&console.log("2402 myMetis",myMetis),_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.Gh(myMetis,myDiagram),debug&&console.log("2404 myMetis",myMetis))},function(e){return!0}));let forelayer=myDiagram.findLayer("Foreground");myDiagram.addLayerBefore($(gojs__WEBPACK_IMPORTED_MODULE_2__.mh,{name:"AdminLayer"}),forelayer);let layer=myDiagram.findLayer("AdminLayer");layer.visible=!1;{let linkTemplateMap=new gojs__WEBPACK_IMPORTED_MODULE_2__.D5;_akmm_ui_templates__WEBPACK_IMPORTED_MODULE_13__.Sn(linkTemplateMap,linkContextMenu,myMetis),linkToLink&&myDiagram.linkTemplateMap.add("linkToLink",$("Link",{relinkableFrom:!1,relinkableTo:!1},$("Shape",{stroke:"#2D9945",strokeWidth:2})));let groupTemplateMap=new gojs__WEBPACK_IMPORTED_MODULE_2__.D5;_akmm_ui_templates__WEBPACK_IMPORTED_MODULE_13__.dY(groupTemplateMap,partContextMenu,myMetis);let nodeTemplateMap=new gojs__WEBPACK_IMPORTED_MODULE_2__.D5;_akmm_ui_templates__WEBPACK_IMPORTED_MODULE_13__.OT(nodeTemplateMap,partContextMenu,myMetis),nodeTemplateMap.add("LinkLabel",$("Node",{selectable:!1,avoidable:!1,layerName:"Foreground"},$("Shape","Ellipse",{width:5,height:5,stroke:null,portId:"",fromLinkable:!0,toLinkable:!1,cursor:"pointer"}))),myDiagram.nodeTemplateMap=nodeTemplateMap,myDiagram.linkTemplateMap=linkTemplateMap,myDiagram.groupTemplateMap=groupTemplateMap}linkToLink&&(myDiagram.toolManager.linkingTool.archetypeLabelNodeData={category:"LinkLabel"});var paletteGroupTemplate1=$(gojs__WEBPACK_IMPORTED_MODULE_2__.ZA,"Auto",new gojs__WEBPACK_IMPORTED_MODULE_2__.KX("text","name"),$(gojs__WEBPACK_IMPORTED_MODULE_2__.bn,"Rectangle",{name:"SHAPE",fill:"lightyellow"}),$(gojs__WEBPACK_IMPORTED_MODULE_2__.s_,"Vertical",$(gojs__WEBPACK_IMPORTED_MODULE_2__.s_,"Table",{defaultRowSeparatorStroke:"black",maxSize:new gojs__WEBPACK_IMPORTED_MODULE_2__.$u(150,999),margin:new gojs__WEBPACK_IMPORTED_MODULE_2__.Zt(6,10,0,3),defaultAlignment:gojs__WEBPACK_IMPORTED_MODULE_2__.z6.Left},$(gojs__WEBPACK_IMPORTED_MODULE_2__.jE,{column:2,width:4}),$(gojs__WEBPACK_IMPORTED_MODULE_2__.al,_akmm_ui_templates__WEBPACK_IMPORTED_MODULE_13__.Cg(),{row:0,column:0,columnSpan:6,font:"12pt Segoe UI,sans-serif",editable:!0,isMultiline:!1,minSize:new gojs__WEBPACK_IMPORTED_MODULE_2__.$u(10,16),name:"name"},new gojs__WEBPACK_IMPORTED_MODULE_2__.KX("text","name").makeTwoWay()))));function addFromNode(e,t){let l={key:t.data.key,name:t.data.name,objid:t.data.object.id,objviewid:t.data.objectview.id,group:t.data.objectview.group,isGroup:t.data.objectview.isGroup,toGroup:"",loc:new String(t.data.loc),scale:new String(t.scale),size:new String(t.data.size)};if(e.push(l),t.data.isGroup)for(let o=t.memberParts.iterator;null==o?void 0:o.next();){let i=o.value;i instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.NB&&i&&addFromNode(e,i)}}function getFromNode(e,t){for(let l=0;l<e.length;l++)if(e[l].key===t)return e[l];return null}function setLayout(e,t){switch(t){case"Circular":e.layout=$(gojs__WEBPACK_IMPORTED_MODULE_2__.SB);break;case"Grid":e.layout=$(gojs__WEBPACK_IMPORTED_MODULE_2__.Me);break;case"Tree":e.layout=$(gojs__WEBPACK_IMPORTED_MODULE_2__.FF);break;case"ForceDirected":e.layout=$(gojs__WEBPACK_IMPORTED_MODULE_2__.hD);break;case"LayeredDigraph":e.layout=$(gojs__WEBPACK_IMPORTED_MODULE_2__.KQ);break;case"Manual":e.layout.isInitial=!1,e.layout.isOngoing=!1}}function maybeChangeLinkCategory(e){var t,l,o=e.subject,i=(null===(t=o.fromNode)||void 0===t?void 0:t.isLinkLabel)||(null===(l=o.toNode)||void 0===l?void 0:l.isLinkLabel);e.diagram.model.setCategoryForLinkData(o.data,i?"linkToLink":"")}function makeButton(e,t,l){return $("ContextMenuButton",$(gojs__WEBPACK_IMPORTED_MODULE_2__.al,e),{click:t},l?new gojs__WEBPACK_IMPORTED_MODULE_2__.KX("visible","",function(e,t){return!!e.diagram&&l(e,t)}).ofObject():{})}return myDiagram}render(){var e,t,l,o;let i,n,s,a;let r=!0;debug&&console.log("2863 Diagram: ",this.props.nodeDataArray),debug&&console.log("2864 Diagram: ",this.props.linkDataArray);let d=this.state.selectedData;debug&&console.log("2866 selObj: ",d);let c=this.myMetis,p=c.currentModel,h=p.metamodel,u=this.state.modalContext;debug&&console.log("2872 modalContext ",u);let m=[{tabName:"Default"}];if((null==u?void 0:u.what)==="editObject"){let g=!1,f=!1,y=null===(t=this.state.selectedData)||void 0===t?void 0:t.object,v=this.myMetis.findObject(null==y?void 0:y.id);debug&&console.log("2879 obj, obj1",y,v),(null==y?void 0:null===(l=y.type)||void 0===l?void 0:l.name)==="Method"&&(r=!1),(null==v?void 0:v.hasInheritedProperties(p))&&(g=!0,r=!0);let b=null==v?void 0:v.getConnectedObjects2(c);(null==b?void 0:b.length)>0&&(f=!0,r=!0);let w={myMetis:c,myModel:p,myMetamodel:h,includeConnected:f,includeInherited:g},j=r?_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.dN(v,w,!0):[],T=v.getConnectedObjectRoles(c);debug&&console.log("2900 context, obj1, namelist",w,v,j),debug&&console.log("2901 connectedRoles",T),m=[];for(let k=0;k<j.length;k++){let O=j[k];if("Element"===O)continue;if(k>0){let M=T[k-1];M&&(O=M)}let D={tabName:O};m.push(D)}debug&&console.log("2913 modalContext, selpropgroup, namelist",u,m,j)}switch(null==u?void 0:u.what){case"selectDropdown":let E,x="",{Option:R}=react_select__WEBPACK_IMPORTED_MODULE_21__.F,N=e=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(R,{...e,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("img",{className:"option-img mr-2",src:e.data.value}),e.data.label]}),A=e=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("img",{className:"option-img mr-2",src:e.data.value}),e.data.label]});if((null==u?void 0:u.title)==="Select Icon")x=this.state.modalContext.iconList.map(e=>({value:e.value.includes("//")?e.value:"./../images/"+e.value,label:e.label})),E={Option:N,SingleValue:A};else if((null==u?void 0:u.title)==="Set Layout Scheme"){let S;x=this.state.modalContext.layoutList.map(e=>(S="./../images/default.png",{value:e.value,label:e.label})),E={Option:N,SingleValue:A}}else if((null==u?void 0:u.title)==="Set Routing Scheme"){let C;x=this.state.modalContext.routingList.map(e=>(C="./../images/default.png",{value:e.value,label:e.label})),E={Option:N,SingleValue:A}}else if((null==u?void 0:u.title)==="Set Link Curve"){let P;x=this.state.modalContext.curveList.map(e=>(P="./../images/default.png",{value:e.value,label:e.label})),E={Option:N,SingleValue:A}}else if((null==u?void 0:u.title)==="Select Relationship Type"){let I;debug&&console.log("2923 modalContext",this.state.modalContext);let _=this.state.modalContext.args.typeNames;x=_.map(e=>(I="./../images/default.png",{value:e,label:e})),E={Option:N,SingleValue:A}}else x=this.state.selectedData.map(e=>e&&{label:e,value:e}),E=null;debug&&console.log("2563 options",x);let{selectedOption:L}=this.state,V=L?L.value:x[0];debug&&console.log("2568 Diagram ",L,this.state.selectedOption,V),n=u.title,i=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"modal-selection d-flex justify-content-center",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_select__WEBPACK_IMPORTED_MODULE_22__.ZP,{className:"modal-select",options:x,components:E,onChange:e=>this.handleSelectDropdownChange(e)})});break;case"editObjectType":case"editObject":case"editObjectview":n=u.title,s=this.state.selectedData.category,null!==this.state.selectedData&&null!=this.myMetis&&(i=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"modal-prop",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_SelectionInspector__WEBPACK_IMPORTED_MODULE_6__.R,{myMetis:this.myMetis,selectedData:this.state.selectedData,context:this.state.modalContext,onInputChange:this.handleInputChange,activeTab:this.state.currentActiveTab})}),debug&&console.log("3021 selectedData, modalContent: ",this.state.selectedData,i));break;case"editRelationshipType":case"editRelationship":case"editRelshipview":case"editTypeview":n=u.title+":",s=this.state.selectedData.category,debug&&console.log("2612 category ",s),a=u.typename?"("+u.typename+")":"("+(null===(o=this.state.selectedData.object)||void 0===o?void 0:o.typeName)+")",null!==this.state.selectedData&&null!=this.myMetis&&(debug&&console.log("2615 Diagram ",this.state.selectedData,this.state.modalContext,u),i=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"modal-prop",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_SelectionInspector__WEBPACK_IMPORTED_MODULE_6__.R,{myMetis:this.myMetis,selectedData:this.state.selectedData,context:this.state.modalContext,onInputChange:this.handleInputChange,activeTab:this.state.currentActiveTab})}))}let F=e=>{this.state.currentActiveTab!==e&&this.setState({currentActiveTab:e})},G=m?m.map((e,t)=>{let l=(null==e?void 0:e.tabName)||"All";if(debug&&console.log("2646",t,l,e),e){let o=t.toString();return this.state.currentActiveTab,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_23__.Z,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_24__.Z,{className:classnames__WEBPACK_IMPORTED_MODULE_5___default()({active:this.state.currentActiveTab===o}),onClick:()=>{F(o)},children:l})},o)}}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{}),K=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"btn-sm bg-light text-black py-0 mt-2 ml-3","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Select tab to see different group of properties.",children:"i"}),B=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(reactstrap__WEBPACK_IMPORTED_MODULE_25__.Z,{tabs:!0,children:[G,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(reactstrap__WEBPACK_IMPORTED_MODULE_23__.Z,{children:[" ",K," "]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_26__.Z,{activeTab:this.state.currentActiveTab,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_27__.Z,{tabId:this.state.currentActiveTab,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"bg-white mt-0 p-1 pt-2",children:i})})})]});return debug&&console.log("2825 Active tab: ",this.state.currentActiveTab),debug&&console.log("3099 nodeDataArray, linkDataArray, modelData: ",this.props.nodeDataArray,this.props.linkDataArray,this.props.modelData),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"jsx-8c4e8623308898b6",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(gojs_react__WEBPACK_IMPORTED_MODULE_3__.FI,{ref:this.diagramRef,divClassName:"diagram-component",initDiagram:this.initDiagram,nodeDataArray:this.props.nodeDataArray,linkDataArray:this.props.linkDataArray,modelData:this.props.modelData,onModelChange:this.props.onModelChange,skipsDiagramUpdate:this.props.skipsDiagramUpdate}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(reactstrap__WEBPACK_IMPORTED_MODULE_28__.Z,{isOpen:this.state.showModal,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"jsx-8c4e8623308898b6 modal-head",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_29__.Z,{className:"modal-button btn-sm float-right m-1",color:"link",onClick:()=>{this.handleCloseModal("x")},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"jsx-8c4e8623308898b6",children:"x"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{className:"jsx-8c4e8623308898b6 text-secondary float-left",children:[n,":"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(reactstrap__WEBPACK_IMPORTED_MODULE_30__.Z,{className:"modal-header",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{className:"jsx-8c4e8623308898b6 modal-name ml-2",children:[null===(e=this.state.selectedData)||void 0===e?void 0:e.name," "]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{className:"jsx-8c4e8623308898b6 modal-objecttype",children:[" ",a," "]})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_31__.Z,{className:"modal-body",children:B}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_32__.Z,{className:"modal-footer",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_29__.Z,{className:"modal-button bg-link m-0 p-0",color:"link",onClick:()=>{this.handleCloseModal()},children:"Done"})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(styled_jsx_style__WEBPACK_IMPORTED_MODULE_1___default(),{id:"8c4e8623308898b6",children:""})]})}constructor(e){super(e),this.handleSelectDropdownChange=e=>{debug&&console.log("185 this.state",this);let t=this.myMetis,l={myMetis:t,myMetamodel:t.currentMetamodel,myModel:t.currentModel,myModelview:t.currentModelview,myGoModel:t.gojsModel,myDiagram:t.myDiagram,modalContext:this.state.modalContext};debug&&console.log("196 selected, context",e,l),_akmm_ui_modal__WEBPACK_IMPORTED_MODULE_12__.Lo(e,l),debug&&console.log("203 selected",e)},debug&&console.log("78 Diagram props:",e),this.myMetis=e.myMetis,this.myMetis.modelType=e.modelType,this.diagramRef=react__WEBPACK_IMPORTED_MODULE_4__.createRef(),this.state={myMetis:e.myMetis,showModal:!1,selectedData:null,modalContext:null,selectedOption:null,currentActiveTab:null},this.mapNodeKeyIdx=new Map,this.mapLinkKeyIdx=new Map,this.initDiagram=this.initDiagram.bind(this),this.handleOpenModal=this.handleOpenModal.bind(this),this.handleCloseModal=this.handleCloseModal.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleSelectDropdownChange=this.handleSelectDropdownChange.bind(this);let t=this.myMetis.findModelByName(_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.admin.AKM_ADMIN_MODEL);this.myMetis.adminModel=t,this.myMetis.showAdminModel=!1}}},8809:function(e,t,l){"use strict";l.d(t,{R:function(){return w}});var o=l(5893),i=l(7294);let n=l(9350),s=!1;class a extends i.PureComponent{handleInputChange(e){s&&console.log("33 this.props, e.target",this.props,e.target);let t=this.props.type,l=e.target.value;if("checkbox"===t&&"true"===this.props.value&&(e.target.checked=!0),"checkbox"===t&&(l=e.target.checked),s&&console.log("41 e.target: ",e.target,e.type),s&&console.log("42 InspectorRow: this.props, value: ",this.props,l),this.props.onInputChange(this.props,l,"blur"===e.type),"blur"===e.type){let o=this.props.pattern;if((null==o?void 0:o.length)>0&&(null==l?void 0:l.length)>0){let i=new n(o);s&&console.log("50 regex:",i),i.test(l)||alert("Value: '"+l+"' IS NOT valid")}}}formatLocation(e){let t=e.split(" ");if(2===t.length){let l=parseFloat(t[0]),o=parseFloat(t[1]);if(!isNaN(l)&&!isNaN(o))return"".concat(l.toFixed(0)," ").concat(o.toFixed(0))}return e}render(){let e="Fieldtype : ".concat(this.props.type," \nDescription: ").concat(this.props.description);s&&console.log("74 InspectorRow: this.props",this.props);let t=this.props.value;if("Not valid"===t&&alert("Input is not valid: "+t),"textarea"===this.props.type)return s&&console.log("80 props",this.props),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"label pr-2 w-25",children:this.props.id}),(0,o.jsx)("td",{children:(0,o.jsx)("textarea",{disabled:this.props.disabled,id:this.props.id,value:t,onChange:this.handleInputChange,onBlur:this.handleInputChange})}),(0,o.jsx)("td",{children:(0,o.jsx)("div",{className:"btn-sm bg-light text-green px-1 py-2 float-right","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:e,children:"i"})})]});if("select"!==this.props.type)return s&&console.log("132 props",this.props),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"pr-2 w-25",children:this.props.id}),(0,o.jsx)("td",{children:(0,o.jsx)("input",{disabled:this.props.disabled,id:this.props.id,value:t,checked:this.props.checked,type:this.props.type,onChange:this.handleInputChange,onBlur:this.handleInputChange})}),(0,o.jsx)("td",{children:(0,o.jsx)("div",{className:"btn-sm bg-light text-green px-1 py-2 float-right","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:e,children:"i"})})]});{let l="Select_"+this.props.id,i=this.props.values,n=null==i?void 0:i.map(e=>(0,o.jsx)("option",{value:e},e)),a=(0,o.jsx)("datalist",{id:l,children:n});return(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"pr-2 w-25",children:this.props.id}),(0,o.jsxs)("td",{children:[(0,o.jsx)("input",{id:this.props.id,type:"text",list:l,placeholder:null==t?void 0:t.toString(),onChange:this.handleInputChange,onBlur:this.handleInputChange}),a]}),(0,o.jsx)("td",{children:(0,o.jsx)("div",{className:"btn-sm bg-light text-green px-1 py-2 float-right","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:e,children:"i"})})]})}}constructor(e){super(e),s&&console.log("28 InspectorRow: props",this.props),this.handleInputChange=this.handleInputChange.bind(this),s&&console.log("30 InspectorRow: this",this,this.props)}}var r=l(6433),d=l(3327),c=l(3165),p=l(2586);let h=l(4683);l(2085);let u=l(5523),m=!1,g=["None","Standard","Backward","OpenTriangle","Triangle","BackwardOpenTriangle","BackwardTriangle","Diamond","StretchedDiamond","Fork","BackwardFork","LineFork","BackwardLineFork","Circle","Block"],f=["black","white","red","pink","green","lightgreen","darkgreen","seagreen","blue","lightblue","darkblue","skyblue","grey","lightgrey","darkgrey","yellow","lightyellow","yellowgreen","orange","brown","purple","violet","turquoise"],y=["1","2","3","4","5"],v=!0,b=!0;class w extends i.PureComponent{renderObjectDetails(){let e,t,l,i,n,s,w,j,T,k,O,M,D,E;let x=this.props.myMetis,R=this.props.activeTab;m&&console.log("60 activeTab, myMetis",R,x),m&&console.log("61 this.props",this.props);let N=x.currentMetamodel,A=x.currentModel,S=A.includeSystemtypes;m&&console.log("64 allowsMetamodeling",A,S);let C=this.props.selectedData,P=this.props.context,I=null==C?void 0:C.category;if((null==C?void 0:C.type)==="GraphLinksModel")return;switch(x.findModelByName(p.admin.AKM_ADMIN_MODEL),m&&console.log("75 selObj",C),I){case p.gojs.C_OBJECT:e=C.object,(t=x.findObject(null==e?void 0:e.id))&&(e=t),l=C.objectview,l=x.findObjectView(null==l?void 0:l.id),i=C.objecttype,(n=x.findObjectType(null==i?void 0:i.id))&&(i=n),w=null==i?void 0:i.typeview,w=x.findObjectTypeView(null==w?void 0:w.id);break;case p.gojs.C_OBJECTTYPE:i=C.objecttype,(n=x.findObjectType(null==i?void 0:i.id))&&(i=n),w=null==i?void 0:i.typeview,w=x.findObjectTypeView(null==w?void 0:w.id);break;case p.gojs.C_RELATIONSHIP:e=C.relship,(t=x.findRelationship(null==e?void 0:e.id))&&(e=t),l=C.relshipview,l=x.findRelationshipView(null==l?void 0:l.id),i=C.relshiptype,(n=x.findRelationshipType(null==i?void 0:i.id))&&(i=n),j=null==i?void 0:i.typeview,j=x.findRelationshipTypeView(null==j?void 0:j.id),m&&console.log("119 inst, instview, type, reltypeview",e,l,i,j);break;case p.gojs.C_RELSHIPTYPE:i=C.reltype,(n=x.findRelationshipType(null==i?void 0:i.id))&&(i=n),j=null==i?void 0:i.typeview,j=x.findRelationshipTypeView(null==j?void 0:j.id)}m&&console.log("123 inst, type",e,i),m&&console.log("121 selObj, this.props, inst, type",C,this.props,e,i);let _="",L="",V=!1,F=!1,G=0;if(I===p.gojs.C_OBJECT){if(m&&console.log("128 type",i),(null==i?void 0:i.name)==="Method")k=null;else{if(k=D=e.type,O=e,_=D.name,L=D.description,m&&console.log("138 inst",e),v&&(null==P?void 0:P.what)==="editObject"){let K=null==e?void 0:e.getInheritedTypes();K.push(D),K=[...new Set(K)],m&&console.log("143 inheritedTypes",K),(null==e?void 0:e.hasInheritedProperties(A))&&(V=!0);let B=null==e?void 0:e.getConnectedObjects2(x);m&&console.log("147 connectedObjects",B),(null==B?void 0:B.length)>0&&(F=!0),m&&console.log("150 includeInherited",V);let U={myMetis:x,myModel:A,myMetamodel:N,includeConnected:F,includeInherited:V},J=r.dN(e,U,!0);if(m&&console.log("159 context, inst, namelist",U,e,J),U.includeInherited){_=J[R];let z=e.getInheritanceObjects(A);for(let H=0;H<z.length;H++)if(z[H].type.name===_){k=z[H].type,O=z[H];break}}if(U.includeConnected){let W=J[R];for(let X=0;X<B.length;X++)if(B[X].name===W){let Y=B[X];_=(i=Y.type).name,L=i.description,k=i,O=Y,G=X+1}}if(m&&console.log("185 typename, chosenType, chosenInst, inheritedTypes",_,k,O,K),m&&console.log("186 chosenType, namelist, inheritedTypes",k,J,K),J.length>1&&"Element"!==_&&"All"!==_)for(let Z=0;Z<K.length;Z++){var $;let q=null===($=K[Z])||void 0===$?void 0:$.name;q===_&&(k=i=K[Z],m&&console.log("193 tname, chosenType",q,k))}m&&console.log("197 typename, chosenType, chosenInst",_,k,O),m&&console.log("198 typename, chosenType",_,k),"All"===_&&(k=null),(null==e?void 0:e.hasInheritedProperties(A))||(k=null)}m&&console.log("206 myModel",A)}m&&console.log("208 inst, inst1, selObj, chosenType",e,t,C,k),m&&console.log("209 instview, typeview",l,s)}if("object"!=typeof i)return;if(m&&console.log("214 myMetis",x),I===p.gojs.C_OBJECT){if(m&&console.log("219 chosenType",k),k)E=k.getProperties(!1),m&&console.log("221 typename, chosenType, properties, chosenInst",_,k,E,O);else if((null==i?void 0:i.name)==="Method")E=(e=x.findObject(e.id)).setAndGetAllProperties(x),O=e,m&&console.log("229 chosenInst, properties",O,E);else{let Q=!0;e=x.findObject(e.id),i=x.findObjectType(i.id);let ee=null==i?void 0:i.getProperties(Q),et=null==e?void 0:e.getInheritedProperties(A);E=(null==et?void 0:et.length)>0?ee.concat(et):ee,m&&console.log("240 typename, typeProps, inheritedProps",_,ee,et)}m&&console.log("241 typename, chosenInst, chosenType, properties",_,O,k,E)}else if(I===p.gojs.C_RELATIONSHIP){let el=!1,eo=null==i?void 0:i.getProperties(el);E=eo}else p.gojs.C_RELSHIPTYPE;m&&console.log("248 type, properties",i,E);for(let ei=0;ei<(null==E?void 0:E.length);ei++){let en=E[ei];if(en&&O){let es=O[en.name];m&&console.log("256 prop.name, chosenInst",en.name,O),es||(O[en.name]="")}}m&&console.log("264 properties, chosenInst, selObj",E,O,C);let ea=[],er=!1,ed=!1,ec=!1,ep=!1,eh=null==P?void 0:P.what;switch(m&&console.log("273 what",eh),eh){case"editObjectType":case"editRelationshipType":T=i;break;case"editObject":T=O,(null==i?void 0:i.name)===p.types.AKM_LABEL&&(ep=!0);break;case"editRelationship":default:T=e;break;case"editModelview":T=modelview;break;case"editObjectview":case"editRelshipview":case"editTypeview":k=null,C.category===p.gojs.C_RELATIONSHIP?T=null==j?void 0:j.data:C.category===p.gojs.C_RELSHIPTYPE?T=null==j?void 0:j.data:C.category===p.gojs.C_OBJECT?T=null==w?void 0:w.data:C.category===p.gojs.C_OBJECTTYPE&&(T=null==w?void 0:w.data),T||(T=e),er=!0,m&&console.log("308 inst, item",e,T),"editObjectview"===eh?ed=!0:"editRelshipview"===eh&&(ec=!0)}for(let eu in m&&console.log("318 myMetis",x),m&&console.log("319 item, inst, selObj, chosenInst, type",T,e,C,O,i),T){let em;if(m&&console.log("333 k in item",eu),"abstract"===eu){if("editObjectType"!==eh)continue;if(T.category===p.gojs.C_OBJECTTYPE){switch(T.name){case"Property":case"Datatype":case"Method":case"MethodType":case"Value":case"FieldType":case"ViewFormat":case"InputPattern":case"undefined":continue}m&&console.log("362 k in item",eu,T.name)}}if(("viewkind"!==eu||("editObjectview"===eh||"editTypeview"===eh||"editObjectType"===eh)&&!ep)&&("relshipkind"!==eu||"editRelationshipType"===eh||A.includeRelshipkind&&"editRelationship"===eh)&&("text"!==eu||ep)&&"copiedFromId"!==eu&&"markedAsDeleted"!==eu){if(m&&console.log("360 k, chosenType",eu,k),k){m&&console.log("364 properties",E);let eg=!1;for(let ef=0;ef<E.length;ef++){let ey=E[ef];if(ey.name===eu){eg=!0;break}}switch(k.name){case"EntityType":("id"===eu||"name"===eu||"description"===eu||"typeName"===eu||"typeDescription"===eu||"abstract"===eu||"viewkind"===eu)&&(eg=!0);break;case"All":eg=!0;break;default:("id"===eu||"name"===eu||"description"===eu)&&(eg=!0)}if(!eg)continue}if(m&&console.log("392 k",eu),M="",eu){m&&console.log("411 k",eu);let ev="text",eb="",ew=!1,ej=!1,eT=!1,ek="",eO=!1,eM="",eD=[],eE=T[eu];if(m&&console.log("422 k",eu),m&&console.log("425 k",eu),"editObjectview"!==eh&&"editTypeview"!==eh&&"editRelshipview"!==eh&&"markedAsDeleted"!==eu&&!r.Cw(eu,i)){m&&console.log("428 k",eu);continue}if("fs_collection"===eu||"dash"===eu&&"object"==typeof eE&&"string"!=typeof(eE=eE.valueOf())||(m&&console.log("437 k",eu),"object"==typeof eE||"function"==typeof eE)||(m&&console.log("440 k",eu),er&&("name"===eu||"description"===eu||"title"===eu)))continue;switch(m&&console.log("444 k",eu),m&&console.log("446 k, item[k], instview: ",eu,T[eu],l),eh){case"editTypeview":w?eE=w.data[eu]:j&&(eE=j.data[eu]),eE=C[eu];break;case"editObjectview":case"editRelshipview":eE=l[eu];break;default:if(F&&"name"===eu){eE=O.getName();break}if("typeDescription"===eu){eE=O?O.type.description:C[eu];break}(eE=C[eu])||(eE=T[eu])}if(m&&console.log("457 k, val, item[k], selObj[k]: ",eu,eE,T[eu],C[eu]),(null==E?void 0:E.length)>0){m&&console.log("460 properties: ",E);for(let ex=0;ex<E.length;ex++){let eR=E[ex];if(eR&&eR.name===eu){let eN=eR.datatype,eA=eR.datatypeRef;eN||(eN=x.findDatatype(eA)),eN&&(ev=eN.fieldType,eb=eN.viewFormat,ek=eN.inputPattern,eM=eN.defaultValue,eD=eN.allowedValues,M=eR.description);let eS=eR.methodRef;if(eS){if(ej=!0,e.category===p.gojs.C_OBJECT){let eC=x.findObject(e.id);eC&&(e=eC)}else if(e.category===p.gojs.C_RELATIONSHIP){let eP=x.findRelationship(e.id);eP&&(e=eP)}m&&console.log("486 item, prop",T,eR);try{eE=T.getPropertyValue(eR,x)}catch(eI){}m&&console.log("492 item, prop, val",T,eR,eE)}let e_=O.getConnectedObjects1(eR,x);m&&console.log("496 prop, chosenInst, objs",eR,O,e_),(null==e_?void 0:e_.length)>1&&(eE="");for(let eL=0;eL<(null==e_?void 0:e_.length);eL++){let eV=e_[eL];eV&&(0==eL?eE=eV.name:eE+=" | "+eV.name)}}m&&console.log("495 prop, fieldType: ",eR,ev)}}if(m&&console.log("498 k, val, item[k], selObj[k]: ",eu,eE,T[eu],C[eu]),ed&&"fillcolor"===eu||ed&&"fillcolor2"===eu||ec&&"strokecolor"===eu||ec&&"strokecolor2"===eu){if(""===eE&&"editObjectview"===eh&&(eE=l.typeview.fillcolor),m&&console.log("507 instview, val",l,eE),ev="color",(null==eE?void 0:eE.substr(0,4))==="rgb("){m&&console.log("511 val",eE);let eF="#"+eE.match(/\d+/g).map(function(e){return 1==(e=parseInt(e).toString(16)).length?"0"+e:e}).join("");m&&console.log("516 color",eF),eE=eF.toUpperCase()}eE&&"#"!==eE[0]&&(eE=h(eE)),m&&console.log("523 color",eE)}m&&console.log("526 k, val",eu,eE,T[eu],C[eu]);{let eG;switch(eu){case"description":case"typeDescription":case"geometry":ev="textarea";break;case"cardinalityFrom":case"cardinalityTo":(eG=N.findDatatypeByName("cardinality"))&&(ev="select",eb=eG.viewFormat,ek=eG.inputPattern,eM=eG.defaultValue,eD=eG.allowedValues),S||(ej=!0);break;case"fieldType":case"viewkind":eG=N.findDatatypeByName(eu),m&&console.log("396 dtype",eG),eG&&(ev=eG.fieldType,ek=eG.inputPattern,eM=eG.defaultValue,eD=eG.allowedValues),S||(ej=!0);break;case"relshipkind":ev="select",eM="Association",eD=["Association","Generalization","Composition","Aggregation"];break;case"abstract":eG=x.findDatatypeByName("boolean"),b?ev="checkbox":(ev="radio",eM="false",eD=["false","true"]),S||(ej=!0);break;case"methodtype":let eK=N.methodtypes;eK&&(eD=eK.map(e=>e&&e.name),ev="radio");break;case"dash":eD=["None","Dashed","Dotted"],eM="None",ev="radio";break;case"template":C.isGroup?(m&&console.log("595 selObj",C),"Container"===C.viewkind&&(eD=d.$m(),eM="",ev="radio")):C.category===p.gojs.C_RELATIONSHIP?(eD=d.dW(),eM="",ev="radio"):C.category===p.gojs.C_RELSHIPTYPE?(eD=d.dW(),eM="",ev="radio"):(C.category===p.gojs.C_OBJECT||C.category===p.gojs.C_OBJECTTYPE)&&("Object"===C.viewkind?(eD=d.qi(),eM="",ev="radio"):"Container"===C.viewkind&&(eD=d.$m(),eM="",ev="radio"));break;case"figure":(C.category===p.gojs.C_OBJECT||C.category===p.gojs.C_OBJECTTYPE)&&(eD=d.g9(),eM="",ev="radio");break;case"fromArrow":eD=g,eM="None",ev="select";break;case"toArrow":eD=g,eM="OpenTriangle",ev="select";break;case"fillcolor":case"fillcolor2":ed||(eD=f,eM="white",ev="select");break;case"strokecolor":case"strokecolor2":ec||(eD=f,eM="black",ev="select");break;case"strokewidth":eD=y,eM="1",ev="select";break;case"textcolor":case"fromArrowColor":case"toArrowColor":eD=f,eM="black",ev="select"}}if("checkbox"===ev&&(eT=eE),"radio"===ev){m&&console.log("469 values, defValue",eD,eM),ev="select";let eB="^(",eU=")$",eJ="";for(let ez=0;ez<(null==eD?void 0:eD.length);ez++){let eH=eD[ez];m&&console.log("477 value",ez,eH),""===eJ?eJ=eH:eJ+="|"+eH}ek=eB+eJ+eU,m&&console.log("485 pattern",ek)}switch("select"===ev&&(m&&console.log("488 values, defValue",eD,eM),""===eE&&(eE=eM)),"name"===eu&&(ev="text"),eb&&c.isNumeric(eE)&&(eE=u(eb,Number(eE))),F&&(G>0&&(ej=!0),m&&console.log("699 tabIndex, disabled",G,ej)),eu){case"id":M="Unique identifier";case"typename":case"typeName":case"typedescription":case"typeDescription":case"loc":case"size":case"markedAsDeleted":case"modelId":case"metamodelId":case"modelviewId":ej=!0}ep&&"text"!==eu&&(ej=!0),m&&console.log("720 selObj, item:",C,T),m&&console.log("721 k, value, disabled:",eu,eE,ej),m&&"name"===eu&&console.log("722 k, fieldType",eu,ev,eM,eD),em=(0,o.jsx)(a,{id:eu,type:ev,value:eE,values:eD,description:M,default:eM,readonly:ew,disabled:ej,required:eO,checked:eT,pattern:ek,obj:C,context:P,onInputChange:this.props.onInputChange},eu)}"key"===eu?ea.unshift(em):ea.push(em)}}return m&&console.log("748 SelectionInspector ",ea),m&&console.log("749 myMetis",x),ea}render(){m&&console.log("754 SelectionInspector ",this.renderObjectDetails());let e=this.props.context;return e?(0,o.jsx)("div",{id:"myInspectorDiv",className:"inspector w-100",children:(0,o.jsx)("table",{className:"w-100",children:(0,o.jsx)("tbody",{className:"table-body",children:this.renderObjectDetails()})})}):null}}},4745:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return tf}});var o=l(5893),i=l(1857),n=l.n(i),s=l(7294),a=l(4416),r=l(1664),d=l.n(r),c=l(1163),p=l(1871),h=l(8261),u=l(1268),m=l(7243),g=l(3999),f=l(8008),y=l(9393),v=l(8829),b=l(267),w=l(1252),j=l(4184),T=l.n(j),k=l(2902),O=l(715),M=l(8726);class D extends O.h1{get guidelineSnapDistance(){return this._guidelineSnapDistance}set guidelineSnapDistance(e){if("number"!=typeof e||isNaN(e)||e<0)throw Error("new value for GuideddraggingTool.guidelineSnapDistance must be a non-negative number");this._guidelineSnapDistance!==e&&(this._guidelineSnapDistance=e)}get isGuidelineEnabled(){return this._isGuidelineEnabled}set isGuidelineEnabled(e){if("boolean"!=typeof e)throw Error("new value for GuidedDraggingTool.isGuidelineEnabled must be a boolean value.");this._isGuidelineEnabled!==e&&(this._isGuidelineEnabled=e)}get horizontalGuidelineColor(){return this._horizontalGuidelineColor}set horizontalGuidelineColor(e){this._horizontalGuidelineColor!==e&&(this._horizontalGuidelineColor=e,this.guidelineHbottom.elements.first().stroke=this._horizontalGuidelineColor,this.guidelineHtop.elements.first().stroke=this._horizontalGuidelineColor)}get verticalGuidelineColor(){return this._verticalGuidelineColor}set verticalGuidelineColor(e){this._verticalGuidelineColor!==e&&(this._verticalGuidelineColor=e,this.guidelineVleft.elements.first().stroke=this._verticalGuidelineColor,this.guidelineVright.elements.first().stroke=this._verticalGuidelineColor)}get centerGuidelineColor(){return this._centerGuidelineColor}set centerGuidelineColor(e){this._centerGuidelineColor!==e&&(this._centerGuidelineColor=e,this.guidelineVcenter.elements.first().stroke=this._centerGuidelineColor,this.guidelineHcenter.elements.first().stroke=this._centerGuidelineColor)}get guidelineWidth(){return this._guidelineWidth}set guidelineWidth(e){if("number"!=typeof e||isNaN(e)||e<0)throw Error("New value for GuidedDraggingTool.guidelineWidth must be a non-negative number.");this._guidelineWidth!==e&&(this._guidelineWidth=e,this.guidelineVcenter.elements.first().strokeWidth=e,this.guidelineHcenter.elements.first().strokeWidth=e,this.guidelineVleft.elements.first().strokeWidth=e,this.guidelineVright.elements.first().strokeWidth=e,this.guidelineHbottom.elements.first().strokeWidth=e,this.guidelineHtop.elements.first().strokeWidth=e)}get searchDistance(){return this._searchDistance}set searchDistance(e){if("number"!=typeof e||isNaN(e)||e<=0)throw Error("new value for GuidedDraggingTool.searchDistance must be a positive number.");this._searchDistance!==e&&(this._searchDistance=e)}get isGuidelineSnapEnabled(){return this._isGuidelineSnapEnabled}set isGuidelineSnapEnabled(e){if("boolean"!=typeof e)throw Error("new value for GuidedDraggingTool.isGuidelineSnapEnabled must be a boolean.");this._isGuidelineSnapEnabled!==e&&(this._isGuidelineSnapEnabled=e)}clearGuidelines(){this.diagram.remove(this.guidelineHbottom),this.diagram.remove(this.guidelineHcenter),this.diagram.remove(this.guidelineHtop),this.diagram.remove(this.guidelineVleft),this.diagram.remove(this.guidelineVright),this.diagram.remove(this.guidelineVcenter)}doDeactivate(){super.doDeactivate(),this.clearGuidelines()}doDragOver(e,t){this.clearGuidelines();let l=this.copiedParts||this.draggedParts;if(null===l)return;let o=l.iterator;if(o.next()){let i=o.key;this.showHorizontalMatches(i,this.isGuidelineEnabled,!1),this.showVerticalMatches(i,this.isGuidelineEnabled,!1)}}doDropOnto(e,t){this.clearGuidelines();let l=this.copiedParts||this.draggedParts;if(null===l)return;let o=l.iterator;if(o.next()){let i=o.key,n=this.diagram.lastInput,s=this.isGuidelineSnapEnabled&&!n.shift;this.showHorizontalMatches(i,!1,s),this.showVerticalMatches(i,!1,s)}}invalidateLinks(e){e instanceof O.NB&&e.invalidateConnectedLinks()}showHorizontalMatches(e,t,l){var o;let i=e.locationObject.getDocumentBounds(),n=i.y,s=i.y+i.height/2,a=i.y+i.height,r=this.guidelineSnapDistance,d=this.searchDistance,c=i.copy();c.inflate(d,r+1);let p=null===(o=this.diagram)||void 0===o?void 0:o.findObjectsIn(c,e=>e.part,e=>e instanceof O.Lz&&!e.isSelected&&!(e instanceof O.rU)&&e.isTopLevel&&null!==e.layer&&!e.layer.isTemporary,!0),h=r,u=null,m=O.z6.Default,g=O.z6.Default;if(p.each(t=>{if(t===e)return;let l=t.locationObject.getDocumentBounds(),o=l.y,i=l.y+l.height/2,r=l.y+l.height;Math.abs(s-i)<h&&(h=Math.abs(s-i),u=t,m=O.z6.Center,g=O.z6.Center),Math.abs(n-o)<h?(h=Math.abs(n-o),u=t,m=O.z6.Top,g=O.z6.Top):Math.abs(n-r)<h&&(h=Math.abs(n-r),u=t,m=O.z6.Top,g=O.z6.Bottom),Math.abs(a-o)<h?(h=Math.abs(a-o),u=t,m=O.z6.Bottom,g=O.z6.Top):Math.abs(a-r)<h&&(h=Math.abs(a-r),u=t,m=O.z6.Bottom,g=O.z6.Bottom)}),null!==u){let f=i.x-e.actualBounds.x,y=i.y-e.actualBounds.y,v=u.locationObject.getDocumentBounds(),b=Math.min(i.x,v.x)-10,w=Math.max(i.x+i.width,v.x+v.width)+10,j=new O.E9().setRectSpot(v,g);m===O.z6.Center?(l&&(e.move(new O.E9(i.x-f,j.y-i.height/2-y)),this.invalidateLinks(e)),t&&(this.guidelineHcenter.position=new O.E9(b,j.y),this.guidelineHcenter.elt(0).width=w-b,this.diagram.add(this.guidelineHcenter))):m===O.z6.Top?(l&&(e.move(new O.E9(i.x-f,j.y-y)),this.invalidateLinks(e)),t&&(this.guidelineHtop.position=new O.E9(b,j.y),this.guidelineHtop.elt(0).width=w-b,this.diagram.add(this.guidelineHtop))):m===O.z6.Bottom&&(l&&(e.move(new O.E9(i.x-f,j.y-i.height-y)),this.invalidateLinks(e)),t&&(this.guidelineHbottom.position=new O.E9(b,j.y),this.guidelineHbottom.elt(0).width=w-b,this.diagram.add(this.guidelineHbottom)))}}showVerticalMatches(e,t,l){var o,i;let n=e.locationObject.getDocumentBounds(),s=n.x,a=n.x+n.width/2,r=n.x+n.width,d=this.guidelineSnapDistance,c=this.searchDistance,p=n.copy();p.inflate(d+1,c);let h=null===(o=this)||void 0===o?void 0:null===(i=o.diagram)||void 0===i?void 0:i.findObjectsIn(p,e=>e.part,e=>e instanceof O.Lz&&!e.isSelected&&!(e instanceof O.rU)&&e.isTopLevel&&null!==e.layer&&!e.layer.isTemporary,!0),u=d,m=null,g=O.z6.Default,f=O.z6.Default;if(h.each(t=>{if(t===e)return;let l=t.locationObject.getDocumentBounds(),o=l.x,i=l.x+l.width/2,n=l.x+l.width;Math.abs(a-i)<u&&(u=Math.abs(a-i),m=t,g=O.z6.Center,f=O.z6.Center),Math.abs(s-o)<u?(u=Math.abs(s-o),m=t,g=O.z6.Left,f=O.z6.Left):Math.abs(s-n)<u&&(u=Math.abs(s-n),m=t,g=O.z6.Left,f=O.z6.Right),Math.abs(r-o)<u?(u=Math.abs(r-o),m=t,g=O.z6.Right,f=O.z6.Left):Math.abs(r-n)<u&&(u=Math.abs(r-n),m=t,g=O.z6.Right,f=O.z6.Right)}),null!==m){let y=n.x-e.actualBounds.x,v=n.y-e.actualBounds.y,b=m.locationObject.getDocumentBounds(),w=Math.min(n.y,b.y)-10,j=Math.max(n.y+n.height,b.y+b.height)+10,T=new O.E9().setRectSpot(b,f);g===O.z6.Center?(l&&(e.move(new O.E9(T.x-n.width/2-y,n.y-v)),this.invalidateLinks(e)),t&&(this.guidelineVcenter.position=new O.E9(T.x,w),this.guidelineVcenter.elt(0).height=j-w,this.diagram.add(this.guidelineVcenter))):g===O.z6.Left?(l&&(e.move(new O.E9(T.x-y,n.y-v)),this.invalidateLinks(e)),t&&(this.guidelineVleft.position=new O.E9(T.x,w),this.guidelineVleft.elt(0).height=j-w,this.diagram.add(this.guidelineVleft))):g===O.z6.Right&&(l&&(e.move(new O.E9(T.x-n.width-y,n.y-v)),this.invalidateLinks(e)),t&&(this.guidelineVright.position=new O.E9(T.x,w),this.guidelineVright.elt(0).height=j-w,this.diagram.add(this.guidelineVright)))}}constructor(){super(),this._guidelineSnapDistance=6,this._isGuidelineEnabled=!0,this._horizontalGuidelineColor="gray",this._verticalGuidelineColor="gray",this._centerGuidelineColor="gray",this._guidelineWidth=1,this._searchDistance=1e3,this._isGuidelineSnapEnabled=!0;let e={layerName:"Tool",isInDocumentBounds:!1},t={stroke:"gray",isGeometryPositioned:!0},l=O.bx.make;this.guidelineHtop=l(O.Lz,e,l(O.bn,t,{geometryString:"M0 0 100 0"})),this.guidelineHbottom=l(O.Lz,e,l(O.bn,t,{geometryString:"M0 0 100 0"})),this.guidelineHcenter=l(O.Lz,e,l(O.bn,t,{geometryString:"M0 0 100 0"})),this.guidelineVleft=l(O.Lz,e,l(O.bn,t,{geometryString:"M0 0 0 100"})),this.guidelineVright=l(O.Lz,e,l(O.bn,t,{geometryString:"M0 0 0 100"})),this.guidelineVcenter=l(O.Lz,e,l(O.bn,t,{geometryString:"M0 0 0 100"}))}}class E extends s.Component{componentDidMount(){if(!this.diagramRef.current)return;let e=this.diagramRef.current.getDiagram();e instanceof O.S0&&e.addDiagramListener("ChangedSelection",this.props.onDiagramEvent)}componentWillUnmount(){if(!this.diagramRef.current)return;let e=this.diagramRef.current.getDiagram();e instanceof O.S0&&e.removeDiagramListener("ChangedSelection",this.props.onDiagramEvent)}initPalette(){let e;let t=O.bx.make;{let l;e=t(O.YI,{initialContentAlignment:O.z6.Top,maxSelectionCount:6,layout:t(O.Me,{sorting:O.Me.Forward,wrappingColumn:1}),draggingTool:new D,grid:t(O.s_,"Grid",t(O.bn,"LineH",{stroke:"lightblue",strokeWidth:.5}),t(O.bn,"LineH",{stroke:"blue",strokeWidth:.5,interval:10}),t(O.bn,"LineV",{stroke:"lightblue",strokeWidth:.5}),t(O.bn,"LineV",{stroke:"blue",strokeWidth:.5,interval:10})),model:t(O.FJ,{linkKeyProperty:"key"})}),l=t(O.NB,"Auto",{click:function(e,t){}},new O.KX("text","name"),t(O.bn,"RoundedRectangle",{name:"SHAPE",fill:"lightyellow",stroke:"black"},new O.KX("fill","fillcolor"),new O.KX("stroke","strokecolor"),new O.KX("strokeWidth","strokewidth")),t(O.s_,"Horizontal",t(O.t,{name:"Picture",desiredSize:new O.$u(20,20),margin:new O.Zt(0,0,0,3)},new O.KX("source","icon",s)),t(O.s_,"Table",{defaultRowSeparatorStroke:"black",maxSize:new O.$u(100,999),minSize:new O.$u(90,15),margin:new O.Zt(6,10,0,0),defaultAlignment:O.z6.Left},t(O.jE,{column:2,width:4}),t(O.al,a(),{row:0,column:0,columnSpan:6,font:"12pt Segoe UI,sans-serif",editable:!1,isMultiline:!0,minSize:new O.$u(10,16),name:"name"},new O.KX("text","name").makeTwoWay()))));let o=new O.D5;o.add("",l),e.nodeTemplateMap=o;let i=t(O.ZA,"Auto",new O.KX("text","name"),t(O.bn,"RoundedRectangle",{name:"SHAPE",fill:"lightyellow",stroke:"black"},new O.KX("fill","fillcolor"),new O.KX("stroke","strokecolor"),new O.KX("strokeWidth","strokewidth")),t(O.s_,"Vertical",t(O.s_,"Table",{defaultRowSeparatorStroke:"black",maxSize:new O.$u(100,999),minSize:new O.$u(90,40),margin:new O.Zt(6,10,0,3),defaultAlignment:O.z6.TopLeft},t(O.jE,{column:2,width:4}),t(O.al,a(),{row:0,column:0,columnSpan:6,font:"12pt Segoe UI,sans-serif",editable:!0,isMultiline:!1,minSize:new O.$u(80,40),name:"name"},new O.KX("text","name").makeTwoWay())))),n=new O.D5;n.add("",i),e.groupTemplateMap=n}return e;function s(e){return e&&!e.includes("//")?"./../images/"+e:""}function a(){return{font:"9pt  Segoe UI,sans-serif",stroke:"black"}}}render(){var e,t;let l="diagram-component-objects"===this.props.divClassName?"diagram-component-objects":"diagram-component-target"===this.props.divClassName?"diagram-component-target":"diagram-component-palette";return(0,o.jsx)(M.FI,{ref:this.diagramRef,divClassName:l,initDiagram:this.initPalette,nodeDataArray:null===(e=this.props)||void 0===e?void 0:e.nodeDataArray,linkDataArray:null===(t=this.props)||void 0===t?void 0:t.linkDataArray,modelData:this.props.modelData,onModelChange:this.props.onModelChange,skipsDiagramUpdate:this.props.skipsDiagramUpdate})}constructor(e){super(e),this.myMetis=e.myMetis,this.diagramRef=s.createRef(),this.initPalette=this.initPalette.bind(this)}}var x=l(8809),R=l(137);let N=!1;class A extends s.Component{refreshNodeIndex(e){this.mapNodeKeyIdx.clear(),null==e||e.forEach((e,t)=>{this.mapNodeKeyIdx.set(null==e?void 0:e.key,t)})}refreshLinkIndex(e){this.mapLinkKeyIdx.clear(),null==e||e.forEach((e,t)=>{this.mapLinkKeyIdx.set(e.key,t)})}handleDiagramEvent(e){let t=e.name;switch(t){case"ChangedSelection":{let l=e.subject.first();if(!l)break;l.data,N&&console.log("104 data",l.data);let o=this.state.myMetis;N&&console.log("106 myMetis",o);let i=l.data.object,n=o.findObject(null==i?void 0:i.id);if(i=n||i,N&&console.log("110 obj",n),n){let s=new R.GZ(n),a=[];a.push(s),a.map(e=>{var t;let l=e;l=JSON.parse(JSON.stringify(l)),null===(t=this.props)||void 0===t||t.dispatch({type:"SET_FOCUS_OBJECT",data:l})})}}}}handleModelChange(e){let t=e.insertedNodeKeys,l=e.modifiedNodeData,o=e.removedNodeKeys,i=e.insertedLinkKeys,n=e.modifiedLinkData,s=e.removedLinkKeys,a=e.modelData,r=new Map,d=new Map;this.setState((0,k.Uy)(e=>{let c=e.nodeDataArray;l&&l.forEach(t=>{r.set(t.key,t);let l=this.mapNodeKeyIdx.get(t.key);void 0!==l&&l>=0&&(c[l]=t,e.selectedData&&e.selectedData.key===t.key&&(e.selectedData=t))}),t&&t.forEach(e=>{let t=r.get(e),l=this.mapNodeKeyIdx.get(e);t&&void 0===l&&(this.mapNodeKeyIdx.set(t.key,c.length),c.push(t))}),o&&(c=c.filter(e=>!o.includes(e.key)),e.nodeDataArray=c,this.refreshNodeIndex(c));let p=e.linkDataArray;n&&n.forEach(t=>{d.set(t.key,t);let l=this.mapLinkKeyIdx.get(t.key);void 0!==l&&l>=0&&(p[l]=t,e.selectedData&&e.selectedData.key===t.key&&(e.selectedData=t))}),i&&i.forEach(e=>{let t=d.get(e),l=this.mapLinkKeyIdx.get(e);t&&void 0===l&&(this.mapLinkKeyIdx.set(t.key,p.length),p.push(t))}),s&&(p=p.filter(e=>!s.includes(e.key)),e.linkDataArray=p,this.refreshLinkIndex(p)),a&&(e.modelData=a),e.skipsDiagramUpdate=!0}))}handleInputChange(e,t,l){this.setState((0,k.Uy)(o=>{let i=o.selectedData;if(i[e]=t,l){let n=i.key;if(n<0){let s=this.mapLinkKeyIdx.get(n);void 0!==s&&s>=0&&(o.linkDataArray[s]=i,o.skipsDiagramUpdate=!1)}else{let a=this.mapNodeKeyIdx.get(n);void 0!==a&&a>=0&&(o.nodeDataArray[a]=i,o.skipsDiagramUpdate=!1)}}}))}handleRelinkChange(e){let t=e.target,l=t.checked;this.setState({modelData:{canRelink:l},skipsDiagramUpdate:!1})}render(){let e;let t=this.state.selectedData;return N&&console.log("269 selectedData",t),null!==t&&(e=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("p",{children:"Selected Object Properties:"}),(0,o.jsx)(x.R,{selectedData:this.state.selectedData,onInputChange:this.handleInputChange}),";"]})),(0,o.jsx)("div",{children:(0,o.jsx)(E,{nodeDataArray:this.state.nodeDataArray,linkDataArray:this.state.linkDataArray,modelData:this.state.modelData,skipsDiagramUpdate:this.state.skipsDiagramUpdate,onDiagramEvent:this.handleDiagramEvent,onModelChange:this.handleModelChange})})}constructor(e){var t,l;super(e),N&&console.log("47 GoJSPaletteApp",e.nodeDataArray),this.state={nodeDataArray:null===(t=this.props)||void 0===t?void 0:t.nodeDataArray,linkDataArray:null===(l=this.props)||void 0===l?void 0:l.linkDataArray,modelData:{canRelink:!1},selectedData:null,skipsDiagramUpdate:!1,metis:this.props.metis,myMetis:this.props.myMetis,myGoModel:this.props.myGoModel,phFocus:this.props.phFocus,dispatch:this.props.dispatch},N&&console.log("55 myMetis",this.state.myMetis),this.mapNodeKeyIdx=new Map,this.mapLinkKeyIdx=new Map,this.refreshNodeIndex(this.state.nodeDataArray),this.refreshLinkIndex(this.state.linkDataArray),this.handleDiagramEvent=this.handleDiagramEvent.bind(this)}}var S=A;let C=!1,P=e=>{var t,l;let i,n;C&&console.log("8 selector",e);let s=(0,a.I0)(),r=e.refresh,d=e.setRefresh;function c(){d(!r)}let p=e.type,h=e.selArray;C&&console.log("14 Selector",e);let u=e=>{C&&console.log("19 Selector",e);let t=JSON.parse(e.value).id,l=JSON.parse(e.value).name,o=(h.find(e=>e.id===t),{id:t,name:l});C&&console.log("26 selector",JSON.parse(e.value),o,p),s({type:p,data:o})};n="Model"===e.selName?null===(t=e.focusModel)||void 0===t?void 0:t.name:null===(l=e.focusModelview)||void 0===l?void 0:l.name,C&&console.log("37 selector",e,n),i=h&&h.map((t,l)=>t&&t.name!=="Select "+e.selName+"..."&&(0,o.jsx)("option",{value:JSON.stringify({id:t.id,name:t.name,type:p}),children:t.name},t.id+l));let m="Model"===e.selName||"Modelviews"===e.selName?"Model"===e.selName?(0,o.jsx)("div",{className:"mod-modview",children:(0,o.jsxs)("div",{className:"select",children:[(0,o.jsxs)("span",{className:"title mx-0 float-left ",children:[e.selName," :"]}),(0,o.jsx)("select",{className:"list-obj mx-2 w-75",defaultValue:"Select ".concat(e.selName," ..."),onChange:e=>u({value:e.target.value}),name:"Focus ".concat(e.selName," ..."),children:i},n)]},e.type)}):(0,o.jsxs)("div",{className:"select",children:[(0,o.jsxs)("span",{className:"title mx-2 ",children:[e.selName,":"]}),(0,o.jsx)("select",{className:"list-obj mx-2",defaultValue:"Select ".concat(e.selName," ..."),onChange:e=>{u({value:e.target.value}),c()},name:"Focus ".concat(e.selName," ..."),children:i},e.type)]},e.type):(0,o.jsx)("div",{className:"mod-modview",children:(0,o.jsx)("div",{className:"select",children:(0,o.jsxs)("select",{className:"list-obj w-100",defaultValue:"Select ".concat(e.selName," ..."),style:{width:"68%"},onChange:e=>u({value:e.target.value}),name:"Focus ".concat(e.selName," ..."),children:[(0,o.jsx)("option",{defaultValue:"selectatask",children:" -- select a task -- "}),i]},n)},e.type)});return(0,o.jsx)(o.Fragment,{children:m})};var I=P;let _=!1,L=(e,t)=>{if(_&&console.log("7 genRoleTasks",e),_&&console.log("11 genRoleTasks",e.objecttypes0,e.objecttypes),(null==e?void 0:e.objecttypes0.length)>0){var l,o;let i=null==e?void 0:null===(l=e.objecttypes0)||void 0===l?void 0:l.map(e=>({id:e.id,name:e.name,description:e.description,icon:e.icon,color:e.color,type:e.type})),n=null==e?void 0:null===(o=e.objecttypes)||void 0===o?void 0:o.map(e=>({id:e.id,name:e.name,description:e.description,icon:e.icon,color:e.color,type:e.type}));_&&console.log("21  oTyp",n,i);let s=n.sort((e,t)=>e.name>t.name?1:-1),a=i.length>0&&{focusRole:{id:"Modeller1",name:"Modeller 1",tasks:[{id:"task00",name:"All types",description:"All types modelling",workOnTypes:["Container","EntityType","Information","Role","Task","View",...null==n?void 0:n.map(e=>"Container"!==e.name&&"EntityType"!==e.name&&"Information"!==e.name&&"Role"!==e.name&&"Task"!==e.name&&"View"!==e.name&&e.name)]},{id:"Task0",name:"Modelling",workOnTypes:["Container","EntityType","Information","Role","Task","View",...null==i?void 0:i.map(e=>"Container"!==e.name&&"EntityType"!==e.name&&"Information"!==e.name&&"Role"!==e.name&&"Task"!==e.name&&"View"!==e.name&&e.name)]},{id:"task1",name:"Entity Modelling",description:"Create New Entity using objecttype: EntityType",workOnTypes:["Container","EntityType","Property","Datatype","Value","Method","ViewFormat","InputPattern","FieldType","Unittype"]},{id:"task2",name:"Property Modelling",description:"Add property to EtityType definitions",workOnTypes:["Container","EntityType","Property","Datatype"]},{id:"task3",name:"Task Modelling",description:"Add property to EtityType definitions",workOnTypes:["Container","EntityType","Information","Role","Task","View"]}]}};_&&console.log("114 datarole",i,a),i.length>0&&t({type:"SET_FOCUS_ROLE",data:a.focusRole});let r={focusTask:{id:"Task4",name:"Modelling",description:"Modelling",workOnTypes:["Container","EntityType","Information","Role","Task","View","Label","Property","Generic","Label",...null==s?void 0:s.map(e=>"Container"!==e.name&&"EntityType"!==e.name&&"Information"!==e.name&&"Role"!==e.name&&"Task"!==e.name&&"View"!==e.name&&"Label"!==e.name&&"Property"!==e.name&&"Generic"!==e.name&&"Datatype"!==e.name&&"InputPattern"!==e.name&&"FieldType"!==e.name&&"Unittype"!==e.name&&"Value"!==e.name&&"ViewFormat"!==e.name&&"Method"!==e.name&&"MethodType"!==e.name&&"View"!==e.name&&"RelshipType"!==e.name&&"ExclusiveGate"!==e.name&&"Process"!==e.name&&"Function"!==e.name&&"Activity"!==e.name&&"Start"!==e.name&&"End"!==e.name&&"ExclusiveGate"!==e.name&&"InclusiveGate"!==e.name&&"ParallelGate"!==e.name&&e.name).filter(Boolean),"Process","Function","Activity","Start","End","ExclusiveGate","InclusiveGate","ParallelGate","Datatype","InputPattern","FieldType","Unittype","Value","ViewFormat","Method","MethodType","RelshipType"]}};return _&&console.log("187 focusTasks",r),r&&t({type:"SET_FOCUS_TASK",data:r.focusTask}),_&&console.log("190 focusTasks",r.focusTask.workOnTypes),r.focusTask.workOnTypes}};var V=L;let F=!1,G=console.log.bind(console,"%c %s","background: blue; color: white");console.trace.bind(console,"%c %s","background: blue; color: white");let K=e=>{var t,l,i,n,r,d,c,p,h,u,m,g,f,y,v,b,w,j,T,k,O;F&&G("20 Palette",e);let M=(0,a.I0)(),D=(0,s.useRef)(!1),[E,x]=(0,s.useState)(!0),[R,N]=(0,s.useState)(!0),[A,C]=(0,s.useState)(!0),[P,I]=(0,s.useState)("1"),_=null===(t=e.phFocus)||void 0===t?void 0:t.focusModel,L=null===(l=e.metis)||void 0===l?void 0:l.models,K=null===(i=e.metis)||void 0===i?void 0:i.metamodels,B=null==L?void 0:L.find(e=>(null==e?void 0:e.id)===(null==_?void 0:_.id)),U=null==K?void 0:K.find(e=>(null==e?void 0:e.id)===(null==B?void 0:B.metamodelRef));F&&console.log("16",e,null==U?void 0:U.name,null==B?void 0:B.metamodelRef);let J=null===(n=e.phFocus)||void 0===n?void 0:n.focusTask,z=(null===(r=e.phFocus)||void 0===r?void 0:null===(d=r.focusRole)||void 0===d?void 0:d.tasks)||[];function H(){x(!E)}F&&console.log("38 seltasks",e.phFocus.focusRole,null===(c=e.phFocus.focusRole)||void 0===c?void 0:c.tasks,z);let W=null===(p=e.gojsMetamodel)||void 0===p?void 0:p.nodeDataArray;F&&console.log("65 propsMetamodel",null==B?void 0:B.name,null==U?void 0:U.name,W);let X=W;if(J){let Y=null===(k=e.phFocus.focusTask)||void 0===k?void 0:null===(O=k.workOnTypes)||void 0===O?void 0:O.map(e=>null==W?void 0:W.find(t=>(null==t?void 0:t.typename)===e&&t)).filter(Boolean);X=Y||[],F&&console.log("73 taskNodeDataArray",Y)}if((0,s.useEffect)(()=>{let e=[];return D=!0,F&&G("82 Palette useEffect"),(null==(e=V(U,M))?void 0:e.length)>0&&(X=null==e?void 0:e.map(e=>null==W?void 0:W.find(t=>(null==t?void 0:t.typename)===e&&t)).filter(Boolean)),()=>{D=!1}},[]),(0,s.useEffect)(()=>{let e=[];return D=!0,F&&G("106 Palette useEffect"),(null==(e=V(U,M))?void 0:e.length)>0&&(X=null==e?void 0:e.map(e=>null==W?void 0:W.find(t=>(null==t?void 0:t.typename)===e&&t)).filter(Boolean)),()=>{D=!1}},[null===(h=e.phFocus)||void 0===h?void 0:null===(u=h.focusModel)||void 0===u?void 0:u.id]),F&&console.log("86 Palette useEffect 2",e.phFocus.focusTask.workOnTypes),(0,s.useEffect)(()=>{var t,l,o;F&&console.log("88 Palette useEffect 2",e.phFocus.focusTask.workOnTypes),(null===(t=e.phFocus)||void 0===t?void 0:t.focusTask.workOnTypes)&&(X=null===(l=e.phFocus.focusTask)||void 0===l?void 0:null===(o=l.workOnTypes)||void 0===o?void 0:o.map(e=>null==W?void 0:W.find(t=>(null==t?void 0:t.typename)===e&&t)).filter(Boolean),F&&console.log("91 taskNodeDataArray",X,X),F&&console.log("94 seltasks",e.phFocus.focusTask))},[null===(m=e.phFocus)||void 0===m?void 0:null===(g=m.focusTask)||void 0===g?void 0:g.id]),!e.gojsModel||!e.gojsMetamodel)return null;F&&G("103 Palette",e,z);let Z=X&&X[0]?X:W;F&&console.log("111 filteredOtNodeDataArray",Z);let $=U?(0,o.jsx)("span",{className:"metamodel-name",children:null==U?void 0:U.name}):(0,o.jsx)("span",{children:"No metamodel"});U?(0,o.jsx)("span",{className:"metamodel-name",children:null==B?void 0:B.name}):(0,o.jsx)("span",{children:"No model"}),z=(null===(f=e.phFocus.focusRole)||void 0===f?void 0:f.tasks)&&(null===(y=e.phFocus.focusRole)||void 0===y?void 0:null===(v=y.tasks)||void 0===v?void 0:v.map(e=>e)),F&&console.log("163 Palette",null===(b=e.phFocus)||void 0===b?void 0:b.focusRole,"tasks:",null===(w=e.phFocus)||void 0===w?void 0:null===(j=w.focusRole)||void 0===j?void 0:j.tasks,"task: ",null===(T=e.phFocus)||void 0===T?void 0:T.focusTask,"seltasks :",z),o.Fragment,null==J||J.name;let q=(0,o.jsxs)("div",{className:"workpad p-1 pt-2 bg-white",children:[(0,o.jsx)("div",{className:"mmname mx-0 px-2 my-3",style:{fontSize:"16px",minWidth:"184px",maxWidth:"212px"},children:$}),(0,o.jsx)(S,{nodeDataArray:Z,linkDataArray:[],metis:e.metis,myMetis:e.myMetis,myGoModel:e.myGoModel,phFocus:e.phFocus,dispatch:e.dispatch})]}),Q=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("button",{className:"btn-sm px-1 m-0 text-left w-100",style:{backgroundColor:"#69a",outline:"0",borderStyle:"none"},onClick:H,children:[" ",E?(0,o.jsx)("span",{children:" <- Palette "}):(0,o.jsx)("span",{children:" ->"})]}),(0,o.jsx)("div",{children:E?R?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"btn-horizontal bg-light mx-0 px-1 mb-1",style:{fontSize:"11px",minWidth:"166px",maxWidth:"160px"}}),q]}):(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"btn-horizontal bg-light mx-0 px-1 mb-1",style:{fontSize:"11px",minWidth:"166px",maxWidth:"160px"}}),q]}):(0,o.jsxs)("div",{className:"btn-vertical px-1 text-center",style:{maxWidth:"4px",padding:"0px"},children:[(0,o.jsx)("span",{children:" P a l e t t e "})," "]})})]});return F&&G("265 Palette",e),(0,o.jsx)(o.Fragment,{children:Q})};var B=K,U=l(7896),J=l(8692),z=l(6571),H=l(7975),W=l(2701),X=l(684),Y=l(6396),Z=l(162),$=l(8749),q=l(6680),Q=l(6433),ee=l(6575),et=l(5506);let el=!1,eo=l(2586),ei=l(3165),en=["Element","Entity","Property","Datatype","Method","Unittype","Value","FieldType","InputPattern","ViewFormat","Generic","Container"];class es extends s.Component{handleOpenModal(e,t){this.setState({selectedData:e,modalContext:t,selectedOption:null,showModal:!0}),el&&console.log("92 node",this.state.selectedData)}handleCloseModal(e){var t,l;el&&console.log("113 handleCloseModal"),this.props;let o=this.state.modalContext,i=null===(t=o.selected)||void 0===t?void 0:t.value;i||(i=o.typename),el&&console.log("113 typename: ",i);let n=null===(l=o.context)||void 0===l?void 0:l.myDiagram,s=o.data;if(el&&console.log("122 modalContext",o),"x"===e){n&&n.model.removeLinkData(s),this.setState({showModal:!1,selectedData:null,modalContext:null});return}let a={data:o.data,typename:i,fromType:o.fromType,toType:o.toType,nodeFrom:o.nodeFrom,nodeTo:o.nodeTo,context:o.context};el&&console.log("128 args",a),Q.Pv(a),this.setState({showModal:!1,selectedData:null,modalContext:null})}handleModelChange(e){e.insertedNodeKeys,e.modifiedNodeData,e.removedNodeKeys,e.insertedLinkKeys,e.modifiedLinkData,e.removedLinkKeys,e.modelData}getNode(e,t){let l=null==e?void 0:e.nodes;if(l)for(let o=0;o<(null==l?void 0:l.length);o++){let i=l[o];if(i&&i.key===t)return i}return null}getLink(e,t){let l=e.links;if(l)for(let o=0;o<l.length;o++){let i=l[o];if(i&&i.key===t)return i}return null}isSystemType(e){for(let t=0;t<en.length;t++){let l=en[t];if(e.name===l)return!0}return!1}isMetamodelType(e){let t=!1;return(e===eo.types.OBJECTTYPE||e===eo.types.RELATIONSHIPTYPE)&&(t=!0),t}handleDiagramEvent(e){let t=this.state.dispatch,l=e.name,o=e.diagram,i=this.state.myMetis;el&&console.log("208 handleDiagramEvent",i);let n=null==i?void 0:i.findModel(null===(lK=this.state.phFocus)||void 0===lK?void 0:lK.focusModel.id),s=null==i?void 0:i.findModelView(null===(lB=this.state.phFocus)||void 0===lB?void 0:lB.focusModelview.id),a=null==n?void 0:n.getMetamodel(),r=this.state.myGoModel,d=this.state.myGoMetamodel;el&&console.log("214 handleDiagramEvent",d);let c={nodeDataArray:null==r?void 0:r.nodes,linkDataArray:null==r?void 0:r.links};el&&console.log("219 gojsModel",c);let p=[],h=null==d?void 0:d.nodes;for(let u=0;u<(null==h?void 0:h.length);u++){let m=h[u],g=m.objecttype;!g.abstract&&(g.markedAsDeleted||p.push(m))}(null==p?void 0:p.length)>0&&(d.nodes=p),el&&console.log("230 gojsMetamodel",d);let f={nodeDataArray:null==d?void 0:d.nodes,linkDataArray:null==d?void 0:d.links};el&&console.log("236 gojsMetamodel",f);let y=[],v=[],b=[],w=[],j=[],T=[],k=[],M=[],D=[],E=!1,x=!1,N={myMetis:i,myMetamodel:a,myModel:n,myModelview:s,myGoModel:r,myGoMetamodel:d,myDiagram:o,dispatch:t,pasted:x,done:E,askForRelshipName:null==s?void 0:s.askForRelshipName,includeInheritedReltypes:null==s?void 0:s.includeInheritedReltypes,handleOpenModal:this.handleOpenModal,modifiedLinks:null,modifiedRelships:null,modifiedTypeLinks:null,modifiedLinkTypeViews:null};switch(el&&console.log("265 handleDiagramEvent - context",l,this.state,N),el&&console.log("266 handleEvent",i),el&&console.log("267 this",this),el&&console.log("268 event name",l),l){case"TextEdited":{let A=e.subject.part,S=A.data,C=S.text,P=e.subject.name;if(el&&console.log("275 data",S,P,A),A instanceof O.NB){let I=S.key,_=S.name,L=S.category;if(el&&console.log("281 data",S),L===eo.gojs.C_OBJECTTYPE){"Edit name"===_&&(_=prompt("Enter name"));let V=A;if(el&&console.log("290 myNode, text",V,_),V){S.name=_,el&&console.log("293 data, field, text",S,P,_),Q.Bc(S,P,_,N),el&&console.log("295 TextEdited",S);let F=i.findObjectType(null===(lU=S.objecttype)||void 0===lU?void 0:lU.id);if(F){let G=new R.vM(F,!0);b.push(G),el&&console.log("300 TextEdited",G)}}}else{"Edit name"===_&&(_=prompt("Enter name"),S.name=_);let K=this.getNode(r,I);if(K.text=C,el&&console.log("310 textvalue, node",C,K),K){K.name=_,el&&console.log("314 field, text, node",P,_,K);let B=Q.v4(K,P,_,N);if(el&&console.log("316 data, node",S,K),B||(B=K.object),B){B.name=_,B.text=C,K.object=B;let U=B.objectviews;for(let J=0;J<U.length;J++){let z=U[J];z.name=_,z.text=C,el&&console.log("328 objview",z);let H=r.findNodeByViewId(null==z?void 0:z.id);if(H){el&&console.log("330 node",H);let W=o.findNodeForKey(H.key);W&&(H=W),null===(lJ=o.model)||void 0===lJ||lJ.setDataProperty(H.data,"name",K.name);let X=new R.kC(z);X.name=_,X.text=C,y.push(X),el&&console.log("337 jsnObjview",X)}}}let Y=new R.GZ(B);Y.text=C,M.push(Y),el&&console.log("343 obj, jsnObj",B,Y)}}let Z=null==r?void 0:r.nodes;for(let et=0;et<(null==Z?void 0:Z.length);et++){let en=Z[et];if(en.key===S.key){en.name=S.name;break}}}if(A instanceof O.rU){let es=S.key,ea=S.name?S.name:" ",er=S.type;if(er===eo.gojs.C_RELSHIPTYPE){let ed=this.getLink(N.myGoMetamodel,es);if(el&&console.log("364 TextEdited",ed),ed&&("Edit name"===ea&&(er=ea=prompt("Enter name"),S.name=ea),Q.GT(ed,"name",ea,N),S.name=ed.name,ed.reltype)){let ec=new R.yh(ed.reltype,!0);T.push(ec),el&&console.log("376 TextEdited",T)}null===(lz=o.model)||void 0===lz||lz.setDataProperty(ed.data,"name",ed.name)}else{el&&console.log("382 data",S);let ep=S.relshipview;if(ep){"Edit name"===ea&&(ea=prompt("Enter name"),S.name=ea);let eh=ep.relship;if(eh){let eu=eh.relshipviews;el&&console.log("394 rel, relviews",eh,eu);for(let em=0;em<eu.length;em++){let eg=eu[em];eg.name=ea,eh.name=ea;let ef=new R.XB(eg);el&&console.log("407 jsnRelview",ef),v.push(ef);let ey=new R.cP(eh);el&&console.log("418 jsnRel",ey),D.push(ey)}}}}}}break;case"SelectionMoved":{let ev,eb;el&&console.log("412 context",N),N.myGoModel;let ew=o.toolManager.draggingTool,ej=ew.draggedParts;el&&console.log("417 parts",ej);let eT=[];for(let ek=ej.iterator;null==ek?void 0:ek.next();){let eO=ek.value,eM=ek.value.point.x+" "+ek.value.point.y;if(el&&console.log("422 n, it.key.data, loc",eO,ek.key.data,eM),"Object"!==ek.key.data.category)continue;let eD=ek.key.data.scale1;eD||(eD="1");let eE={key:ek.key.data.key,name:ek.key.data.name,loc:new String(eM),scale:new String(eD)};eT.push(eE),el&&console.log("434 myFromNode",eE)}let ex=e.subject;el&&console.log("437 selected",ex);let eR=[];for(let eN=ex.iterator;null==eN?void 0:eN.next();){let eA=eN.value,eS=eA.key;if(eA.data.loc,!(eA instanceof O.NB))continue;let eC=r.findNode(eS);if(eC){let eP=new String(eA.data.scale1);el&&console.log("447 n.data, nod, myScale",eA.data,eC,eP);let eI={key:eA.data.key,name:eA.data.name,loc:new String(eA.data.loc),scale:new String(eA.data.scale1)};eR.push(eI)}}el&&console.log("459 myFromNodes, myToNodes",eT,eR);let e_=0,eL=-1;for(let eV=ex.iterator;null==eV?void 0:eV.next();){let eF=eV.value,eG=eF.data;if("Relationship"===eG.category||"Relationship type"===eG.category)continue;let eK=eG.type;if(el&&console.log("470 typename",eK,eG.objecttype),"Object type"===eK){let eB=i.findObjectType(eG.objecttype.id);if(el&&console.log("474 objtype",eB),eB){let eU=N.myMetamodel.findObjtypeGeoByType(eB);el&&console.log("477 objtypegeo",eU),eU||(eU=new $.sS(ei.createGuid(),N.myMetamodel,eB,"","")),eU.setLoc(eG.loc),eU.setSize(eG.size),eU.setModified();let eJ=new R.tI(eU);el&&console.log("485 jsnObjtypeGeo",eJ),j.push(eJ)}}else{let ez,eH,eW,eX,eY;el&&console.log("501 data",eG);let eZ=N.myModelview,e$=[];for(let eq=0;eq<(null===(lH=eZ.objectviews)||void 0===lH?void 0:lH.length);eq++){let eQ=eZ.objectviews[eq],e0=new $.q6(eQ.id,eQ.name,eQ.object,"");for(let e1 in eQ)e0[e1]=eQ[e1];e$.push(e0)}el&&console.log("501 myObjectviews",e$);for(let e2=0;e2<eT.length;e2++){let e6=eT[e2];if(e6.key===eG.key){eH=e6,ez=e6.loc.valueOf();break}}for(let e5=0;e5<eR.length;e5++){let e3=eR[e5];if(e3.key===eG.key){eX=e3,eW=e3.loc.valueOf();break}}if(el&&console.log("523 data, fromloc, toloc, toNode",eG,ez,eW,eX),eG.key,el&&console.log("527 selcnt, data",e_,eG),eY=Q.s_(eG,ez,eW,r,o,y)){eY.scale1=eY.getMyScale(r).toString(),el&&console.log("532 node, node.scale1",eY,eY.scale1),el&&console.log("532 myGoModel, node.loc",r,eY.loc);let e4=Q.m4(r,eY.loc);if(el&&console.log("533 group",e4),el&&console.log("534 selcnt, group, node",e_,e4,eY),e4){let e8=e4;eY.group=e8.key,eX.scale=new String(eY.getMyScale(r)),el&&console.log("535 fromNode, toNode",eH,eX);let e9=eH.scale.valueOf(),e7=eX.scale.valueOf(),te=e9<e7?e9/e7:e7/e9;el&&console.log("539 scale0, scale1, scaleFactor",e9,e7,te),eY.scale1=e7;let tt=eG.key;if(tt=tt.substr(0,36),0==e_&&(ev=eY.loc,el&&console.log("545 node, refloc",eY,ev)),e_>0){let tl,to;for(let ti=0;ti<eR.length;ti++){let tn=eR[ti];if(tn.key===tt){tl=tn.loc;break}}for(let ts=0;ts<eT.length;ts++){let ta=eT[ts];if(ta.key===tt){to=ta.loc;break}}el&&console.log("564 node, refloc, fromloc, toloc, scaleFactor",eY,ev,to,tl,te);let tr=Q.KP(eY,ev,tl,te);if(tr){let td=tr.x+" "+tr.y;eY.loc=td,eX.loc=new String(td)}el&&console.log("571 node, toNode",eY,eX)}eY.isGroup&&(eY.memberscale=eY.typeview.memberscale,el&&console.log("575 group, node",e8,eY),el&&console.log("576 context",N),eY.group=e8.key)}else{eY.group="";let tc=eH.scale,tp=1,th=tc>1?tc/tp:tp/tc;if(o.model.setDataProperty(eY.data,"group",eY.group),eY.isGroup){eY.scale1=1,eY.group="",eY.memberscale=eY.typeview.memberscale,o.model.setDataProperty(eY,"scale",Number(eY.scale1));let tu=Q.b8(eY,r,e$),tm=eY.loc;el&&console.log("593 node, nodes, scaleFactor, refloc",eY,tu,th,tm);for(let tg=0;tg<tu.length;tg++){let tf=tu[tg];if(tf){let ty,tv,tb,tw;tf.scale1=tf.getMyScale(r);for(let tj=0;tj<(null==eT?void 0:eT.length);tj++){let tT=eT[tj];if(tT.key===tf.key){ty=tT.loc,tc=tT.scale,el&&console.log("604 fromNode, fromnode, fromScale",tT,ty,tc);break}}for(let tk=0;tk<(null==eR?void 0:eR.length);tk++)if((tv=eR[tk]).key===tf.key){tb=tv.loc,el&&console.log("613 toNode, toloc, toScale",tv,tb,tp);break}if(el&&console.log("617 n, refloc, toloc, scaleFactor",tf,tm,tb,th),tw=Q.KP(tf,tm,tb,th),el&&console.log("620 n, nodeloc",tf,tw),tw){let tO=tw.x+" "+tw.y;tf.loc=tO,tv.loc=new String(tO),tf.scale1=Number(tp.valueOf());let tM=r.findNodeByViewId(tf.objectview.id);tM&&((tM=o.findNodeForKey(tM.key)).loc=tO,tM.scale1=Number(tp.valueOf()),o.model.setDataProperty(tM.data,"loc",tO)),el&&console.log("633 nod, loc",tM,tO)}}}}else{el&&console.log("639 node, group",eY,e4);let tD=o.findNodeForKey(eY.key);if(eL<0)eL++,eb=eY.loc,eY.objectview.loc=eY.loc;else{el&&console.log("647 fromScale, toScale",tc,tp),el&&console.log("649 node, rloc, toloc, scaleFactor",eY,eb,eW,th);let tE=Q.KP(eY,eb,eW,th);if(tE){let tx=tE.x+" "+tE.y;eW=new String(tx),eY.loc=tx,eY.objectview.loc=eW.valueOf(),el&&console.log("656 loc, scaleFactor, node",tx,th,eY),o.model.setDataProperty(tD.data,"loc",tx)}eY.objectview.group="",el&&console.log("661 objectview, loc",eY.objectview,eY.loc)}eY.scale1=Number(tp.valueOf()),o.model.setDataProperty(tD,"scale",eY.scale1)}}el&&console.log("665 node, data,",eY,eG);let tR=o.findNodeForKey(eY.key);if(tR)for(let tN=null==tR?void 0:tR.findLinksConnected();null==tN?void 0:tN.next();){let tA=null==tN?void 0:tN.value;if(el&&console.log("671 link",tA),tA){el&&console.log("673 link",tA);let tS=tA.data.relshipview;if(tS){if(e4){let tC=e4.scale1,tP=e4.memberscale,tI=e4&&tC?tC*tP:"1";tS.textscale=tI,Q.fM(tA,tS,o)}tS.points=tA.points;let t_=new R.XB(tS);v.push(t_)}}}if(el&&console.log("688 group, node, n",e4,eY,tR),tR&&tR.data&&tR.data.group!==eY.group)try{o.model.setDataProperty(tR.data,"group",eY.group)}catch(tL){el&&console.log("694 error",tL)}tR.data&&o.model.setDataProperty(tR.data,"loc",eY.loc),o.model.setDataProperty(tR,"scale",Number(eY.scale1)),el&&console.log("693 myGoModel",r)}for(let tV=0;tV<r.nodes.length;tV++){let tF;let tG=r.nodes[tV];for(let tK=0;tK<eR.length;tK++)if(tF=eR[tK],tG.key===tF.key){tG.loc=tF.loc.valueOf();break}let tB=tG.objectview;if(tB.scale1=tG.scale1,tB.loc=tG.loc,tG.group){let tU=r.findNode(tG.group);tB.group=null==tU?void 0:tU.objectview.id}else tB.group="";let tJ=new R.kC(tB);Q.Ne(y,tJ),el&&console.log("718 jsnObjview",tJ)}e_++}}o.requestUpdate()}break;case"SelectionDeleting":{el&&console.log("727 myMetis",i);let tz=!0,tH=!1,tW=e.subject;el&&console.log("738 selection",tW);let tX=tW.first().data;if(el&&console.log("732 data, selection",tX,tW),this.isMetamodelType(tX.category)){confirm("If instances exists, do you want to change their types instead of deleting?")&&(tH=!0);let tY=[];for(let tZ=null==tW?void 0:tW.iterator;null==tZ?void 0:tZ.next();){let t$=tZ.value,tq=t$.data;if(tq.category===eo.gojs.C_OBJECTTYPE){let tQ=i.findObjectType(null===(lW=tq.objecttype)||void 0===lW?void 0:lW.id);if(tQ){let t0=tQ.inputreltypes;for(let t1=0;t1<(null==t0?void 0:t0.length);t1++){let t2=t0[t1];-1===tY.indexOf(t2)&&tY.push(t2)}let t6=tQ.outputreltypes;for(let t5=0;t5<(null==t6?void 0:t6.length);t5++){let t3=t6[t5];-1===tY.indexOf(t3)&&tY.push(t3)}}}else if(tq.category===eo.gojs.C_RELSHIPTYPE){let t4=i.findRelationshipType(null===(lX=tq.reltype)||void 0===lX?void 0:lX.id);t4&&-1===tY.indexOf(t4)&&tY.push(t4)}for(let t8=null==tW?void 0:tW.iterator;null==t8?void 0:t8.next();){let t9=t8.value,t7=t9.data;if(el&&console.log("743 sel, data",t9,t7),t7.key,t7.type,t7.category===eo.gojs.C_RELSHIPTYPE){let le=i.findRelationshipTypeByName(eo.types.AKM_GENERIC_REL),lt=i.findRelationshipType(null===(lY=t7.reltype)||void 0===lY?void 0:lY.id);if(el&&console.log("749 reltype",lt),lt){let ll=i.getRelationshipsByType(lt,!1);if(el&&console.log("753 reltype, rels, myMetis",lt,ll,i),ll.length>0){if(tH)for(let lo=0;lo<ll.length;lo++){let li=ll[lo];li.type=le,li.typeview=le.typeview;let ln=new R.cP(li);D.push(ln)}else for(let ls=0;ls<ll.length;ls++){let la=ll[ls];la.markedAsDeleted=tz}}el&&console.log("785 reltype",lt),lt.markedAsDeleted=tz,Q.H_(lt,tz);let lr=lt.typeview;lr&&(lr.markedAsDeleted=tz)}}}for(let ld=null==tW?void 0:tW.iterator;null==ld?void 0:ld.next();){let lc=ld.value,lp=lc.data;if(el&&console.log("805 sel, data",lc,lp),lp.key,lp.type,lp.category===eo.gojs.C_OBJECTTYPE){let lh=i.findObjectTypeByName("Generic"),lu=i.findObjectType(null===(lZ=lp.objecttype)||void 0===lZ?void 0:lZ.id);if(lu){el&&console.log("835 objtype to be removed ??",lu);let lm=i.getObjectsByType(lu,!0);if(el&&console.log("814 objtype, objects, myMetis",lu,lm,i),lm.length>0){if(tH)for(let lg=0;lg<lm.length;lg++){let lf=lm[lg];lf.type=lh,lf.typeview=lh.typeview}else for(let ly=0;ly<lm.length;ly++){let lv=lm[ly];lv.markedAsDeleted=tz}}lu.markedAsDeleted=tz;let lb=lu.typeview;lb&&(lb.markedAsDeleted=tz);let lw=N.myMetamodel.findObjtypeGeoByType(lu);lw&&(lw.markedAsDeleted=tz)}}}}}else{for(let lj=null==tW?void 0:tW.iterator;null==lj?void 0:lj.next();){let lT=lj.value,lk=lT.data;if(lk.key,lk.category===eo.gojs.C_OBJECT){el&&console.log("866 sel, data",lT,lk);let lO=lk.key,lM=this.getNode(N.myGoModel,lO);lM&&(el&&console.log("870 delete node",lk,lM),Q.IK(lM,tz,N),el&&console.log("872 delete node",lk,lM))}}for(let lD=null==tW?void 0:tW.iterator;null==lD?void 0:lD.next();){let lE=lD.value,lx=lE.data,lR=lx.key;if(lx.category===eo.gojs.C_RELATIONSHIP){let lN=this.getLink(N.myGoModel,lR);el&&console.log("888 myLink, data",lN,lx),Q.Yw(lx,tz,N);let lA=lx.relshipview;if(lA&&lA.category===eo.gojs.C_RELATIONSHIP&&(lA.markedAsDeleted=tz,lA.relship=i.findRelationship(lA.relship.id),!i.deleteViewsOnly)){let lS=lA.relship;lS.markedAsDeleted=tz}}}}el&&console.log("933 myMetis",i)}el&&console.log("935 Deletion completed",i);let lC=new R.st(i,!0);el&&console.log("938 jsnMetis",lC);let lP={metis:lC};lP=JSON.parse(JSON.stringify(lP)),el&&console.log("941 PhData",lP),o.dispatch({type:"LOAD_TOSTORE_PHDATA",data:lP});return;case"ExternalObjectsDropped":e.subject.each(function(e){let t=o.findNodeForKey(e.data.key),l=t.data;l.scale=t.scale;let n="Label"===l.typename;if(el&&console.log("916 found node",t),el&&console.log("917 myMetis",i),el&&console.log("918 myGoModel",r,d),el&&console.log("919 part, node",l,t),"objecttype"===l.type){let s=Q.Pg(l,N);if(el&&console.log("922 myMetis",i),s){s.typename=eo.types.OBJECTTYPE_NAME,el&&console.log("925 otype, part",s,l);let a=new R.vM(s,!0);el&&console.log("927 modifiedTypeNodes",a),b.push(a);let c=new R.XA(s.typeview);el&&console.log("931 modifiedTypeViews",c),w.push(c);let p=l.loc,h=l.size,u=new $.sS(ei.createGuid(),N.myMetamodel,s,p,h),m=new R.tI(u);el&&console.log("938 modifiedTypeGeos",m),j.push(m)}}else{l.category="Object",el&&console.log("944 part",l),l.objecttype||i.findObject(l.id),n&&(l.text="label"),el&&console.log("949 part",l),l.parentModelRef||(i.pasteViewsOnly=!0),el&&console.log("952 myMetis",i);let g=Q.nW(l,N);if(el&&console.log("954 myMetis",i),el&&console.log("955 part, objview",l,g),g){let f=g.object;f.name=l.name;let v=f.type;v||(v=i.findObjectType(g.object.typeRef),f.type=v),g.viewkind=l.viewkind;let T=new R.kC(g);Q.Ne(y,T),el&&console.log("966 New object",T,y);let k=new R.GZ(g.object);M.push(k),el&&console.log("969 New object",k)}}el&&console.log("972 myGoModel",r,i),t.updateTargetBindings()});break;case"ObjectDoubleClicked":{let lI=e.subject.part,l_=lI.data;el&&console.log("981 node",l_);let lL=l_.category;switch(lL){case eo.gojs.C_OBJECTTYPE:ee.VL(l_,i,o);break;case eo.gojs.C_OBJECT:el&&console.log("988 myMetis",i),ee.Gf(l_,i,o),el&&console.log("990 myMetis",i)}}break;case"ObjectSingleClicked":{let lV=e.subject.part,lF=lV.data;console.log("1019 selected",lF,lV);for(let lG=lV.memberParts;null==lG?void 0:lG.next();){var lK,lB,lU,lJ,lz,lH,lW,lX,lY,lZ,l$,lq,lQ,l0,l1,l2,l6,l5,l3,l4,l8=lG.value;l8 instanceof O.NB&&console.log("1023 n",l8.data)}}break;case"ObjectContextClicked":{let l9=e.subject.part;l9.data}break;case"PartResized":{let l7=e.subject.part,oe=e.subject.part.data;el&&console.log("1009 PartResized",l7,oe);let ot=r.findNode(oe.key),ol=[],oo={key:oe.key,name:oe.name,loc:oe.loc};ol.push(oo);let oi=[];oi.push(oo);let on=oo.loc,os=oo.loc;el&&console.log("1022 data, myNode, fromNode, toNode",oe,ot,oo,oo);let oa=Q.s_(oe,on,os,r,o,y);el&&console.log("1024 node, modifiedNodes",oa,y);let or=oa.objectview;if(or){or.loc=oe.loc,or.size=oe.size;let od=new R.kC(or);Q.Ne(y,od)}el&&console.log("1032 node, objview",oa,or)}break;case"ClipboardChanged":{let oc=e.subject;el&&console.log("nodes",oc)}break;case"ClipboardPasted":{let op=i.currentModel.args1;el&&console.log("1043 myMetis, myGoModel, myFromNodes",i,r,op);let oh=e.subject;N.pasted=!0;let ou=[],om=[];el&&console.log("1097 myFromNodes",op);let og,of=0,oy=[],ov=[],ob=oh.iterator;for(;ob.next();){let ow=ob.value.data;if(ow.category===eo.gojs.C_OBJECT){N.pasted=!0,0==of&&(og=ow.loc,of++),el&&console.log("1070 data, myGoModel",ow,r);let oj=Q.nW(ow,N);oj.group="";let oT=ow.key,ok=new q.of(oT,oj);ok.group="",ov.push(ok);let oO=ok.getMyScale(r),oM={key:oT,name:ow.name,loc:new String(ow.loc),scale:new String(oO),size:new String(ow.size)};om.push(oM),oj.loc=oM.loc.valueOf(),oj.size=oM.size.valueOf(),oy.push(oj),ok.loc=oj.loc,ok.size=oj.size;let oD=r.findNode(oT);oD.loc=oj.loc,oD.size=oj.size,el&&console.log("1082 objview, node, n",oj,ok,oD)}}el&&console.log("1086 myFromNodes, myToNodes, objviews, nodes",op,om,oy,ov);for(let oE=0;oE<(null==oy?void 0:oy.length);oE++){let ox;let oR=oy[oE],oN=ov[oE],oA=om[oE];for(let oS=0;oS<(null==op?void 0:op.length);oS++){let oC=op[oS];if(oC.key.substr(0,36)===oN.key.substr(0,36)){ox=oC;break}}if(oR){el&&console.log("1077 myGoModel, nodes, objview",r,ov,oR),el&&console.log("1078 myGoModel, loc",r,oR.loc);let oP=Q.m4(r,oR.loc);el&&console.log("1079 group",oP);let oI=o.findNodeForKey(oN.key);oP&&oN&&(oR.group=null===(lq=oP.objectview)||void 0===lq?void 0:lq.id,oN.group=oP.key,null===(lQ=o.model)||void 0===lQ||lQ.setDataProperty(oI,"group",oP.key)),el&&console.log("1096 myFromNodes, myToNodes",op,om),oN.loc=oA.loc.valueOf();let o_=ox?ox.scale.valueOf():1,oL=oA.scale.valueOf(),oV=oL/o_;el&&console.log("1101 scale0, scale1, scaleFactor",o_,oL,oV),el&&console.log("1102 myToNode, node, refloc",oA,oN,og);let oF=Q.KP(oN,og,oA.loc,oV);if(oF){let oG=oF.x+" "+oF.y;oA.loc=new String(oG)}oN.loc=oA.loc.valueOf(),oR.loc=oA.loc.valueOf(),el&&console.log("1205 myToNode, node, refloc",oA,oN,og);let oK=oN.getMyScale(r);oN.scale1=oK,oR.scale1=oK,el&&console.log("1113 node, objview",oN,oR);let oB=o.findNodeForKey(oN.key);o.model.setDataProperty(oB.data,"loc",oN.loc),o.model.setDataProperty(oB,"scale",oN.scale1),o.model.setDataProperty(oB.data,"group",oN.group),ou.push(oN);let oU=null===(l$=oR.object)||void 0===l$?void 0:l$.id;oR.object=i.findObject(oU);let oJ=new R.kC(oR);y.push(oJ),el&&console.log("1122 jsnObjview",oJ);let oz=new R.GZ(oR.object);M.push(oz),el&&console.log("1125 ClipboardPasted",M)}}el&&console.log("1221 myFromNodes, myToNodes",op,om),el&&console.log("1222 pastedNodes",ou),el&&console.log("1223 ClipboardPasted",N.myGoModel);let oH=oh.iterator;for(;oH.next();){let oW=oH.value.data;if(oW.category===eo.gojs.C_RELATIONSHIP){el&&console.log("1229 ClipboardPasted",oW),el&&console.log("1230 ClipboardPasted",oW,ou);let oX=Q.Kp(oW,ou,N);if(el&&console.log("1232 relview",oW,oX),oX){let oY=null===(l0=oX.relship)||void 0===l0?void 0:l0.id;oX.relship=i.findRelationship(oY);let oZ=oX.fromObjview,o$=oX.toObjview;if(oZ&&o$){let oq=oZ.scale1,oQ=o$.scale1,o0=oq>oQ?oq:oQ;oX.textscale=o0}let o1=o.findLinkForKey(oW.key);Q.fM(o1,oX,o);let o2=new R.XB(oX);el&&console.log("1248 ClipboardPasted",o2,oX),v.push(o2);let o6=new R.cP(oX.relship);el&&console.log("1251 ClipboardPasted",o6,oX.relship),D.push(o6)}}}el&&console.log("1256 ClipboardPasted",v,D,i),o.requestUpdate()}break;case"LinkDrawn":{let o5=e.subject,o3=o5.data;el&&console.log("1171 link",o5.data,o5.fromNode,o5.toNode),el&&console.log("1188 data",o3);let o4=o.findNodeForKey(o3.from),o8=o.findNodeForKey(o3.to);if(el&&console.log("1192 LinkDrawn",o4,o8,o3),(null==o4?void 0:null===(l1=o4.data)||void 0===l1?void 0:l1.category)===eo.gojs.C_OBJECTTYPE){o3.category=eo.gojs.C_RELSHIPTYPE,el&&console.log("1196 link",o4,o8);let o9=Q.D3(o4.data,o8.data,o3,N);if(o9){el&&console.log("1200 reltype",o9);let o7=new R.yh(o9,!0);T.push(o7),el&&console.log("1203 jsnType",o7);let ie=o9.typeview;if(ie){let it=new R.Ug(ie);k.push(it),el&&console.log("1208 jsnTypeView",it);let il=i.gojsModel,io=new q.zV(ei.createGuid(),il,o9);io.fromNode=o4.data,io.toNode=o8.data,io.loadLinkContent(il),il.addLink(io),io.name=o9.name,el&&console.log("1261 link, myGoModel, reltype",io,il,o9),o.model.addLinkData(io);let ii=o.findLinkForKey(io.key);el&&console.log("1264 lnk, reltype",ii,o9),o.model.setDataProperty(ii.data,"name",o9.name)}}(null==o4?void 0:null===(l6=o4.data)||void 0===l6?void 0:l6.category)===eo.gojs.C_OBJECT&&(o3.category="Relationship",N.handleOpenModal=this.handleOpenModal,el&&console.log("1215 data, context",o3,N),Q.qs(o3,N)),o.requestUpdate()}(null==o4?void 0:null===(l2=o4.data)||void 0===l2?void 0:l2.category)===eo.gojs.C_OBJECT&&(o3.category=eo.gojs.C_RELATIONSHIP,N.handleOpenModal=this.handleOpenModal,el&&console.log("1225 data, context",o3,N),Q.qs(o3,N)),o.requestUpdate()}break;case"LinkRelinked":{let is=e.subject,ia=null===(l5=is.fromNode)||void 0===l5?void 0:l5.data,ir=null===(l3=is.toNode)||void 0===l3?void 0:l3.data;el&&console.log("727 link, fromNode, toNode",is,ia,ir);let id=e.subject.data;id.category=eo.gojs.C_RELATIONSHIP,ia.category===eo.gojs.C_OBJECTTYPE&&(id.category=eo.gojs.C_RELSHIPTYPE),o.model.setDataProperty(id,"name",id.name),el&&console.log("729 newLink",id),N.modifiedLinks=v,N.modifiedRelships=D,N.modifiedTypeLinks=T,N.modifiedLinkTypeViews=k,Q.AS(id,ia,ir,N),el&&console.log("722 LinkRelinked",v),el&&console.log("723 LinkRelinked",D),el&&console.log("724 LinkRelinked",T),o.requestUpdate()}break;case"LinkReshaped":{let ic=e.subject;ic=o.findLinkForKey(ic.key);let ip=ic.data;el&&console.log("996 data",ip);let ih=ip.relshipview;if(ih=s.findRelationshipView(null==ih?void 0:ih.id)){if(null===(l4=ic.data.points)||void 0===l4?void 0:l4.j){let iu=[],im=ic.points.j;for(let ig=0;ig<im.length;ig++)iu.push(im[ig].x),iu.push(im[ig].y);ic.data.points=iu}ih.points=ic.data.points;let iy=new R.XB(ih);el&&console.log("1011 relview, jsnRelview",ih,iy),v.push(iy)}}break;case"BackgroundSingleClicked":el&&console.log("1178 BackgroundSingleClicked",e,e.diagram);break;case"BackgroundDoubleClicked":el&&console.log("728 BackgroundDoubleClicked",e,e.diagram);break;default:el&&console.log("802 GoJSApp event name: ",l)}el&&console.log("1288 modifiedNodes",y),y.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),el&&console.log("877 UPDATE_OBJECTVIEW_PROPERTIES",t),N.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})}),el&&console.log("1296 modifiedTypeNodes",b),null==b||b.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),el&&console.log("900 UPDATE_OBJECTTYPE_PROPERTIES",t),N.dispatch({type:"UPDATE_OBJECTTYPE_PROPERTIES",data:t})}),el&&console.log("1304 modifiedTypeViews",w),null==w||w.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),N.dispatch({type:"UPDATE_OBJECTTYPEVIEW_PROPERTIES",data:t}),el&&console.log("892 data",t)}),el&&console.log("1312 modifiedTypeGeos",j),null==j||j.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),N.dispatch({type:"UPDATE_OBJECTTYPEGEOS_PROPERTIES",data:t})}),el&&console.log("1319 modifiedLinks",v),v.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),N.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})}),el&&console.log("1326 modifiedTypeLinks",T),null==T||T.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),el&&console.log("1330 data",t),N.dispatch({type:"UPDATE_RELSHIPTYPE_PROPERTIES",data:t})}),null==k||k.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),N.dispatch({type:"UPDATE_RELSHIPTYPEVIEW_PROPERTIES",data:t})}),el&&console.log("968 modifiedObjects",M),null==M||M.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),el&&console.log("938 UPDATE_OBJECT_PROPERTIES",t),N.dispatch({type:"UPDATE_OBJECT_PROPERTIES",data:t})}),el&&console.log("1348 modifiedRelships",D),null==D||D.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),el&&console.log("945 data",t),N.dispatch({type:"UPDATE_RELSHIP_PROPERTIES",data:t})}),el&&console.log("1383 myMetis",i)}render(){var e;let t,l,i,n;let s=this.state.selectedData;el&&console.log("1111 selectedData",s,this.props);let a=this.state.modalContext;if(el&&console.log("1115 modalContext ",a),(null==a?void 0:a.what)==="selectDropdown"){let r="",d="",{Option:c}=U.F;r=this.state.selectedData.map(e=>e&&{label:e,value:e}),d=null,el&&console.log("1138 options",r,this.state);let{selectedOption:p}=this.state;el&&console.log("1139 selectedOption",p,this.state);let h=p?p.value:r[0],u=p?p.label:r[0];el&&console.log("1143 selectedOption, value, label ",p,h,u),i=a.title,t=(0,o.jsx)("div",{className:"modal-selection d-flex justify-content-center",children:(0,o.jsx)(J.ZP,{className:"modal-select",options:r,components:d,onChange:e=>this.handleSelectDropdownChange(e)})})}else null!==s&&(el&&console.log("1151 selectedData",s),l=(0,o.jsxs)("div",{className:"p-2",style:{backgroundColor:"#ddd"},children:[(0,o.jsx)("p",{children:"Selected Object Properties:"}),(0,o.jsx)(x.R,{myMetis:this.state.myMetis,selectedData:this.state.selectedData,context:this.state.context,onInputChange:this.handleInputChange})]}));return this.state.myMetis&&(this.state.myMetis.dispatch=this.state.dispatch),el&&console.log("1089 dispatch",this.state.myMetis.dispatch),el&&console.log("1090 linkdataarray:",this.state.linkDataArray),this.state&&(0,o.jsxs)("div",{className:"diagramwrapper",children:[(0,o.jsx)(Z.Z,{nodeDataArray:this.state.nodeDataArray,linkDataArray:this.state.linkDataArray,modelData:this.state.modelData,modelType:this.state.modelType,skipsDiagramUpdate:this.state.skipsDiagramUpdate,onDiagramEvent:this.handleDiagramEvent,onModelChange:this.handleModelChange,onInputChange:this.handleInputChange,myMetis:this.state.myMetis,myGoModel:this.state.myGoModel,myGoMetamodel:this.state.myGoMetamodel,dispatch:this.state.dispatch}),(0,o.jsxs)(z.Z,{className:"",isOpen:this.state.showModal,children:[(0,o.jsxs)("div",{className:"modal-head",children:[(0,o.jsx)(H.Z,{className:"modal-button btn-sm float-right m-1",color:"link",onClick:()=>{this.handleCloseModal("x")},children:(0,o.jsx)("span",{children:"x"})}),(0,o.jsxs)(W.Z,{className:"modal-header",children:[(0,o.jsxs)("span",{className:"text-secondary",children:[i," "]}),(0,o.jsxs)("span",{className:"modal-name ",children:[null===(e=this.state.selectedData)||void 0===e?void 0:e.name," "]}),(0,o.jsxs)("span",{className:"modal-objecttype float-right",children:[" ",n," "]})]})]}),(0,o.jsx)(X.Z,{children:(0,o.jsx)("div",{className:"modal-body1",children:t})}),(0,o.jsx)(Y.Z,{className:"modal-footer",children:(0,o.jsx)(H.Z,{className:"modal-button bg-link m-0 p-0",color:"link",onClick:()=>{this.handleCloseModal()},children:"Done"})})]})]})}constructor(e){var t,l;super(e),this.handleSelectDropdownChange=e=>{el&&console.log("99 handleSelectDropdownChange");let t=this.state.myMetis,l={myMetis:t,myMetamodel:t.currentMetamodel,myModel:t.currentModel,myModelview:t.currentModelview,myGoModel:t.gojsModel,myDiagram:t.myDiagram,modalContext:this.state.modalContext};et.Lo(e,l)},el&&console.log("62 GoJSApp",this.props.nodeDataArray),this.state={nodeDataArray:null===(t=this.props)||void 0===t?void 0:t.nodeDataArray,linkDataArray:null===(l=this.props)||void 0===l?void 0:l.linkDataArray,modelData:{canRelink:!0},selectedData:null,editedData:null,skipsDiagramUpdate:!1,metis:this.props.metis,myMetis:this.props.myMetis,myGoModel:this.props.myGoModel,myGoMetamodel:this.props.myGoMetamodel,phFocus:this.props.phFocus,dispatch:this.props.dispatch,modelType:this.props.phFocus.focusTab,showModal:!1,modalContext:null,selectedOption:null},el&&console.log("76 this.state.linkDataArray: ",this.state.linkDataArray),this.handleDiagramEvent=this.handleDiagramEvent.bind(this),this.handleOpenModal=this.handleOpenModal.bind(this),this.handleCloseModal=this.handleCloseModal.bind(this),this.handleSelectDropdownChange=this.handleSelectDropdownChange.bind(this)}}var ea=es;let er=!1;console.log.bind(console,"%c %s","background: blue; color: white"),console.trace.bind(console,"%c %s","background: green; color: white");let ed=e=>{var t,l,i,r,d,c,p,h,u,j,k,O,M,D,E,x;if(er&&console.log("19 Modeller: props",e),!e.metis)return(0,o.jsx)(o.Fragment,{children:" not found"});let R=(0,a.I0)(),[N,A]=(0,s.useState)(!1),[C,P]=(0,s.useState)(),[I,_]=(0,s.useState)("All"),[L,V]=(0,s.useState)(!1),F=null===(t=e.phFocus)||void 0===t?void 0:t.focusModel,G=null===(l=e.phFocus)||void 0===l?void 0:l.focusModelview,K=0;(0,s.useEffect)(()=>{let t={id:e.metis.models[0].id,name:e.metis.models[0].name};R({type:"SET_FOCUS_MODEL",data:t}),R({type:"SET_FOCUS_REFRESH",data:{id:e.metis.name,name:"refresh"}});let l=e.metis.models[0].modelviews[0];R({type:"SET_FOCUS_MODELVIEW",data:{id:l.id,name:l.name}})},[]),(0,s.useEffect)(()=>{P(K)},[C]);let B=e.gojsModel;er&&console.log("107 Modeller: gojsmodel",null==B?void 0:B.nodeDataArray),e.myMetis;let U=(null===(i=e.phFocus)||void 0===i?void 0:null===(r=i.focusRole)||void 0===r?void 0:r.tasks)||[],J=null===(d=e.phFocus)||void 0===d?void 0:d.focusTask,z=null===(c=e.phUser)||void 0===c?void 0:null===(p=c.focusUser)||void 0===p?void 0:null===(h=p.diagram)||void 0===h?void 0:h.showDeleted;function H(){V(!L)}er&&console.log("121 Modeller: props, refresh",e,N);let W=null===(u=e.metis)||void 0===u?void 0:u.models,X=null==W?void 0:W.find(e=>(null==e?void 0:e.id)===(null==F?void 0:F.id)),Y=null==W?void 0:W.findIndex(e=>(null==e?void 0:e.id)===(null==F?void 0:F.id)),Z=null==X?void 0:X.modelviews,$=null==Z?void 0:Z.find(e=>(null==e?void 0:e.id)===(null==G?void 0:G.id)),q=null==Z?void 0:Z.findIndex((e,t)=>t&&(null==e?void 0:e.id)===(null==G?void 0:G.id)),Q=null===(j=e.metis)||void 0===j?void 0:j.metamodels,ee=null==Q?void 0:Q.find(e=>(null==e?void 0:e.id)===(null==X?void 0:X.metamodelRef)),et=[W[Y],...W.slice(0,Y),...W.slice(Y+1,W.length)],el=Z;er&&console.log("126 Modeller",ee,G,et,el);let eo=null==et?void 0:et.filter(e=>e&&!e.markedAsDeleted),ei=e=>{er&&console.log("69 Modeller: handleProjectChange",e),R({type:"UPDATE_PROJECT_PROPERTIES",data:{name:e.value}}),R({type:"SET_FOCUS_PROJECT",data:{id:e.value,name:e.value}})},en=e=>{er&&console.log("19 Selector",JSON.parse(e.value).name);let t=JSON.parse(e.value).id,l=JSON.parse(e.value).name,o=W.find(e=>e.id===t);er&&console.log("86 Selector",o);let i={id:t,name:l};R({type:"SET_FOCUS_MODEL",data:i}),R({type:"SET_FOCUS_REFRESH",data:{id:Math.random().toString(36).substring(7),name:"refresh"}});let n=o.modelviews[0];R({type:"SET_FOCUS_MODELVIEW",data:{id:n.id,name:n.name}})},es=eo&&eo.map((t,l)=>t&&t.name!=="Select "+e.selName+"..."&&(0,o.jsx)("option",{value:JSON.stringify({id:t.id,name:t.name}),children:t.name},t.id+l)),ed=(0,o.jsx)("div",{className:"Selector--menu",style:{width:"80rem"},children:(0,o.jsxs)("label",{className:"Selector--menu-label","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Description : ".concat(e.metis.description," \n\nTo change Project Name : \nEdit this field and click on the Save button.\n\nor Right-click the background below and select 'Edit Project Name'. \n\nThe suffix '.json' will be added to the filename."),children:[" Project :",(0,o.jsx)("input",{className:"ml-2 w-50 ",type:"text",defaultValue:e.metis.name,onBlur:e=>ei({value:e.target.value}),style:{minWidth:"36%"}}),(0,o.jsxs)("span",{className:"model-selection w-25","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",style:{width:"100%"},title:"Description: ".concat(null==X?void 0:X.description,"\n    \nTo change Model name, rigth click the background below and select 'Edit Model'."),children:[" Model :",(0,o.jsx)("select",{className:"list-obj mx-2 ",style:{minWidth:"32%"},onChange:e=>en({value:e.target.value}),name:"Focus ".concat(e.selName," ..."),children:es},"select-title")]})]})});K=q<0?0:q,er&&console.log("78 Modeller",F.name,G.name,K);let ec=null===(k=e.gojsMetamodel)||void 0===k?void 0:k.nodeDataArray;U=(null===(O=e.phFocus.focusRole)||void 0===O?void 0:O.tasks)&&(null===(M=e.phFocus.focusRole)||void 0===M?void 0:null===(D=M.tasks)||void 0===D?void 0:D.map(e=>e));let ep=null===(E=e.gojsModelObjects)||void 0===E?void 0:E.nodeDataArray,eh=ep,eu=null==eh?void 0:eh.filter(e=>e&&!1===e.markedAsDeleted);er&&console.log("209 nodeArray_all",eh,eu);let em=null==eu?void 0:eu.filter(e=>e&&"EntityType"===e.typename),eg=null==eu?void 0:eu.filter(e=>e&&"Property"!==e.typename);er&&console.log("185 Palette noPropertyObj",eg),o.Fragment,null==J||J.name;let ef=null==eu?void 0:eu.filter(e=>e&&"Container"!==e.typename);"Sorted"===I&&(ef=em),"!Property"===I&&(ef=eg);let ey={nodeDataArray:ef,linkDataArray:[]};er&&console.log("253  Modeller",ey.nodeDataArray);let ev=ec;er&&console.log("269 objArr",e.gojsModel,ev);for(let eb=0;eb<(null==ev?void 0:ev.length);eb++)(null===(x=ev[eb])||void 0===x?void 0:x.viewkind)==="Container"&&(ev[eb].isGroup=!0);er&&console.log("274 objArr",ev);let ew=el?el.map((e,t)=>{if(e&&!e.markedAsDeleted){let l=t.toString(),i={id:e.id,name:e.name};return Math.random().toString(36).substring(7),(0,o.jsx)(g.Z,{className:"model-selection","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Description: ".concat(null==$?void 0:$.description,"\n\nTo change Modelview name, rigth click the background below and select 'Edit Modelview'."),children:(0,o.jsx)(f.Z,{style:{paddingTop:"0px",paddingBottom:"0px",border:"solid 1px",borderBottom:"none",borderColor:"#eee gray white #eee",color:"black"},className:T()({active:C==l}),onClick:()=>{R({type:"SET_FOCUS_MODELVIEW",data:i}),R({type:"SET_FOCUS_REFRESH",data:{id:Math.random().toString(36).substring(7),name:l+"name"}})},children:e.name})},l)}}):(0,o.jsx)(o.Fragment,{}),ej=B&&(0,o.jsx)(ea,{nodeDataArray:B.nodeDataArray,linkDataArray:B.linkDataArray,metis:e.metis,myMetis:e.myMetis,myGoModel:e.myGoModel,myGoMetamodel:e.myGoMetamodel,phFocus:e.phFocus,dispatch:e.dispatch,modelType:e.phFocus.focusTab}),eT=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(m.Z,{tabs:!0,children:[ew,(0,o.jsx)(g.Z,{children:(0,o.jsx)("button",{className:"btn-sm bg-warning text-white py-0 ml-3 float-right","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:" Modelling: Insert an Object: Click on an Object Type in the Palette (the left) and drag and drop it into the Modelling area below. Connect two objects: Position the cursor on on the edge of one object (An arrow appears) and drag and drop to another object to make a relationshop between them.",children:"i"})})]}),(0,o.jsx)(y.Z,{children:(0,o.jsx)(v.Z,{children:(0,o.jsx)("div",{className:"workpad bg-white mt-0 p-1 pt-2",children:N?(0,o.jsxs)(o.Fragment,{children:[" ",ej," "]}):(0,o.jsx)(o.Fragment,{children:ej})})})})]}),ek=(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"workpad p-1 pt-2",children:N?(0,o.jsxs)(o.Fragment,{children:[" ",ej," "]}):(0,o.jsx)(o.Fragment,{children:ej})})}),eO=(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"workpad p-1 pt-2 bg-white",children:(0,o.jsx)(S,{divClassName:"diagram-component-objects",nodeDataArray:ey.nodeDataArray,linkDataArray:[],metis:e.metis,myMetis:e.myMetis,myGoModel:e.myGoModel,phFocus:e.phFocus,dispatch:e.dispatch})})});return console.log("372 Modeller ",e.modelType),"model"===e.modelType?(0,o.jsxs)("div",{className:"modeller-workarea ml-1 mb-1 ",children:[(0,o.jsxs)("div",{className:"modeller--topbar d-flex justify-content-between m-0 p-0 w-100 ",children:[(0,o.jsx)("span",{className:"--heading text-dark m-0 p-1 ml-4 mr-2 fs-6 fw-bold ph-2 ",children:"Modeller "}),(0,o.jsx)("div",{className:"modeller--heading-selector d-flex justify-content-right ",children:ed})]}),(0,o.jsx)("div",{className:"modeller--workarea m-0 p-0",children:(0,o.jsxs)(b.Z,{className:"m-0",children:[(0,o.jsx)(w.Z,{className:"modeller--workarea-objects mx-0 px-0 mt-0 col-auto ",children:(0,o.jsxs)("div",{className:"modeller--workarea-objects-content mt-2 border border-dark",style:{height:"81vh"},children:[(0,o.jsxs)("button",{className:"btn-sm px-1 m-0 text-left w-100",style:{backgroundColor:"#a0caca",outline:"0",borderStyle:"none"},onClick:H,children:[" ",L?(0,o.jsx)("span",{children:" <- Objects "}):(0,o.jsx)("span",{children:" ->"})]}),L?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"btn-horizontal bg-light mx-0 px-1 mb-1",style:{fontSize:"11px",minWidth:"166px",maxWidth:"166px"}}),eO]}):(0,o.jsxs)("div",{className:"btn-vertical px-1 text-center",style:{height:"78vh",maxWidth:"20px",padding:"0px"},children:[(0,o.jsx)("span",{children:" O b j e c t s "})," "]})]})}),(0,o.jsxs)(w.Z,{className:"modeller--workarea-modelling px-1 ",children:[(0,o.jsx)("div",{className:"mt-2",children:eT}),(0,o.jsxs)("div",{className:"modeller--footer-buttons",children:[(0,o.jsx)("button",{className:"btn-sm bg-transparent text-muted py-0","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Zoom all diagram",children:"Zoom All"}),(0,o.jsx)("button",{className:"btn-sm bg-transparent text-muted py-0","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Toggle relationhip layout routing",children:"Toggle relationship layout"}),(0,o.jsx)("button",{className:"btn-sm bg-transparent text-muted py-0","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Toggle relationhip show relship name",children:"Toggle relationships name"}),(0,o.jsx)("button",{className:"btn-sm bg-transparent text-muted py-0","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Zoom to objectview in focus",children:"Zoom to Focus"}),(0,o.jsxs)("button",{className:"btn-sm py-0","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Toggle show/ hide deleted objectviews",onClick:()=>{R({type:"SET_USER_SHOWDELETED",data:!z}),R({type:"SET_FOCUS_REFRESH",data:{id:Math.random().toString(36).substring(7),name:"name"}})},children:[" ",z?" Hide deleted":"Show deleted"]}),(0,o.jsxs)("span",{className:"sourceName pl-1 pr-1 ml-1 mt-1 mr-1 float-right",style:{minWidth:"130px",maxHeight:"22px",backgroundColor:"#eee",fontSize:"small"},children:["Current source:  ",e.phSource]})]})]})]})})]}):(0,o.jsxs)("div",{style:{backgroundColor:"#7ac",minWidth:"100%"},className:"jsx-e0fd84ff389428a2 mt-2 mb-2",children:[(0,o.jsx)("span",{style:{minWidth:"8%"},className:"jsx-e0fd84ff389428a2 modeller--heading float-left text-dark m-0 p-0 ml-2 mr-2 fs-6 fw-bold lh-2",children:"Metamodeller"}),(0,o.jsx)("div",{style:{transform:"scale(0.9)",transformOrigin:"right",minWidth:"100%"},className:"jsx-e0fd84ff389428a2 modeller--heading-selector",children:ed}),ek,(0,o.jsx)(n(),{id:"e0fd84ff389428a2",children:""})]})};var ec=ed;class ep extends s.Component{refreshNodeIndex(e){this.mapNodeKeyIdx.clear(),null==e||e.forEach((e,t)=>{this.mapNodeKeyIdx.set(e.key,t)})}refreshLinkIndex(e){this.mapLinkKeyIdx.clear(),null==e||e.forEach((e,t)=>{this.mapLinkKeyIdx.set(e.key,t)})}handleDiagramEvent(e){let t=e.name;if("ChangedSelection"===t){let l=e.subject.first();this.setState((0,k.Uy)(e=>{if(l){if(l instanceof O.NB){let t=this.mapNodeKeyIdx.get(l.key);if(void 0!==t&&t>=0){let o=e.nodeDataArray[t];e.selectedData=o}}else if(l instanceof O.rU){let i=this.mapLinkKeyIdx.get(l.key);if(void 0!==i&&i>=0){let n=e.linkDataArray[i];e.selectedData=n}}}else e.selectedData=null}))}}handleModelChange(e){let t=e.insertedNodeKeys,l=e.modifiedNodeData,o=e.removedNodeKeys,i=e.insertedLinkKeys,n=e.modifiedLinkData,s=e.removedLinkKeys,a=e.modelData,r=new Map,d=new Map;this.setState((0,k.Uy)(e=>{let c=e.nodeDataArray;l&&l.forEach(t=>{r.set(t.key,t);let l=this.mapNodeKeyIdx.get(t.key);void 0!==l&&l>=0&&(c[l]=t,e.selectedData&&e.selectedData.key===t.key&&(e.selectedData=t))}),t&&t.forEach(e=>{let t=r.get(e),l=this.mapNodeKeyIdx.get(e);t&&void 0===l&&(this.mapNodeKeyIdx.set(t.key,c.length),c.push(t))}),o&&(c=c.filter(e=>!o.includes(e.key)),e.nodeDataArray=c,this.refreshNodeIndex(c));let p=e.linkDataArray;n&&n.forEach(t=>{d.set(t.key,t);let l=this.mapLinkKeyIdx.get(t.key);void 0!==l&&l>=0&&(p[l]=t,e.selectedData&&e.selectedData.key===t.key&&(e.selectedData=t))}),i&&i.forEach(e=>{let t=d.get(e),l=this.mapLinkKeyIdx.get(e);t&&void 0===l&&(this.mapLinkKeyIdx.set(t.key,p.length),p.push(t))}),s&&(p=p.filter(e=>!s.includes(e.key)),e.linkDataArray=p,this.refreshLinkIndex(p)),a&&(e.modelData=a),e.skipsDiagramUpdate=!0}))}handleInputChange(e,t,l){this.setState((0,k.Uy)(o=>{let i=o.selectedData;if(i[e]=t,l){let n=i.key;if(n<0){let s=this.mapLinkKeyIdx.get(n);void 0!==s&&s>=0&&(o.linkDataArray[s]=i,o.skipsDiagramUpdate=!1)}else{let a=this.mapNodeKeyIdx.get(n);void 0!==a&&a>=0&&(o.nodeDataArray[a]=i,o.skipsDiagramUpdate=!1)}}}))}handleRelinkChange(e){let t=e.target,l=t.checked;this.setState({modelData:{canRelink:l},skipsDiagramUpdate:!1})}render(){let e;let t=this.state.selectedData;return null!==t&&(e=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("p",{children:"Selected Object Properties:"}),(0,o.jsx)(x.R,{selectedData:this.state.selectedData,onInputChange:this.handleInputChange}),";"]})),(0,o.jsx)("div",{children:(0,o.jsx)(E,{divClassName:"diagram-component-target",nodeDataArray:this.state.nodeDataArray,linkDataArray:this.state.linkDataArray,modelData:this.state.modelData,skipsDiagramUpdate:this.state.skipsDiagramUpdate,onDiagramEvent:this.handleDiagramEvent,onModelChange:this.handleModelChange})})}constructor(e){var t,l;super(e),this.state={nodeDataArray:null===(t=this.props)||void 0===t?void 0:t.nodeDataArray,linkDataArray:null===(l=this.props)||void 0===l?void 0:l.linkDataArray,modelData:{canRelink:!1},selectedData:null,skipsDiagramUpdate:!1,metis:this.props.metis,myMetis:this.props.myMetis,myGoModel:this.props.myGoModel,phFocus:this.props.phFocus,dispatch:this.props.dispatch},this.mapNodeKeyIdx=new Map,this.mapLinkKeyIdx=new Map,this.refreshNodeIndex(this.state.nodeDataArray),this.refreshLinkIndex(this.state.linkDataArray),this.handleDiagramEvent=this.handleDiagramEvent.bind(this)}}var eh=ep;let eu=!1,em=e=>{var t,l,i;let r=(0,a.I0)();eu&&console.log("10 TargetMeta",e);let d=null===(t=e.phFocus)||void 0===t?void 0:t.focusModel,c=null===(l=e.metis)||void 0===l?void 0:l.models,p=null===(i=e.metis)||void 0===i?void 0:i.metamodels,h=null==c?void 0:c.find(e=>(null==e?void 0:e.id)===(null==d?void 0:d.id)),u=null==p?void 0:p.find(e=>(null==e?void 0:e.id)===(null==h?void 0:h.targetMetamodelRef)),m=null==c?void 0:c.find(e=>(null==e?void 0:e.id)===(null==h?void 0:h.targetModelRef)),g=e.gojsTargetMetamodel,[f,y]=(0,s.useState)(!1);function v(){y(!f)}if((0,s.useEffect)(()=>{eu&&console.log("35 TargetMeta useEffect",null==h?void 0:h.targetMetamodelRef,"targetmm",null==u?void 0:u.id,null==u?void 0:u.name),(null==u?void 0:u.id)===void 0?eu&&console.log("39 TargetMeta useEffect",null==u?void 0:u.id,null==u?void 0:u.name):(null==u?void 0:u.id)===""?eu&&console.log("41 TargetMeta useEffect",null==u?void 0:u.id,null==u?void 0:u.name):(eu&&console.log("43 TargetMeta useEffect",null==u?void 0:u.id,null==u?void 0:u.name),r({type:"SET_FOCUS_TARGETMETAMODEL",data:{id:null==u?void 0:u.id,name:null==u?void 0:u.name}}))},[void 0!==u&&""!==u.id]),eu&&console.log("33 TargetMeta",e,g,g.nodeDataArray),!(null==h?void 0:h.targetMetamodelRef))return(0,o.jsx)(o.Fragment,{});let b=g&&(0,o.jsx)(eh,{nodeDataArray:g.nodeDataArray,linkDataArray:[],metis:e.metis,myMetis:e.myMetis,myGoModel:e.myGoModel,phFocus:e.phFocus,dispatch:e.dispatch}),w=u?(0,o.jsx)("span",{children:null==u?void 0:u.name}):(0,o.jsx)("span",{children:"No target metamodel"}),j=m?(0,o.jsxs)("span",{children:["Target model: ",null==m?void 0:m.name]}):(0,o.jsx)("span",{children:"No target model"}),T=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("button",{className:"btn-sm pt-2 pr-1 b-0 mt-0 mb-2 mr-2 ",style:{textAlign:"left",backgroundColor:"#8ce",outline:"0",borderStyle:"none"},onClick:v,children:[" ",f?(0,o.jsx)("span",{children:"-> Target Metamodel"}):(0,o.jsx)("span",{children:"<-"})]}),f?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"mmname bg-light mb-4 mx-1 px-1",style:{fontSize:"10px"},children:w}),(0,o.jsxs)("div",{className:"m-1",children:[" ",b," "]}),(0,o.jsx)("div",{className:"mmname bg-light mb-4 mx-1 px-1",style:{fontSize:"10px"},children:j})]}):(0,o.jsx)("div",{className:"btn-vertical m-0 pl-2 p-0 ",style:{textAlign:"center",verticalAlign:"baseline",maxWidth:"3px",padding:"0px"},children:(0,o.jsx)("span",{children:" T a r g e t "})})]});return(0,o.jsxs)(o.Fragment,{children:[T,(0,o.jsx)(n(),{id:"29cec1c42cd7217f",children:""})]})};var eg=em,ef=l(3165);let ey=!1,ev=console.log.bind(console,"%c %s","background: green; color: white");console.trace.bind(console,"%c %s","background: green; color: white");let eb=l(2586),ew=!1,ej=async(e,t)=>{var l,o,i,n,s,a,r,d,c,p,h,u,m,g,f,y,v,b,w;let j;ey&&console.log("28 GenGojsModel started",e);let T=null!==(l=e.phUser)&&void 0!==l&&!!l.focusUser&&(null===(o=e.phUser)||void 0===o?void 0:null===(i=o.focusUser)||void 0===i?void 0:null===(n=i.diagram)||void 0===n?void 0:n.showDeleted),k=null!==(s=e.phUser)&&void 0!==s&&!!s.focusUser&&(null===(a=e.phUser)||void 0===a?void 0:null===(r=a.focusUser)||void 0===r?void 0:null===(d=r.diagram)||void 0===d?void 0:d.showDeleted);null!==(c=e.phUser)&&void 0!==c&&c.focusUser&&null!==(p=e.phUser)&&void 0!==p&&null!==(h=p.focusUser)&&void 0!==h&&null!==(u=h.diagram)&&void 0!==u&&u.showDeleted,ey&&console.log("32 GenGojsModel showDeleted",T,null===(m=e.phUser)||void 0===m?void 0:null===(g=m.focusUser)||void 0===g?void 0:null===(f=g.diagram)||void 0===f?void 0:f.showDeleted);let O=e.phData&&e.phData.metis,M=O&&O.models,D=null===(y=e.phFocus)||void 0===y?void 0:y.focusModel,E=null===(v=e.phFocus)||void 0===v?void 0:v.focusModelview;if(ey&&console.log("37 GenGojsModel focusModel",D,E),O&&O.metamodels,null!=O){ey&&ev("42 GenGojsModel: props",e);let x=M&&(null==D?void 0:D.id)&&M.find(e=>e.id===D.id),N=e.phFocus&&e.phFocus.focusTargetModel,A=e.phFocus&&e.phFocus.focusTargetModelview,S=M&&(null==N?void 0:N.id)&&M.find(e=>e.id===(null==x?void 0:x.targetModelRef)),C=S&&(null==A?void 0:A.id)&&S.modelviews.find(e=>e.id===(null==A?void 0:A.id)),P=C||(null==S?void 0:S.modelviews[0]),I=x&&(null==E?void 0:E.id)&&(null===(b=x.modelviews)||void 0===b?void 0:b.find(e=>e.id===E.id)),_=new $.OP,L=_;if(ey&&console.log("55 GenGojsModel: tempMetis",L),_.importData(O,!0),j=eu(_),ev("61 GenGojsModel :","\n currentModelview :",null===(w=_.currentModelview)||void 0===w?void 0:w.name,",\n props :",e,"\n myMetis :",_),x&&x.id){let V=null==_?void 0:_.findModel(x.id);ey&&console.log("65 myModel :",V);let F=null==_?void 0:_.findModel(null==S?void 0:S.id),G=P&&_.findModelView(null==A?void 0:A.id),K=null==V?void 0:V.metamodel;ey&&console.log("70 myMetamodel :",K),K=K?_.findMetamodel(null==K?void 0:K.id):null,ey&&console.log("72 myMetamodel :",x.metamodel,curmetamodel),ey&&console.log("73 myTargetMetamodel :",x,x.targetMetamodelRef,S);let B=_.findMetamodel(x.targetMetamodelRef)||null;ey&&console.log("77 myTargetMetamodel :",B);let U=K&&ep();ey&&console.log("80 myMetamodelPalette",U);let J=eh(K);ey&&console.log("82 myGoMetamodel",J);let z=B&&er(B,_);ey&&console.log("84 myTargetModelPalette",B,z);let H=K&&er(K,_);ey&&console.log("87 myPalette",H);let W=I&&(null==_?void 0:_.findModelView(null==I?void 0:I.id));ey&&console.log("89 myModelview",W),ey&&console.log("90 GenGojsModel  myModel",_,V,W);let X=ec(_,V,W);ey&&console.log("92 GenGojsModel myGoModel",X,null==X?void 0:X.nodes);let Y=ec(_,F,G);ey&&console.log("94 GenGojsModel myGoModel",_,Y,F,G),null==_||_.setGojsModel(X),null==_||_.setCurrentMetamodel(K),null==_||_.setCurrentModel(V),null==_||_.setCurrentModelview(W),F&&(null==_||_.setCurrentTargetModel(F)),G&&(null==_||_.setCurrentTargetModelview(G)),ey&&console.log("101 GenGojsModel  myMetis",_),ey&&console.log("115 myPalette",H.nodes,H.links),ey&&console.log("116 myMetamodelPalette",U.nodes),ey&&console.log("117 myTargetMetamodelPalette",z);let Z={nodeDataArray:null==U?void 0:U.nodes,linkDataArray:[]},ee=z&&{nodeDataArray:null==z?void 0:z.nodes,linkDataArray:[]},et=J&&{nodeDataArray:null==J?void 0:J.nodes,linkDataArray:null==J?void 0:J.links},el={nodeDataArray:null==H?void 0:H.nodes,linkDataArray:[]},eo={};eo={nodeDataArray:null==X?void 0:X.nodes,linkDataArray:null==X?void 0:X.links};let ei={nodeDataArray:null==Y?void 0:Y.nodes,linkDataArray:null==Y?void 0:Y.links},en=V.objects,es=ed(en),ea={nodeDataArray:es,linkDataArray:[]};ey&&console.log("155 GenGojsModel gojsModel",eo),t({type:"SET_GOJS_METAMODELPALETTE",gojsMetamodelPalette:Z}),t({type:"SET_GOJS_METAMODELMODEL",gojsMetamodelModel:et}),t({type:"SET_GOJS_METAMODEL",gojsMetamodel:el}),t({type:"SET_GOJS_MODELOBJECTS",gojsModelObjects:ea}),t({type:"SET_GOJS_MODEL",gojsModel:eo}),t({type:"SET_GOJS_TARGETMODEL",gojsTargetModel:ei}),t({type:"SET_GOJS_TARGETMETAMODEL",gojsTargetMetamodel:ee}),t({type:"SET_MYMETIS_MODEL",myMetis:_}),t({type:"SET_MYMETIS_METAMODEL",myMetis:_}),t({type:"SET_MY_GOMODEL",myGoModel:X}),t({type:"SET_MY_GOMETAMODEL",myGoMetamodel:J})}}function er(e,t){let l,o;ey&&console.log("177 metamodel",e);let i=e.generatedFromModelRef,n=t.findModel(i);if(e){let s=[],a=e.includeSystemtypes?null==e?void 0:e.objecttypes:null==e?void 0:e.objecttypes0;if(a)for(let r=0;r<a.length;r++){let d=a[r];d&&s.push(d.name)}o=[...new Set(s)],ey&&console.log("193 MM objecttypes",o)}if(n){let c=n.metamodel,p=[],h=null==c?void 0:c.objecttypes;if(h)for(let u=0;u<h.length;u++){let m=h[u];m&&p.push(m.name)}l=[...new Set(p)],ey&&console.log("208 objecttypes",l)}let g=new q.SP(ef.createGuid(),"myPaletteModel",null),f=null==e?void 0:e.objecttypes;if(f&&f.sort(ef.compare),ey&&console.log("215 objecttypes",f),f){let y=!1,v=[];for(let b=0;b<f.length;b++){let w=f[b];if(ey&&console.log("202 objtype",w),w&&!w.markedAsDeleted&&!w.abstract&&"Entity0"!==w.nameId){if("Datatype"===w.name&&(y=!0),!y&&!(o&&ef.nameExistsInNames(o,w.name))&&"Generic"!==w.name&&"Container"!==w.name&&"Label"!==w.name&&l&&ef.nameExistsInNames(l,w.name))continue;v.push(w)}}ey&&console.log("239 otypes",v);let j=v.length;for(let T=0;T<j;T++){let k=v[T];if(!y&&!(o&&ef.nameExistsInNames(o,k.name))&&"Generic"!==k.name&&"Container"!==k.name&&"Label"!==k.name&&l&&ef.nameExistsInNames(l,k.name))continue;let O=ef.createGuid(),M=k.name,D=new $.e9(O,M,k,"");if(""===D.id&&(D.id=O),""===D.name&&(D.name=M),!D.type){let E=e.findObjectType(D.type.id);D.type=E}if(D.isDeleted())continue;ey&&console.log("264 obj, objtype",D,k);let x=new $.q6(ef.createGuid(),D.name,D,""),R=k.getDefaultTypeView();(null==R?void 0:R.data.viewkind)==="Container"&&(k.viewkind="Container");let N=t.findObjectTypeByName(k.name);R||(R=N?N.getDefaultTypeView():k.newDefaultTypeView("Object")),x.setTypeView(R);let A=new q.of(ef.createGuid(),x);A.loadNodeContent(g),ey&&console.log("279 node",k,x,A),A.isGroup=k.isContainer(),A.isGroup&&(A.category=eb.gojs.C_PALETTEGROUP_OBJ),g.addNode(A)}}return ey&&console.log("286 Objecttype palette",g),g}function ed(e){new q.SP(ef.createGuid(),"myObjectPalette",null),e&&e.sort(ef.compare);let t=[];for(let l=0;l<(null==e?void 0:e.length);l++){let o=!1,i=e[l],n=null==i?void 0:i.getObjectType();if(!n||!n.getDefaultTypeView)continue;let s=null==n?void 0:n.getDefaultTypeView(),a=new $.q6(ef.createGuid(),null==n?void 0:n.getName(),i,"");if(a.setTypeView(s),ey&&console.log("303 obj, objview:",i,a),!T&&i.isDeleted()&&(o=!1),T&&i.markedAsDeleted&&(a.strokecolor="red",o=!0),ew||i.type||(ey&&console.log("316 obj",i),i.markedAsDeleted=!0),ew&&!i.type&&(ey&&console.log("322 obj",i),a.strokecolor="green",o=!0),!i.markedAsDeleted&&i.type&&(o=!0),o){let r=new q.of(ef.createGuid(),a);ey&&console.log("337 node, objview, objtype:",r,a,n),r.isGroup=null==n?void 0:n.isContainer(),r.category=eb.gojs.C_OBJECT;let d=null==s?void 0:s.data;r.addData(d),t.push(r),"Container"===r.name&&ey&&console.log("344 node",r)}}return ey&&console.log("347 Object palette",t),t}function ec(t,l,o){var i,n,s,a,r,d,c,p,h;if(ey&&console.log("357 GenGojsModel",t,l,o),!l||!o)return;o.includeInheritedReltypes||(o.includeInheritedReltypes=null===(i=l.metamodel)||void 0===i?void 0:i.includeInheritedReltypes);let u=o.showRelshipNames;void 0==u&&(u=!0);let m=new q.SP(ef.createGuid(),"myModel",o),g=null==o?void 0:o.getObjectViews();if(g){ey&&console.log("363 modelview, objviews:",o,g);for(let f=0;f<g.length;f++){let y,v=!1,b=g[f];if(!b.id||b.name===b.id)continue;let w=b.object;if(l.findObject(null==w?void 0:w.id)&&(b.typeview||b.object||(b.markedAsDeleted=!0,b.textcolor||(b.textcolor="black")),y=null==w?void 0:w.type,ey&&console.log("379 obj, objview",w,b),y?(w&&(null==w?void 0:w.markedAsDeleted)==void 0&&(w.markedAsDeleted=!1),(null==w?void 0:w.markedAsDeleted)&&(b.markedAsDeleted=null==w?void 0:w.markedAsDeleted),b.name=null==w?void 0:w.name,(null==w?void 0:null===(n=w.type)||void 0===n?void 0:n.name)==="Label"&&(b.name=w.text),b.viewkind===eb.viewkinds.CONT&&(b.isGroup=!0),T&&b.markedAsDeleted&&((null===(s=b.object)||void 0===s?void 0:s.markedAsDeleted)?(b.strokecolor="orange",v=!0):(b.strokecolor="pink",v=!0)),k&&!b.object&&(b.strokecolor="blue",b.fillcolor||(b.fillcolor="lightgrey"),v=!0),!ew||(null===(a=b.object)||void 0===a?void 0:a.type)||(ey&&console.log("406 objview",b),b.strokecolor="green",b.fillcolor&&(b.fillcolor="lightgrey"),v=!0),!b.markedAsDeleted&&b.object&&(v=!0)):(v=!0,ew=!0,ey&&console.log("374 includeObjview, includeNoType",v,ew)),v)){if(ey&&console.log("418 objview:",b),(null==y?void 0:y.viewkind)===eb.viewkinds.CONT&&(b.viewkind=eb.viewkinds.CONT),!T&&b.markedAsDeleted||!k&&!b.object||!ew&&!(null===(r=b.object)||void 0===r?void 0:r.type))continue;let j=new q.of(ef.createGuid(),b);ey&&console.log("429 node",j),""===j.template&&(j.template="textAndIcon"),m.addNode(j),j.name=b.name,""===j.fillcolor&&(j.fillcolor="lightgrey"),ey&&console.log("437 buildGoModel - node",j,m)}}let O=m.nodes;ey&&console.log("450 buildGoModel - nodes",O);for(let M=0;M<O.length;M++){let D=O[M];if(!D.object)continue;let E=D.objectview,x=D.object,N=x.type;(null==N?void 0:N.name)==="Label"&&(D.text=E.name),D.name=E.name,D.loadNodeContent(m),D.name=E.name,m.addNode(D)}ey&&console.log("465 myGoModel",m)}let A=[],S=o&&o.getRelationshipViews();if(S){ey&&console.log("471 modelview, relviews",o,S);let C=[],P=S.length;for(let I=0;I<P;I++){let _=!1,L=S[I],V=L.fromObjview;if(!o.findObjectView(V.id))continue;let F=L.toObjview;if(!o.findObjectView(F.id))continue;let G=L.relship;G&&(void 0==G.markedAsDeleted&&(G.markedAsDeleted=!1),G.markedAsDeleted&&(L.markedAsDeleted=null==G?void 0:G.markedAsDeleted),L.name=G.name);let K="black";if(T&&(L.markedAsDeleted&&(null===(c=L.relship)||void 0===c?void 0:c.markedAsDeleted)?(K="red",_=!0):L.markedAsDeleted?(K="rgb(220,0,150)",_=!0):(null===(p=L.relship)||void 0===p?void 0:p.markedAsDeleted)&&(K="orange",_=!0)),k&&!L.relship&&(K="blue",_=!0),!ew||(null===(h=L.relship)||void 0===h?void 0:h.type)||(K="green",_=!0),!L.markedAsDeleted&&L.relship&&(_=!0),T||k||ew||!L||(K=null==L?void 0:null===(d=L.typeview)||void 0===d?void 0:d.strokecolor),ey&&console.log("521 rel, relview, relcolor:",G,L,K),K||(K="black"),ey&&console.log("523 rel, relview, relcolor:",G,L,K),_){"NaN"===L.strokewidth&&(L.strokewidth="1"),L.setFromArrow2(null==G?void 0:G.relshipkind),L.setToArrow2(null==G?void 0:G.relshipkind),L=Q.rw(L),A.push(L),ey&&console.log("533 rel, relview, relcolor:",G,L,K);let B=new R.XB(L);C.push(B);let U=new q.hX(ef.createGuid(),m,L);ey&&console.log("538 modelview, link:",o,U),U.loadLinkContent(m),u||(U.name=" "),(T||k||ew)&&(U.strokecolor=K,U.strokewidth="1"),ey&&console.log("542 link, relview:",U,L),ey&&console.log("543 GenGojsModel: props",e),m.addLink(U)}ey&&console.log("546 myGoModel",m)}C.map(t=>{let l=t;e.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:l})}),ey&&console.log("552 modifiedRelviews",C)}return o.relshipviews=A,ey&&console.log("539 buildGoModel - myGoModel",m),Q.ju(m,o),ey&&console.log("558 myGoModel.links",m.links),ey&&console.log("569 myGoModel",m),m}function ep(){ey&&console.log("547 buildGoMetaPalette");let e=new q.SP(ef.createGuid(),"myMetaPalette",null),t=[],l=new q.fx("01","objecttype","Object type","Object type","");t.push(l);let o=JSON.parse("[]");return e.nodes=t,e.links=o,ey&&console.log("560 myGoMetaPalette",e),e}function eh(e){if(e&&(ey&&console.log("600 metamodel",e),e.objecttypes=ef.removeArrayDuplicates(null==e?void 0:e.objecttypes),e.objecttypes)){var t,l;ey&&console.log("603 metamodel",e);let o=new q.SP(ef.createGuid(),"myMetamodel",null),i=null==e?void 0:e.getObjectTypes();if(i){ey&&console.log("565 objtypes",i);for(let n=0;n<i.length;n++){let s=!1,a=i[n],r=a.outputreltypes;for(let d=0;d<(null==r?void 0:r.length);d++){let c=r[d];c&&(ey&&console.log("615 reltype",c),!c.fromObjtype&&c.fromobjtypeRef&&(c.fromObjtype=e.findObjectType(c.fromobjtypeRef)),!c.toObjtype&&c.toobjtypeRef&&(c.toObjtype=e.findObjectType(c.toobjtypeRef)))}let p=a.typeview,h=null===(t=a.typeview)||void 0===t?void 0:t.strokecolor;if(null==p||p.fillcolor,a&&(a.markedAsDeleted?(ey&&console.log("632 objtype",a),T&&a.markedAsDeleted&&(h="orange",s=!0)):s=!0,s)){a.typeview||(a.typeview=a.newDefaultTypeView("Object"));let u=new q.Yg(ef.createGuid(),a);u.loadNodeContent(e),u.strokecolor=h,ey&&console.log("648 objtype, node",a,u),o.addNode(u)}}}let m=e.relshiptypes;if(ey&&console.log("656 relshiptypes",m),m)for(let g=0;g<m.length;g++){let f=!1,y=m[g];"isRelatedTo"===y.name&&(y.name="generic"),"contains"===y.name&&y.fromObjtype===y.toObjtype&&(y.markedAsDeleted=!0);let v=null===(l=y.typeview)||void 0===l?void 0:l.strokecolor;if(y.cardinality.length>0&&(y.cardinalityFrom=y.getCardinalityFrom(),y.cardinalityTo=y.getCardinalityTo()),void 0===y.markedAsDeleted&&(y.markedAsDeleted=!1),y&&!y.markedAsDeleted?f=!0:T&&y.markedAsDeleted&&(v="orange",f=!0),f){ey&&console.log("685 reltype",y),y.typeview||(y.typeview=y.newDefaultTypeView(y.relshipkind)),y.fromObjtype||(y.fromObjtype=e.findObjectType(y.fromobjtypeRef)),y.toObjtype||(y.toObjtype=e.findObjectType(y.toobjtypeRef));let b=ef.createGuid(),w=new q.zV(b,o,y);ey&&console.log("694 reltype, link",y,w);let j=y.typeview.strokewidth;j||(j="1"),w.loadLinkContent()&&(w.relshipkind=y.relshipkind,w.strokewidth=j,w.strokecolor=v,w.routing=e.routing,w.curve=e.linkcurve,w.category=eb.gojs.C_RELSHIPTYPE,ey&&console.log("701 link",w.name,w),o.addLink(w))}}return ey&&console.log("707 myGoMetamodel",o),o}}function eu(e){let l;let o=e.findMetamodelByName(eb.admin.AKM_ADMIN_MM);if(!o){ey&&console.log("590 No Admin Metamodel found!");return}{let i;let n=o.findRelationshipTypeByName(eb.admin.AKM_GENERATEDFROM_MODEL);n&&(l=n.typeview)&&(l.toArrow="",l.strokecolor="red",l.fromArrow="BackwardOpenTriangle",l.toArrow="None");let s=!1,a=e.findModelByName(eb.admin.AKM_ADMIN_MODEL);if(a||(s=!0,a=new $.qv(ef.createGuid(),eb.admin.AKM_ADMIN_MODEL,o,""),e.addModel(a),(i=new $.Nn(ef.createGuid(),"_ADMIN",a,"")).layout="LayeredDigraph",a.addModelView(i),e.addModelView(i)),a){let r,d;ey&&console.log("709 adminModel",a),a.objects=null,a.relships=null,(i=a.modelviews?a.modelviews[0]:null)&&(i.objectviews=null,i.relshipviews=null);let c=e.findObjectTypeByName(eb.admin.AKM_PROJECT),p=e.findObjectTypeByName(eb.admin.AKM_METAMODEL),h=e.findObjectTypeByName(eb.admin.AKM_MODEL),u=e.findObjectTypeByName(eb.admin.AKM_MODELVIEW),m=e.findRelationshipTypeByName(eb.admin.AKM_HAS_METAMODEL),g=e.findRelationshipTypeByName(eb.admin.AKM_HAS_MODEL),f=e.findRelationshipTypeByName(eb.admin.AKM_HAS_MODELVIEW),y=e.findRelationshipTypeByName(eb.admin.AKM_REFERSTO_METAMODEL),v=e.findRelationshipTypeByName(eb.admin.AKM_GENERATEDFROM_MODEL);ey&&console.log("598 adminModel",a),d||((d=new $.e9(ef.createGuid(),e.name,c,e.description)).metisId=e.id,a.addObject(d),e.addObject(d),(r=new $.q6(ef.createGuid(),d.name,d,"")).fillcolor="lightgrey",d.addObjectView(r),i.addObjectView(r),e.addObjectView(r)),ey&&console.log("741 project",d);let b=e.metamodels;for(let w=0;w<b.length;w++){let j=b[w];if(j){let T;if(j.name===eb.admin.AKM_ADMIN_MM)continue;if(!T){(T=new $.e9(ef.createGuid(),j.name,p,j.description)).metamodelId=j.id,a.addObject(T),e.addObject(T);let k=new $.Uj(ef.createGuid(),m,d,T,eb.admin.AKM_HAS_METAMODEL,"");a.addRelationship(k),e.addRelationship(k);let O=new $.q6(ef.createGuid(),T.name,T,"");O.fillcolor="lightblue",T.addObjectView(O),i.addObjectView(O),e.addObjectView(O);let M=new $.IM(ef.createGuid(),k.name,k,"");M.setFromObjectView(r),M.setToObjectView(O),k.addRelationshipView(M),i.addRelationshipView(M),e.addRelationshipView(M);let D=e.models;ey&&console.log("640 models",D);for(let E=0;E<D.length;E++){var x;let N=D[E];if(N&&(null===(x=N.metamodel)||void 0===x?void 0:x.id)===j.id){let A;if(!A){(A=new $.e9(ef.createGuid(),N.name,h,N.description)).modelId=N.id,a.addObject(A),e.addObject(A),ey&&console.log("654 mObj",A);let S=new $.q6(ef.createGuid(),A.name,A,"");S.fillcolor="lightgreen",A.addObjectView(S),i.addObjectView(S),e.addObjectView(S);let C=N.metamodel;if(a.findObjectByTypeAndName(p,C.name)){let P=new $.Uj(ef.createGuid(),y,A,T,eb.admin.AKM_REFERSTO_METAMODEL,"");a.addRelationship(P),e.addRelationship(P);let I=new $.IM(ef.createGuid(),P.name,P,"");I.setFromObjectView(S),I.setToObjectView(O),P.addRelationshipView(I),I.strokecolor="blue",i.addRelationshipView(I),e.addRelationshipView(I)}let _=new $.Uj(ef.createGuid(),g,d,A,eb.admin.AKM_HAS_MODEL,"");a.addRelationship(_),e.addRelationship(_);let L=new $.IM(ef.createGuid(),_.name,_,"");L.setFromObjectView(r),L.setToObjectView(S),_.addRelationshipView(L),i.addRelationshipView(L),e.addRelationshipView(L);let V=N.modelviews;for(let F=0;F<(null==V?void 0:V.length);F++){let G=V[F];if(G){let K;if(!K){(K=new $.e9(ef.createGuid(),G.name,u,G.description)).modelviewId=G.id,K.layout=G.layout,K["link routing"]=G.routing,K["link curve"]=G.linkcurve,K.showCardinality=G.showCardinality,K.askForRelshipName=G.askForRelshipName,K.includeInheritedReltypes=G.includeInheritedReltypes,a.addObject(K),e.addObject(K);let B=new $.q6(ef.createGuid(),K.name,K,"");B.fillcolor="pink",K.addObjectView(B),i.addObjectView(B),e.addObjectView(B);let U=new $.Uj(ef.createGuid(),f,A,K,eb.admin.AKM_HAS_MODELVIEW,"");U.setFromObject(A),U.setToObject(K),a.addRelationship(U),e.addRelationship(U);let J=new $.IM(ef.createGuid(),U.name,U,"");J.setFromObjectView(S),J.setToObjectView(B),U.addRelationshipView(J),i.addRelationshipView(J),e.addRelationshipView(J)}}}}}}}}}for(let z=0;z<b.length;z++){let H=b[z];if(H.generatedFromModelRef){let W=H.generatedFromModelRef,X=e.findModel(W);if(X){let Y=a.findObjectByTypeAndName(p,H.name),Z=a.findObjectByTypeAndName(h,X.name),q=new $.Uj(ef.createGuid(),v,Y,Z,eb.admin.AKM_GENERATEDFROM_MODEL,"");q.setFromObject(Y),q.setToObject(Z),a.addRelationship(q),e.addRelationship(q);let Q=new $.IM(ef.createGuid(),q.name,q,"");if(Q.typeview=l,ey&&console.log("886 genRelview",Q),Y&&Z&&q&&Q){let ee=Y.objectviews[0],et=Z.objectviews[0];Q.setFromObjectView(ee),Q.setToObjectView(et),Q.strokecolor="red",Q.toArrow="None",Q.toArrowColor="black",Q.fromArrow="BackwardOpenTriangle",q.addRelationshipView(Q),i.addRelationshipView(Q),ey&&console.log("899 adminModelview",i),e.addRelationshipView(Q)}}}}}if(ey&&console.log("910 adminModel, adminModelview",a,i),s){let el=new R.qf(a,!0),eo=[];eo.push(el),eo.map(e=>{let l=e;l=JSON.parse(JSON.stringify(l)),t({type:"LOAD_TOSTORE_NEWMODEL",data:l})})}return a}}};var eT=ej,ek=l(2702),eO=l.n(ek);l(3144),eO().polyfill();let eM=async e=>{console.log("7 modeldata",e);let t=JSON.stringify(e),l="http://localhost:4000/";try{await fetch("".concat(l,"postakmmodels/"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:t}).then(e=>{console.log("51 saveModelDataToServer res",e)}),await fetch("".concat(l,"system/reboot/"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(e=>{console.log("68 Reboot res",e)})}catch(o){console.log("72 saga",o)}};l(412);let eD="https://akmserver-eq.herokuapp.com/";var eE=function(e,t){let[l,o]=(0,s.useState)(()=>{try{var l;let o=null==window?void 0:null===(l=window.localStorage)||void 0===l?void 0:l.getItem(e);return o?JSON.parse(o):t}catch(i){return console.log(i),t}}),i=t=>{try{let i=t instanceof Function?t(l):t;o(i),null==window||window.localStorage.setItem(e,JSON.stringify(i))}catch(n){console.log(n)}};return[l,i]};let ex=e=>{let t=(0,a.I0)(),l=!1,i=e.refresh,r=e.setRefresh;new Date().toISOString();let{buttonLabel:d,className:c}=e,[p,h]=(0,s.useState)(!1),u=()=>h(!p),[m,g]=eE("memorystate",null),[f,y]=(0,s.useState)("");function v(){r(!i)}l&&console.log("31 memoryLocState",m),m||g([]);let b=m;if("object"==typeof m||0===m.length)return(0,o.jsx)(o.Fragment,{children:" "});b=Array.isArray(m)?m:[m],l&&console.log("31 memoryTmp",b);let w=b.map((e,t)=>({value:e.lastUpdate||"",label:t+" "+e.phSource+" Saved : "+e.lastUpdate}));function j(e){let o=e.target.value;function i(e){console.log("59 cleanMemoryState",e);let t=null==e?void 0:e.filter(e=>void 0!==e.phSource);g(t)}function n(){if(l&&console.log("62 LoadRecovery",o,m),""!==o&&void 0!==m[o]){if(o>m.length)return;let e=o,i=m[e];l&&console.log("74 LoadRecovery",e,m[e],m);let n=null==i?void 0:i.phData,s=null==i?void 0:i.phFocus,a=null==i?void 0:i.phUser,r=(null==i?void 0:i.phSource)===""&&n.metis.name||(null==i?void 0:i.phSource);t({type:"LOAD_TOSTORE_PHDATA",data:n}),t({type:"LOAD_TOSTORE_PHFOCUS",data:s}),t({type:"LOAD_TOSTORE_PHUSER",data:a}),t({type:"LOAD_TOSTORE_PHSOURCE",data:""===r?n.metis.name:r})}}l&&console.log("58 LoadRecovery",o,"memval ",m[o],"mem ",m),i(b),n()}l&&console.log("46 LoadRecovery",m,w);let T=(0,o.jsx)(o.Fragment,{});return T=(0,o.jsx)("div",{className:"loadstore selection d-flex justify-content-center border border-dark ",children:(0,o.jsxs)("select",{className:"modal-select w-100",placeholder:"Select Model to recover : ",onChange:j,children:[(0,o.jsx)("option",{children:"Select model to recover from last refresh"}),w.map((e,t)=>(0,o.jsx)("option",{value:t,title:e.label,children:e.label},t))]})}),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{onClick:u,className:"jsx-8d83c959561e2082 btn-transparent text-warning float-right ml-2 mr-2 mb-0 pr-2",children:d}),(0,o.jsxs)(z.Z,{isOpen:p,toggle:u,className:c,children:[(0,o.jsx)(W.Z,{className:"bg-warning pl-2",toggle:()=>{u(),v()},children:" Recover from last refresh: "}),(0,o.jsx)(X.Z,{className:"pt-0 bg-warning",children:(0,o.jsxs)("div",{className:"jsx-8d83c959561e2082 source bg-warning p-2",children:[(0,o.jsx)("hr",{style:{borderTop:"1px solid #8c8b8",backgroundColor:"#9cf",padding:"2px",margin:"1px",marginBottom:"1px"},className:"jsx-8d83c959561e2082"}),(0,o.jsx)("div",{className:"jsx-8d83c959561e2082 loadsave px-2 pb-1 mb-0 bg-warning",children:(0,o.jsxs)("div",{className:"jsx-8d83c959561e2082 loadsave--memoryStore select mb-1 p-2  bg-secondary border border-dark",children:[(0,o.jsx)("h5",{className:"jsx-8d83c959561e2082 text-warning",children:"Crash Recovery "}),(0,o.jsxs)("div",{style:{fontSize:"smaller"},className:"jsx-8d83c959561e2082 footer--text mb-2",children:["If the browser hang or crash, or you made a mistake, you can go back to an earlier version by select a recovery version below!",(0,o.jsx)("br",{className:"jsx-8d83c959561e2082"}),"(The recovery version is updated each time you select a new modelview tab or click refresh)"]}),T]})})]})}),(0,o.jsxs)(Y.Z,{className:"bg-warning",children:[(0,o.jsx)("div",{style:{fontSize:"smaller"},className:"jsx-8d83c959561e2082 footer--text mb-2",children:"Local Storage is controlled by the Internet Browser, and may at some point be deleted."}),(0,o.jsx)(H.Z,{className:"modal--footer m-0 py-1 px-2",color:"secondary","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Click here when done!",onClick:()=>{u(),v()},children:"Done"})]})]}),(0,o.jsx)(n(),{id:"8d83c959561e2082",children:".list-obj.jsx-8d83c959561e2082{min-width:90px}.modal.jsx-8d83c959561e2082{z-index:1;margin-top:8%}.modal.right.jsx-8d83c959561e2082 .modal-dialog.jsx-8d83c959561e2082{position:fixed;margin:150px auto 200px auto;width:380px;height:80%;color:black;-webkit-transform:translate3d(0%,0,0);-ms-transform:translate3d(0%,0,0);-o-transform:translate3d(0%,0,0);-moz-transform:translate3d(0%,0,0);transform:translate3d(0%,0,0)}.modal.right.jsx-8d83c959561e2082 .modal-content.jsx-8d83c959561e2082{height:100%;overflow-y:auto}.modal.right.jsx-8d83c959561e2082 .modal-body.jsx-8d83c959561e2082{padding:15px 15px 80px;color:#444}.modal.right.fade.jsx-8d83c959561e2082 .modal-dialog.jsx-8d83c959561e2082{right:320px;-webkit-transition:opacity.3s linear,left.3s ease-out;-moz-transition:opacity.3s linear,left.3s ease-out;-o-transition:opacity.3s linear,left.3s ease-out;transition:opacity.3s linear,left.3s ease-out}.modal.fade.in.jsx-8d83c959561e2082{opacity:1}.modal.right.fade.show.jsx-8d83c959561e2082 .modal-dialog.jsx-8d83c959561e2082{right:0;-webkit-transform:translate(0,0);-moz-transform:translate(0,0);-ms-transform:translate(0,0);-o-transform:translate(0,0);transform:translate(0,0)}.modal-content.jsx-8d83c959561e2082{-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;border:none}.modal-header.jsx-8d83c959561e2082{border-bottom-color:#eee;background-color:#fafafa}.modal-body.jsx-8d83c959561e2082{}.modal-backdrop.jsx-8d83c959561e2082 .fade.jsx-8d83c959561e2082 .in.jsx-8d83c959561e2082{}.modal-background.jsx-8d83c959561e2082{display:none}.btn-context.jsx-8d83c959561e2082{font-weight:bold}"})]})};var eR=ex;let eN=!1;JSON.safeStringify=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,l=[],o=JSON.stringify(e,(e,t)=>"object"==typeof t&&null!==t?l.includes(t)?void 0:l.push(t)&&t:t,t);return l=null,o};let eA=(e,t,l)=>{new Date().toISOString().slice(0,19);let o=t+"_"+l,i=JSON.safeStringify(e),n=new Blob([i],{type:"application/json"}),s=URL.createObjectURL(n),a=document.createElement("a");a.href=s,a.download=o+".json",document.body.appendChild(a),a.click(),document.body.removeChild(a)},eS=(e,t,l)=>{new Date().toISOString().slice(0,19);let o=t.includes("_MM")?t:t+"_"+l,i=JSON.safeStringify(e),n=new Blob([i],{type:"application/json"}),s=URL.createObjectURL(n),a=document.createElement("a");a.href=s,a.download=o+".json",document.body.appendChild(a),a.click(),document.body.removeChild(a)},eC=(e,t,l)=>{let o=t;eN&&console.log("22 LoadLocal",e,o);let i=JSON.safeStringify(e),n=new Blob([i],{type:"application/json"}),s=URL.createObjectURL(n),a=document.createElement("a");a.href=s,a.download=o+".json",document.body.appendChild(a),a.click(),document.body.removeChild(a)},eP=(e,t,l)=>{let o=new Date().toISOString().slice(0,10),i=t+"_"+l+"_"+o;eN&&console.log("22 LoadLocal",e,i);let n=JSON.safeStringify(e),s=new Blob([n],{type:"application/json"}),a=URL.createObjectURL(s),r=document.createElement("a");r.href=a,r.download=i+".json",document.body.appendChild(r),r.click(),document.body.removeChild(r)},eI=async(e,t,l)=>{var o;l.preventDefault();let i=new FileReader;if(i.fileName="",i.fileName=null===(o=l.target.files[0])||void 0===o?void 0:o.name,console.log("92 ReadModelFromFile",i.fileName),!i.fileName)return null;i.onload=async t=>{var l,o,i,n,s,a,r,d,c,p,h,u,m,g,f,y,v,b,w,j,T,k,O,M,D,E,x,R,N,A,S,C,P,I,_,L,V,F,G,K,B,U;let J;let z=t.target.result,H=JSON.parse(z),W=t.target.fileName;eN&&console.log("46 SaveModelToFile",e.phFocus.focusModel.id),eN&&console.log("44 SaveModelToFile",e,H);let X=null===(l=e.phData)||void 0===l?void 0:null===(o=l.metis)||void 0===o?void 0:null===(i=o.models)||void 0===i?void 0:i.findIndex(e=>e.id===(null==H?void 0:H.id)),Y=null===(n=e.phData)||void 0===n?void 0:null===(s=n.metis)||void 0===s?void 0:s.models.length;if(console.log("104 SaveModelToFile",X,Y,null==H?void 0:H.id,null===(a=null===(r=e.phData)||void 0===r?void 0:null===(d=r.metis)||void 0===d?void 0:d.models[X])||void 0===a?void 0:a.id),eN&&console.log("138 SaveModelToFile",mvindex,mvlength),console.log("142 SaveModelToFile",null===(c=e.phData)||void 0===c?void 0:c.metis,null===(p=H.phData)||void 0===p?void 0:p.metis),H.phData)console.log("145 SaveModelToFile",null===(h=e.phData)||void 0===h?void 0:h.metis,null===(u=H.phData)||void 0===u?void 0:u.metis),J={phData:H.phData,phFocus:H.phFocus,phUser:H.phUser,phSource:W};else if(H.modelview){let Z,$;let q=null===(m=e.phData)||void 0===m?void 0:null===(g=m.metis)||void 0===g?void 0:null===(f=g.models)||void 0===f?void 0:f.findIndex(t=>{var l;return t.id===(null===(l=e.phFocus.focusModel)||void 0===l?void 0:l.id)});Z=null===(y=null===(v=e.phData)||void 0===v?void 0:null===(b=v.metis)||void 0===b?void 0:b.models[q])||void 0===y?void 0:y.modelviews.findIndex(e=>{var t;return e.id===(null===(t=H.modelview)||void 0===t?void 0:t.id)}),$=null===(w=null===(j=e.phData)||void 0===j?void 0:null===(T=j.metis)||void 0===T?void 0:T.models[q])||void 0===w?void 0:null===(k=w.modelviews)||void 0===k?void 0:k.length,Z<0&&(Z=$),J={phData:{...e.phData,metis:{...e.phData.metis,metamodels:e.phData.metis.metamodels,models:[...null===(O=e.phData.metis.models)||void 0===O?void 0:O.slice(0,q),{...e.phData.metis.models[q],modelviews:[...null===(M=e.phData.metis.models[q])||void 0===M?void 0:null===(D=M.modelviews)||void 0===D?void 0:D.slice(0,Z),{...null===(E=e.phData.metis.models[q])||void 0===E?void 0:E.modelviews[Z],...H.modelview},...null===(x=e.phData.metis.models[q])||void 0===x?void 0:null===(R=x.modelviews)||void 0===R?void 0:R.slice(Z+1,$)]},...null===(N=e.phData.metis.models)||void 0===N?void 0:N.slice(q+1,Y)]}}}}else if(W.includes("_MM")){let Q=null===(A=e.phData)||void 0===A?void 0:null===(S=A.metis)||void 0===S?void 0:null===(C=S.metamodels)||void 0===C?void 0:C.findIndex(e=>e.id===(null==H?void 0:H.id)),ee=null===(P=e.phData)||void 0===P?void 0:null===(I=P.metis)||void 0===I?void 0:I.metamodels.length;Q<0&&(Q=ee),eN&&console.log("189 LoadLocal",metamodelff,Q,ee),J={phData:{...e.phData,metis:{...e.phData.metis,metamodels:[...null===(_=e.phData.metis.metamodels)||void 0===_?void 0:_.slice(0,X),{...e.phData.metis.metamodels[X],...H},...null===(L=e.phData.metis.metamodels)||void 0===L?void 0:L.slice(X+1,Y)]}}}}else{let et=window.confirm("Model already exists! Existing: "+(null===(V=null===(F=e.phData)||void 0===F?void 0:null===(G=F.metis)||void 0===G?void 0:G.models[X])||void 0===V?void 0:V.name)+" New: "+(null==H?void 0:H.name)+" Do you want to replace (overwrite it)?");!1===et&&(H.id=H.id+Y,console.log("124 SaveModelToFile",X=Y,Y,null==H?void 0:H.id,null===(K=null===(B=e.phData)||void 0===B?void 0:null===(U=B.metis)||void 0===U?void 0:U.models[X])||void 0===K?void 0:K.id)),J={phData:{...e.phData,metis:{...e.phData.metis,metamodels:e.phData.metis.metamodels,models:[...e.phData.metis.models.slice(0,X),H,...e.phData.metis.models.slice(X+1,Y)]}}}}eN&&console.log("193 SaveModelToFile",J),J.phData&&e.dispatch({type:"LOAD_TOSTORE_PHDATA",data:J.phData}),J.phFocus&&e.dispatch({type:"LOAD_TOSTORE_PHFOCUS",data:J.phFocus}),J.phUser&&e.dispatch({type:"LOAD_TOSTORE_PHUSER",data:J.phUser}),J.phSource&&e.dispatch({type:"LOAD_TOSTORE_PHSOURCE",data:J.phSource})},i.readAsText(l.target.files[0])},e_=async(e,t,l)=>{l.preventDefault();let o=new FileReader;o.onload=async t=>{var l,o,i,n,s;let a=t.target.result,r=JSON.parse(a);eN&&console.log("155 LoadLocal",e);let d=null===(l=e.phData)||void 0===l?void 0:null===(o=l.metis)||void 0===o?void 0:null===(i=o.metamodels)||void 0===i?void 0:i.findIndex(e=>e.id===(null==r?void 0:r.id)),c=null===(n=e.phData)||void 0===n?void 0:null===(s=n.metis)||void 0===s?void 0:s.metamodels.length;d<0&&(d=c),eN&&console.log("189 LoadLocal",r,d,c);let p={phData:{...e.phData,metis:{...e.phData.metis,metamodels:[...e.phData.metis.metamodels.slice(0,d),r,...e.phData.metis.metamodels.slice(d+1,e.phData.metis.metamodels.length)],models:e.phData.metis.models}}};eN&&console.log("205 LoadLocal",p),e.dispatch({type:"LOAD_TOSTORE_PHDATA",data:p.phData})},o.readAsText(l.target.files[0])},eL=!1,eV=async(e,t,l,o)=>{console.log("11",e,t);let i=e.objects.filter(e=>e&&(null==t?void 0:t.objectviews.find(t=>e.id===t.objectRef)));console.log("11",i);let n=i,s=eF(n),a=JSON.parse(s)?JSON.parse(s):null;console.log("33 ",a);let r=a||s;console.log("37 ",r);let d=Object.keys(r)[0];console.log("38",d);let c=a[d],p=d,h=JSON.stringify(c),u=new Blob([h],{type:"application/txt"}),m=URL.createObjectURL(u),g=document.createElement("a");g.href=m,eL&&console.log("25",c,h,"\n blob : ",u,m,g,g.href),g.download=p,document.body.appendChild(g),g.click(),document.body.removeChild(g)},eF=e=>{console.log("36",e[0]),e.sort((e,t)=>e.osduId>t.osduId?1:t.osduId>e.osduId?-1:0);let t="{",l="{",o="}",i=[],n="",s="",a=[],r=e=>{eL&&console.log("51 : ",e.map(e=>e.osduId)),e.map((r,d)=>{var c,p,h,u,m;let g;let f=r.osduId,y=r.osduId.split("|").slice(-1)[0],v=r.osduId.split("|").slice(0,-2).join("|"),b=r.osduId.split("|").slice(-2)[0],w=null===(c=e[d-1])||void 0===c?void 0:c.osduId,j=null===(p=e[d-1])||void 0===p?void 0:p.osduId.split("|").slice(-1)[0],T=null===(h=e[d+1])||void 0===h?void 0:h.osduId,k=null===(u=e[d+1])||void 0===u?void 0:u.osduId.split("|").slice(-1)[0];if(null===(m=e[d+1])||void 0===m||m.osduId.split("|").slice(-1)[0],"required"===r.name){let O=r.propNames.split(",");g=JSON.stringify(O)}else g=JSON.stringify(eG(r));console.log("55",r.name,g);let M="false"!==g?g.slice(0,-1):"",D="false"!==g?M.substring(1):"",E=null==w?void 0:w.split("|").length,x=null==f?void 0:f.split("|").length,R=(null==T?void 0:T.split("|").length)||0,N=E-x;eL&&console.log("77\n                prev        : %c ".concat(w,"  : %c ").concat(j," \n                curOsduId   : %c ").concat(f,"   : %c ").concat(y," \n                next        : %c ").concat(T,"  : %c ").concat(k,"\n                parent      : %c ").concat(v,": %c ").concat(b," \n                "),"color: green","color: blue","color: green","color: blue","color: green","color: blue","color: green","color: blue"),eL&&console.log("96  prev, cur, next, rest :",E,x,R,N,x>E||x!==R),l="isArray"===r.jsonType?"[":"{",o="isArray"===r.jsonType?"]":"}",i.unshift(o),eL&&console.log("107 ","\n pc ",o,"\n pp ",i,"\n pp0",i[0],"\n lc ",n,"\n rpc",s);let A=isNaN(r.jsonKey)?'"'.concat(r.jsonKey,'": ').concat(l).concat(D):"".concat(l).concat(D),S=e=>{a=[],e=e||x-R;do{let t=i.shift();a.unshift(t),e-=1}while(e>0);return a.length>1?a.reverse().join(""):a[0]};if(x>E&&x!==R){if(eL&&console.log("127",x,E,R,i,o),E>x)s=S(),eL&&console.log("129",E,x,R,s);else if(x>E&&x>R){let C=x-E+(x-R);s=S(C)+",",eL&&console.log("133",E,x,R,C,s)}else x>E&&x<R?(s=",",eL&&console.log("137",E,x,R,s,r)):(s="",eL&&console.log("139",E,x,R,s))}else if(x===E){if(x<R)"{"===A.charAt(A.length-1)?(s="",eL&&console.log("143",A,E,x,R,s)):(s=",",eL&&console.log("146",E,x,R,s));else{let P=x-E+(x-R);s=S(P)+",",eL&&console.log("151",E,x,R,P,s)}}else if(E){if(E===x||x===R)s=S()+",",eL&&console.log("163",E,x,R,s);else{let I=3;s=S(I)+",",eL&&console.log("160",E,x,R,I,s)}}else s=",",eL&&console.log("156",E,x,R,s);A+=s,eL&&console.log("172 restPath : ",a,"postPath : ",i,"restChar : ",s),eL&&console.log("173 #######------- \n","o.jkey : ",r.jsonKey,"\n",A),t+=A});let r=(t+=i.reverse().join(",")+"}").replace(/,}/g,"}").replace(/,]/g,"]").replace(/{,/g,"{").replace(/\[,/g,"[").replace(/\{},/g,""),d=r.substring(0,3);return'{{"'===d&&(r=(r=r.substring(1)).substring(0,r.length-1)),r},d=r(e);return console.log("132 : ",d),d};function eG(e){let t={};for(var l in t=(null==e?void 0:e.osduId.split("|").slice(-1)[0])==="allOf"||(null==e?void 0:e.osduId.split("|").slice(-1)[0])==="items"&&[],e){if(!e.hasOwnProperty(l)||"object"==typeof e[l]||(e[l],"abstract"===l||"generatedTypeId"===l||"markedAsDeleted"===l||"objectviews"===l||"typeName"===l||"typeRef"===l||"viewkind"===l||"modified"===l||"id"===l||"name"===l||"jsonKey"===l||"jsonType"===l||"osduId"===l||""===e[l]))continue;let o=l;"osduType"===l&&(o="type"),t={...t,[o]:e[l]}}return!1===t||!0===t?"":t}JSON.safeStringify=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,l=[],o=JSON.stringify(e,(e,t)=>"object"==typeof t&&null!==t?l.includes(t)?void 0:l.push(t)&&t:t,t);return l=null,o};let eK=e=>{var t,l,i,r,d,c;let p=!1,h=(0,a.I0)(),u=e.refresh,m=e.setRefresh;function g(){m(!u)}let f=null===(t=e.ph.phData)||void 0===t?void 0:null===(l=t.metis)||void 0===l?void 0:null===(i=l.models)||void 0===i?void 0:i.map(e=>(0,o.jsxs)("span",{children:[e.name," | "]},e.id)),y=null===(r=e.ph.phData)||void 0===r?void 0:null===(d=r.metis)||void 0===d?void 0:null===(c=d.metamodels)||void 0===c?void 0:c.map(e=>e&&(0,o.jsxs)("span",{children:[e.name," | "]},e.id));p&&console.log("26 LoadLocal",e,typeof window),p&&console.log("28 LoadLocal",e.ph.phData,f,y);let v={phData:e.ph.phData,phFocus:e.ph.phFocus,phUser:e.ph.phUser,phSource:e.phSource,lastUpdate:new Date().toISOString()};function b(){let t=e.ph.phData.metis.name;console.log("37 LoadFile",v),eP(v,t,"Project")}function w(){var t,l,o,i,n;e.ph.phData.metis.name;let s=null===(t=e.ph)||void 0===t?void 0:null===(l=t.phData)||void 0===l?void 0:null===(o=l.metis)||void 0===o?void 0:null===(i=o.models)||void 0===i?void 0:i.find(t=>{var l,o,i;return t.id===(null===(l=e.ph)||void 0===l?void 0:null===(o=l.phFocus)||void 0===o?void 0:null===(i=o.focusModel)||void 0===i?void 0:i.id)}),a=null===(n=s.modelviews)||void 0===n?void 0:n.findIndex(t=>{var l,o,i;return t.id===(null===(l=e.ph)||void 0===l?void 0:null===(o=l.phFocus)||void 0===o?void 0:null===(i=o.focusModelview)||void 0===i?void 0:i.id)}),r=s.modelviews[a];console.log("43",a,r),eA({modelview:r},r.name,"Modelview")}function j(){var t,l,o,i;e.ph.phData.metis.name;let n=null===(t=e.ph)||void 0===t?void 0:null===(l=t.phData)||void 0===l?void 0:null===(o=l.metis)||void 0===o?void 0:null===(i=o.models)||void 0===i?void 0:i.find(t=>{var l,o,i;return t.id===(null===(l=e.ph)||void 0===l?void 0:null===(o=l.phFocus)||void 0===o?void 0:null===(i=o.focusModel)||void 0===i?void 0:i.id)});eA(n,n.name,"Model")}function T(){var t,l,o,i,n,s,a,r;let d=null===(t=e.ph)||void 0===t?void 0:null===(l=t.phData)||void 0===l?void 0:null===(o=l.metis)||void 0===o?void 0:null===(i=o.models)||void 0===i?void 0:i.find(t=>{var l,o,i;return t.id===(null===(l=e.ph)||void 0===l?void 0:null===(o=l.phFocus)||void 0===o?void 0:null===(i=o.focusModel)||void 0===i?void 0:i.id)}),c=null===(n=e.ph)||void 0===n?void 0:null===(s=n.phData)||void 0===s?void 0:null===(a=s.metis)||void 0===a?void 0:null===(r=a.metamodels)||void 0===r?void 0:r.find(e=>e.id===(null==d?void 0:d.metamodelRef));eS(c,c.name,"MM")}let{buttonLabel:k,className:O}=e,[M,D]=(0,s.useState)(!1),E=()=>D(!M),x=(0,o.jsx)("button",{className:"btn-primary mr-2 mb-3 w-100 ","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Click here to download the Project (all models and metamodels) to file (in Downloads folder)",onClick:b,children:"Save Project (all) to File"}),R=(0,o.jsx)("button",{className:"btn-primary text-white-50 btn-sm mr-2 w-100 ","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Click here to download current model to file (in Downloads folder)",onClick:j,children:"Save Current Model to File"}),N=(0,o.jsx)("button",{className:"btn-primary text-white-50 btn-sm mr-2 w-100 ","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Click here to download current modelview to file (in Downloads folder)",onClick:w,children:"Save Current Modelview to File"}),A=(0,o.jsx)("button",{className:"btn-primary btn-sm mr-2 w-100 ","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Click here to download the current Metamodel to file (in Downloads folder) The current Metamoel is the Metamodel of the current Model.",onClick:T,children:"Save Current Metamodel to File"});return p&&console.log("172",k),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{color:"link",onClick:E,className:"jsx-6345ac565d94d45f btn-context btn-primary float-right mr-2 mb-0 pr-2",children:k}),(0,o.jsxs)(z.Z,{isOpen:M,toggle:E,className:O,children:[(0,o.jsx)(W.Z,{toggle:()=>{E(),g()},children:"Export/Import: "}),(0,o.jsxs)(X.Z,{className:"pt-0",children:["Current Source: ",(0,o.jsxs)("strong",{className:"jsx-6345ac565d94d45f",children:[" ",e.ph.phSource]}),(0,o.jsxs)("div",{className:"jsx-6345ac565d94d45f source bg-light p-2 ",children:[" Models: ",(0,o.jsxs)("strong",{className:"jsx-6345ac565d94d45f",children:[" ",f]})]}),(0,o.jsxs)("div",{className:"jsx-6345ac565d94d45f source bg-light p-2 ",children:[" Metamodels: ",(0,o.jsxs)("strong",{className:"jsx-6345ac565d94d45f",children:[" ",y]})]}),(0,o.jsxs)("div",{className:"jsx-6345ac565d94d45f source bg-light p-2 ",children:[(0,o.jsx)("hr",{style:{borderTop:"1px solid #8c8b8",backgroundColor:"#9cf",padding:"2px",margin:"1px",marginBottom:"1px"},className:"jsx-6345ac565d94d45f"}),(0,o.jsxs)("div",{className:"jsx-6345ac565d94d45f loadsave px-2 pb-1 mb-0",children:[(0,o.jsxs)("div",{className:"jsx-6345ac565d94d45f loadsave--modelToFile select mb-1 p-2 border border-dark",children:[(0,o.jsx)("h5",{className:"jsx-6345ac565d94d45f",children:"Model"}),(0,o.jsxs)("div",{className:"jsx-6345ac565d94d45f selectbox mb-2 border",children:[(0,o.jsx)("h6",{className:"jsx-6345ac565d94d45f",children:"Import from file (will overwrite current) "}),(0,o.jsx)("input",{type:"file",accept:".json",onChange:t=>eI(e.ph,h,t),className:"jsx-6345ac565d94d45f select-input w-100"})]}),(0,o.jsxs)("div",{className:"jsx-6345ac565d94d45f selectbox mb-2 border",children:[(0,o.jsx)("h6",{className:"jsx-6345ac565d94d45f",children:"Export to file "}),x,R,N]})]}),(0,o.jsxs)("div",{className:"jsx-6345ac565d94d45f loadsave--metamodelToFile select mb-1 p-2 border border-dark",children:[(0,o.jsx)("h5",{className:"jsx-6345ac565d94d45f",children:"Metamodel "}),(0,o.jsxs)("div",{className:"jsx-6345ac565d94d45f selectbox mb-2 border",children:[(0,o.jsx)("h6",{className:"jsx-6345ac565d94d45f",children:"Import from file (will overwrite current)"}),(0,o.jsx)("input",{type:"file",accept:".json",onChange:t=>e_(e.ph,h,t),className:"jsx-6345ac565d94d45f select-input"})]}),(0,o.jsxs)("div",{className:"jsx-6345ac565d94d45f selectbox mb-2 border",children:[(0,o.jsx)("h6",{className:"jsx-6345ac565d94d45f",children:"Export to file "}),A]})]})]})]})]}),(0,o.jsx)(Y.Z,{children:(0,o.jsx)(H.Z,{className:"modal--footer m-0 py-1 px-2",color:"primary","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Click here when done!",onClick:()=>{E(),g()},children:"Done"})})]}),(0,o.jsx)(n(),{id:"6345ac565d94d45f",children:".list-obj.jsx-6345ac565d94d45f{min-width:90px}.modal.jsx-6345ac565d94d45f{z-index:1;margin-top:8%}.modal.right.jsx-6345ac565d94d45f .modal-dialog.jsx-6345ac565d94d45f{position:fixed;margin:150px auto 200px auto;width:380px;height:80%;color:black;-webkit-transform:translate3d(0%,0,0);-ms-transform:translate3d(0%,0,0);-o-transform:translate3d(0%,0,0);-moz-transform:translate3d(0%,0,0);transform:translate3d(0%,0,0)}.modal.right.jsx-6345ac565d94d45f .modal-content.jsx-6345ac565d94d45f{height:100%;overflow-y:auto}.modal.right.jsx-6345ac565d94d45f .modal-body.jsx-6345ac565d94d45f{padding:15px 15px 80px;color:#444}.modal.right.fade.jsx-6345ac565d94d45f .modal-dialog.jsx-6345ac565d94d45f{right:320px;-webkit-transition:opacity.3s linear,left.3s ease-out;-moz-transition:opacity.3s linear,left.3s ease-out;-o-transition:opacity.3s linear,left.3s ease-out;transition:opacity.3s linear,left.3s ease-out}.modal.fade.in.jsx-6345ac565d94d45f{opacity:1}.modal.right.fade.show.jsx-6345ac565d94d45f .modal-dialog.jsx-6345ac565d94d45f{right:0;-webkit-transform:translate(0,0);-moz-transform:translate(0,0);-ms-transform:translate(0,0);-o-transform:translate(0,0);transform:translate(0,0)}.modal-content.jsx-6345ac565d94d45f{-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;border:none}.modal-header.jsx-6345ac565d94d45f{border-bottom-color:#eee;background-color:#fafafa}.modal-body.jsx-6345ac565d94d45f{}.modal-backdrop.jsx-6345ac565d94d45f .fade.jsx-6345ac565d94d45f .in.jsx-6345ac565d94d45f{}.modal-background.jsx-6345ac565d94d45f{display:none}.btn-context.jsx-6345ac565d94d45f{font-weight:bold}}\n            "})]})};var eB=eK;let eU=e=>{let{label:t,value:l,onChange:i,placeholder:n}=e,[a,r]=(0,s.useState)(l),[d,c]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=setTimeout(()=>{c(a)},1e3);return()=>clearTimeout(e)},[a]),(0,s.useEffect)(()=>{i(d)},[d]),(0,o.jsxs)("div",{children:[(0,o.jsxs)("span",{className:"w-25 float-left bg-light py-1",children:[" ",t," "]}),(0,o.jsx)("input",{className:"w-75",value:a,onChange:e=>r(e.target.value),placeholder:n})]})};var eJ=eU;let ez=e=>{let{label:t,value:l,onChange:i,options:n}=e;return(0,o.jsxs)("div",{children:[t,(0,o.jsx)("select",{value:l,onChange:e=>i(e.target.value),children:n.map(e=>(0,o.jsx)("option",{value:e.value,children:e.label},e.value))})]})};var eH=ez,eW=l(8384);let eX=!1,eY=e=>{let t=(0,a.I0)(),[l,i]=(0,s.useState)(!0);e.phFocus;let n=e.phData;e.phUser;let r=e.phSource,[d,c]=(0,s.useState)("http://github.com/"),[p,h]=(0,s.useState)("Kavca"),[u,m]=(0,s.useState)("kavca-akm-models"),[g,f]=(0,s.useState)("models"),[y,v]=(0,s.useState)("main"),[b,w]=(0,s.useState)([]),[j,T]=(0,s.useState)({}),[k,O]=(0,s.useState)([]),[M,D]=(0,s.useState)([]),[E,x]=(0,s.useState)(!1),[R,N]=(0,s.useState)(!1),[A,S]=(0,s.useState)(!1),{buttonLabel:C,className:P}=e,I=()=>S(!A);function _(){i(!l)}let L={phData:e.ph.phData,phFocus:e.ph.phFocus,phUser:e.ph.phUser,phSource:""===r&&n.metis.name||r,lastUpdate:new Date().toISOString()};(0,s.useEffect)(()=>{c("https://github.com/".concat(p,"/").concat(u,"/tree/main/").concat(g))},[]);let V=e=>{(null==e?void 0:e.length)>0&&(eX&&console.log("50 onUsernameChange",e),h(e),c("http://github.com/".concat(e,"/").concat(u)),eX&&console.log("55 onUsernameChange",p))},F=e=>{e?m(e):m("")},G=e=>{(null==e?void 0:e.length)<2?f(""):f(e)},K=e=>{eX&&console.log("71 onModelChange",e);let t="".concat(p,"/").concat(u),o="".concat(e);U(t,o),eX&&console.log("52",t,o);let n=()=>{i(!l)};setTimeout(n,3e3)},B=async(e,t)=>{if((null==p?void 0:p.length)>0){var l;x(!0),eX&&console.log("76 loadRepos",e,t,j);let o=await (0,eW.q9)(e,t),i=await (null===(l=o.data.items)||void 0===l?void 0:l.filter(t=>t.name===e));x(!1),eX&&console.log("118 res.data.items: ",await o.data.items,b),w(await i),eX&&console.log("122",p,t,e,o.data.items,b)}},U=async(l,o)=>{x(!0);let i="".concat(l);console.log("126 searchtexttmp",l,u,g,i,o,o);let n=i.replace(/\/\//g,"/");eX&&console.log("128 ",n,g,o,y,"file");let s=await (0,eW.au)(n,g,o,y,"file"),a=await s.data.sha;eX&&console.log("131 res",s,s.data,a);let r=s.data;eX&&console.log("138 ",n,s);let d={...r,phData:{...r.phData,organisation:l.split("/")[0],repository:l.split("/")[1],path:g}};if(eX&&console.log("142 ",r,d),T(d),x(!1),eX&&console.log("90 onModelChange",d,e),d){if(o.includes("_MM.json")){var c,p,h,m,f;let v=d,b=null===(c=e.ph.phData)||void 0===c?void 0:null===(p=c.metis)||void 0===p?void 0:null===(h=p.metamodels)||void 0===h?void 0:h.findIndex(e=>e.id===(null==v?void 0:v.id)),w=null===(m=e.ph.phData)||void 0===m?void 0:null===(f=m.metis)||void 0===f?void 0:f.metamodels.length;b<0&&(b=w);let j={phData:{...e.ph.phData,metis:{...e.ph.phData.metis,metamodels:[...e.ph.phData.metis.metamodels.slice(0,b),v,...e.ph.phData.metis.metamodels.slice(b+1,e.ph.phData.metis.metamodels.length)],models:e.ph.phData.metis.models}}};eX&&console.log("166 ",j),j.phData&&t({type:"LOAD_TOSTORE_PHDATA",data:j.phData})}else{let k={phData:d.phData,phFocus:d.phFocus,phUser:d.phUser,phSource:"GitHub: ".concat(u,"/").concat(g,"/").concat(o)};eX&&console.log("154",k),k.phData&&t({type:"LOAD_TOSTORE_PHDATA",data:k.phData}),k.phFocus&&t({type:"LOAD_TOSTORE_PHFOCUS",data:k.phFocus}),k.phUser&&t({type:"LOAD_TOSTORE_PHUSER",data:k.phUser}),k.phSource&&t({type:"LOAD_TOSTORE_PHSOURCE",data:k.phSource})}}},J=async(e,t)=>{var o,n;x(!0);let s=""!==t?"repos/".concat(e,"/").concat(u,"/contents/").concat(t):"repos/".concat(e,"/").concat(u,"/contents");eX&&console.log("131  u",e,"r",u,"p",t,"repos",s);let a=await (0,eW.U_)(s,t);eX&&console.log("133 ",await a.data),x(!1);let r=await (null===(o=a.data)||void 0===o?void 0:o.filter(e=>"dir"===e.type&&"img"!==e.name&&"imgdocs"!==e.name&&".github"!==e.name&&".gitignore"!==e.name)),d=await (null===(n=a.data)||void 0===n?void 0:n.filter(e=>e.name.endsWith(".json")));eX&&console.log("136 ",d),O(d),D(r),c("https://github.com/".concat(e,"/").concat(u,"/tree/").concat(y,"/").concat(t)),i(!l)};(0,s.useEffect)(()=>{(null==p?void 0:p.length)>0&&B(u,g)},[A]),(0,s.useEffect)(()=>{O([]),D([]),c("https://github.com/".concat(p,"/").concat(u,"/tree/").concat(y,"/").concat(g))},[p,u,g]),(0,s.useEffect)(()=>{eX&&console.log("170 useEffect 3",j);let e=()=>{i(!l)};setTimeout(e,3e3)},[j]);let Y=null==k?void 0:k.map(e=>({value:e.name,label:e.name})),Z=k.length>0?" Select Model - - - ":' - - - Click on "LIST MODELS" above! - - - ',$=[{value:"",label:Z},...Y];function q(){let t=e.ph.phData.metis.name;eC(L,t,"Project")}return eX&&console.log("163 modeloptions",k,$,null==$?void 0:$.length),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:(0,o.jsx)("button",{className:"btn-context btn-outline-primary font-weight-bold text-primary ml-1",onClick:I,children:C})}),(0,o.jsxs)(z.Z,{isOpen:A,toggle:I,className:P,children:[(0,o.jsx)(W.Z,{toggle:()=>{I()},children:"GitHub Model Repository"}),(0,o.jsx)(X.Z,{className:"pl-1 pt-1 ",children:(0,o.jsxs)("div",{className:"bg-light",children:[(0,o.jsxs)("div",{className:"bg-secondary square border border-2 border-success p-1",children:[(0,o.jsx)("strong",{children:"Download from a list of Models:"}),(0,o.jsx)(eJ,{label:"RepoOwner:",value:p,onChange:e=>V(e),placeholder:"Repos UserName:"}),(0,o.jsx)("hr",{className:"bg-primary my-1 mx-4"}),E?"Loading...":(0,o.jsxs)("div",{className:"text-success m-1",children:[" ",b.map(e=>(0,o.jsxs)("span",{className:"px-1",children:[" ",e.full_name,", "]},e.id)),"  "]}),(0,o.jsxs)("span",{className:"",children:[(0,o.jsx)(eJ,{label:"Repository:",value:u,onChange:e=>F(e),placeholder:"Repo name:"})," "]}),(0,o.jsx)("hr",{className:"bg-primary my-2 mx-4"}),(null==M?void 0:M.length)>0?(0,o.jsxs)("div",{children:["Model paths (folders) found: ",(0,o.jsxs)("span",{className:"text-success m-1",children:[" ",null==M?void 0:M.map(e=>(0,o.jsxs)("span",{className:"px-1",children:[e.name,", "]},e.name))]})," "]}):!g&&(0,o.jsx)("div",{className:"text-warning",children:" 'No model paths (folders) found!'"}),(0,o.jsxs)("span",{className:"",children:[" ",(0,o.jsx)(eJ,{label:"Path:",value:g,onChange:e=>G(e),placeholder:"Path to models"})," "]}),(0,o.jsx)("hr",{className:"bg-light my-1 mx-4"}),(0,o.jsx)(H.Z,{className:"btn-primary text-black border-success w-100 float-right mt-2 mb-2 pb-0",onClick:()=>J(p,g),children:"List Models"}),(null==k?void 0:k.length)>0?(0,o.jsxs)("div",{children:["Models found: ",(0,o.jsxs)("span",{className:"text-success m-1",children:[null==k?void 0:k.map(e=>(0,o.jsxs)("span",{className:"px-1",children:[e.name,", "]},e.name))," "]})]}):(0,o.jsx)("div",{className:"text-warning",children:" 'No models found!'"}),(0,o.jsx)("hr",{className:"bg-primary px-10 my-1 mx-4"}),(0,o.jsx)(H.Z,{className:"btn-primary modal--footer mr-4 py-0 px-1 float-right",color:"primary","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Click here when done!",onClick:()=>{I(),_()},children:"Done"}),(0,o.jsx)("label",{className:"w-70 d-inline-flex justify-content-left",children:(0,o.jsx)(eH,{label:" Select model : ",value:$?$[0]:"no models",options:$||[],onChange:e=>K(e)})})]}),(0,o.jsx)("hr",{className:"bg-secondary py-1 my-1 mx-4"}),(0,o.jsxs)("div",{className:"bg-secondary square border border-2 border-primary p-2",children:[(0,o.jsx)("strong",{children:"Upload model files:"})," ",(0,o.jsx)("br",{}),(0,o.jsxs)("div",{className:"bg-secondary square border border-2 border-primary p-2",children:[(0,o.jsx)("strong",{children:"First save the project.json file:"})," (It will be saved to Download folder)",(0,o.jsx)("button",{className:"btn-primary modal--footer mr-2 py-0 px-1 float-right","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Click here to Save the Project (all models and metamodels) to file (in Downloads folder)",onClick:q,children:"Save"}),(0,o.jsx)("br",{})," NB! The file must have the same name as on GitHub.",(0,o.jsx)("br",{})," Rename the file before uploading if necessary."]}),(0,o.jsx)("a",{href:d,target:"_blank",rel:"noopener noreferrer",children:(0,o.jsx)("strong",{children:" Click here to open GitHub "})})," (RepoOwner, Repository and Path must be filled in)",(0,o.jsx)("br",{}),"(On GitHub: Check the README file for Guidance)",(0,o.jsxs)("div",{className:" text-secondary",children:[d," "]})]}),(0,o.jsx)("hr",{className:"bg-primary my-1 mx-0"})]})})]})]})};var eZ=eY,e$=l(3204),eq=l.n(e$);let eQ=!1,e0=async(e,t,l,o,i)=>{let n;let s=l.phData.metis.models.find(e=>e.id===l.phFocus.focusModel.id);s.objects,eQ&&console.log("14 ",l.phFocus.focusModel,s,l.phData.metis.models);let a=l.phData.metis.metamodels.find(e=>e.id===s.metamodelRef),r=a.objecttypes,d=a.relshiptypes,c=r.find(e=>"JsonObject"===e.name&&e);r.find(e=>"EntityType"===e.name&&e);let p=d.find(e=>"hasPart"===e.name&&e),h=d.find(e=>"contains"===e.name&&e),u=d.find(e=>"has"===e.name&&e),m=null==c?void 0:c.id,g=null==p?void 0:p.id,f=null==p?void 0:p.name;d.find(e=>"Is"===e.name&&e);let y="Association",v="",b=function(t,l,i,n,s){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"object",r=arguments.length>6?arguments[6]:void 0;eQ&&console.log("51 createObject",l,r);let d="AKM"===e?{id:t,name:l,typeRef:i,abstract:!1,markedAsDeleted:!1,modified:!0,externalID:n,osduId:n,osduType:s,...r}:{id:t,name:l,typeRef:i,abstract:!1,markedAsDeleted:!1,modified:!0,externalID:n,osduId:n,jsonType:a,jsonKey:l,...r};return eQ&&console.log("68 Create object: ",d.name,d),o({type:"UPDATE_OBJECT_PROPERTIES",data:d}),d},w=(e,t,l,i,n,s,a,r,d,c)=>{let p=a?{id:e,name:t,title:i.replace(/\s+/g,""),cardinality:"",cardinalityFrom:void 0,cardinalityTo:void 0,description:l,fromobjectRef:a,nameFrom:r,generatedTypeId:"",markedAsDeleted:!1,modified:!0,relshipkind:s,relshipviews:void 0,toobjectRef:d,nameTo:c,typeRef:n}:{};eQ&&console.log("100 Create relship",a,r,p.name,d,c),a&&d&&o({type:"UPDATE_RELSHIP_PROPERTIES",data:p})},j=JSON.parse(i.toString());eQ&&console.log("121 osduMod",j);let T=[];if(console.log("142 osduMod",j.data),console.log("140 osduMod",j,j.hasOwnProperty("data")),void 0!==j.properties.data){j.hasOwnProperty("properties")&&(delete j.properties.id,delete j.properties.kind,delete j.properties.version,delete j.properties.acl,delete j.properties.legal,delete j.properties.tags,delete j.properties.createTime,delete j.properties.createUser,delete j.properties.modifyTime,delete j.properties.modifyUser,delete j.properties.ancestry,delete j.properties.meta,console.log("155",j));let k=j.properties.data.allOf;delete j.properties,console.log("142 allOf",k);let O=JSON.parse('{ "$ref": "../abstract/AbstractSystemProperties.1.0.0.json" }');j.allOf=[...k,O],eQ&&console.log("150 ",j,O)}console.log("155 osduMod",j);let M=j,D=M.id||M.$id;M.externalID=D,M.name=M.id?M.id.split(":").slice(-1)[0]:M.title,eQ&&console.log("165",M,M.$id,M["x-osdu-schema-source"]);let E=M.$id?M.$id.split("/").slice(-1)[0]:M.id?M.id.split(":").slice(-1)[0]:null;eQ&&console.log("170",E,M);let x={[E]:M};function R(e){var t,l,o="",i=0,n=-1;function a(e){for(l=e.length,i+=e.length;l--;)e[l][0]=o+JSON.stringify(e[l][0])+"|";return e}for(eQ&&console.log("175 deepEntries",e),t=a(Object.entries(e||{})),eQ&&console.log("193 allkeys : ",t),t=t.sort((e,t)=>e.key<t.key),eQ&&console.log("196 allkeys sorted: ",t);++n!==i;)if("object"==typeof t[n][1]&&null!==t[n][1]){let r;console.log("-----------------------------------------------------------------------"),o=t[n][0]+"",Array.isArray(t[n][1]),Array.prototype.push.apply(t,a(Object.entries(t[n][1]))),eQ&&console.log("210 :",n,l,i,o.slice(0,-1),t[n][1]);let d=o.slice(0,-1).replace(/"/g,""),c=d,p=c.split("|");if(c.includes("|definitions")){let[,...h]=p;r=h.join("|")}else r=c;let u=r,m=t[n][1];eQ&&console.log("241 : ",u,s.objects.find(e=>{var t;return e.name===(null===(t=null==u?void 0:u.split("|"))||void 0===t?void 0:t.slice(-1)[0].split(".")[0])&&e}));let g=s.objects.find(e=>e.osduId===u&&e),f=g?g.id:ef.createGuid();eQ&&console.log("244 : ",g,null==g?void 0:g.id,f,u,m),T=[...T,[f,u,m]],eQ&&console.log("249 ",T)}return T}eQ&&console.log("173",x);let N=R(x);function A(e){var t,l,o,i,n,s,a,r;eQ&&console.log("432 ",e);let d=T[0],c=d[0],p=d[1],h=d[1].split(".").slice(-1)[0];eQ&&console.log("topObjName",h,p,d);let[m,v,b]=e,j=null===(t=null==v?void 0:v.split("|"))||void 0===t?void 0:t.slice(-1)[0],k=null===(l=null==v?void 0:v.split("|"))||void 0===l?void 0:l.slice(-2,-1)[0],O=null===(o=null==v?void 0:v.split("|"))||void 0===o?void 0:o.slice(-3,-2)[0],M=null===(i=null==v?void 0:v.split("|"))||void 0===i?void 0:i.slice(-4,-3)[0],D=null===(n=null==v?void 0:v.split("|"))||void 0===n?void 0:n.slice(-5,-4)[0];null===(s=null==v?void 0:v.split("|"))||void 0===s||s.slice(-6,-5)[0],null===(a=null==v?void 0:v.split("|"))||void 0===a||a.slice(-7,-6)[0];let E=v.split("|").slice(0,-1).join("|"),x=v.split("|").slice(0,-2).join("|"),R=v.split("|").slice(0,-3).join("|"),A=v.split("|").slice(0,-4).join("|"),S=v.split("|").slice(0,-5).join("|");v.split("|").slice(0,-6).join("|");let C=ef.createGuid(),P="",I="";if(g=u.id,f=u.name,y="Association",eQ&&console.log("390 parentName",D,M,O,k),"properties"===k){if(eQ&&console.log("473 ",j,k,O,M,v),x===p){let _=c,L=h,V=m,F=j;eQ&&console.log("472 ---------",L,f,F,_,V,b),_&&V&&w(C,f,P,I,g,y,_,L,V,F)}else if(A===p){let G=c,K=h,B=m,U=j;eQ&&console.log("482 ---------",K,f,U,G,B),G&&B&&w(C,f,P,I,g,y,G,K,B,U)}else if("items"===O){let J=N.find(e=>e[1]===x),z=J[0],H=J[1].split("|").slice(-1)[0],W=m,X=j;eQ&&console.log("587 ---------",H,f,X,z,W),z&&W&&w(C,f,P,I,g,y,z,H,W,X)}else if("items"===O||"properties"===M){let Y,Z,$;"properties"===M?(Z=(Y=N.find(e=>e[1]===E))[0],$=Y[1].split("|").slice(-1)[0]):"Markers"===M?(Z=(Y=N.find(e=>e[1]===E))[0],$=Y[1].substring(0,Y[1].length-1)):(Z=(Y=N.find(e=>e[1]===R))[0],$=Y[1].split("|").slice(-1)[0]),eQ&&console.log("493",x,k,p);let q=m,Q=j;eQ&&console.log("498 ---------",$,f,Q,Z,q),Z&&q&&w(C,f,P,I,g,y,Z,$,q,Q)}else if("items"===D){let ee=N.find(e=>e[1]===S),et=ee[0],el=ee[1].split("|").slice(-1)[0],eo=m,ei=j;eQ&&console.log("587 ---------",el,f,ei,et,eo),et&&eo&&w(C,f,P,I,g,y,et,el,eo,ei)}else{let en=N.find(e=>e[1]===x),es=en[0],ea=en[1].split("|").slice(-1)[0],er=m,ed=j;eQ&&console.log("515 ---------",ea,f,ed,es,er),es&&er&&w(C,f,P,I,g,y,es,ea,er,ed)}}else if(b.$ref){let ec=null===(r=N.find(e=>e[1]===v)[2])||void 0===r?void 0:r.type;if(eQ&&console.log("470 ",ec,k,x,p,v),"data"===k){let ep=N.find(e=>e[1]===E),eh=ep[0],eu=ep[1].split("|").slice(-1)[0],em=m,eg=j;eQ&&console.log("476 ---------",eu,f,eg,eh,em),eh&&em&&w(C,f,P,I,g,y,eh,eu,em,eg)}else if(x===p){let ey=N.find(e=>e[1]===x),ev=ey[0],eb=ey[1].split("|").slice(-1)[0],ew=m,ej=j;eQ&&console.log("476 ---------",eb,f,ej,ev,ew),ev&&ew&&w(C,f,P,I,g,y,ev,eb,ew,ej)}else if(ec){let eT=N.find(e=>e[1]===x),ek=eT[0],eO=eT[1].split("|").slice(-1)[0],eM=m,eD=j;eQ&&console.log("496 ---------",eO,f,eD,ek,eM),ek&&eM&&w(C,f,P,I,g,y,ek,eO,eM,eD)}else{let eE=N.find(e=>e[1]===E),ex=eE[0],eR=eE[1].split("|").slice(-1)[0],eN=m,eA=j;eQ&&console.log("488 ---------",eR,f,eA,ex,eN),ex&&eN&&w(C,f,P,I,g,y,ex,eR,eN,eA)}}else if("items"===j){let eS=N.find(e=>e[1]===E),eC=eS[0],eP=eS[1].split("|").slice(-1)[0],eI=m,e_=j;eQ&&console.log("464 ---------",eP,f,e_,eC,eI),eC&&eI&&w(C,f,P,I,g,y,eC,eP,eI,e_)}}function S(e){let t={};for(var l in e){if(!e.hasOwnProperty(l)||"object"==typeof e[l])continue;let o=l;t={...t,[o]:e[l]},eQ&&console.log("130",l,e[l],t)}return eQ&&console.log("513 :",e,t),t}eQ&&console.log("255 deepEntries",N),null==N||N.map((e,t)=>{var l,o,i,s,a,d,c,p,u,w,j,T,k,O,M,D;let[E,x,R]=e,N=null===(l=null==x?void 0:x.split("|"))||void 0===l?void 0:l.slice(-1)[0];eQ&&console.log("261 :",N,x,R);let C=S(R),P=null===(o=null==x?void 0:x.split("|"))||void 0===o?void 0:o.slice(-2,-1)[0],I=Array.isArray(R)?"isArray":"isObject";if(0===t){let _=N.split(".")[0],L=R.$id?R.$id.split("/").slice(-2)[0]:"";"Abstract"===(v=eq()(L,{pascalCase:!0}))&&(C.abstract=!0),m=null===(i=r.find(e=>"EntityType"===e.name))||void 0===i?void 0:i.id,_.includes("Abstract")&&("AbstractWorkProductComponent"==_||(_=_.replace("Abstract",""),C.abstract=!0)),b(E,_,m,x,v,I,C),console.log("337 topObject",E,N,m,x,v,I,C)}else if("properties"===P){if(eQ&&console.log("340 ",N,R),R["x-osdu-relationship"])R["x-osdu-relationship"].map(t=>{var l;m=null===(l=r.find(e=>"PropLink"===e.name))||void 0===l?void 0:l.id,eQ&&console.log("324  relationship",t,m),N.includes("IDs")||N.includes("ID")?(C.linkID=N.replace("IDs",""),C.linkID=N.replace("ID","")):C.linkID=N,eQ&&console.log("324 relationship",E,N,m,x,t.type,I,C);let o="has"+N;"Company"===C.linkID&&(C.linkID="Organisation"),"Owner"===C.linkID&&(C.linkID="Organisation"),"ServiceCompany"===C.linkID&&(C.linkID="Organisation"),"ParentProject"===C.linkID&&(C.linkID="Project"),"StationPropertyUnit"===C.linkID&&(C.linkID="UnitOfMeasure"),"TrajectoryStationPropertyType"===C.linkID&&(C.linkID="TrajectoryStationPropertyType"),"SurveyToolType"===C.linkID&&(C.linkID="SurveyToolType"),"Target"===C.linkID&&(C.linkID="GeometricTargetSet"),"GeographicCRS"===C.linkID&&(C.linkID="CoordinateReferenceSystem"),"ProjectedCRS"===C.linkID&&(C.linkID="CoordinateReferenceSystem"),"Feature"===C.linkID&&(C.linkID="LocalRockVolumeFeature"),"ColumnStratigraphicHorizonTop"===C.linkID&&(C.linkID="HorizonInterpretation"),"ColumnStratigraphicHorizonBase"===C.linkID&&(C.linkID="HorizonInterpretation"),"Interpretation"===C.linkID&&(C.linkID="HorizonInterpretation"),"RockVolumeFeature"===C.linkID&&(C.linkID="RockVolumeFeature"),"MarkerPropertyUnit"===C.linkID&&(C.linkID="UnitOfMeasure"),"WellLogType"===C.linkID&&(C.linkID="LogType"),"SamplingDomainType"===C.linkID&&(C.linkID="WellLogSamplingDomainType"),"StartMarkerSet"===C.linkID&&(C.linkID="WellboreMarkerSet"),"StopMarkerSet"===C.linkID&&(C.linkID="WellboreMarkerSet"),"StartMarker"===C.linkID&&(C.linkID="Marker"),"StopMarker"===C.linkID&&(C.linkID="Marker"),"StartBoundaryInterpretation"===C.linkID&&(C.linkID="HorizonInterpretation"),"StopBoundaryInterpretation"===C.linkID&&(C.linkID="HorizonInterpretation"),b(E,o,m,x,v,I,C),eQ&&console.log("383 not ID ",E,o,m,x,I,C),A(e)});else if("array"===R.type){if(eQ&&console.log("293  array Set: ",E,N,m,x,I,C,R),eQ&&console.log("294 :",P.substring(P.length-3)),"Set"===N.substring(N.length-3)||"Markers"===N)m=null===(s=r.find(e=>"Collection"===e.name))||void 0===s?void 0:s.id,C.viewkind="container",b(E,N,m,x,v,I,C),eQ&&console.log("299  array Set",E,N,m,x,I,C),A(e);else if(N.includes("ID")||N.includes("IDs")){if("MarkerID"===N||"IntervalID"===N);else{eQ&&console.log("275  array",E,N,x,I,C),m=null===(a=r.find(e=>"PropLink"===e.name))||void 0===a?void 0:a.id;let V=N.replace("ID",""),F="has"+N;C.linkID=N,eQ&&console.log("277  array",N,V,C),b(E,F,m,x,v,I,C),eQ&&console.log("309  array ID",E,F,m,x,I,C),A(e)}}else C.$ref?(b(E,N,m=null===(d=r.find(e=>"PropCollection"===e.name))||void 0===d?void 0:d.id,x,I,C),eQ&&console.log("319  array $ref",E,N,m,x,I,C),A(e)):(eQ&&console.log("389  array",E,N,x,I),m=null===(c=r.find(e=>"PropCollection"===e.name))||void 0===c?void 0:c.id,"Markers"===N&&(N=N.substring(0,N.length-1)),b(E,N,m,x,v,I,C),eQ&&console.log("320  array else",E,N,m,x,I,C),A(e))}else if("string"===R.type||"nunber"===R.type||"integer"===R){if(eQ&&console.log("321  primitive",E,N,x,I,C),N.includes("IDs")||N.includes("ID")){let G="has"+N;m=null===(p=r.find(e=>"PropLink"===e.name))||void 0===p?void 0:p.id,C.linkID=N.replace("IDs",""),C.linkID=N.replace("ID",""),eQ&&console.log("322 ",N,C),"Company"===C.linkID&&(C.linkID="Organisation"),"ServiceCompany"===C.linkID&&(C.linkID="Organisation"),"ParentProject"===C.linkID&&(C.linkID="Project"),"StationPropertyUnit"===C.linkID&&(C.linkID="UnitOfMeasure"),"TrajectoryStationPropertyType"===C.linkID&&(C.linkID="TrajectoryStationPropertyType"),"SurveyToolType"===C.linkID&&(C.linkID="SurveyToolType"),"GeographicCRS"===C.linkID&&(C.linkID="CoordinateReferenceSystem"),"ProjectedCRS"===C.linkID&&(C.linkID="CoordinateReferenceSystem"),"Feature"===C.linkID&&(C.linkID="LocalRockVolumeFeature"),"ColumnStratigraphicHorizonTop"===C.linkID&&(C.linkID="HorizonInterpretation"),"ColumnStratigraphicHorizonBase"===C.linkID&&(C.linkID="HorizonInterpretation"),"Interpretation"===C.linkID&&(C.linkID="HorizonInterpretation"),"RockVolumeFeature"===C.linkID&&(C.linkID="RockVolumeFeature"),"MarkerPropertyUnit"===C.linkID&&(C.linkID="UnitOfMeasure"),"WellLogType"===C.linkID&&(C.linkID="LogType"),"SamplingDomainType"===C.linkID&&(C.linkID="WellLogSamplingDomainType"),"StartMarkerSet"===C.linkID&&(C.linkID="WellboreMarkerSet"),"StopMarkerSet"===C.linkID&&(C.linkID="WellboreMarkerSet"),"StartMarker"===C.linkID&&(C.linkID="Marker"),"StopMarker"===C.linkID&&(C.linkID="Marker"),"StartBoundaryInterpretation"===C.linkID&&(C.linkID="HorizonInterpretation"),"StopBoundaryInterpretation"===C.linkID&&(C.linkID="HorizonInterpretation"),eQ&&console.log("346  ",C),b(E,G,m,x,v,I,C),eQ&&console.log("352 ID",E,G,m,x,I,C),A(e)}else if("Type"===N.substring(N.length-4)){C.linkID=N;let K="has"+N;b(E,K,m=null===(u=r.find(e=>"PropLink"===e.name))||void 0===u?void 0:u.id,x,v,I,C),eQ&&console.log("359 TYPE",E,K,m,x,I,C),A(e)}else b(E,N,m=null===(w=r.find(e=>"Property"===e.name))||void 0===w?void 0:w.id,x,v,I,C),eQ&&console.log("464 not ID ",E,N,m,x,I,C),A(e)}else b(E,N,m=null===(j=r.find(e=>"Property"===e.name))||void 0===j?void 0:j.id,x,I,C),eQ&&console.log("315  array",E,N,m,x,I,C),A(e)}else if(R.$ref){let B=null===(T=r.find(e=>"PropLink"===e.name))||void 0===T?void 0:T.id,U=R.$ref.split("/").slice(-1)[0];C.title=U&&U.split(".")[0];let J=U&&U.split(".")[0];C.linkID=J&&"AbstractWorkProductComponent"===J?J:J.replace("Abstract","");let z="Is"+C.title;b(E,z,B,x,v,I,C),eQ&&console.log("330 $ref",E,z,B,x,I,C),A(e)}else if("items"===N){let H,W;if(eQ&&console.log("383  items",P.substring(N.length-3)),"Set"===P.substring(P.length-3)){let X=P.substring(0,P.length-3),Y="has"+X;m=null===(k=r.find(e=>"PropLink"===e.name))||void 0===k?void 0:k.id,C.linkID=X,b(E,Y,m,x,v,I,C),eQ&&console.log("349 Set",E,Y,m,x,I,C),A(e)}else if("Markers"===P||"Intervals"===P||(null==P?void 0:P.includes("IDs"))){let Z=P.substring(0,P.length-1);m=null===(O=r.find(e=>"PropCollection"===e.name))||void 0===O?void 0:O.id,g=null==h?void 0:h.id,f=null==h?void 0:h.name,y="Association",b(E,Z,m,x,v,I,C),eQ&&console.log("398 Markers",E,Z,m,x,I,C),A(e)}else R.allOf&&(W=Object.keys(null===(M=null==R?void 0:R.allOf[0])||void 0===M?void 0:M.properties).find(e=>e.includes("ID")),H=null==H?void 0:H.replace("ID",""),m=null===(D=r.find(e=>"PropLink"===e.name))||void 0===D?void 0:D.id,H&&(n="Is"+H,C.title=W,C.linkID=W,g=null==h?void 0:h.id,f=null==h?void 0:h.name,y="Association",b(E,n,m,x,I,C),A(e)))}else eQ&&console.log("376 no obj",E,N,m,x,I,C)})},e1=!1,e2=async(e,t,l,o,i)=>{i.preventDefault();let n=new FileReader,s=l.phData.metis.models.find(e=>e.id===l.phFocus.focusModel.id);e1&&console.log("23 ",l.phFocus.focusModel,s,l.phData.metis.models);let a=l.phData.metis.metamodels.find(e=>e.id===s.metamodelRef),r=a.objecttypes,d=a.relshiptypes,c=r.find(e=>"JsonObject"===e.name&&e),p=r.find(e=>"EntityType"===e.name&&e),h=d.find(e=>"hasPart"===e.name&&e),u=d.find(e=>"contains"===e.name&&e),m=d.find(e=>"has"===e.name&&e),g=null==c?void 0:c.id,f=null==h?void 0:h.id,y=null==h?void 0:h.name,v="Association";n.onload=async o=>{let i,n,a,d,c,T,k;let O=o.target.result,M=JSON.parse(O);e1&&console.log("32",M,M.$id,M["x-osdu-schema-source"]);let D=M.$id?M.$id.split("/").slice(-1)[0]:M["x-osdu-schema-source"],E={[D]:M},x=null,R=[],N=null,A=[];(function(o){var O,M,E,S,C,P,I,_,L,V,F,G,K,B,U,J,z,H="",W=0,X=-1;function Y(e){for(z=e.length,W+=e.length;z--;)e[z][0]=H+JSON.stringify(e[z][0])+"|";return e}for(e1&&console.log("75 deepEntries",o),J=(J=Y(Object.entries(o||{}))).sort((e,t)=>e.key<t.key),e1&&console.log("85 allkeys : ",J);++X!==W;)if("object"==typeof J[X][1]&&null!==J[X][1]){let Z,$,q,Q,ee,et;console.log("-----------------------------------------------------------------------"),H=J[X][0]+"";let el=Array.isArray(J[X][1])?"isArray":"isObject";Array.prototype.push.apply(J,Y(Object.entries(J[X][1]))),e1&&console.log("35 :",X,z,W,H.slice(0,-1),J[X][1]);let eo=H.slice(0,-1).replace(/"/g,""),ei=eo,en=ei.split("|");if(ei.includes("|definitions")){let[,...es]=en;Z=es.join("|")}else Z=ei;let ea=Z;ea.split("|").slice(0,-5).join("|"),ea.split("|").slice(0,-5).join("|"),ea.split("|").slice(-6)[0];let er=ea.split("|").slice(0,-4).join("|"),ed=ea.split("|").slice(-5)[0],ec=ea.split("|").slice(0,-3).join("|"),ep=ea.split("|").slice(-4)[0],eh=ea.split("|").slice(0,-2).join("|"),eu=ea.split("|").slice(-3)[0],em=ea.split("|").slice(0,-1).join("|"),eg=ea.split("|").slice(-2)[0],ey=ea.split("|").slice(-1)[0],ev=J[X][1];e1&&console.log("153 :","\n cleanPath: ",eo,"\n oKey: ",ea,"\n oName : ",ey,"\n oVal: ",ev,"\n parentKey: ",em,"\n parentId: ",x,"\n parentName: ",eg);let eb=j(ev);if("required"===ey){let ew=Object.assign(...Object.entries(o).map(e=>{let[t,l]=e;return!isNaN(t)!==t}));eb={...ew,propNames:Object.values(ev).toString()}}e1&&console.log("153 : oKey",ea,ey,"\n oVal : ",ev,"\n cNewVal : ",eb);let ej="properties"===eg?"Property":"allOf"===ey||"anyOf"===ey||"oneOf"===ey||"required"===ey?"JsonArray":"AKM"===e?0===X?"EntityType":"items"===ey?"EntityType":"properties"===ey?"Properties":"JsonObject":"properties"===ey?"Properties":"JsonObject";g=(null===(O=r.find(e=>e.name===ej))||void 0===O?void 0:O.id)||(null===(M=r.find(e=>"EntityType"===e.name))||void 0===M?void 0:M.id),e1&&console.log("170 : ",X,e,ey,ej," - ",g,ev.$ref),e1&&console.log("173 : props",l,"curModel ",s);let eT=s.objects.find(e=>e.osduId===ea);e1&&console.log("175 : ",s.objects,eT,ea,null==eT?void 0:eT.id);let ek=eT?eT.id:ef.createGuid();if(R=[...R,[ek,ea,ev]],e1&&console.log("186 ",ek,ea,ev),"AKM"===e){if(e1&&console.log("191 ",er,ec,eh,em,"oKey",ea,"oVal",ev),0===X){e1&&console.log("----- i = 0"),ee=null,et=null,N=ek,i=null==eb?void 0:null===(E=eb.title)||void 0===E?void 0:E.replace(/\s+/g,""),n=ev.$id?ev.$id.split("/").slice(-2)[0]:"EntityType";let eO=eq()(n,{pascalCase:!0});g=(null===(S=r.find(e=>e.name===eO))||void 0===S?void 0:S.id)||p.id,e1&&console.log("197 ",eO,g,eb),b(ek,i,g,ea,el,eb),k=ek}else if("properties"===eg&&t){if(e1&&console.log("----- parentName = properties"),e1&&console.log("227 ",ea,ev),"string"===ev.type||"number"===ev.type||"integer"===ev.type||"boolean"===ev.type)e1&&console.log("----- oval.type = string, number, integer, boolean"),ey.includes("ID")?(g=null===(C=r.find(e=>"PropLink"===e.name))||void 0===C?void 0:C.id,$="has"+ey.replace("ID",""),eb.linkID=ey,eb.title=ey):g=null===(P=r.find(e=>"Property"===e.name))||void 0===P?void 0:P.id;else if("array"===ev.type)e1&&console.log("----- oVal.type = array"),R.find(e=>e[1]===ea&&e[0]),g=null===(I=r.find(e=>"PropCollection"===e.name))||void 0===I?void 0:I.id;else if(!ev.type&&ev.$ref)e1&&console.log("----- oVal.type = $ref"),e1&&console.log("243 ",ev),g=null===(_=r.find(e=>"PropLink"===e.name))||void 0===_?void 0:_.id;else if(ev["x-osdu-indexing"]){e1&&console.log("----- oVal[x-osdu-indexing]");continue}else if("items"===eu||"items"===eg){e1&&console.log("----- gparentName = items or parentName = items");continue}else e1&&console.log("----- else"),g=null===(L=r.find(e=>"PropLink"===e.name))||void 0===L?void 0:L.id;b(ek,$||ey,g,ea,el,eb),e1&&console.log("239 ",R.find(e=>e[1]===ea&&e[0]),ea,ey,g,eb),f=m.id,y=m.name,v="Association",console.log("248 ",eg,eu,ep,ed,x),e1&&console.log("232 :  oVal, oId, oName, parentId, parentName \n",ev,ek,ey,x,eg),ee=er?R.find(e=>e[1]===er)[0]:k,et=er?R.find(e=>e[1]===er)[1]:D}else if(ev.$ref){e1&&console.log("----- oVal[$ref]"),N=ek;let eM=ev.$ref.split("/").slice(-1)[0];e1&&console.log("264 ",eM),eb.title=eM&&eM.split(".")[0],i="Is"+eb.title,e1&&console.log("270 i",X,ey,i,N,q,Q),e1&&console.log("271: ",ek,ey,i,N,ee,et),b(ek,i,g=(null===(V=r.find(e=>e.name===ej))||void 0===V?void 0:V.id)||(null===(F=r.find(e=>"PropLink"===e.name))||void 0===F?void 0:F.id),ea,el,eb),f=null==m?void 0:m.id,y=null==m?void 0:m.name,v="Association",console.log("286 ",eh,R.find(e=>e[1]===eh)[0],R.find(e=>e[1]===eh)[1]),"items"===eu?(ee=R.find(e=>e[1]===eh)[0],et=R.find(e=>e[1]===eh)[1],e1&&console.log("298 :  ",ek,ey,ee,et)):"items"===eg?(ee=R.find(e=>e[1]===em)[0],et=R.find(e=>e[1]===em)[1],e1&&console.log("301 :  ",ek,ey,ee,et)):"items"===ey?(ee=R.find(e=>e[1]===em)[0],et=R.find(e=>e[1]===em)[1],e1&&console.log("305 :  ",ek,ey,ee,et)):(ee=k,et=D,e1&&console.log("305 :  ",ek,ey,ee,et)),e1&&console.log("307 :  ",ek,ey,ee,et,eu)}else if("object"===ev.type)continue;else switch(ey){case"allOf":case"anyOf":case"oneOf":case"properties":case"required":case"x-osdu-indexing":break;case"items":e1&&console.log("----- oName = items -------------------------------------------------------------------------------------------------"),e1&&console.log("345",ev,ek,ey,ej,"i",X),console.log("348 ",ev.allOf&&Object.keys(null===(G=null==ev?void 0:ev.allOf[0])||void 0===G?void 0:G.properties));let eD=ev.allOf?Object.keys(null===(K=null==ev?void 0:ev.allOf[0])||void 0===K?void 0:K.properties).find(e=>e.includes("ID")).replace("ID",""):null;eD&&(N=ek,i=eD,g=eD&&(null===(B=r.find(e=>e.name===ej))||void 0===B?void 0:B.id)||(null===(U=r.find(e=>"PropLink"===e.name))||void 0===U?void 0:U.id),f=null==u?void 0:u.id,y=null==u?void 0:u.name,v="Association",ee=em&&R.find(e=>e[1]===em)[0]||k,et=em&&R.find(e=>e[1]===em)[1]||D),e1&&console.log("285 :  ",ev,ek,ey,ee,et),b(ek,i,g,ea,el,eb)}e1&&console.log("390",ee,et)}else f=null==h?void 0:h.id,y=null==h?void 0:h.name,v="Association",b(ek,ey,g,ea,el,eb),x=(A=R.find(e=>e[1]===em&&e[0]))&&A[1],e1&&console.log("249 ",A,x);let eE=ef.createGuid();a=ee,d=et,e1&&console.log("402 parId ",ee,"parName",et,"entId ",N,"entName",i,"mainArray ",R),c=ek,T=ey,e1&&console.log("405 : name",y,"reltypeRef",f,"fromobject",a,d,"toobject",c,T),e1&&onsole.log("408 relId",eE,"reltypeName ",y,"relRef ",f,"fromId ",a,"fromName ",d,"toId ",c,"toName ",T),a!==c&&w(eE,y,"","",f,v,a,d,c,T)}})(E)},n.readAsText(i.target.files[0]);let b=(t,l,i,n,a,r)=>{let d=s.objects.find(e=>e.id===t)||null;if(console.log("existObj",l,d),!d){let c="AKM"===e?{id:t,name:l,typeRef:i,abstract:!1,markedAsDeleted:!1,modified:!0,osduId:n,...r}:{id:t,name:l,typeRef:i,abstract:!1,markedAsDeleted:!1,modified:!0,osduId:n,jsonType:a,jsonKey:l,...r};e1&&console.log("469 Create object: ",c.name),o({type:"UPDATE_OBJECT_PROPERTIES",data:c})}},w=(e,t,l,i,n,s,a,r,d,c)=>{let p=a?{id:e,name:t,title:i.replace(/\s+/g,""),cardinality:"",cardinalityFrom:void 0,cardinalityTo:void 0,description:l,fromobjectRef:a,nameFrom:r,generatedTypeId:"",markedAsDeleted:!1,modified:!0,relshipkind:s,relshipviews:void 0,toobjectRef:d,nameTo:c,typeRef:n}:{};e1&&console.log("492 Create relship",r,p.name,c),a&&d&&o({type:"UPDATE_RELSHIP_PROPERTIES",data:p})};function j(e){let t={};for(var l in e){if(!e.hasOwnProperty(l)||"object"==typeof e[l])continue;let o=l;"type"===l&&(o="osduType"),t={...t,[o]:e[l]}}return e1&&console.log("513 :",e,t),t}},e6=!1,e5=async(e,t,l,o)=>{let i,n,s,a,r,d,c,p,h;e6&&console.log("13 ",l);let u=l.phData.metis.models.find(e=>e.id===l.phFocus.focusModel.id),m=u.objects,g=u.relships;e6&&console.log("23 ",l.phFocus.focusModel,u,l.phData.metis.models);let f=l.phData.metis.metamodels.find(e=>e.id===u.metamodelRef),y=f.objecttypes,v=f.relshiptypes;y.find(e=>"JsonObject"===e.name&&e),y.find(e=>"Container"===e.name&&e),y.find(e=>"JsonArray"===e.name&&e),y.find(e=>"EntityType"===e.name&&e),y.find(e=>"Property"===e.name&&e),v.find(e=>"hasPart"===e.name&&e),v.find(e=>"hasMember"===e.name&&e);let b=v.find(e=>"refersTo"===e.name&&e),w=v.find(e=>"has"===e.name&&e),j=v.find(e=>"Is"===e.name&&e),T=null==w?void 0:w.id,k=null==w?void 0:w.name,O=(e,t,l,i,n,s,a,r,d,c,p)=>{e6&&console.log("45 ",e,s,a,r,d,c);let h=g.find(t=>t.id===e),u=a?{id:e,name:t,title:null==i?void 0:i.replace(/\s+/g,""),typeRef:s,cardinality:"",cardinalityFrom:void 0,cardinalityTo:void 0,description:l,fromobjectRef:a,nameFrom:r,generatedTypeId:"",markedAsDeleted:!1,modified:!0,relshipkind:n,relshipviews:void 0,toobjectRef:d,nameTo:c}:{};if(e6&&console.log("67 CreatedRel",a,d,u),h){let m={id:p,markedAsDeleted:!0};o({type:"UPDATE_OBJECT_PROPERTIES",data:m})}else if(a&&d){o({type:"UPDATE_RELSHIP_PROPERTIES",data:u}),e6&&console.log("76 CreatedRel",a,d,u);let f={id:p,markedAsDeleted:!0};o({type:"UPDATE_OBJECT_PROPERTIES",data:f})}else d||o({type:"UPDATE_OBJECT_PROPERTIES",data:{id:p,markedAsDeleted:!0}})},M=ef.findObjectsByType(u.objects,y,"PropLink");e6&&console.log("85 :",u.objects,M);let D=M;e6&&console.log("103 ",D),D.forEach(e=>{e6&&console.log("109 ",e.name,e.title,e.id,e.linkID,e),e6&&console.log("110 ",e.linkID);let t=ef.findObjectByTitle(u.objects,{},e.linkID);e6&&console.log("112 ",e,e.linkID,t);let l=ef.findRelshipByToIdAndType(g,null==t?void 0:t.id,null==w?void 0:w.id);if(l=ef.findRelshipByToIdAndType(g,null==t?void 0:t.id,null==j?void 0:j.id),e6&&console.log("116 ",e.name,t&&t.id,l),e6&&console.log("117 ",e.name),t){var o,f,v,M;h=e?ef.findTopLevelObject(e,"",m,g):null,e6&&console.log("122 ",e.name,t),e6&&console.log("123 ",h,m,e),e6&&console.log("125 ",t,e.name,m,h),s=null==h?void 0:h.id,a=null==h?void 0:h.name;let D=null===(o=m.find(e=>e.id===s))||void 0===o?void 0:o.typeRef,E=null===(f=y.find(e=>e.id===D))||void 0===f?void 0:f.name;n=e.title,i=e.description,r=null==t?void 0:t.id,d=null==t?void 0:t.name;let x=null===(v=m.find(e=>e.id===r))||void 0===v?void 0:v.typeRef,R=null===(M=y.find(e=>e.id===x))||void 0===M?void 0:M.name;p=l?l.id:ef.createGuid(),T=(null==b?void 0:b.id)||(null==w?void 0:w.id),"ColumnStratigraphicHorizonTopID"===e.title?(k=(null==w?void 0:w.name)+"Top",i="".concat(a," has Top ").concat(d)):"ColumnStratigraphicHorizonBaseID"===e.title?(k=(null==w?void 0:w.name)+"Base",i="".concat(a," has Base ").concat(d)):(k=(null==b?void 0:b.name)||(null==w?void 0:w.name),i="".concat(a," refersTo ").concat(d)),e6&&console.log("152 ",p,k,c,n,T,s,a,r,d),e6&&console.log("153 ",k,"from: ",a,"to:",d),r&&s&&!l&&(e6&&console.log("155 ",D,E,a,x,R,d),s!==r&&(e6&&console.log("157 ",k,E,a,R,d),"Abstract"===E||"Abstract"===R?e6&&console.log("160 ",E,a,R,d):(e6&&console.log("163 ",E,a,R,d),O(p,k,i,n,"Associaton",T,s,a,r,d,e.id))))}});let E=M.filter(e=>e.$ref);e6&&console.log("174 ",M,E),E.forEach(e=>{e6&&console.log("177 ",e.$ref);let t=e.$ref.split("/").pop(),l=t.split(".")[0],o="AbstractWorkProductComponent"===l?l:l.replace("Abstract",""),i=ef.findObjectByName(u.objects,{},o);e6&&console.log("185 ",e,l,i);let b=ef.findRelshipByToIdAndType(g,null==i?void 0:i.id,null==j?void 0:j.id)||null;if(i){var w;e6&&console.log("191 ",e,i,j.id,j.name),h=e?ef.findTopLevelObject(e,"",m,g):null,e6&&console.log("194 ",h.name,i.name),h||console.log("171 topLevelObject does not exist"),e6&&console.log("197 ",e,h,i.name),s=null==h?void 0:h.id,a=null==h?void 0:h.name,r=null==i?void 0:i.id,d=null==i?void 0:i.name,p=b?b.id:ef.createGuid();let M=null===(w=m.find(e=>e.id===s))||void 0===w?void 0:w.typeRef,D=m.find(e=>e.id===r).typeRef;e6&&console.log("209 ",M,D);let E=y.find(e=>e.id===M),x=y.find(e=>e.id===D);e6&&console.log("213 ",E,x);let R=v.find(e=>"5718b4c7-3aa1-4ee3-0a9d-5e7cdcd18a24"===e.id&&e);if(e6&&console.log("218 ",a,g.find(e=>e.fromobjectRef===s),r,g.find(e=>e.toobjectRef===r)),e6&&console.log("219 ",a,null==E?void 0:E.id,d,null==x?void 0:x.id,R.name,R),e6&&console.log("220 ",f),g.find(e=>e.fromobjectRef===s&&e.toobjectRef===r&&e.reltypeRef===(null==R?void 0:R.id)))console.log("227 Relship exisit ",a,d,R.name);else{e6&&console.log("229 ",null==E?void 0:E.id,R),T=null==R?void 0:R.id,k=null==R?void 0:R.name;let N="".concat(a," Is ").concat(d);n="",e6&&console.log("237 ",p,k,c,"title:",n,T,"from :",s,a,"to :",r,d,e.id),e6&&console.log("238 ",p,k,"from : ",a,"to : ",d),s!==r&&r&&!b&&O(p,k,N,n,"Generalization",T,s,a,r,d,e.id)}}})},e3=e=>{var t,l,i,r,d;if(!(null===(t=e.ph.phData)||void 0===t?void 0:t.metis.models))return null;let c=!1,p=(0,a.I0)(),h=e.refresh,u=e.setRefresh;function m(){u(!h)}let g=null===(l=e.ph.phData)||void 0===l?void 0:null===(i=l.metis)||void 0===i?void 0:i.models.map(e=>(0,o.jsxs)("span",{children:[e.name," | "]},e.id)),f=null===(r=e.ph.phData)||void 0===r?void 0:null===(d=r.metis)||void 0===d?void 0:d.metamodels.map(e=>e&&(0,o.jsxs)("span",{children:[e.name," | "]},e.id));function y(){var t,l,o,i,n;e.ph.phData.metis.name;let s=null===(t=e.ph)||void 0===t?void 0:null===(l=t.phData)||void 0===l?void 0:null===(o=l.metis)||void 0===o?void 0:null===(i=o.models)||void 0===i?void 0:i.find(t=>{var l,o,i;return t.id===(null===(l=e.ph)||void 0===l?void 0:null===(o=l.phFocus)||void 0===o?void 0:null===(i=o.focusModel)||void 0===i?void 0:i.id)}),a=null===(n=s.modelviews)||void 0===n?void 0:n.find(t=>{var l,o,i;return t&&t.id===(null===(l=e.ph)||void 0===l?void 0:null===(o=l.phFocus)||void 0===o?void 0:null===(i=o.focusModelview)||void 0===i?void 0:i.id)});eV(s,a,s.name,"Json")}c&&console.log("20 LoadLocal",e.ph.phData,g,f),e.ph.phData,e.ph.phFocus,e.ph.phUser,e.phSource,new Date().toISOString();let{buttonLabel:v,className:b}=e,[w,j]=(0,s.useState)(!1),T=()=>j(!w),[k,O]=(0,s.useState)(!0),M=()=>{O(!k)},D=(0,o.jsx)("button",{className:"btn-success text-white-50 btn-sm mr-2 w-100 ","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Click here to download current model as JSON to file (in Downloads folder)",onClick:y,children:"Save Current Model to File"});c&&console.log("172",v);let E=async t=>{let l=Array.from(t.target.files);console.log("125",l);let o=l.map(e=>{c&&console.log("126 file",e);let t=new FileReader;return new Promise(l=>{t.onload=()=>l(t.result),t.readAsText(e)})});c&&console.log("12 files",o),(await Promise.all(o)).map(t=>{e0("AKM",k,e.ph,p,t)})};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{onClick:T,className:"jsx-47ff1a2767aed522 btn-context btn-secondary float-right mr-1 mb-0 pr-2",children:v}),(0,o.jsxs)(z.Z,{size:"lg",isOpen:w,toggle:function(){},children:[(0,o.jsx)(W.Z,{className:"handle",toggle:()=>{T(),m()},children:"Export/Import: "}),(0,o.jsxs)(X.Z,{className:"pt-0",children:["Current Source: ",(0,o.jsxs)("strong",{className:"jsx-47ff1a2767aed522",children:[" ",e.ph.phSource]}),(0,o.jsxs)("div",{className:"jsx-47ff1a2767aed522 source bg-light p-2 ",children:[" Models: ",(0,o.jsxs)("strong",{className:"jsx-47ff1a2767aed522",children:[" ",g]})]}),(0,o.jsxs)("div",{className:"jsx-47ff1a2767aed522 source bg-light p-2 ",children:[" Metamodels: ",(0,o.jsxs)("strong",{className:"jsx-47ff1a2767aed522",children:[" ",f]})]}),(0,o.jsxs)("div",{className:"jsx-47ff1a2767aed522 source bg-light p-2 ",children:[(0,o.jsx)("hr",{style:{borderTop:"1px solid #8c8b8",backgroundColor:"#9cf",padding:"2px",margin:"1px",marginBottom:"1px"},className:"jsx-47ff1a2767aed522"}),(0,o.jsxs)("div",{className:"jsx-47ff1a2767aed522 loadsave--JsonToFile select bg-primary mb-1 p-2  border border-dark",children:[(0,o.jsx)("h5",{className:"jsx-47ff1a2767aed522",children:"AKM objecttypes"}),(0,o.jsxs)("div",{className:"jsx-47ff1a2767aed522 selectbox3 mb-2 border",children:[(0,o.jsx)("h6",{className:"jsx-47ff1a2767aed522",children:"Import OSDU JSON-file as AKM model types"}),(0,o.jsx)("h6",{className:"jsx-47ff1a2767aed522",children:"(This will import the OSDU Types as AKM EntityType and Property)"}),(0,o.jsx)("input",{type:"file",accept:".json",onChange:E,multiple:!0,className:"jsx-47ff1a2767aed522 select-input w-100"}),(0,o.jsxs)("label",{htmlFor:"inclProps ",className:"jsx-47ff1a2767aed522 pt-3",children:["Include Properties",(0,o.jsx)("input",{type:"checkbox",checked:k,onChange:M,className:"jsx-47ff1a2767aed522 ml-3 mt-2 "})]})]}),(0,o.jsx)("hr",{style:{borderTop:"4px solid #8c8b8",backgroundColor:"#9cf",padding:"2px",marginTop:"3px",marginBottom:"3px"},className:"jsx-47ff1a2767aed522"}),(0,o.jsx)("h6",{className:"jsx-47ff1a2767aed522",children:"Connect imported EntityTypes"}),(0,o.jsx)("div",{className:"jsx-47ff1a2767aed522 selectbox3 mb-2 border",children:(0,o.jsx)(H.Z,{className:"modal--footer m-0 py-1 px-2 w-100",color:"primary","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Picking Propertylinks and convert to relatioships!",onClick:()=>{e5("JSON",k,e.ph,p)},children:"Generate Relationships between EntityTypes"})})]}),(0,o.jsxs)("div",{className:"jsx-47ff1a2767aed522 loadsave--JsonToFile select bg-success mb-1 p-2  border border-dark",children:[(0,o.jsx)("h5",{className:"jsx-47ff1a2767aed522",children:"OSDU JSON filestructure"}),(0,o.jsxs)("div",{className:"jsx-47ff1a2767aed522 selectbox3 mb-2 border",children:[(0,o.jsx)("h6",{className:"jsx-47ff1a2767aed522",children:"Import OSDU Json file as a Json model "}),(0,o.jsx)("h6",{className:"jsx-47ff1a2767aed522",children:"(This will import the OSDU Json structure)"}),(0,o.jsx)("input",{type:"file",accept:".json",onClick:e=>{},onChange:t=>e2("JSON",k,e.ph,p,t),className:"jsx-47ff1a2767aed522 select-input w-100"})]}),(0,o.jsxs)("div",{className:"jsx-47ff1a2767aed522 selectbox2 mb-2 border",children:[(0,o.jsx)("h6",{className:"jsx-47ff1a2767aed522",children:"Export model as OSDU Json file "}),(0,o.jsx)("h6",{className:"jsx-47ff1a2767aed522",children:"(The file will be found in the download folder)"}),D]})]})]})]}),(0,o.jsx)(Y.Z,{children:(0,o.jsx)(H.Z,{className:"modal--footer m-0 py-0 px-2","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Click here when done!",onClick:()=>{T(),m()},children:"Done"})})]}),(0,o.jsx)(n(),{id:"47ff1a2767aed522",children:".selectbox2.jsx-47ff1a2767aed522{background-color:rgba(0,0,0,.3);border:20px;border-color:tomato;padding:1%}.selectbox3.jsx-47ff1a2767aed522{background-color:rgba(100,100,100,.1);border:20px;border-color:tomato;padding:1%}"})]})};var e4=e3,e8=l(4298);let e9=e=>(0,o.jsxs)("div",{className:"jsx-89a6fbd541cc7051",children:[(0,o.jsxs)("div",{className:"jsx-89a6fbd541cc7051 field",children:[(0,o.jsx)("label",{htmlFor:"name",className:"jsx-89a6fbd541cc7051 label mt-1",children:"".concat(e.p)}),(0,o.jsx)("input",{type:"text",id:"".concat(e.curitem.id,"+").concat(e.p),name:"".concat(e.p),defaultValue:"".concat(e.curitem[e.p]),ref:e.register({required:!1}),className:"jsx-89a6fbd541cc7051 input pt-1 float-right "}),e.errors.name&&"required"===e.errors.name.type&&(0,o.jsx)("div",{className:"jsx-89a6fbd541cc7051 error",children:"Your must enter the name."})]}),(0,o.jsx)(n(),{id:"89a6fbd541cc7051",children:".field.jsx-89a6fbd541cc7051{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;width:100%}.field.jsx-89a6fbd541cc7051 label.jsx-89a6fbd541cc7051{display:inline-block;width:30%;text-align:right;margin-right:3px;margin-top:3px}.field.jsx-89a6fbd541cc7051 input.jsx-89a6fbd541cc7051{display:inline-block;width:75%;margin-left:2px;margin-right:3px;padding-top:0px}.field.jsx-89a6fbd541cc7051 .error.jsx-89a6fbd541cc7051{color:red;margin-left:3px;font-size:.8em;width:100px}"})]});var e7=e9,te=l(843);let tt=e=>{let t=!1;t&&console.log("19 EditProperties",e);let l=(0,a.I0)(),i=e.item,{register:r,handleSubmit:d,errors:c}=(0,e8.cI)(),[p,h]=(0,s.useState)(e.item.fillcolor),[u,m]=(0,s.useState)(e.item.strokecolor),[g,f]=(0,s.useState)(e.item.strokewidth),[y,v]=(0,s.useState)(e.item.icon);(0,s.useEffect)(e=>{h(e)},[p]);let b=o=>{t&&console.log("36 EditProperties",i,o,e.item);let n={...i,...o};t&&console.log("38 EditProperties",e,n),l({type:e.type,data:n})};function w(e){var t,l=[];for(t=e;null!==t;t=Object.getPrototypeOf(t))l=l.concat(Object.getOwnPropertyNames(t));return l}let j=e=>{let t=e.target.value;h(t)},T=e=>{let t=e.target.value;m(t)},k=e=>{let t=e.target.value;f(t)},O=e=>{let t=e.target.value;v(t)},M=w(i).map(e=>"__"!==e.substring(0,2)&&"constructor"!==e&&"hasOwnProperty"!==e&&"isPrototypeOf"!==e&&"propertyIsEnumerable"!==e&&"toString"!==e&&"valueOf"!==e&&"toLocaleString"!==e&&"group"!==e&&"isGroup"!==e&&"propertyValues"!==e&&"size"!==e&&"properties"!==e&&"objects"!==e&&"relships"!==e&&"modelviews"!==e&&"objectviews"!==e&&"objecttypeviews"!==e&&"relshiptypeviews"!==e&&"pasteViewsOnly"!==e&&"deleteViewsOnly"!==e&&"datatypes"!==e&&"relshiptypes"!==e&&"inputrels"!==e&&"outputrels"!==e&&"unittypes"!==e&&"objtypegeos"!==e&&"relshipviews"!==e&&"objecttypes"!==e&&e).filter(Boolean),D=M.map(t=>{var l,o;return"Ref"!==t.slice(-3)?t:null===(l=e.curobj)||void 0===l?void 0:null===(o=l.models)||void 0===o?void 0:o.find(e=>e.name&&e.id===t)}).filter(Boolean),E=null==D?void 0:D.map(e=>e&&x(e,i));function x(e,l){switch(e){case"fillcolor":return(0,o.jsx)("div",{children:(0,o.jsxs)("div",{className:"field d-flex mr-1 float-right",children:[(0,o.jsxs)("label",{className:"label mt-1",htmlFor:"name",children:["fillcolor",(0,o.jsxs)("select",{className:"input ml-3",value:p,onChange:j,children:[(0,o.jsx)("option",{value:"".concat(p),children:"Select ..."}),(0,o.jsx)("option",{value:"transparent",children:"transparent"}),(0,o.jsx)("option",{value:"lightgray",children:"Gray"}),(0,o.jsx)("option",{value:"white",children:"White"}),(0,o.jsx)("option",{value:"#ffaaaa",children:"Red"}),(0,o.jsx)("option",{value:"lightblue",children:"Blue"}),(0,o.jsx)("option",{value:"lightgreen",children:"Green"}),(0,o.jsx)("option",{value:"lightyellow",children:"Yellow"}),(0,o.jsx)("option",{value:"#D58181",children:"Brown"}),(0,o.jsx)("option",{value:"#e8bfd3",children:"Purple"}),(0,o.jsx)("option",{value:"orange",children:"Orange"})]})," colorcode :"]}),(0,o.jsx)("input",{className:"input pt-0 mt-1 mb-3",onChange:j,style:{backgroundColor:"".concat(p)},type:"text",id:"".concat(l.id,"+").concat(e),name:"".concat(e),value:p,ref:r({required:!1})})]},l.id+e)});case"strokecolor":return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"field d-flex mr-1 float-right",children:[(0,o.jsxs)("label",{className:"label mt-1",htmlFor:"name",children:["strokecolor",(0,o.jsxs)("select",{className:"sel ml-2",value:u,onChange:T,children:[(0,o.jsx)("option",{value:"".concat(u),children:"Select ..."}),(0,o.jsx)("option",{value:"transparent",children:"transparent"}),(0,o.jsx)("option",{value:"gray",children:"Gray"}),(0,o.jsx)("option",{value:"white",children:"White"}),(0,o.jsx)("option",{value:"#ff0000",children:"Red"}),(0,o.jsx)("option",{value:"blue",children:"Blue"}),(0,o.jsx)("option",{value:"green",children:"Green"}),(0,o.jsx)("option",{value:"yellow",children:"Yellow"}),(0,o.jsx)("option",{value:"#D58181",children:"Brown"}),(0,o.jsx)("option",{value:"#e8bfd3",children:"Purple"}),(0,o.jsx)("option",{value:"orange",children:"Orange"})]})," color :"]}),(0,o.jsx)("input",{className:"input pt-0 mt-1 mb-3",onChange:T,style:{backgroundColor:"".concat(u)},type:"text",id:"".concat(l.id,"+").concat(e),name:"".concat(e),value:u,ref:r({required:!1})})]},l.id+e)});case"strokewidth":return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"field d-flex mr-1 float-right",children:[(0,o.jsxs)("label",{className:"label mt-1",htmlFor:"name",children:["strokewidth",(0,o.jsxs)("select",{className:"sel ml-2",value:g,onChange:k,children:[(0,o.jsx)("option",{value:g,children:"Current"}),(0,o.jsx)("option",{value:1,children:"1"}),(0,o.jsx)("option",{value:2,children:"2"}),(0,o.jsx)("option",{value:3,children:"3"}),(0,o.jsx)("option",{value:4,children:"4"}),(0,o.jsx)("option",{value:5,children:"5"}),(0,o.jsx)("option",{value:6,children:"6"}),(0,o.jsx)("option",{value:7,children:"7"})]})," width :"]}),(0,o.jsx)("input",{className:"input pt-0 mt-1 mb-3",onChange:k,type:"text",id:"".concat(l.id,"+").concat(e),name:"".concat(e),value:g,ref:r({required:!1})})]},l.id+e)});case"icon":return t&&console.log("188",(0,te.xZ)(l,e,y,r,O)),(0,te.xZ)(l,e,y,r,O);default:return(0,o.jsx)(e7,{p:e,curitem:l,register:r,errors:c},l.id+e)}}t&&console.log("100 EditProperties",e.item,i,M,D,E);let R=y&&"http"===y.substring(0,4)?(0,o.jsx)("div",{className:"ml-2",children:(0,o.jsx)("img",{src:y})}):(0,o.jsx)("div",{children:(0,o.jsx)("img",{src:"./../images/".concat(y)})});return(0,o.jsxs)("div",{className:"jsx-ef6919ab7d08cd11 edit bg-light",children:[(0,o.jsx)("div",{className:"jsx-ef6919ab7d08cd11 edit-dialog",children:(0,o.jsxs)("form",{onSubmit:d(b),className:"jsx-ef6919ab7d08cd11",children:[E,(0,o.jsx)("span",{className:"jsx-ef6919ab7d08cd11 img float-left",children:R}),(0,o.jsx)("button",{type:"submit",className:"jsx-ef6919ab7d08cd11 btn-primary bg-secondary",children:"Save"})]})}),(0,o.jsx)(n(),{id:"ef6919ab7d08cd11",children:'.edit.jsx-ef6919ab7d08cd11{font - family: sans-serif;}.field.jsx-ef6919ab7d08cd11{-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;width:100%}.field.jsx-ef6919ab7d08cd11 label.jsx-ef6919ab7d08cd11{display:inline-block;width:25%;text-align:right;margin-right:3px;margin-top:3px}.field.jsx-ef6919ab7d08cd11 input.jsx-ef6919ab7d08cd11{display:inline-block;width:75%;hight:10px;margin-left:2px;margin-right:3px;padding-top:0px}.field.jsx-ef6919ab7d08cd11 .error.jsx-ef6919ab7d08cd11{color:red;margin-left:3px;font-size:.8em;width:100px}form.jsx-ef6919ab7d08cd11 button[type="submit"].jsx-ef6919ab7d08cd11{margin-top:5px;width:100%}form.jsx-ef6919ab7d08cd11 button.add.jsx-ef6919ab7d08cd11{margin:0px 0px 10px 73px}form.jsx-ef6919ab7d08cd11 button.remove.jsx-ef6919ab7d08cd11{margin-left:5px}'})]})};var tl=tt;let to=e=>{var t,l,i,n,a,r,d,c,p,h,u,m,g,f,y,v,b,w,j,T,k,O,M,D,E,x,R,N;let A;let S=!1;S&&console.log("10 EditFocusModal",e);let C=e.refresh,P=e.setRefresh;function I(){P(!C)}let _=null===(t=e.ph.phData.metis)||void 0===t?void 0:t.models,L=null===(l=e.ph.phFocus)||void 0===l?void 0:l.focusModel,V=null===(i=e.ph.phFocus)||void 0===i?void 0:i.focusModelview,F=null===(n=e.ph.phFocus)||void 0===n?void 0:n.focusObjectview,G=null===(a=e.ph.phFocus)||void 0===a?void 0:a.focusObject,K=null===(r=e.ph.phFocus)||void 0===r?void 0:r.focusRelshipview,B=null==_?void 0:_.find(e=>(null==e?void 0:e.id)===(null==L?void 0:L.id)),U=null==B?void 0:null===(d=B.modelviews)||void 0===d?void 0:d.find(e=>(null==e?void 0:e.id)===(null==V?void 0:V.id)),J=null==U?void 0:null===(c=U.objectviews)||void 0===c?void 0:c.find(e=>(null==e?void 0:e.id)===(null==F?void 0:F.id)),Z=null==B?void 0:null===(p=B.objects)||void 0===p?void 0:p.find(e=>e.id===(null==J?void 0:J.objectRef)),$=Z&&{...Z,name:null==J?void 0:J.name,description:null==J?void 0:J.description},q=null==B?void 0:null===(h=B.objects)||void 0===h?void 0:h.find(e=>e.id===(null==G?void 0:G.id)),Q=null==U?void 0:null===(u=U.relshipviews)||void 0===u?void 0:u.find(e=>(null==e?void 0:e.id)===(null==K?void 0:K.id)),ee=null==B?void 0:null===(m=B.relships)||void 0===m?void 0:m.find(e=>e.id===(null==Q?void 0:Q.relshipRef)),et=ee&&{...ee,name:null==Q?void 0:Q.name,description:null==Q?void 0:Q.description},el=null===(g=e.ph.phFocus)||void 0===g?void 0:g.focusObjecttype,eo=null===(f=e.ph.phFocus)||void 0===f?void 0:f.focusRelshiptype,ei=null===(y=e.ph.phData.metis)||void 0===y?void 0:y.metamodels,en=null==ei?void 0:ei.find(e=>e&&e.id===(null==B?void 0:B.metamodelRef)),es=null==en?void 0:null===(v=en.objecttypes)||void 0===v?void 0:v.find(e=>(null==e?void 0:e.id)===(null==el?void 0:el.id)),ea=null==en?void 0:null===(b=en.objecttypegeos)||void 0===b?void 0:b.find(e=>e.typeRef===(null==es?void 0:es.id)),er=null==en?void 0:null===(w=en.objecttypeviews)||void 0===w?void 0:w.find(e=>e.id===(null==es?void 0:es.typeviewRef)),ed=null==en?void 0:null===(j=en.relshiptypes)||void 0===j?void 0:j.find(e=>(null==e?void 0:e.id)===(null==eo?void 0:eo.id)),ec=null==en?void 0:null===(T=en.relshiptypeviews)||void 0===T?void 0:T.find(e=>e.id===(null==ed?void 0:ed.typeviewRef)),ep=null==en?void 0:null===(k=en.objecttypeviews)||void 0===k?void 0:k.find(e=>e.id===(null==J?void 0:J.typeviewRef)),eh=null==en?void 0:null===(O=en.relshiptypeviews)||void 0===O?void 0:O.find(e=>e.id===(null==Q?void 0:Q.typeviewRef));S&&console.log("42 EditFocusModal",e.modelType,q,$);let eu="modelview"===e.modelType&&B&&(0,o.jsx)(tl,{item:B,curobj:B,type:"UPDATE_MODEL_PROPERTIES"},B.id),em="modelview"===e.modelType&&U&&(0,o.jsx)(tl,{item:U,curobj:U,type:"UPDATE_MODELVIEW_PROPERTIES"},U.id),eg="modelview"===e.modelType&&en&&(0,o.jsx)(tl,{item:en,curobj:en,type:"UPDATE_METAMODEL_PROPERTIES"},en.id),ef="model"===e.modelType?"Object"===e.buttonLabel?J&&(0,o.jsx)(tl,{item:J,curobj:$,type:"UPDATE_OBJECTVIEW_PROPERTIES"},J.id):Q&&(0,o.jsx)(tl,{item:Q,curobj:et,type:"UPDATE_RELSHIPVIEW_PROPERTIES"},Q.id):"Object"===e.buttonLabel?es&&(0,o.jsx)(tl,{item:es,curobj:$,type:"UPDATE_OBJECTTYPE_PROPERTIES"},es.id):ed&&(0,o.jsx)(tl,{item:ed,curobj:ed,type:"UPDATE_RELSHIPTYPE_PROPERTIES"},ed.id),ey=(e.modelType,"model"===e.modelType)?"Object"===e.buttonLabel?$&&(0,o.jsx)(tl,{item:$,type:"UPDATE_OBJECT_PROPERTIES"})||ea&&(0,o.jsx)(tl,{item:ea,type:"UPDATE_OBJECTTYPEGEOS_PROPERTIES"}):et&&(0,o.jsx)(tl,{item:et,type:"UPDATE_RELSHIP_PROPERTIES"}):q&&(0,o.jsx)(tl,{item:q,type:"UPDATE_OBJECT_PROPERTIES"}),ev="model"===e.modelType?"Object"===e.buttonLabel?ep&&(0,o.jsx)(tl,{item:ep,type:"UPDATE_OBJECTTYPEVIEW_PROPERTIES"},ep.id):eh&&(0,o.jsx)(tl,{item:eh,type:"UPDATE_RELSHIPTYPEVIEW_PROPERTIES"},eh.id):"Object"===e.buttonLabel?er&&(0,o.jsx)(tl,{item:er,type:"UPDATE_OBJECTTYPEVIEW_PROPERTIES"},er.id):ec&&(0,o.jsx)(tl,{item:ec,type:"UPDATE_RELSHIPTYPEVIEW_PROPERTIES"},ec.id),eb="modelview"===e.modelType?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{children:["Id : ",(0,o.jsxs)("span",{className:"font-weight-bolder ml-5",children:[null===(M=e.ph.phFocus.focusModel)||void 0===M?void 0:M.id," "]})]}),(0,o.jsxs)("div",{children:[" Name :",(0,o.jsx)("span",{className:"titlename font-weight-bolder ml-4",children:null===(D=e.ph.phFocus.focusModel)||void 0===D?void 0:D.name})]})]}):"model"===e.modelType?"Object"==e.buttonLabel?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{children:["Id : ",(0,o.jsxs)("span",{className:"font-weight-bolder ml-5",children:[null===(E=e.ph.phFocus.focusObjectview)||void 0===E?void 0:E.id," "]})]}),(0,o.jsxs)("div",{children:[" Name :",(0,o.jsx)("span",{className:"titlename font-weight-bolder ml-4",children:null==J?void 0:J.name})]})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{children:["Id : ",(0,o.jsxs)("span",{className:"font-weight-bolder ml-5",children:[null===(x=e.ph.phFocus.focusRelshipview)||void 0===x?void 0:x.id," "]})]}),(0,o.jsxs)("div",{children:[" Name :",(0,o.jsx)("span",{className:"titlename font-weight-bolder ml-4",children:null==Q?void 0:Q.name})]})]}):"Object"===e.buttonLabel?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{children:["Id : ",(0,o.jsxs)("span",{className:"font-weight-bolder ml-5",children:[null===(R=e.ph.phFocus.focusObjecttype)||void 0===R?void 0:R.id," "]})]}),(0,o.jsxs)("div",{children:[" Name :",(0,o.jsx)("span",{className:"titlename font-weight-bolder ml-4",children:null==es?void 0:es.name})]})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{children:["Id : ",(0,o.jsxs)("span",{className:"font-weight-bolder ml-5",children:[null===(N=e.ph.phFocus.focusRelshiptype)||void 0===N?void 0:N.id," "]})]}),(0,o.jsxs)("div",{children:[" Name :",(0,o.jsx)("span",{className:"titlename font-weight-bolder ml-4",children:null==et?void 0:et.name})]})]}),ew=(e.modelType,"Model"===e.buttonLabel?"Edit Model Properties:":"Edit Properties:"),ej="Model"===e.buttonLabel&&"Model",eT="Model"===e.buttonLabel&&"Modelview",ek="Model"===e.buttonLabel&&"Metamodel",eO="model"===e.modelType?"Object"===e.buttonLabel?"Objectview":"Relshipview":"Object"===e.buttonLabel?"Objecttype":"Relshiptype",eM=(e.modelType,"Object"===e.buttonLabel)?"Object":"Relship",eD=(e.modelType,e.buttonLabel,"Typeview");A="modelview"===e.modelType?(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"select bg-light pt-0 ",children:[(0,o.jsx)("div",{className:"title mb-1 pb-1 px-2",children:eb}),(0,o.jsxs)("div",{className:"propview bg-light mt-1 p-0 border border-dark",children:[(0,o.jsxs)("div",{className:"title bg-light mb-1 pb-1 px-2",children:[ej,":"]}),eu]}),(0,o.jsxs)("div",{className:"propview bg-light mt-1 p-0 border border-dark",children:[(0,o.jsxs)("div",{className:"title bg-light mb-1 pb-1 px-2",children:[eT,":"]}),em]}),(0,o.jsxs)("div",{className:"propview bg-light mt-1 p-0 border border-dark",children:[(0,o.jsxs)("div",{className:"title bg-light mb-1 pb-1 px-2",children:[ek,":"]}),eg]})]})}):"objects"===e.modelType?(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"select bg-light pt-0 ",children:[(0,o.jsx)("div",{className:"title mb-1 pb-1 px-2",children:eb}),(0,o.jsxs)("div",{className:"propview bg-light mt-1 p-0 border border-dark",children:[(0,o.jsxs)("div",{className:"title bg-light mb-1 pb-1 px-2",children:[eM,":"]}),ey]})]})}):(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"select bg-light pt-0 ",children:[(0,o.jsx)("div",{className:"title mb-1 pb-1 px-2",children:eb}),(0,o.jsxs)("div",{className:"propview bg-light mt-1 p-0 border border-dark",children:[(0,o.jsxs)("div",{className:"title bg-light mb-1 pb-1 px-2",children:[eO,":"]}),ef]}),(0,o.jsxs)("div",{className:"propview bg-light mt-1 p-0 border border-dark",children:[(0,o.jsxs)("div",{className:"title bg-light mb-1 pb-1 px-2",children:[eM,":"]}),ey]}),(0,o.jsxs)("div",{className:"propview bg-light mt-1 p-0 border border-dark",children:[(0,o.jsxs)("div",{className:"title bg-light mb-1 pb-1 px-2",children:[eD,":"]}),ev]})]})});let{buttonLabel:eE,className:ex}=e,[eR,eN]=(0,s.useState)(!1),eA=()=>eN(!eR);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("button",{className:"btn-dark float-right px-3 mr-1",onClick:eA,children:[" ",eE]}),(0,o.jsxs)(z.Z,{isOpen:eR,toggle:eA,className:ex,style:{marginTop:"96px",fontSize:"90%"},children:[(0,o.jsx)(W.Z,{toggle:eA,children:ew}),(0,o.jsx)(X.Z,{children:A}),(0,o.jsx)(Y.Z,{children:(0,o.jsx)(H.Z,{className:"modal-footer m-0 p-0",color:"link",onClick:()=>{eA(),I()},children:"Done"})})]})]})};var ti=to;let tn=!1,ts=console.log.bind(console,"%c %s","background: blue; color: white");console.trace.bind(console,"%c %s","background: blue; color: white");let ta=e=>{var t,l,i,n,r,d,c,p,h,u,j,k,O,M,D;tn&&ts("40 Modelling:",e);let E=(0,a.I0)(),[x,R]=(0,s.useState)(!0),[N,A]=eE("memorystate",null),[S,C]=(0,s.useState)("2"),[P,I]=(0,s.useState)(!1),[_,L]=(0,s.useState)(!0),V=(0,a.v9)(t=>{var l;return null===(l=e.phFocus)||void 0===l?void 0:l.focusModel}),F=(0,a.v9)(t=>{var l;return null===(l=e.phFocus)||void 0===l?void 0:l.focusModelview}),G=(0,a.v9)(t=>{var l;return null===(l=e.phFocus)||void 0===l?void 0:l.focusObjectview}),K=(0,a.v9)(t=>{var l;return null===(l=e.phFocus)||void 0===l?void 0:l.focusRelshipview}),U=(0,a.v9)(t=>{var l;return null===(l=e.phFocus)||void 0===l?void 0:l.focusObjecttype}),J=(0,a.v9)(t=>{var l;return null===(l=e.phFocus)||void 0===l?void 0:l.focusRelshiptype}),z=(0,a.v9)(t=>e.phSource),[H,W]=(0,s.useState)(!1);function X(){tn&&console.log("124 Modelling",e,N,Array.isArray(N));let t=N&&Array.isArray(N)?[e,...N]:[e];tn&&console.log("161 Modelling refresh",t),t.length>2&&(t=t.slice(0,2)),t.length>2&&t.pop(),tn&&console.log("164 Modelling refresh",t),A(t),eT(e,E),setTimeout(function(){R(!x)},100),A(t)}if((0,s.useEffect)(()=>{var t;if(tn||console.log("97 Modelling useEffect 1",e),null===(t=e.query)||void 0===t?void 0:t.repo){let l=setTimeout(()=>{eT(e,E),R(!x)},5e3);return()=>clearTimeout(l)}eT(e,E),W(!0)},[]),(0,s.useEffect)(()=>{eT(e,E),setTimeout(function(){R(!x)},1)},[null===(t=e.phFocus)||void 0===t?void 0:null===(l=t.focusRefresh)||void 0===l?void 0:l.id,e.phSource]),!H)return(0,o.jsx)(o.Fragment,{});{let Y=null===(i=e.phData)||void 0===i?void 0:i.metis,Z=null===(n=e.phMymetis)||void 0===n?void 0:n.myMetis,$=null===(r=e.phMyGoModel)||void 0===r?void 0:r.myGoModel,q=null===(d=e.phMyGoMetamodel)||void 0===d?void 0:d.myGoMetamodel,Q=null===(c=e.phGojs)||void 0===c?void 0:c.gojsMetamodelPalette,ee=null===(p=e.phGojs)||void 0===p?void 0:p.gojsMetamodelModel,et=null===(h=e.phGojs)||void 0===h?void 0:h.gojsModelObjects,el=(null===(u=e.phGojs)||void 0===u?void 0:u.gojsTargetMetamodel)||[],eo=null===(j=e.phGojs)||void 0===j?void 0:j.gojsModel,ei=null===(k=e.phGojs)||void 0===k?void 0:k.gojsMetamodel;null===(O=e.phGojs)||void 0===O||O.gojsTargetModel,tn&&console.log("93 Modelling: gojsmodel",eo,null===(M=e.phGojs)||void 0===M?void 0:M.gojsModel);let en=null==Y?void 0:null===(D=Y.models)||void 0===D?void 0:D.find(e=>e.i===(null==V?void 0:V.id)),es=null==en?void 0:en.modelviews.find(e=>e.id=null==F?void 0:F.id);null==es||es.objectviews;let ea=e.phFocus;e.phData;let er=e.phUser;function ed(){let t=e.phData.metis.name;eC(e,t,"Project")}tn&&console.log("90 Modelling",Y.metamodels,Y.models,en,es,V),tn&&console.log("174 Modelling",en,es);let ep=e=>{S!==e&&C(e);let t="1"===e?"Metamodelling":"Modelling";E({type:"SET_FOCUS_TAB",data:t})};tn&&console.log("Modelling: gojsmodel",et),ee?(0,o.jsx)(B,{gojsModel:ee,gojsMetamodel:Q,myMetis:Z,myGoModel:$,myGoMetamodel:q,metis:Y,phFocus:ea,dispatch:E}):(0,o.jsx)(o.Fragment,{}),ee?(0,o.jsx)(ec,{gojsModel:ee,gojsMetamodel:Q,myMetis:Z,myGoModel:$,myGoMetamodel:q,metis:Y,phFocus:ea,dispatch:E,modelType:"metamodel",phUser:er}):(0,o.jsx)(o.Fragment,{}),(null==en?void 0:en.targetMetamodelRef)!==""?(0,o.jsx)(eg,{gojsModel:eo,gojsMetamodel:ei,gojsTargetMetamodel:el,myMetis:Z,myGoModel:$,myGoMetamodel:q,phFocus:ea,metis:Y,dispatch:E,modelType:"model"}):(0,o.jsx)(o.Fragment,{});let eh=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(m.Z,{tabs:!0,children:[(0,o.jsx)(g.Z,{children:(0,o.jsx)(f.Z,{style:{paddingTop:"0px",paddingBottom:"0px",borderColor:"#eee gray white #eee",color:"black"},className:T()({active:"1"===S}),onClick:()=>{ep("1"),X()},children:"Metamodelling"})}),(0,o.jsx)(g.Z,{children:(0,o.jsx)(f.Z,{style:{paddingTop:"0px",paddingBottom:"0px",borderColor:"#eee gray white #eee",color:"black"},className:T()({active:"2"===S}),onClick:()=>{ep("2"),X()},children:"Modelling"})})]}),(0,o.jsxs)(y.Z,{activeTab:S,children:[(0,o.jsx)(o.Fragment,{}),(0,o.jsxs)(v.Z,{tabId:"1",children:["   ",(0,o.jsx)("div",{className:"workpad p-1 pt-2 bg-white",children:(0,o.jsxs)(b.Z,{className:"row",style:{height:"100%",marginRight:"2px",backgroundColor:"#7ac",border:"solid 1px black"},children:[(0,o.jsx)(w.Z,{className:"col1 m-0 p-0 pl-3",xs:"auto",children:(0,o.jsx)("div",{className:"myPalette px-1 mt-0 mb-0 pt-0 pb-1",style:{height:"100%",marginRight:"2px",backgroundColor:"#7ac",border:"solid 1px black"}})}),(0,o.jsx)(w.Z,{className:"col2",style:{paddingLeft:"1px",marginLeft:"1px",paddingRight:"1px",marginRight:"1px"},children:(0,o.jsx)("div",{className:"myModeller pl-0 mb-0 pr-1",style:{backgroundColor:"#7ac",minHeight:"7vh",width:"100%",height:"100%",border:"solid 1px black"}})})]})})]}),(0,o.jsxs)(v.Z,{tabId:"2",children:["   ",(0,o.jsx)("div",{className:"workpad d-flex justify-content-center p-1 pt-2 bg-white",children:(0,o.jsxs)(b.Z,{className:"row1 d-flex ml-2 w-100 h-100",children:[(0,o.jsxs)(w.Z,{className:"col1 m-0 p-0 pl-3",xs:"auto",children:[" ",(0,o.jsx)("div",{className:"myPalette px-1 mt-0 mb-0 pt-0 pb-1",style:{height:"100%",marginRight:"2px",backgroundColor:"#7ac",border:"solid 1px black"},children:(0,o.jsx)(B,{gojsModelObjects:et,gojsModel:eo,gojsMetamodel:ei,myMetis:Z,myGoModel:$,myGoMetamodel:q,metis:Y,phFocus:ea,dispatch:E,modelType:"model"})}),(0,o.jsx)("div",{})]}),(0,o.jsxs)(w.Z,{className:"col2",style:{paddingLeft:"1px",marginLeft:"1px",paddingRight:"1px",marginRight:"1px"},children:[" ",(0,o.jsx)("div",{className:"myModeller pl-0 mb-0 pr-1",style:{backgroundColor:"#acc",minHeight:"7vh",width:"100%",height:"100%",border:"solid 1px black"},children:(0,o.jsx)(ec,{gojsModelObjects:et,gojsModel:eo,gojsMetamodel:ei,myMetis:Z,myGoModel:$,myGoMetamodel:q,phFocus:ea,phUser:er,phSource:z,metis:Y,dispatch:E,modelType:"model"})})]}),(0,o.jsxs)(w.Z,{className:"col3 mr-0 p-0 ",xs:"auto",children:[" ",(0,o.jsx)("div",{className:"myTargetMeta px-0 mb-1 mr-3 pt-0 float-right",style:{minHeight:"7vh",height:"100%",marginRight:"0px",backgroundColor:"#8ce",border:"solid 1px black"}})]})]})})]})]})]});tn&&console.log("383 Modelling",S);let eu=(0,o.jsx)(eB,{buttonLabel:"Model file",className:"ContextModal",ph:e,refresh:x,setRefresh:R}),em=(0,o.jsx)(e4,{buttonLabel:"OSDU",className:"ContextModal",ph:e,refresh:x,setRefresh:R}),ef=(0,o.jsx)(eZ,{buttonLabel:"GitHub",className:"ContextModal",ph:e,refresh:x,setRefresh:R}),ey=(0,o.jsx)(eR,{buttonLabel:"Recovery",className:"ContextModal",ph:e,refresh:x,setRefresh:R}),ev="1"===S?"metamodel":"model",eb=((null==K?void 0:K.name)||(null==J?void 0:J.name))&&(0,o.jsx)(ti,{buttonLabel:"M",className:"ContextModal",modelType:"modelview",ph:e,refresh:x,setRefresh:R}),ew=((null==G?void 0:G.name)||(null==U?void 0:U.name))&&(0,o.jsx)(ti,{buttonLabel:"O",className:"ContextModal",modelType:ev,ph:e,refresh:x,setRefresh:R}),ej=((null==K?void 0:K.name)||(null==J?void 0:J.name))&&(0,o.jsx)(ti,{className:"ContextModal",buttonLabel:"R",modelType:ev,ph:e,refresh:x,setRefresh:R});return tn&&console.log("460 Modelling",et),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"header-buttons float-end",style:{transform:"scale(0.7)",transformOrigin:"center",backgroundColor:"#ddd"},children:(0,o.jsxs)("span",{className:"buttonrow mr-4 d-flex justify-content-around",style:{width:"60rem",maxHeight:"9px",minHeight:"30px"},children:[(0,o.jsxs)("span",{"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Select an Relationship and click to edit properties",children:[" ",ej," "]}),(0,o.jsxs)("span",{"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Select an Object and click to edit properties",children:[" ",ew," "]}),(0,o.jsxs)("span",{"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Click to edit Model and Modelview properties",children:[" ",eb," "]}),(0,o.jsxs)("span",{"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Save and Load models (download/upload) from file",style:{minWidth:"108px"},children:[" ",eu," "]}),(0,o.jsxs)("span",{"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Save and Load models (download/upload) from OSDU Json file",children:[" ",em," "]}),(0,o.jsxs)("span",{"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Save and Load models (download/upload) from GitHub",children:[" ",ef," "]}),(0,o.jsx)("span",{className:"m-0 p-0",style:{transform:"scale(0.9)",minWidth:"96px"},children:"Project files:"}),(0,o.jsx)("span",{className:" ",style:{minWidth:"220px",maxHeight:"22px",backgroundColor:"#fff"},children:(0,o.jsx)("input",{className:"select-input",type:"file",accept:".json",onChange:t=>eI(e,E,t)})}),(0,o.jsx)("span",{children:(0,o.jsx)("button",{className:"btn-secondary ml-2 mr-2 mb-3 ","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Click here to Save the Project (all models and metamodels) to file (in Downloads folder)",onClick:ed,children:"Save"})}),(0,o.jsxs)("span",{"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Recover project from last refresh",children:[" ",ey," "]}),(0,o.jsxs)("span",{className:"btn btn-link float-right",onClick:X,"data-toggle":"tooltip","data-placement":"top",title:"Refresh the modelview",children:[" ","refresh"," "]})]})}),(0,o.jsx)("div",{className:"diagramtabs pb-0",children:(0,o.jsx)("div",{className:"modellingContent mt-1",children:x?(0,o.jsxs)(o.Fragment,{children:[" ",eh," "]}):(0,o.jsx)(o.Fragment,{children:eh})})})]})}};var tr=(0,p.Z)((0,a.$j)(e=>e)(ta)),td=l(8287);let tc=!1,tp=e=>{var t,l,i,r,d,c,p,h,u,m,g,f,y,v,b,w,j,T,k,O,M,D,E,x,R,N,A;tc&&console.log("12 ",e),(0,a.I0)();let S=(0,a.v9)(e=>e);if(tc&&console.log("15 state",S),!(null===(t=S.phData)||void 0===t?void 0:null===(l=t.metis)||void 0===l?void 0:l.models))return null;let C=(0,a.v9)(e=>{var t,l;return null===(t=S.phData)||void 0===t?void 0:null===(l=t.metis)||void 0===l?void 0:l.metamodels}),P=(0,a.v9)(e=>{var t,l;return null===(t=S.phData)||void 0===t?void 0:null===(l=t.metis)||void 0===l?void 0:l.models}),_=(0,a.v9)(e=>{var t;return null===(t=S.phFocus)||void 0===t?void 0:t.focusModel});(0,a.v9)(e=>{var t;return null===(t=S.phUser)||void 0===t?void 0:t.focusUser});let L=(0,a.v9)(e=>{var t;return null===(t=S.phFocus)||void 0===t?void 0:t.focusModelview});tc&&console.log("23 focusModel",_,P);let V=(null==P?void 0:P.find(e=>(null==e?void 0:e.id)===(null==_?void 0:_.id)))||P[0],F=null==V?void 0:V.modelviews,G=null==V?void 0:V.objects,K=(null===(i=null==F?void 0:F.find(e=>e.id===(null==L?void 0:L.id)))||void 0===i?void 0:i.objectviews)||[],B=(null==K?void 0:K.filter((e,t,l)=>t===l.findIndex(t=>t.place===e.place&&t.id===e.id)))||[];null==C||C.find(e=>e&&e.id===(null==V?void 0:V.metamodelRef));let U=(e,t,l,o)=>{var i,n;let s=null==e?void 0:e.find(e=>e&&e.id===t.metamodelRef),a=l.find(e=>e.id===o.objectRef),r=null===(i=null==s?void 0:null===(n=s.objecttypes)||void 0===n?void 0:n.find(e=>e.name&&(null==a?void 0:a.typeRef)===e.id))||void 0===i?void 0:i.name;return r},J=null==B?void 0:B.filter(e=>"Role"===U(C,V,G,e)),Z=null==B?void 0:B.filter(e=>"Task"===U(C,V,G,e));null==B||B.filter(e=>"Organisation"===U(C,V,G,e)),null==B||B.filter(e=>"Projects"===U(C,V,G,e));let $=null==B?void 0:B.filter(e=>null!=U(C,V,G,e));null==B||B.filter(e=>"Person"===U(C,V,G,e)),null==B||B.filter(e=>"Property"===U(C,V,G,e)),null==B||B.filter(e=>"Information"===U(C,V,G,e)),tc&&console.log("76",B,$);let{buttonLabel:q,className:Q}=e,[ee,et]=(0,s.useState)(!1),el=()=>et(!ee);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{style:{height:"22px"},color:"link",onClick:el,className:"jsx-221966332d5615e3 btn-context btn-link btn-sm float-right mb-0 py-0 pr-2",children:q}),(0,o.jsxs)(z.Z,{isOpen:ee,toggle:el,children:[(0,o.jsx)(W.Z,{toggle:el,children:"Set Context: "}),(0,o.jsxs)(X.Z,{children:[(0,o.jsxs)("div",{className:"jsx-221966332d5615e3 context-list1 border-bottom border-dark",children:["Current Context / Focus :",(0,o.jsx)("br",{className:"jsx-221966332d5615e3"}),(0,o.jsxs)("span",{className:"jsx-221966332d5615e3 context-item",children:["Model: ",(0,o.jsx)("strong",{className:"jsx-221966332d5615e3 focusValue",children:null===(r=e.phFocus)||void 0===r?void 0:null===(d=r.focusModel)||void 0===d?void 0:d.name})," "]}),(0,o.jsx)("br",{className:"jsx-221966332d5615e3"}),(0,o.jsxs)("span",{className:"jsx-221966332d5615e3 context-item",children:["Modelview: ",(0,o.jsx)("strong",{className:"jsx-221966332d5615e3 focusValue",children:null===(c=e.phFocus)||void 0===c?void 0:null===(p=c.focusModelview)||void 0===p?void 0:p.name})," "]}),(0,o.jsx)("br",{className:"jsx-221966332d5615e3"}),(0,o.jsxs)("span",{className:"jsx-221966332d5615e3 context-item",children:["Objectview: ",(0,o.jsx)("strong",{className:"jsx-221966332d5615e3 focusValue",children:null===(h=e.phFocus)||void 0===h?void 0:null===(u=h.focusObjectview)||void 0===u?void 0:u.name})," "]}),(0,o.jsx)("br",{className:"jsx-221966332d5615e3"}),(0,o.jsxs)("span",{className:"jsx-221966332d5615e3 context-item",children:["Focus Object: ",(0,o.jsx)("strong",{className:"jsx-221966332d5615e3 focusValue",children:null===(m=e.phFocus)||void 0===m?void 0:null===(g=m.focusObject)||void 0===g?void 0:g.name})," "]}),(0,o.jsx)("br",{className:"jsx-221966332d5615e3"}),(0,o.jsxs)("span",{className:"jsx-221966332d5615e3 context-item",children:["Org: ",(0,o.jsx)("strong",{className:"jsx-221966332d5615e3 focusValue",children:null===(f=e.phFocus)||void 0===f?void 0:null===(y=f.focusOrg)||void 0===y?void 0:y.name})," "]}),(0,o.jsx)("br",{className:"jsx-221966332d5615e3"}),(0,o.jsxs)("span",{className:"jsx-221966332d5615e3 context-item",children:["Proj: ",(0,o.jsx)("strong",{className:"jsx-221966332d5615e3 focusValue",children:null===(v=e.phFocus)||void 0===v?void 0:null===(b=v.focusProj)||void 0===b?void 0:b.name})," "]}),(0,o.jsx)("br",{className:"jsx-221966332d5615e3"}),(0,o.jsxs)("span",{className:"jsx-221966332d5615e3 context-item",children:["Role: ",(0,o.jsx)("strong",{className:"jsx-221966332d5615e3 focusValue",children:null===(w=e.phFocus)||void 0===w?void 0:null===(j=w.focusRole)||void 0===j?void 0:j.name})," "]}),(0,o.jsx)("br",{className:"jsx-221966332d5615e3"}),(0,o.jsxs)("span",{className:"jsx-221966332d5615e3 context-item",children:["Task: ",(0,o.jsx)("strong",{className:"jsx-221966332d5615e3 focusValue",children:null===(T=e.phFocus)||void 0===T?void 0:null===(k=T.focusTask)||void 0===k?void 0:k.name})," "]}),(0,o.jsx)("br",{className:"jsx-221966332d5615e3"}),(0,o.jsxs)("span",{className:"jsx-221966332d5615e3 context-item",children:["Template: ",(0,o.jsx)("strong",{className:"jsx-221966332d5615e3 focusValue",children:null===(O=e.phFocus)||void 0===O?void 0:null===(M=O.focusTemplateModel)||void 0===M?void 0:M.name})," "]}),(0,o.jsx)("br",{className:"jsx-221966332d5615e3"}),(0,o.jsxs)("span",{className:"jsx-221966332d5615e3 context-item",children:["TemplateModelview: ",(0,o.jsx)("strong",{className:"jsx-221966332d5615e3 focusValue",children:null===(D=e.phFocus)||void 0===D?void 0:null===(E=D.focusTemplateModelview)||void 0===E?void 0:E.name})," "]}),(0,o.jsx)("br",{className:"jsx-221966332d5615e3"}),(0,o.jsxs)("span",{className:"jsx-221966332d5615e3 context-item",children:["TargetModel: ",(0,o.jsx)("strong",{className:"jsx-221966332d5615e3 focusValue",children:null===(x=e.phFocus)||void 0===x?void 0:null===(R=x.focusTargetModel)||void 0===R?void 0:R.name})," "]}),(0,o.jsx)("br",{className:"jsx-221966332d5615e3"}),(0,o.jsxs)("span",{className:"jsx-221966332d5615e3 context-item",children:["TargetModelview: ",(0,o.jsx)("strong",{className:"jsx-221966332d5615e3 focusValue",children:null===(N=e.phFocus)||void 0===N?void 0:null===(A=N.focusTargetModelview)||void 0===A?void 0:A.name})," "]}),(0,o.jsx)("br",{className:"jsx-221966332d5615e3"})]}),(0,o.jsxs)("div",{className:"jsx-221966332d5615e3 select bg-light pt-0 ",children:[(0,o.jsx)(I,{type:"SET_FOCUS_TAB",selArray:Z,selName:"Tab",focustype:"focusTab"},"Tab"),(0,o.jsx)(I,{type:"SET_FOCUS_TASK",selArray:Z,selName:"Tasks",focustype:"focusTask"},"Task"),(0,o.jsx)(I,{type:"SET_FOCUS_ROLE",selArray:J,selName:"Roles",focustype:"focusRole"},"Role"),(0,o.jsx)(I,{type:"SET_FOCUS_OBJECTVIEW",selArray:$,selName:"Object(view)",focustype:"focusObjectview"},"Objectview"),(0,o.jsx)("hr",{style:{backgroundColor:"#ccc",padding:"1px",marginTop:"5px",marginBottom:"0px"},className:"jsx-221966332d5615e3"})]})]}),(0,o.jsx)(Y.Z,{children:(0,o.jsx)(H.Z,{color:"link",onClick:el,children:"Exit"})})]}),(0,o.jsx)(n(),{id:"221966332d5615e3",children:""})]})};var th=tp,tu=l(9381);let tm=!1,tg=e=>{var t;let l=(0,a.I0)();tm&&console.log("30 modelling",e.phList&&e.phList);let[i,r]=eE("memorystate",[]),[p,m]=(0,s.useState)(!1),[g,f]=(0,s.useState)(!0);tm&&console.log("41 modelling",e);let[y,v]=(0,s.useState)(!0),{query:b}=(0,c.useRouter)();tm&&console.log("modelling 48",b,b.repo,b.path,b.file),(0,s.useEffect)(()=>{tm||console.log("modelling 59",b,b.repo,b.path,b.file),b.repo&&b.file&&l({type:"LOAD_DATAGITHUB",query:b})},[b.file]),(0,s.useEffect)(()=>{if(!b.repo&&(tm||console.log("modelling 74",i),null!=i&&i.length>0&&i[0].phData&&window.confirm("Do you want to recover your last model project?")&&Array.isArray(i)&&i[0])){let e=i[0];e&&l({type:"LOAD_TOSTORE_PHDATA",data:e.phData})}},[]);let w=e?(0,o.jsx)(tr,{query:b}):(0,o.jsx)("div",{children:"loading"});return(0,o.jsxs)("div",{className:"jsx-e68dd2280b2096eb",children:[(0,o.jsx)(h.Z,{user:null===(t=e.phUser)||void 0===t?void 0:t.focusUser,children:(0,o.jsx)("div",{id:"index",className:"jsx-e68dd2280b2096eb",children:(0,o.jsxs)("div",{className:"jsx-e68dd2280b2096eb wrapper",children:[(0,o.jsxs)("div",{className:"jsx-e68dd2280b2096eb workplace",children:[(0,o.jsx)("div",{className:"jsx-e68dd2280b2096eb contextarea",children:(0,o.jsxs)("div",{className:"jsx-e68dd2280b2096eb help d-flex",children:[(0,o.jsx)(td.Z,{className:"setContext flex",ph:e}),(0,o.jsx)(th,{className:"ContextModal m-0 p-0",buttonLabel:"Context",phData:e.phData,phFocus:e.phFocus}),(0,o.jsx)(d(),{href:"/videos",children:"Video"})]})}),(0,o.jsx)("div",{style:{backgroundColor:"#eed",borderRadius:"5px 5px 5px 5px"},className:"jsx-e68dd2280b2096eb tasksarea mr-1",children:(0,o.jsx)(tu.Z,{})}),(0,o.jsx)("div",{style:{backgroundColor:"#ddd"},className:"jsx-e68dd2280b2096eb workarea p-1 w-100",children:y?(0,o.jsxs)(o.Fragment,{children:[" ",w," "]}):(0,o.jsx)(o.Fragment,{children:w})})]}),(0,o.jsx)("div",{className:"jsx-e68dd2280b2096eb footer",children:(0,o.jsx)(u.Z,{})})]})})}),(0,o.jsx)(n(),{id:"e68dd2280b2096eb",children:'.wrapper.jsx-e68dd2280b2096eb{display:grid;height:101%;min-height:101%;grid-gap:0px;grid-template-areas:"header""workplace""footer"}.workplace.jsx-e68dd2280b2096eb{grid-area:workplace;display:grid;height:101%;grid-template-columns:auto 1fr;grid-template-areas:"contextarea contextarea""tasksarea workarea"}.contextarea.jsx-e68dd2280b2096eb{grid-area:contextarea;display:grid;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;padding:0px;margin:0px;font-size:80%;background-color:#e8e8e8;color:#700;max-height:20px}.tasksarea.jsx-e68dd2280b2096eb{grid-area:tasksarea;padding:0px;margin-right:0px;padding-right:3px;border:2px;-webkit-border-radius:5px 5px 5px 5px;-moz-border-radius:5px 5px 5px 5px;border-radius:5px 5px 5px 5px;border-width:2px;background-color:#ffe}.workarea.jsx-e68dd2280b2096eb{grid-area:workarea;-webkit-border-radius:5px 5px 0px 0px;-moz-border-radius:5px 5px 0px 0px;border-radius:5px 5px 0px 0px;grid-template-columns:auto;grid-template-areas:"workpad"}.workpad.jsx-e68dd2280b2096eb{grid-area:workpad;display:grid;-webkit-border-radius:5px 5px 0px 0px;-moz-border-radius:5px 5px 0px 0px;border-radius:5px 5px 0px 0px}p.jsx-e68dd2280b2096eb{color:white}'})]})};var tf=(0,p.Z)((0,a.$j)(e=>e)(tg))}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[445,726,313,895,692,248,268,774,888,179],function(){return t(196)}),_N_E=e.O()}]);