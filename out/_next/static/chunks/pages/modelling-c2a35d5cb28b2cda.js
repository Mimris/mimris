(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[399],{13:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var l=i(4232);let n=function(e,t){let[i,n]=(0,l.useState)(()=>{try{var i,l;let n=null===(l=window)||void 0===l?void 0:null===(i=l.localStorage)||void 0===i?void 0:i.getItem(e);return n?JSON.parse(n):t}catch(e){return console.log(e),t}}),s=t=>{try{var l;let s=t instanceof Function?t(i):t;n(s),null===(l=window)||void 0===l||l.localStorage.setItem(e,JSON.stringify(s))}catch(e){console.log(e)}};return[i,s]}},679:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>eK});var l=i(7876),n=i(4250),s=i.n(n),r=i(4232),a=i(1777),d=i(8230),p=i.n(d),c=i(9099),u=i(13),h=i(5378),m=i(8943),f=i(6445),y=i(9371),g=i(4597),v=i(282),w=i(1774),b=i(33),T=i(1597),j=i(8801),O=i(672),k=i(2290),M=i(9160),R=i(5039),A=i.n(R),E=i(9619),D=i(4609),S=i(7621),N=i(2272),P=i(6196);class C extends S.Iy{get guidelineSnapDistance(){return this._guidelineSnapDistance}set guidelineSnapDistance(e){if("number"!=typeof e||isNaN(e)||e<0)throw Error("new value for GuideddraggingTool.guidelineSnapDistance must be a non-negative number");this._guidelineSnapDistance!==e&&(this._guidelineSnapDistance=e)}get isGuidelineEnabled(){return this._isGuidelineEnabled}set isGuidelineEnabled(e){if("boolean"!=typeof e)throw Error("new value for GuidedDraggingTool.isGuidelineEnabled must be a boolean value.");this._isGuidelineEnabled!==e&&(this._isGuidelineEnabled=e)}get horizontalGuidelineColor(){return this._horizontalGuidelineColor}set horizontalGuidelineColor(e){this._horizontalGuidelineColor!==e&&(this._horizontalGuidelineColor=e,this.guidelineHbottom.elements.first().stroke=this._horizontalGuidelineColor,this.guidelineHtop.elements.first().stroke=this._horizontalGuidelineColor)}get verticalGuidelineColor(){return this._verticalGuidelineColor}set verticalGuidelineColor(e){this._verticalGuidelineColor!==e&&(this._verticalGuidelineColor=e,this.guidelineVleft.elements.first().stroke=this._verticalGuidelineColor,this.guidelineVright.elements.first().stroke=this._verticalGuidelineColor)}get centerGuidelineColor(){return this._centerGuidelineColor}set centerGuidelineColor(e){this._centerGuidelineColor!==e&&(this._centerGuidelineColor=e,this.guidelineVcenter.elements.first().stroke=this._centerGuidelineColor,this.guidelineHcenter.elements.first().stroke=this._centerGuidelineColor)}get guidelineWidth(){return this._guidelineWidth}set guidelineWidth(e){if("number"!=typeof e||isNaN(e)||e<0)throw Error("New value for GuidedDraggingTool.guidelineWidth must be a non-negative number.");this._guidelineWidth!==e&&(this._guidelineWidth=e,this.guidelineVcenter.elements.first().strokeWidth=e,this.guidelineHcenter.elements.first().strokeWidth=e,this.guidelineVleft.elements.first().strokeWidth=e,this.guidelineVright.elements.first().strokeWidth=e,this.guidelineHbottom.elements.first().strokeWidth=e,this.guidelineHtop.elements.first().strokeWidth=e)}get searchDistance(){return this._searchDistance}set searchDistance(e){if("number"!=typeof e||isNaN(e)||e<=0)throw Error("new value for GuidedDraggingTool.searchDistance must be a positive number.");this._searchDistance!==e&&(this._searchDistance=e)}get isGuidelineSnapEnabled(){return this._isGuidelineSnapEnabled}set isGuidelineSnapEnabled(e){if("boolean"!=typeof e)throw Error("new value for GuidedDraggingTool.isGuidelineSnapEnabled must be a boolean.");this._isGuidelineSnapEnabled!==e&&(this._isGuidelineSnapEnabled=e)}clearGuidelines(){this.diagram.remove(this.guidelineHbottom),this.diagram.remove(this.guidelineHcenter),this.diagram.remove(this.guidelineHtop),this.diagram.remove(this.guidelineVleft),this.diagram.remove(this.guidelineVright),this.diagram.remove(this.guidelineVcenter)}doDeactivate(){super.doDeactivate(),this.clearGuidelines()}doDragOver(e,t){this.clearGuidelines();let i=this.copiedParts||this.draggedParts;if(null===i)return;let l=i.iterator;if(l.next()){let e=l.key;this.showHorizontalMatches(e,this.isGuidelineEnabled,!1),this.showVerticalMatches(e,this.isGuidelineEnabled,!1)}}doDropOnto(e,t){this.clearGuidelines();let i=this.copiedParts||this.draggedParts;if(null===i)return;let l=i.iterator;if(l.next()){let e=l.key,t=this.diagram.lastInput,i=this.isGuidelineSnapEnabled&&!t.shift;this.showHorizontalMatches(e,!1,i),this.showVerticalMatches(e,!1,i)}}invalidateLinks(e){e instanceof S.bP&&e.invalidateConnectedLinks()}showHorizontalMatches(e,t,i){var l;let n=e.locationObject.getDocumentBounds(),s=n.y,r=n.y+n.height/2,a=n.y+n.height,d=this.guidelineSnapDistance,p=this.searchDistance,c=n.copy();c.inflate(p,d+1);let u=null===(l=this.diagram)||void 0===l?void 0:l.findObjectsIn(c,e=>e.part,e=>e instanceof S.eS&&!e.isSelected&&!(e instanceof S.N_)&&e.isTopLevel&&null!==e.layer&&!e.layer.isTemporary,!0),h=d,m=null,f=S.P1.Default,y=S.P1.Default;if(u.each(t=>{if(t===e)return;let i=t.locationObject.getDocumentBounds(),l=i.y,n=i.y+i.height/2,d=i.y+i.height;Math.abs(r-n)<h&&(h=Math.abs(r-n),m=t,f=S.P1.Center,y=S.P1.Center),Math.abs(s-l)<h?(h=Math.abs(s-l),m=t,f=S.P1.Top,y=S.P1.Top):Math.abs(s-d)<h&&(h=Math.abs(s-d),m=t,f=S.P1.Top,y=S.P1.Bottom),Math.abs(a-l)<h?(h=Math.abs(a-l),m=t,f=S.P1.Bottom,y=S.P1.Top):Math.abs(a-d)<h&&(h=Math.abs(a-d),m=t,f=S.P1.Bottom,y=S.P1.Bottom)}),null!==m){let l=n.x-e.actualBounds.x,s=n.y-e.actualBounds.y,r=m.locationObject.getDocumentBounds(),a=Math.min(n.x,r.x)-10,d=Math.max(n.x+n.width,r.x+r.width)+10,p=new S.bR().setRectSpot(r,y);f===S.P1.Center?(i&&(e.move(new S.bR(n.x-l,p.y-n.height/2-s)),this.invalidateLinks(e)),t&&(this.guidelineHcenter.position=new S.bR(a,p.y),this.guidelineHcenter.elt(0).width=d-a,this.diagram.add(this.guidelineHcenter))):f===S.P1.Top?(i&&(e.move(new S.bR(n.x-l,p.y-s)),this.invalidateLinks(e)),t&&(this.guidelineHtop.position=new S.bR(a,p.y),this.guidelineHtop.elt(0).width=d-a,this.diagram.add(this.guidelineHtop))):f===S.P1.Bottom&&(i&&(e.move(new S.bR(n.x-l,p.y-n.height-s)),this.invalidateLinks(e)),t&&(this.guidelineHbottom.position=new S.bR(a,p.y),this.guidelineHbottom.elt(0).width=d-a,this.diagram.add(this.guidelineHbottom)))}}showVerticalMatches(e,t,i){var l,n;let s=e.locationObject.getDocumentBounds(),r=s.x,a=s.x+s.width/2,d=s.x+s.width,p=this.guidelineSnapDistance,c=this.searchDistance,u=s.copy();u.inflate(p+1,c);let h=null===(n=this)||void 0===n?void 0:null===(l=n.diagram)||void 0===l?void 0:l.findObjectsIn(u,e=>e.part,e=>e instanceof S.eS&&!e.isSelected&&!(e instanceof S.N_)&&e.isTopLevel&&null!==e.layer&&!e.layer.isTemporary,!0),m=p,f=null,y=S.P1.Default,g=S.P1.Default;if(h.each(t=>{if(t===e)return;let i=t.locationObject.getDocumentBounds(),l=i.x,n=i.x+i.width/2,s=i.x+i.width;Math.abs(a-n)<m&&(m=Math.abs(a-n),f=t,y=S.P1.Center,g=S.P1.Center),Math.abs(r-l)<m?(m=Math.abs(r-l),f=t,y=S.P1.Left,g=S.P1.Left):Math.abs(r-s)<m&&(m=Math.abs(r-s),f=t,y=S.P1.Left,g=S.P1.Right),Math.abs(d-l)<m?(m=Math.abs(d-l),f=t,y=S.P1.Right,g=S.P1.Left):Math.abs(d-s)<m&&(m=Math.abs(d-s),f=t,y=S.P1.Right,g=S.P1.Right)}),null!==f){let l=s.x-e.actualBounds.x,n=s.y-e.actualBounds.y,r=f.locationObject.getDocumentBounds(),a=Math.min(s.y,r.y)-10,d=Math.max(s.y+s.height,r.y+r.height)+10,p=new S.bR().setRectSpot(r,g);y===S.P1.Center?(i&&(e.move(new S.bR(p.x-s.width/2-l,s.y-n)),this.invalidateLinks(e)),t&&(this.guidelineVcenter.position=new S.bR(p.x,a),this.guidelineVcenter.elt(0).height=d-a,this.diagram.add(this.guidelineVcenter))):y===S.P1.Left?(i&&(e.move(new S.bR(p.x-l,s.y-n)),this.invalidateLinks(e)),t&&(this.guidelineVleft.position=new S.bR(p.x,a),this.guidelineVleft.elt(0).height=d-a,this.diagram.add(this.guidelineVleft))):y===S.P1.Right&&(i&&(e.move(new S.bR(p.x-s.width-l,s.y-n)),this.invalidateLinks(e)),t&&(this.guidelineVright.position=new S.bR(p.x,a),this.guidelineVright.elt(0).height=d-a,this.diagram.add(this.guidelineVright)))}}constructor(){super(),this._guidelineSnapDistance=6,this._isGuidelineEnabled=!0,this._horizontalGuidelineColor="gray",this._verticalGuidelineColor="gray",this._centerGuidelineColor="gray",this._guidelineWidth=1,this._searchDistance=1e3,this._isGuidelineSnapEnabled=!0;let e={layerName:"Tool",isInDocumentBounds:!1},t={stroke:"gray",isGeometryPositioned:!0},i=S.Ke.make;this.guidelineHtop=i(S.eS,e,i(S.yp,t,{geometryString:"M0 0 100 0"})),this.guidelineHbottom=i(S.eS,e,i(S.yp,t,{geometryString:"M0 0 100 0"})),this.guidelineHcenter=i(S.eS,e,i(S.yp,t,{geometryString:"M0 0 100 0"})),this.guidelineVleft=i(S.eS,e,i(S.yp,t,{geometryString:"M0 0 0 100"})),this.guidelineVright=i(S.eS,e,i(S.yp,t,{geometryString:"M0 0 0 100"})),this.guidelineVcenter=i(S.eS,e,i(S.yp,t,{geometryString:"M0 0 0 100"}))}}let x=!1;class _ extends r.Component{componentDidMount(){if(!this.diagramRef.current)return;let e=this.diagramRef.current.getDiagram();e instanceof S.yF&&e.addDiagramListener("ChangedSelection",this.props.onDiagramEvent)}componentWillUnmount(){if(!this.diagramRef.current)return;let e=this.diagramRef.current.getDiagram();e instanceof S.yF&&e.removeDiagramListener("ChangedSelection",this.props.onDiagramEvent)}initPalette(){let e;let t=S.Ke.make;{let r;e=t(S.es,{initialContentAlignment:S.P1.Top,maxSelectionCount:6,layout:t(S.JT,{sorting:S.JT.Forward,wrappingColumn:1}),draggingTool:new C,grid:t(S.Zk,"Grid",t(S.yp,"LineH",{stroke:"lightblue",strokeWidth:.5}),t(S.yp,"LineH",{stroke:"blue",strokeWidth:.5,interval:10}),t(S.yp,"LineV",{stroke:"lightblue",strokeWidth:.5}),t(S.yp,"LineV",{stroke:"blue",strokeWidth:.5,interval:10})),model:t(S.D7,{linkKeyProperty:"key"})}),r=t(S.bP,"Auto",new S.Of("visible"),new S.Of("stroke","strokecolor"),new S.Of("layerName","layer"),new S.Of("deletable"),new S.Of("scale","scale").makeTwoWay(),{name:"GROUP",resizable:!0,resizeObjectName:"SHAPE",selectionObjectName:"GROUP",selectionAdorned:!0,click:function(e,t){}},new S.Of("text","name"),new S.Of("scale","scale").makeTwoWay(),new S.Of("background","isHighlighted",function(e){return e?"rgba(255,0,0,0.2)":"transparent"}).ofObject(),{toolTip:t(S.h2,"Auto",t(S.yp,{fill:"lightyellow"}),t(S.VJ,{margin:8},new S.Of("text","",function(e){return P.rz(e,this.myMetis)})))},t(S.yp,"RoundedRectangle",{name:"SHAPE",fill:"transparent",stroke:"black",cursor:"grabbing"},new S.Of("fill","fillcolor"),new S.Of("stroke","strokecolor"),new S.Of("strokeWidth","strokewidth")),t(S.Zk,"Horizontal",{name:"PANEL",margin:new S.R5(4,0,0,2)},t(S.Zk,"Spot",{alignment:S.P1.Center,cursor:"grabbing"},t(S.VI,{name:"Picture",desiredSize:new S.or(30,30),margin:new S.R5(0,0,0,0)},new S.Of("source","icon",i)),t(S.VJ,s(),{background:"transparent",desiredSize:new S.or(30,30),textAlign:"center",stroke:"#466",margin:new S.R5(0,0,0,0),font:"24px 'FontAwesome'",editable:!1,isMultiline:!1,alignment:S.P1.Center},new S.Of("text","icon",l))),t(S.Zk,"Table",{defaultRowSeparatorStroke:"black",maxSize:new S.or(120,999),minSize:new S.or(128,25),margin:new S.R5(0,0,0,2),defaultAlignment:S.P1.Left},t(S.VJ,s(),{name:"name",font:"11pt Segoe UI,sans-serif",editable:!1,isMultiline:!0,minSize:new S.or(14,16),isMultiline:!0},new S.Of("text","name").makeTwoWay()))));let a=new S.T5;a.add("",r),e.nodeTemplateMap=a;let d=t(S.YJ,"Auto",new S.Of("text","name"),t(S.yp,"RoundedRectangle",{name:"SHAPE",fill:"lightyellow",stroke:"black"},new S.Of("fill","fillcolor"),new S.Of("stroke","strokecolor"),new S.Of("strokeWidth","strokewidth")),t(S.Zk,"Vertical",t(S.Zk,"Horizontal",{defaultRowSeparatorStroke:"black",maxSize:new S.or(100,999),minSize:new S.or(150,20),margin:new S.R5(6,10,0,3),defaultAlignment:S.P1.TopLeft},t(S.Gk,{column:2,width:4}),t(S.Zk,"Spot",{alignment:S.P1.Center,cursor:"grabbing"},t(S.VI,{name:"Picture",desiredSize:new S.or(30,30),margin:new S.R5(0,0,10,0)},new S.Of("source","icon",i)),t(S.VJ,s(),{background:"transparent",desiredSize:new S.or(30,30),textAlign:"center",stroke:"#666",margin:new S.R5(0,0,0,0),font:"18px 'FontAwesome'",editable:!1,isMultiline:!1,alignment:S.P1.Center},new S.Of("text","icon",n))),t(S.VJ,s(),{row:0,column:0,columnSpan:6,font:"11pt Segoe UI,sans-serif",editable:!0,isMultiline:!1,minSize:new S.or(80,40),name:"name"},new S.Of("text","name").makeTwoWay())))),p=new S.T5;p.add("",d),e.groupTemplateMap=p}return e;function i(e){if(x&&console.log("3238 findImage: ",e),""==e)return"";if(null==e?void 0:e.includes("//"))return x&&console.log("3249 Diagram",e),e;if(null==e?void 0:e.includes("/"))return x&&console.log("3250 Diagram",e),e;if(null==e?void 0:e.startsWith("<i ")){let t=e;return x&&console.log("3244",t),t}if(null==e?void 0:e.includes("<svg")){let e={image:"data:image/svg+xml;charset=UTF-8,image"};return x&&console.log("3269",e),e}{if(!(!(null==e?void 0:e.includes("images/"))&&(null==e?void 0:e.includes(".png"))))return"";let t="./../images/types/"+e;return x&&console.log("3273 Diagram",e,t),t}}function l(e){return e.includes("\\u")?String.fromCharCode(parseInt(e.slice(2),16)).toLowerCase():""}function n(e){return e.includes("\\u")?String.fromCharCode(parseInt(e.slice(2),16)).toLowerCase():""===e?String.fromCharCode(parseInt("\\uf07c".slice(2),16)).toLowerCase():e}function s(){return{font:"9pt  Segoe UI,sans-serif",stroke:"black"}}}render(){var e,t;let i="diagram-component-objects"===this.props.divClassName?"diagram-component-objects":"diagram-component-target"===this.props.divClassName?"diagram-component-target":"diagram-component-palette";return x&&console.log("296 Palette nodeDataArray",this.props.nodeDataArray),(0,l.jsx)(N.Vg,{ref:this.diagramRef,divClassName:i,initDiagram:this.initPalette,nodeDataArray:null===(e=this.props)||void 0===e?void 0:e.nodeDataArray,linkDataArray:null===(t=this.props)||void 0===t?void 0:t.linkDataArray,modelData:this.props.modelData,onModelChange:this.props.onModelChange,skipsDiagramUpdate:this.props.skipsDiagramUpdate,style:this.props.diagramStyle})}constructor(e){super(e),this.myMetis=e.myMetis,this.diagramRef=r.createRef(),this.initPalette=this.initPalette.bind(this)}}var I=i(8044),V=i(3022);let L=!1;class F extends r.Component{refreshNodeIndex(e){this.mapNodeKeyIdx.clear(),null==e||e.forEach((e,t)=>{this.mapNodeKeyIdx.set(null==e?void 0:e.key,t)})}refreshLinkIndex(e){this.mapLinkKeyIdx.clear(),null==e||e.forEach((e,t)=>{this.mapLinkKeyIdx.set(e.key,t)})}handleDiagramEvent(e){switch(e.name){case"InitialLayoutCompleted":{let e=this.state.nodeDataArray;for(let t=0;t<e.length;t++){let i=e[t];if(!i.fillcolor){let e=i.object;(null==e?void 0:e.fillcolor)&&(i.fillcolor=e.fillcolor)}}break}case"ChangedSelection":{var t,i,l,n,s;let r=e.subject.first();if(!r)break;let a=r.data,d=e.diagram,p=d.findNodeForKey(a.key);L&&console.log("122 data",a,r,r.data,e);let c=this.state.myMetis;L&&console.log("106 myMetis",c);let u=p.data.object;if(!u)break;let h=c.findObject(null==u?void 0:u.id);if(u=h||u,L&&console.log("110 obj",h),u){let e=new V.pJ(u),t=[];t.push(e),t.map(e=>{var t;let i={id:e.id,name:e.name};L&&console.log("120 data",i),null===(t=this.props)||void 0===t||t.dispatch({type:"SET_FOCUS_OBJECT",data:i})})}let m=null===(t=c.currentModelview.objectviews)||void 0===t?void 0:t.filter(e=>{var t;return(null===(t=e.object)||void 0===t?void 0:t.id)===(null==u?void 0:u.id)}),f=null==d?void 0:d.nodes;for(let e=null==f?void 0:f.iterator;null==e?void 0:e.next();){let t=e.value;t.data.object.id==u.id&&(t.isSelected=!0)}let y={id:"",name:""};m&&(null===(i=m[0])||void 0===i?void 0:i.id)&&(y={id:null===(n=m[0])||void 0===n?void 0:n.id,name:null===(s=m[0])||void 0===s?void 0:s.name}),L&&console.log("134 dataov",y),null===(l=this.props)||void 0===l||l.dispatch({type:"SET_FOCUS_OBJECTVIEW",data:y})}}}handleModelChange(e){let t=e.insertedNodeKeys,i=e.modifiedNodeData,l=e.removedNodeKeys,n=e.insertedLinkKeys,s=e.modifiedLinkData,r=e.removedLinkKeys,a=e.modelData,d=new Map,p=new Map;this.setState((0,D.jM)(e=>{let c=e.nodeDataArray;i&&i.forEach(t=>{d.set(t.key,t);let i=this.mapNodeKeyIdx.get(t.key);void 0!==i&&i>=0&&(c[i]=t,e.selectedData&&e.selectedData.key===t.key&&(e.selectedData=t))}),t&&t.forEach(e=>{let t=d.get(e),i=this.mapNodeKeyIdx.get(e);t&&void 0===i&&(this.mapNodeKeyIdx.set(t.key,c.length),c.push(t))}),l&&(e.nodeDataArray=c=c.filter(e=>!l.includes(e.key)),this.refreshNodeIndex(c));let u=e.linkDataArray;s&&s.forEach(t=>{p.set(t.key,t);let i=this.mapLinkKeyIdx.get(t.key);void 0!==i&&i>=0&&(u[i]=t,e.selectedData&&e.selectedData.key===t.key&&(e.selectedData=t))}),n&&n.forEach(e=>{let t=p.get(e),i=this.mapLinkKeyIdx.get(e);t&&void 0===i&&(this.mapLinkKeyIdx.set(t.key,u.length),u.push(t))}),r&&(e.linkDataArray=u=u.filter(e=>!r.includes(e.key)),this.refreshLinkIndex(u)),a&&(e.modelData=a),e.skipsDiagramUpdate=!0}))}handleInputChange(e,t,i){this.setState((0,D.jM)(l=>{let n=l.selectedData;if(n[e]=t,i){let e=n.key;if(e<0){let t=this.mapLinkKeyIdx.get(e);void 0!==t&&t>=0&&(l.linkDataArray[t]=n,l.skipsDiagramUpdate=!1)}else{let t=this.mapNodeKeyIdx.get(e);void 0!==t&&t>=0&&(l.nodeDataArray[t]=n,l.skipsDiagramUpdate=!1)}}}))}handleRelinkChange(e){let t=e.target.checked;this.setState({modelData:{canRelink:t},skipsDiagramUpdate:!1})}render(){let e;let t=this.state.selectedData;return L&&console.log("269 selectedData",t),null!==t&&(e=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{children:"Selected Object Properties:"}),(0,l.jsx)(I.E,{selectedData:this.state.selectedData,onInputChange:this.handleInputChange}),";"]})),L&&console.log("294 this.diagramStyle",this.state.diagramStyle),L&&console.log("295 this.state",this.state.nodeDataArray,this.state.linkDataArray),(0,l.jsx)("div",{children:(0,l.jsx)(_,{nodeDataArray:this.state.nodeDataArray,linkDataArray:this.state.linkDataArray,modelData:this.state.modelData,skipsDiagramUpdate:this.state.skipsDiagramUpdate,onDiagramEvent:this.handleDiagramEvent,onModelChange:this.handleModelChange,diagramStyle:this.state.diagramStyle})})}constructor(e){var t,i;super(e),L&&console.log("47 GoJSPaletteApp",this.props.nodeDataArray,this.props),this.state={nodeDataArray:null===(t=this.props)||void 0===t?void 0:t.nodeDataArray,linkDataArray:null===(i=this.props)||void 0===i?void 0:i.linkDataArray,modelData:{canRelink:!1},selectedData:null,skipsDiagramUpdate:!1,metis:this.props.metis,myMetis:this.props.myMetis,phFocus:this.props.phFocus,dispatch:this.props.dispatch,diagramStyle:this.props.diagramStyle},L&&console.log("55 myMetis",this.state.myMetis),this.mapNodeKeyIdx=new Map,this.mapLinkKeyIdx=new Map,this.refreshNodeIndex(this.state.nodeDataArray),this.refreshLinkIndex(this.state.linkDataArray),this.handleDiagramEvent=this.handleDiagramEvent.bind(this)}}let B=F;var G=i(1746);let K=!1,J=console.log.bind(console,"%c %s","background: blue; color: white"),W=console.log.bind(console,"%c %s","background: red; color: white");console.trace.bind(console,"%c %s","background: blue; color: white");let U=e=>{var t,i,n,s,d,p,c,u,h;K&&J("22 Palette",e),(0,a.wA)(),(0,r.useRef)({role:null,task:null,metamodelList:null,types:null});let[m,f]=(0,r.useState)(!0),[y,g]=(0,r.useState)(!0),[v,w]=(0,r.useState)(!0),[b,T]=(0,r.useState)("1"),[j,O]=(0,r.useState)([]),[k,M]=(0,r.useState)([]),[R,A]=(0,r.useState)([]),[D,S]=(0,r.useState)([]),[N,P]=(0,r.useState)(""),[C,x]=(0,r.useState)(""),[_,I]=(0,r.useState)([]),[V,L]=(0,r.useState)(!1),[F,U]=(0,r.useState)(""),[z,H]=(0,r.useState)("top"),Y=e=>{H(e)},Z=null===(t=e.phFocus)||void 0===t?void 0:t.focusModel,q=null===(i=e.metis)||void 0===i?void 0:i.models,X=null===(n=e.metis)||void 0===n?void 0:n.metamodels;if(!X)return null;let $=null==q?void 0:q.find(e=>(null==e?void 0:e.id)===(null==Z?void 0:Z.id)),Q=null==X?void 0:X.find(e=>(null==e?void 0:e.id)===(null==$?void 0:$.metamodelRef)),ee=null==X?void 0:null===(s=X.filter(e=>(null==e?void 0:e.id)!==void 0&&(null==e?void 0:e.name)!=="AKM-ADMIN_MM"))||void 0===s?void 0:s.map(e=>({id:null==e?void 0:e.id,name:null==e?void 0:e.name}));K&&console.log("47",$,Q,X,ee);let et=e.gojsMetaModel;K&&console.log("50 Palette start",et,e);let ei=[];function el(){f(!m)}null===(d=e.phFocus)||void 0===d||d.focusTask;let eo=E.S4(e.myMetis.currentMetamodel,e.myMetis).nodes;K&&console.log("65 Palette",null==$?void 0:$.name,null==Q?void 0:Q.name,eo);let en=null===(c=e.myMetis)||void 0===c?void 0:null===(p=c.metamodels)||void 0===p?void 0:p.find(e=>(null==e?void 0:e.name)==="AKM-Core_MM"),es=null===(h=e.myMetis)||void 0===h?void 0:null===(u=h.metamodels)||void 0===u?void 0:u.find(e=>(null==e?void 0:e.name)==="AKM-IRTV_MM");if(K&&console.log("76 Palette",N,C,ee,_,ei),(0,r.useEffect)(()=>{var t,i;K&&W("89 Palette useEffect 1 [] "),(null==Q?void 0:Q.name)==="AKM-OSDU_MM"&&f(!0);let{focusRole:l,focusTask:n}=e.phFocus,s=null==Q?void 0:Q.objecttypes;if(!X)return null;"metamodel"===e.modelType&&f(!1),P(l),x(n);let r=null==s?void 0:s.map(e=>null==e?void 0:e.name);I(r),r&&S(er(r,Q)),K&&console.log("89 Palette useEffect 1",Q,e);let a=null==(en=null===(i=e.myMetis)||void 0===i?void 0:null===(t=i.metamodels)||void 0===t?void 0:t.find(e=>(null==e?void 0:e.name)==="AKM-Core_MM"))?void 0:en.objecttypes.map(e=>null==e?void 0:e.name),d=null==(es=X.find(e=>(null==e?void 0:e.name)==="AKM-IRTV_MM"))?void 0:es.objecttypes.map(e=>null==e?void 0:e.name),p=(null==en?void 0:en.name)===(null==Q?void 0:Q.name)?es:en,c=null==p?void 0:p.objecttypes.map(e=>null==e?void 0:e.name);U(null==p?void 0:p.name),K&&console.log("115 Palette",p),L(null==p?void 0:p.name),A(er(a,en)),M(er(d,es)),O(er(c,p));let u=setTimeout(()=>{g(!y),K&&console.log("124 Palette useEffect ",d,k)},1e3);return()=>clearTimeout(u)},[]),!X)return null;let er=(t,i)=>{var l;K&&console.log("106 Palette",i,e.myMetis);let n=null===(l=e.myMetis)||void 0===l?void 0:l.findMetamodel(null==i?void 0:i.id);K&&console.log("109 Palette",e.myMetis,n);let s=E.S4(n,e.myMetis);if(K&&console.log("118 Palette",t,n,s,null==s?void 0:s.nodes),!((null==t?void 0:t.length)>0))return eo;{let e=t.map(e=>null==s?void 0:s.nodes.find(t=>(K&&console.log("123 Palette",null==t?void 0:t.name,e,(null==t?void 0:t.name)===e),(null==t?void 0:t.name)===e&&t))).filter(Boolean);K&&console.log("122 Palette",e);let l="AKM-Core_MM"===i.name?["Container","EntityType","RelshipType","Property","Datatype","Value","Fieldtype","InputPattern","ViewFormat","Method","MethodType"]:"AKM-IRTV_MM"===i.name?["Container","Information","Role","Task","View"]:["Container","OSDUType","Property","Proxy","Array","Item"];return e.sort((e,t)=>{let i=l.indexOf(null==e?void 0:e.name),n=l.indexOf(null==t?void 0:t.name);return -1===i?1:-1===n?-1:i-n}),e}};function ea(e){var t;U(ee[e].name),console.log("143 Palette",e,ee[e],F);let i=ee[e],l=X.find(e=>e.id===(null==i?void 0:i.id)),n=(null==l?void 0:null===(t=l.objecttypes)||void 0===t?void 0:t.map(e=>null==e?void 0:e.name))||[];K&&console.log("147 Palette",e,ee[e],F,i,n,l);let s=er(n,l);K&&console.log("149 Palette",s);let r=setTimeout(()=>{O(s),g(!y)},200);return()=>clearTimeout(r)}K&&console.log("127 Palette useEffect 2",e.phFocus.focusTask.workOnTypes),ee&&ee.length>0&&(l.Fragment,null==ee||ee.map((e,t)=>(null==e?void 0:e.name)!==(null==Q?void 0:Q.name)&&(0,l.jsx)("option",{value:t,children:null==e?void 0:e.name},t)));let ed=Q&&D&&(0,l.jsxs)("details",{open:"top"===z,onClick:()=>Y("top"),className:"metamodel-pad",children:[(0,l.jsx)("summary",{className:"mmname mx-0 px-1 my-0",style:{fontSize:"16px",backgroundColor:"#9cd",minWidth:"184px",maxWidth:"212px"},children:null==Q?void 0:Q.name}),(0,l.jsx)(B,{nodeDataArray:D,linkDataArray:[],metis:e.metis,myMetis:e.myMetis,phFocus:e.phFocus,dispatch:e.dispatch,diagramStyle:{height:"76vh"}})]}),ep=Q&&(null==Q?void 0:Q.name)!=="AKM-IRTV_MM"&&k&&(0,l.jsxs)("details",{open:"irtv"===z,onClick:()=>Y("irtv"),className:"metamodel-pad",children:[(0,l.jsx)("summary",{className:"mmname mx-0 px-1",style:{fontSize:"16px",backgroundColor:"#9cd",minWidth:"184px",maxWidth:"212px"},children:null==es?void 0:es.name}),(0,l.jsx)(B,{nodeDataArray:k,linkDataArray:[],myMetis:e.myMetis,metis:e.metis,phFocus:e.phFocus,dispatch:e.dispatch,diagramStyle:{height:"37vh"}})]}),ec=Q&&R&&(0,l.jsxs)("details",{open:"core"===z,onClick:()=>Y("core"),className:"metamodel-pad",children:[(0,l.jsx)("summary",{className:"mmname mx-0 px-1 my-1",style:{fontSize:"16px",backgroundColor:"#9cd",minWidth:"184px",maxWidth:"212px"},children:null==en?void 0:en.name}),(0,l.jsx)(B,{nodeDataArray:R,linkDataArray:[],myMetis:e.myMetis,metis:e.metis,phFocus:e.phFocus,dispatch:e.dispatch,diagramStyle:{height:"65vh"}})]}),eu=(0,l.jsx)(G.A,{taskFocusModel:void 0,asPage:!1,visible:!0,props:e}),eh=(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{children:[ed,ec,ep]})}),em=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{className:"btn-sm text-light bg-transparent border border-0 border-transparent",onClick:el,children:[" ",m?(0,l.jsxs)("span",{className:"fs-8",children:[(0,l.jsx)("i",{className:"fa fa-lg fa-angle-left pull-right-container"}),"  Palette: Obj. Types "]}):(0,l.jsx)("i",{className:"fa fa-lg fa-angle-right pull-right-container"})]}),(0,l.jsxs)("div",{className:"d-flex justify-content-left",children:[(0,l.jsx)("div",{children:m?y?(0,l.jsx)(l.Fragment,{children:eh}):(0,l.jsxs)(l.Fragment,{children:[" ",eh,"  "]}):(0,l.jsxs)("div",{className:"btn-vertical d-flex justify-content-between fs-7",style:{height:"82vh",maxWidth:"4px",padding:"2px",fontSize:"12px",fontWeight:"bold"},children:[(0,l.jsx)("span",{children:" P a l e t t e - S o u r c e - M e t a m o d e l"})," "]})}),(0,l.jsx)("div",{className:"ps-1 m-0 bg-transparent",children:eu})]})]});return K&&J("244 Palette",e),e.metis?(0,l.jsx)(l.Fragment,{children:em}):(0,l.jsx)(l.Fragment,{children:"No metamodels found"})};var z=i(4987),H=i(2566),Y=i(3060),Z=i(5554),q=i(3172),X=i(1445),$=i(8466),Q=i(6248),ee=i(7089),et=i(7662),ei=i(2210),el=i(8296),eo=i(1457),en=i(2588);let es=!1,er=["Element","Entity","Property","Datatype","Method","Unittype","Value","FieldType","InputPattern","ViewFormat","Generic","Container"];class ea extends r.Component{handleOpenModal(e,t){this.setState({selectedData:e,modalContext:t,selectedOption:null,showModal:!0}),es&&console.log("90 node",this.state.selectedData)}handleCloseModal(e){var t,i,l;es&&console.log("109 handleCloseModal");let n=this.state.modalContext;if(!n)return;let s=null===(t=n.context)||void 0===t?void 0:t.myDiagram,r=null===(i=n.context)||void 0===i?void 0:i.link;if(n.data,"x"===e){s.remove(r),this.setState({showModal:!1,selectedData:null,modalContext:null});return}this.props;let a=null===(l=n.selected)||void 0===l?void 0:l.value;a||(a=n.typename),es&&console.log("113 typename: ",a),es&&console.log("122 modalContext",n);let d={data:n.data,metamodel:n.myMetamodel,typename:a,fromType:n.fromType,toType:n.toType,nodeFrom:n.nodeFrom,nodeTo:n.nodeTo,context:n.context};es&&console.log("128 args",d),ei.TL(d),this.setState({showModal:!1,selectedData:null,modalContext:null})}handleModelChange(e){e.insertedNodeKeys,e.modifiedNodeData,e.removedNodeKeys,e.insertedLinkKeys,e.modifiedLinkData,e.removedLinkKeys,e.modelData}addToNode(e,t){let i={key:t.data.key,name:t.data.name,loc:new String(t.data.loc),scale:Number(t.data.scale),size:new String(t.data.size),template:t.data.template,figure:t.data.figure,geometry:t.data.geometry,fillcolor:t.data.fillcolor,fillcolor2:t.data.fillcolor2,strokecolor:t.data.strokecolor,strokecolor2:t.data.strokecolor2,textcolor:t.data.textcolor,strokewidth:Number(t.data.strokewidth),textscale:Number(t.data.textscale),icon:t.data.icon};if(e.push(i),t.data.isGroup)for(let i=t.memberParts.iterator;null==i?void 0:i.next();){let t=i.value;t instanceof S.bP&&t&&this.addToNode(e,t)}}getNode(e,t){let i=null==e?void 0:e.nodes;if(i)for(let e=0;e<(null==i?void 0:i.length);e++){let l=i[e];if(l&&l.key===t)return l}return null}getLink(e,t){let i=e.links;if(i)for(let e=0;e<i.length;e++){let l=i[e];if(l&&l.key===t)return l}return null}isSystemType(e){for(let t=0;t<er.length;t++){let i=er[t];if(e.name===i)return!0}return!1}isMetamodelType(e){let t=!1;return(e===eo.types.OBJECTTYPE||e===eo.types.RELATIONSHIPTYPE)&&(t=!0),t}isSourceNode(e,t){let i=!1;for(let l=0;l<e.length;l++){let n=e[l],s=t;if(n.key===s){i=!0;break}}return i}handleDiagramEvent(e){var t,i,l,n,s,r,a,d,p,c,u,h,m,f,y,g,v,w;let b=this.state.dispatch,T=e.name,j=e.diagram,O=this.state.myMetis;O.relinked=!1;let k=null==O?void 0:O.findModel(null===(i=this.state.phFocus)||void 0===i?void 0:null===(t=i.focusModel)||void 0===t?void 0:t.id),M=null==O?void 0:O.findModelView(null===(n=this.state.phFocus)||void 0===n?void 0:null===(l=n.focusModelview)||void 0===l?void 0:l.id);M||(M=null==O?void 0:O.currentModelview);let R=null==k?void 0:k.getMetamodel(),A=this.state.myMetis.gojsModel,E=[],D=[],N=[],C=[],x=[],_=[],I=[],L=[],F=[],B=!1,G=!1,K={myMetis:O,myMetamodel:R,myModel:k,myModelview:M,myGoModel:O.gojsModel,myDiagram:j,dispatch:b,pasted:G,done:B,askForRelshipName:null==M?void 0:M.askForRelshipName,includeInheritedReltypes:null==M?void 0:M.includeInheritedReltypes,handleOpenModal:this.handleOpenModal,modifiedObjects:[],modifiedRelships:[],modifiedObjectViews:[],modifiedRelshipViews:[],modifiedObjectTypes:[],modifiedRelshipTypes:[],modifiedObjectTypeViews:[],modifiedRelshipTypeViews:[],modifiedObjectTypeGeos:[],modifiedModelviews:[]};switch(es&&console.log("265 handleDiagramEvent - context",T,this.state,K),es&&console.log("266 handleEvent",O),es&&console.log("267 this",this),es&&console.log("268 event name",T),T){case"InitialLayoutCompleted":{es&&console.log("Begin: After Reload:");let e=M.objectviews;M.objectviews=en.EL(e),e=M.objectviews;for(let t=0;t<(null==e?void 0:e.length);t++){let i=e[t];if(!i.typeview){let e=k.findObject(i.objectRef);if(e){let t=R.findObjectType(e.typeRef);if(t){let e=R.findObjectTypeView(t.typeviewRef);i.typeview=e,i.typeviewRef=null==e?void 0:e.id}}}}let t=null===(s=O.currentModelview)||void 0===s?void 0:s.focusObjectview;for(let i=0;i<(null==e?void 0:e.length);i++){let l=e[i],n=l.object;if(!n)continue;let s=n.type;s||(s=R.findObjectTypeByName(n.typeName),n.type=s);let r=null==A?void 0:A.findNodeByViewId(l.id);if(r){for(let e=j.nodes;null==e?void 0:e.next();){let t=e.value,i=t.data;i.key===r.key&&(i.scale=Number(r.scale),es&&console.log("300 objview, goNode, node: ",l,r,t,i),i.textcolor="black")}let e=j.findNodeForKey(null==r?void 0:r.key);e&&r.scale&&(e.scale=Number(r.scale))}if(l.id===(null==t?void 0:t.id)){let e=A.findNodeByViewId(l.id);if(e){let t=j.findNodeForKey(null==e?void 0:e.key);j.select(t)}}}if(es&&console.log("End: After Reload:"),j.links.count>0){O.currentModelview.objectviews;let e=j.nodes,t=[];for(let i=e.iterator;null==i?void 0:i.next();){let e=i.value,l=e.data;if("Object type"===l.category)continue;e.loc=l.loc,e.size=l.size,e.fillcolor=l.fillcolor,e.strokecolor=l.strokecolor;let n=l.object,s=l.objectview,r=(null==n?void 0:n.image)?n.image:null==s?void 0:s.image;r&&j.model.setDataProperty(l,"image",r);let a=new V.g_(s);t.push(a)}let i=[],l=j.links;for(let e=l.iterator;null==e?void 0:e.next();){let t=e.value,l=t.data;if("Relationship"===l.category){let e=l.relshipview;if((e=M.findRelationshipView(l.key))||(e=O.findRelationshipView(l.key)),e){if(e.markedAsDeleted=l.markedAsDeleted,!1===e.visible)i.push(t);else{let i=e.points;if((null==i?void 0:i.length)==0||(null==i?void 0:i.length)==4){t.points=[],e.points=[];let i=new V.GI(e);F.push(i)}}}}}for(let e=0;e<i.length;e++){let t=i[e];j.remove(t)}}break}case"TextEdited":{let t=e.subject.part,i=t.data,l=i.name;"Label"===i.typename&&(l=i.text);let n=e.subject.name;if(""===n&&(n="name"),t instanceof S.bP){let e=i.key,t=A.findNode(e),s=l;if(i.category===eo.gojs.C_OBJECTTYPE){if("Edit name"===s&&(s=prompt("Enter name")),i){i.name=s,ei.fs(i,n,s,K);let e=O.findObjectType(null===(r=i.objecttype)||void 0===r?void 0:r.id);if(e){let t={id:e.id,name:s};j.dispatch({type:"UPDATE_OBJECTTYPE_PROPERTIES",data:t})}}}else{"Edit name"===s&&(i.name=s=prompt("Enter name"));let r=M.findObjectView(e);if(r){let e=r.object;if(e){if(t.objRef=e.id,t.text=l,t.name=s,e=ei.jq(t,n,s,K)){e.name=s,e.text=l;let t=e.objectviews;for(let e=0;e<t.length;e++){let i=t[e];i.name=s,i.text=l;let n=A.findNodeByViewId(null==i?void 0:i.id);if(n){j.findNodeForKey(n.key).name=s;let e=new V.g_(i);e.name=s,e.text=s,L.push(e);let t=JSON.parse(JSON.stringify(e));K.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})}}}if(e){let t=new V.pJ(e);t.text=l,_.push(t);let i=JSON.parse(JSON.stringify(t));K.dispatch({type:"UPDATE_OBJECT_PROPERTIES",data:i})}}}}let a=null==A?void 0:A.nodes;for(let e=0;e<(null==a?void 0:a.length);e++){let t=a[e];if(t.key===i.key){t.name=i.name;break}}}if(t instanceof S.N_){let e=i.key,t=i.nameFrom?i.nameFrom:i.name,l=i.typename;if(l===eo.gojs.C_RELSHIPTYPE){let n=this.getLink(K.myGoMetamodel,e);if(n){if("Edit name"===t&&(l=t=prompt("Enter name"),i.name=t),ei._3(n,"name",t,K),i.name=n.name,n.reltype){let e=new V.Mq(n.reltype,!0);C.push(e)}null===(a=j.model)||void 0===a||a.setDataProperty(n.data,"name",n.name)}}else{let l=i.relshipview;if(l||(l=M.findRelationshipView(e)),l){"Edit name"===t&&(i.name=t=prompt("Enter name"));let e=l.relship;if(e){(e=k.findRelationship(e.id))&&(e.name=t);let l=eo.props.DRAFT;e.setStringValue2(l,t);let n=e.relshipviews;for(let l=0;l<(null==n?void 0:n.length);l++){let s=n[l];if(s.name=t,"Is"===t){e.relshipkind="Generalization",s.toArrow="Triangle",i.toArrow="Triangle";let t=j.findLinkForKey(i.key);j.model.setDataProperty(t.data,"toArrow",i.toArrow)}let r=new V.GI(s);F.push(r);let a=new V.w(e);I.push(a),I.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),e&&j.dispatch({type:"UPDATE_RELSHIP_PROPERTIES",data:t})}),F.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),e&&j.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})})}}}}}return}case"SelectionMoved":{let t=K.myGoModel,i=K.myModelview,l=i.relshipviews;i.relshipviews=en.EL(l);let n=j.toolManager.draggingTool.draggedParts,s=[];for(let e=n.iterator;null==e?void 0:e.next();){if(e.value,e.value.point.x,e.value.point.y,"Object"!==e.key.data.category)continue;let t=i.findObjectView(e.key.data.key);if(!t)continue;i.repairObjectView(t);let l=t.object;l=k.findObject(null==l?void 0:l.id);let n=Number(t.scale);n||(n=1);let r="";e.key.data.group&&(r=e.key.data.group);let a={key:e.key.data.key,name:e.key.data.name,group:r,isGroup:e.key.data.isGroup,loc:t.loc,size:t.size,scale:n,object:l,objectview:t};s.push(a)}let r=[],a=e.subject;for(let e=a.iterator;null==e?void 0:e.next();){let i=e.value;if(i instanceof S.N_)continue;let l=i.data.loc,n=t.findNode(i.data.key);if(!n)continue;n.loc=l;let s=i.actualBounds.width+" "+i.actualBounds.height,a=ei.kj(t,l,s,n),d="";a?(d=i.data.group,n.scale=n.getMyScale(t)):n.scale=1;let p={n:i,gjsData:i.data,key:i.data.key,name:i.data.name,group:d,isGroup:i.data.isGroup,loc:n.loc,size:s,scale:Number(n.scale),object:i.data.object,objectview:i.data.objectview,objecttype:i.data.objecttype,typeview:i.data.typeview};r.push(p),j.model.setDataProperty(i.data,"group",d)}for(let e=0;e<s.length;e++){let l=s[e];for(let e=0;e<r.length;e++){let n=r[e];if(l.key===n.key){let e=t.findNode(n.key);l.object;let s=l.objectview;s.loc=n.loc,s.group=n.group,s.scale=n.scale;let r=ei.V_(n.gjsData,l.loc,n.loc,t,j,O,L);r&&(!(r=t.findNode(r.key))instanceof et.mC&&(t=t.fixGoModel()),r.loc=n.loc.valueOf(),r.size=n.size,r.scale=n.scale);let a=ei.kj(t,r.loc,r.size,r),c=null==a?void 0:a.objectview;if(c||(c=i.findObjectView(null==a?void 0:a.objviewRef)),a&&c){let e=n.gjsData;r.group=a.key,c.isExpanded=!0,s.group=a.key,j.model.setDataProperty(e,"group",r.group),r.scale=r.getMyScale(t),e.scale=Number(r.scale),s.scale=e.scale,j.model.setDataProperty(n.n,"scale",e.scale),s.loc=n.loc,j.model.setDataProperty(n.n,"loc",n.loc);let i=[],l=null==s?void 0:s.inputrelviews;(null==l?void 0:l.length)>0&&(s.purgeInputRelviews(),l=s.inputrelviews);for(let e=0;e<(null==l?void 0:l.length);e++){let t=l[e];if(t){let e=t.fromObjview;if(null==e?void 0:e.isGroup){let l=t.relship,n=l.fromObject,s=null==c?void 0:c.object,a=l.toObject,d=r.object;c&&(null==n?void 0:n.id)!==(null==s?void 0:s.id)&&(l.relocate(n,s,a,d),t.relocate(e,c));let p=l.type;if(p.name===eo.types.AKM_HAS_MEMBER||p.name===eo.types.AKM_HAS_PART){t.markedAsDeleted=!0;let e=j.findLinkForKey(t.id);e&&j.remove(e)}i.push(t);let u=new V.w(t.relship);ei.oK(I,u);let h=new V.GI(t);h&&ei.oK(F,h)}}}let d=null==s?void 0:s.outputrelviews;(null==d?void 0:d.length)>0&&(s.purgeOutputRelviews(),d=s.outputrelviews);for(let e=0;e<(null==d?void 0:d.length);e++){let t=d[e];if(t){let e=t.toObjview;if(null==e?void 0:e.isGroup){let i=t.relship,l=i.fromObject,n=null==c?void 0:c.object,s=i.toObject,a=r.object;c&&(null==l?void 0:l.id)!==(null==n?void 0:n.id)&&(i.relocate(l,n,s,a),t.relocate(e,c),t.markedAsDeleted=!0)}i.push(t);let l=j.findLinkForKey(t.id);l&&t.markedAsDeleted&&j.remove(l)}let l=j.model.linkDataArray;for(let e=0;e<l.length&&l[e].key!==t.id;e++);let n=new V.w(t.relship);ei.oK(I,n);let s=new V.GI(t);ei.oK(F,s)}}else{r.group="";let e=n.gjsData;j.model.setDataProperty(e,"group",r.group);let l=r.object;l||(l=k.findObject(r.objRef));let a=r.objectview;a||(a=i.findObjectView(r.objviewRef)),n.group=r.group,j.model.setDataProperty(e,"group",n.group),e.scale=Number(r.scale),s.scale=e.scale,j.model.setDataProperty(n.n,"scale",e.scale),s.group=r.group;let c=null==a?void 0:a.inputrelviews;(null==c?void 0:c.length)>0&&a.purgeInputRelviews();let u=null==l?void 0:l.inputrels;for(let e=0;e<(null==u?void 0:u.length);e++){let l=u[e],n=l.fromObject;if(!n.objectviews)continue;let s=i.findObjectViewsByObject(n)[0];if(null==s?void 0:s.isGroup){let e;s.object;let n=s,c=i.findRelationshipViewsByRel2(l,s,a,!0);if((null==c?void 0:c.length)>0){(e=c[0]).markedAsDeleted=!1,a.group=r.group;let i=new V.g_(a);L.push(i),e.toObjview=a,e.points=[];let l=new V.GI(e);F.push(l);let n=t.findNodeByViewId(s.id),d=t.findNodeByViewId(a.id);if(n&&d){d.group=r.group;let e=j.findNodeForKey(d.key);e.group=r.group,e.data.group=r.group,j.model.setDataProperty(e,"group",e.group)}}else{e=new ee.Zc(en.gj(),l.name,l),s.addOutputRelview(e),a.addInputRelview(e),e.fromObjview=n,e.toObjview=a,e.points=[],l.addRelationshipView(e);let t=new V.GI(e);t&&ei.oK(F,t);let r=new V.w(l);r&&ei.oK(I,r),i.addRelationshipView(e)}let u=j.findLinkForKey(null==e?void 0:e.id);if(!u&&e){j.startTransaction("AddLink");let i=new et.gR(e.id,t,e);i.loadLinkContent(t),i.fromNode=P.Sr(n.id,j),i.from=null===(d=i.fromNode)||void 0===d?void 0:d.key,i.toNode=P.Sr(a.id,j),i.to=null===(p=i.toNode)||void 0===p?void 0:p.key,i.points=[],t.addLink(i),j.model.addLinkData(i),P.tO(j.links,O,j),j.commitTransaction("AddLink")}else u&&P.tO(j.links,O,j)}else{let e=i.findRelationshipViewsByRel(l,!0);if((null==e?void 0:e.length)>0){let t=e[0];t.markedAsDeleted=!1,t.toObjview=a,t.points=[];let i=new V.GI(t);F.push(i)}}}}if(e.key!==n.group&&(e.scale=n.scale,e.loc=n.loc,e.group=n.group),e.object){let t={id:e.key,name:e.name},i={id:e.object.id,name:e.object.name};j.dispatch({type:"SET_FOCUS_OBJECTVIEW",data:t}),j.dispatch({type:"SET_FOCUS_OBJECT",data:i})}let u=new V.g_(s);u&&ei.oK(L,u)}}}{let e=j.links;for(let t=e.iterator;null==t?void 0:t.next();){let e=t.value,l=i.findRelationshipView(e.data.key);if(!l)continue;let n=i.relshipviews;for(let t=0;t<(null==n?void 0:n.length);t++){let s=n[t];if(s.id===l.id){let t=[];for(let i=e.points.iterator;null==i?void 0:i.next();){let e=i.value;t.push(e.x),t.push(e.y)}s.points=t;let l=new V.GI(s);l&&ei.oK(F,l),i.addRelationshipView(s)}}}P.tO(e,O,j)}let c=[];c.push(new V.Yp(i)),c.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),j.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:t})});break}case"SelectionDeleting":{let t=!0,i=!1,l=e.subject,n=l.first().data,s=this.isMetamodelType(n.category);if(s){confirm("If instances exists, do you want to change their types instead of deleting?")&&(i=!0);let e=[];for(let n=null==l?void 0:l.iterator;null==n?void 0:n.next();){let s=n.value.data;if(!s.markedAsDeleted){if(s.category===eo.gojs.C_OBJECTTYPE){let t=O.findObjectType(null===(c=s.objecttype)||void 0===c?void 0:c.id);if(t){let i=t.inputreltypes;for(let t=0;t<(null==i?void 0:i.length);t++){let l=i[t];-1===e.indexOf(l)&&e.push(l)}let l=t.outputreltypes;for(let t=0;t<(null==l?void 0:l.length);t++){let i=l[t];-1===e.indexOf(i)&&e.push(i)}}}else if(s.category===eo.gojs.C_RELSHIPTYPE){let t=O.findRelationshipType(null===(u=s.reltype)||void 0===u?void 0:u.id);t&&-1===e.indexOf(t)&&e.push(t)}for(let e=null==l?void 0:l.iterator;null==e?void 0:e.next();){let l=e.value.data;if(l.key,l.type,l.category===eo.gojs.C_RELSHIPTYPE){let e=O.findRelationshipTypeByName(eo.types.AKM_GENERIC_REL),n=O.findRelationshipType(null===(h=l.reltype)||void 0===h?void 0:h.id);if(n){let l=O.getRelationshipsByType(n,!1);if(l.length>0){if(i)for(let t=0;t<l.length;t++){let i=l[t];i.type=e,i.typeview=e.typeview;let n=new V.w(i);I.push(n)}else for(let e=0;e<l.length;e++){let i=l[e];i.markedAsDeleted=t;let n=new V.w(i);I.push(n)}}n.markedAsDeleted=t,ei.cH(n,t);let s=n.typeview;if(s){s.markedAsDeleted=t;let e=new V.KW(s);x.push(e)}let r=new V.Mq(n,!0);C.push(r)}}}for(let e=null==l?void 0:l.iterator;null==e?void 0:e.next();){let l=e.value.data;if(l.key,l.type,l.category===eo.gojs.C_OBJECTTYPE){let e=O.findObjectTypeByName("Generic"),n=O.findObjectType(null===(m=l.objecttype)||void 0===m?void 0:m.id);if(n){let l=O.getObjectsByType(n,!0);if(l.length>0){if(i)for(let t=0;t<l.length;t++){let i=l[t];i.type=e,i.typeview=e.typeview;let n=new V.pJ(i);_.push(n)}else for(let e=0;e<l.length;e++){let i=l[e];i.markedAsDeleted=t;let n=new V.pJ(i);_.push(n)}}let s=n.typeview;if(s){s.markedAsDeleted=t;let e=new V.mX(s);D.push(e)}let r=K.myMetamodel.findObjtypeGeoByType(n);if(r){r.markedAsDeleted=t;let e=new V.IB(r);N.push(e)}n.markedAsDeleted=t;let a=new V.DY(n);E.push(a)}}}}}if(s){ei.g3(O,j);return}}else{for(let e=null==l?void 0:l.iterator;null==e?void 0:e.next();){let i=e.value.data,l=i.key;if(i.category===eo.gojs.C_RELATIONSHIP){let e=M.findRelationshipView(l);if(e&&e.category===eo.gojs.C_RELSHIPVIEW){e.markedAsDeleted=t;let i=e.relship;O.deleteViewsOnly&&(i.markedAsDeleted=!1);let l=new V.w(i);I.push(l);let n=new V.GI(e);F.push(n)}}}let e=M.relshipviews;for(let t=0;t<e.length;t++){let i=e[t];if(i.markedAsDeletet){let e=j.findNodeForKey(i.key);ei.SV(e,!0,K)}}for(let e=null==l?void 0:l.iterator;null==e?void 0:e.next();){let t=e.value.data;if(t.category===eo.gojs.C_OBJECT){let e=t.key,i=this.getNode(K.myGoModel,e);if(i){let e=M.findObjectView(i.key),t=null==e?void 0:e.object;if(t){t.markedAsDeleted=!O.deleteViewsOnly,e.markedAsDeleted=!0;let i=new V.pJ(t);_.push(i);let l=new V.g_(e);L.push(l)}}}}}for(let e=0;e<L.length;e++){let i=L[e];if(i.markedAsDeleted){let e=this.getNode(K.myGoModel,i.id);e&&ei.AC(e,t,K)}}break}case"ExternalObjectsDropped":e.subject.each(function(e){let t,i,l,n,s;let r=j.findNodeForKey(e.data.key);r.data;let a=e.data.objecttype,d=e.data.typeview;if(a&&d){if(n=r.data.object.name,s=r.data.object.description,d=(a=O.findObjectType(a.id)).typeview,"Datatype"===a.name&&"Datatype"===n){let t=!0;for(;t;)n="datatype"+Math.floor(100*Math.random()),t=O.findDatatype(n);t||(n=prompt("Enter Datatype name;",n)),e.data.name=n}i=en.gj(),(l=new ee.Jo(i,n,a,s)).parentModelRef=k.id,k.addObject(l),O.addObject(l),console.log("1241 node, data",r,e.data),(t=M.findObjectView(r.data.key))||((t=new ee.wN(r.data.key,r.data.name,l,r.data.description,M)).isGroup=r.data.isGroup,t.objectRef=l.id,l.addObjectView(t),M.addObjectView(t),O.addObjectView(t)),M.setFocusObjectview(t);let p=[];p.push(new V.Yp(M)),p.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),j.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:t})})}else{if(d=(a=O.findObjectType(e.data.objtypeRef)).typeview,i=e.data.objRef,l=O.findObject(i)){k.addObject(l);let i=e.data.key;(t=new ee.wN(i,e.data.name,l,l.description,M)).viewkind=eo.viewkinds.CONT,t.isGroup=e.data.isGroup,t.size=e.data.size,t.isGroup?t.viewkind=eo.viewkinds.CONT:t.viewkind=eo.viewkinds.OBJ,t=ei.hG(e.data,l,t,d,j),l.addObjectView(t),M.addObjectView(t),M.setFocusObjectview(t),O.addObjectView(t);let n=A.findNode(i);n||((n=new et.mC(i,A,t)).loadNodeContent(A),A.addNode(n));let s=[];s.push(new V.Yp(M)),s.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),j.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:t})})}if(t&&l){let e={id:t.id,name:t.name},i={id:l.id,name:l.name};j.dispatch({type:"SET_FOCUS_OBJECTVIEW",data:e}),j.dispatch({type:"SET_FOCUS_OBJECT",data:i})}}let p="",c="",u="",h=e.data;h.scale=Number(e.scale),""!==h.size&&h.size||(h.isGroup?h.size="200 100":h.size="160 70"),l&&(p=l.fillcolor?l.fillcolor:h.fillcolor,c=l.strokecolor?l.strokecolor:h.strokecolor,u=l.textcolor?l.textcolor:h.textcolor),l||(l=new ee.Jo(i,n,a,s),ei.Lb(l,h),l.setModified(),k.addObject(l),O.addObject(l)),t&&t instanceof ee.wN?(t.loc=h.loc,t.size=h.size):((t=new ee.wN(h.key,h.name,l,h.description,M)).isGroup=h.isGroup,(t=ei.hG(h,l,t,d,j)).loc=h.loc,t.viewkind=a.viewkind,t.scale=Number(h.scale),t.size=h.size,"Container"===t.viewkind&&(t.isGroup=!0),t.setModified(),M.addObjectView(t),O.addObjectView(t));let m=A.findNodeByViewId(t.id);m||((m=new et.mC(t.id,A,t)).loadNodeContent(A),A.addNode(m));let f=ei.kj(A,h.loc,h.size,m);if(f){let e=f;m.group=e.key,m.objectview.group=e.objviewRef,j.model.setDataProperty(h,"group",m.group),m.scale=m.getMyScale(A),h.scale=Number(m.scale)}if(m&&(m.object=null,m.objecttype=null,m.objectview=null),"Label"===h.typename&&(h.text="Label"),"objecttype"===h.type){let e=ei.aH(h,K);if(e){e.typename=eo.types.OBJECTTYPE_NAME;let t=new V.DY(e,!0);E.push(t);let i=new V.mX(e.typeview);D.push(i);let l=h.loc,n=h.size,s=new ee.Ah(en.gj(),K.myMetamodel,e,l,n),r=new V.IB(s);N.push(r)}}else{let e=new V.g_(t);L.push(e),ei.oK(L,e);let i=new V.pJ(l);_.push(i);let n={id:t.id,name:t.name},s={id:t.object.id,name:t.object.name};j.dispatch({type:"SET_FOCUS_OBJECTVIEW",data:n}),j.dispatch({type:"SET_FOCUS_OBJECT",data:s})}r.updateTargetBindings()});break;case"ObjectDoubleClicked":{let t=e.subject.part.data;switch(es&&console.log("981 node",t),t.category){case eo.gojs.C_OBJECTTYPE:P.g_(t,O,j);break;case eo.gojs.C_OBJECT:es&&console.log("988 myMetis",O),P.sS(t,O,j),es&&console.log("990 myMetis",O)}break}case"ObjectSingleClicked":{let t=e.subject.part,i=t.data;es&&console.log("1313 selected",i,t);let l=M.findObjectView(null==i?void 0:i.key);l||(l=M.findObjectView(null==i?void 0:null===(f=i.fromNode)||void 0===f?void 0:f.key));let n=null==l?void 0:l.object;console.log("1360 object, objectview",n,l);for(let e=j.nodes;null==e?void 0:e.next();){let t=e.value.data;t.isSelected&&es&&console.log("1319 goNode",t)}{let e=A.findNode(i.key);es&&console.log("1319 myGoModel, goNode",A,e)}if(l&&n){let e={id:l.id,name:l.name},t={id:n.id,name:n.name};es&&console.log("1072 SET_FOCUS_OBJECTVIEW",e,t),K.dispatch({type:"SET_FOCUS_OBJECTVIEW",data:e}),K.dispatch({type:"SET_FOCUS_OBJECT",data:t})}for(let e=t.memberParts;null==e?void 0:e.next();){let t=e.value;t instanceof S.N_||!es||console.log("1079 n",t.data)}break}case"ObjectContextClicked":{let t=e.subject.part,i=t.data;es&&console.log("1316 selected",i,t);break}case"PartResized":{let t=e.diagram.selection;for(let e=t.iterator;null==e?void 0:e.next();){let t=e.value;if(t.data.isGroup){let e;if(!(e=M.findObjectView(t.data.key)))continue;e.loc=t.data.loc,e.size=t.data.size;let i=A.findNodeByViewId(t.data.key);i.size=e.size,i.key=e.id;let l=new V.g_(e);ei.oK(L,l);let n=t.memberParts;for(let e=n.iterator;null==e?void 0:e.next();){let t=e.value;if(t instanceof S.bP){let e=t.data,i=e.objectview;if(i){i.loc=e.loc,i.size=e.size;let t=new V.g_(i);ei.oK(L,t)}}}}}break}case"ClipboardChanged":{let t=e.subject;es&&console.log("nodes",t);break}case"ClipboardPasted":{let t=e.subject,i=O.pasteViewsOnly,l=!1,n=O.gojsModel,s=O.gojsModel,r=M,a=M,d=[],p=[],c=t.iterator;for(;c.next();)if(c.value instanceof S.bP){let e=c.value.data;r=e.fromModelview,n=e.fromGoModel;let t=e.fromNode;if(!t)continue;let u=t.key,h=u;(null==u?void 0:u.length)==e.key.length&&(e.key=h=en.gj(),a=M,s=A);let m=new ee.k2;m.name=e.name,m.objId=t.objid,m.object=O.findObject(m.objId),m.descr=null===(y=m.object)||void 0===y?void 0:y.description,m.objecttype=null===(g=m.object)||void 0===g?void 0:g.type,m.objviewId=t.objviewid,m.objectview=r.findObjectView(m.objviewId),m.gjsKey=u,m.gjsNode=t,m.memberscale=Number(t.memberscale),m.loc=t.loc,m.size=t.size,m.group=t.group,m.isGroup=t.isGroup,m.goNodeId=u;let f=n.findNode(m.goNodeId);m.goNode=f,d.push(m);let v=new ee.k2;v.name=m.name,v.objecttype=m.objecttype,i?v.object=m.object:(v.objId=en.gj(),v.object=new ee.Jo(v.objId,v.name,v.objecttype,m.descr),ei.Lb(v.object,m.object),v.object.setModified(),k.addObject(v.object),O.addObject(v.object)),v.objviewId=en.gj(),v.goNodeId=v.objviewId,v.objectview=new ee.wN(v.objviewId,v.name,v.object,m.descr,a),e.key=v.objviewId,ei.aw(v.objectview,m.objectview),v.loc=e.loc,v.size=e.size,v.gjsKey=e.key,v.group=e.group,v.isGroup=e.isGroup,v.objectview.loc=v.loc,v.objectview.size=v.size,v.objectview.readOnly=l,v.objecttype=m.objecttype,v.goNode=new et.mC(v.goNodeId,s,v.objectview),s.addNode(v.goNode),a.addObjectView(v.objectview),O.addObjectView(v.objectview),O.setGojsModel(s),p.push(v),es&&console.log("Checkpoint")}for(let e=0;e<d.length;e++){let t=d[e],i=O.getNodeGroup(t);if((null==i?void 0:i.length)>0){let e=O.getNodeByGroup(p,i);e&&(e.group="",a.findObjectViewByName(e.name).group=e.objviewId)}}let u=t.iterator;for(;u.next();)if(!(u.value instanceof S.bP)&&u.value instanceof S.N_){let e=u.value.data;if(!e.fromLink)continue;let t=e.fromLink.key,i=O.findRelationshipView(t),l=null==i?void 0:i.relship,n=l.fromObject,r=l.toObject,d=null,c=null;for(let e=0;e<p.length;e++){let t=p[e],i=t.objecttype,l=t.name;i&&n.name===l&&n.type.id===i.id&&(d=t.object,c=t.objectview)}let h=null,m=null;for(let e=0;e<p.length;e++){let t=p[e],i=t.objecttype,l=t.name;i&&r.name===l&&r.type.id===i.id&&(h=t.object,m=t.objectview)}let f=new ee.CK(en.gj(),l.type,d,h,l.name,l.description),y=en.gj();e.key=y;let g=new ee.Zc(y,i.name,f,i.description);g.fromObjview=c,g.toObjview=m;let v=new et.gR(y,s,g);s.addLink(v),a.addRelationshipView(g),O.addRelationshipView(g);let w=new V.w(f);ei.oK(I,w);let b=new V.GI(g);ei.oK(F,b)}let h=s.nodes;for(let e=0;e<h.length;e++){let t=h[e],i=t.objectview,l=ei.kj(A,t.loc,t.size,t),n=null==l?void 0:l.objectview;n||(n=M.findObjectView(null==l?void 0:l.objviewRef)),l&&n&&(t.group=l.key,n.isExpanded=!0,i.group=l.key,i.scale=Number(t.getMyScale(A)),i.loc=t.loc)}let m={metis:new V.io(O,!0)};m=JSON.parse(JSON.stringify(m)),j.dispatch({type:"LOAD_TOSTORE_PHDATA",data:m}),es&&console.log("1770 pastedNodes",p);break}case"LayoutCompleted":break;case"LinkDrawn":{let t,i,l,n,s,r;let a=e.subject,d=a.data;K.link=a,K.gjsData=d,K.goModel=A,es&&console.log("1498 link",a.data,a.data.from,a.data.to);for(let e=j.nodes;null==e?void 0:e.next();){let l=e.value;(null===(v=l.data)||void 0===v?void 0:v.key)===d.from&&(t=l.data),(null===(w=l.data)||void 0===w?void 0:w.key)===d.to&&(i=l.data)}if(t&&(s=M.findObjectView(t.key),K.goFromNode=l=A.findNode(t.key),K.fromObjView=s,ei.vn(l,null==s?void 0:s.typeview,j,A)),i&&(r=M.findObjectView(i.key),K.goToNode=n=A.findNode(i.key),K.toObjView=r,ei.vn(n,null==r?void 0:r.typeview,j,A)),(null==t?void 0:t.category)===eo.gojs.C_OBJECTTYPE){d.category=eo.gojs.C_RELSHIPTYPE,es&&console.log("1523 link",fromNode,toNode);let e=ei.hh(t.data,i.data,d,K);if(e){es&&console.log("1527 reltype",e);let l=new V.Mq(e,!0);C.push(l),es&&console.log("1530 jsnType",l);let n=e.typeview;if(n){let l=new V.KW(n);x.push(l),es&&console.log("1535 jsnTypeView",l);let s=O.gojsModel,r=new et.UB(en.gj(),s,e);r.fromNode=t.data,r.toNode=i.data,r.loadLinkContent(s),s.addLink(r),r.name=e.name,es&&console.log("1543 goLink, myGoModel, reltype",r,s,e);let a=j.findLinkForKey(r.key);j.model.addLinkData(a),es&&console.log("1546 lnk, reltype",a,e),j.model.setDataProperty(a.data,"name",e.name)}}j.requestUpdate()}(null==t?void 0:t.category)===eo.gojs.C_OBJECT&&(K.handleOpenModal=this.handleOpenModal,t&&i&&ei.He(t,i,K)),j.requestUpdate();break}case"LinkRelinked":{let t=[],i=[],l=e.subject,n=l.key,s=l.data,r=A.findLink(n),a=A.findNode(s.from),d=A.findNode(s.to),p=r.relshipRef,c=k.findRelationship(p),u=a.object;u||(u=k.findObject(a.objRef)),c.fromObject=u;let h=d.object;h||(h=k.findObject(d.objRef)),c.toObject=h;let m=r.relviewRef,f=M.findRelationshipView(m);if(f||(f=M.findRelationshipView(m)),!f)break;let y=a.fromObjview;y||(y=M.findObjectView(a.objviewRef)),f.fromObjview=y;let g=d.toObjview;g||(g=M.findObjectView(d.objviewRef)),f.toObjview=g,t.push(new V.w(c)),i.push(new V.GI(f)),t.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),j.dispatch({type:"UPDATE_RELSHIP_PROPERTIES",data:t})}),i.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),j.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})});break}case"LinkReshaped":{let t=e.subject,i=null==(t=j.findLinkForKey(t.key))?void 0:t.data;es&&console.log("1596 link, data",t,i);let l=null==i?void 0:i.relshipview;if(l=M.findRelationshipView(null==i?void 0:i.key)){let e=[];for(let i=t.data.points.iterator;null==i?void 0:i.next();){let t=i.value;es&&console.log("1603 point",t.x,t.y),e.push(t.x),e.push(t.y)}l.points=e;let i=new V.GI(l);es&&console.log("1609 relview, jsnRelview",l,i),F.push(i)}break}case"SubGraphCollapsed":case"SubGraphExpanded":e.subject.each(function(e){let t=e.data,i=null==t?void 0:t.objectview;if(i){i.isExpanded=t.isExpanded;let e=new V.g_(i);L.push(e)}});break;case"BackgroundSingleClicked":{es&&console.log("1615 myMetis",O),P.KL(M);let e={id:M.id,name:M.name};e=JSON.parse(JSON.stringify(e)),K.dispatch({type:"SET_FOCUS_OBJECTVIEW",data:e});let t={id:k.id,name:k.name};t=JSON.parse(JSON.stringify(t)),K.dispatch({type:"SET_FOCUS_OBJECT",data2:t});break}case"BackgroundDoubleClicked":es&&console.log("1619 BackgroundDoubleClicked",e,e.diagram);break;case"ModelChanged":console.log("Transaction Finished");default:es&&console.log("1399 GoJSApp event name: ",T)}es&&console.log("1928 modifiedObjectViews",L),L.map(e=>{let t=e&&e;e.id&&(t=JSON.parse(JSON.stringify(t)),K.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t}))}),null==E||E.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),K.dispatch({type:"UPDATE_OBJECTTYPE_PROPERTIES",data:t})}),null==D||D.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),K.dispatch({type:"UPDATE_OBJECTTYPEVIEW_PROPERTIES",data:t})}),null==N||N.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),K.dispatch({type:"UPDATE_OBJECTTYPEGEOS_PROPERTIES",data:t})}),es||console.log("1955 modifiedRelshipViews",F),F.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),K.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})}),null==C||C.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),K.dispatch({type:"UPDATE_RELSHIPTYPE_PROPERTIES",data:t})}),null==x||x.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),K.dispatch({type:"UPDATE_RELSHIPTYPEVIEW_PROPERTIES",data:t})}),null==_||_.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),K.dispatch({type:"UPDATE_OBJECT_PROPERTIES",data:t})}),null==I||I.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),K.dispatch({type:"UPDATE_RELSHIP_PROPERTIES",data:t})}),es||console.log("1704 myMetis",O)}render(){var e;let t,i,n,s;let r=this.state.selectedData;es&&console.log("1777 selectedData",r,this.props);let a=this.state.modalContext;if(es&&console.log("1780 modalContext ",a),(null==a?void 0:a.what)==="selectDropdown"){let e="",i="",{Option:s}=z.c;e=this.state.selectedData.map(e=>e&&{label:e,value:e}),i=null,es&&console.log("1507 options",e,this.state);let{selectedOption:r}=this.state;es&&console.log("1509 selectedOption",r,this.state);let d=r?r.value:e[0],p=r?r.label:e[0];es&&console.log("1513 selectedOption, value, label ",r,d,p),n=a.title,t=(0,l.jsx)("div",{className:"modal-selection d-flex justify-content-center",children:(0,l.jsx)(H.Ay,{className:"modal-select",options:e,components:i,onChange:e=>this.handleSelectDropdownChange(e)})})}else null!==r&&(es&&console.log("1527 selectedData",r),i=(0,l.jsxs)("div",{className:"p-2",style:{backgroundColor:"#ddd"},children:[(0,l.jsx)("p",{children:"Selected Object Properties:"}),(0,l.jsx)(I.E,{myMetis:this.state.myMetis,selectedData:this.state.selectedData,context:this.state.context,onInputChange:this.handleInputChange})]}));return this.state.myMetis&&(this.state.myMetis.dispatch=this.state.dispatch),es&&console.log("1542 dispatch",this.state.myMetis.dispatch),es&&console.log("1837 dataarray:",this.state),es&&console.log("1838 dataarray:",this.state.nodeDataArray,this.state.linkDataArray),this.state&&(0,l.jsxs)("div",{className:"diagramwrapper",children:[(0,l.jsx)(Q.j,{nodeDataArray:this.state.nodeDataArray,linkDataArray:this.state.linkDataArray,modelData:this.state.modelData,modelType:this.state.modelType,skipsDiagramUpdate:this.state.skipsDiagramUpdate,onDiagramEvent:this.handleDiagramEvent,onModelChange:this.handleModelChange,onInputChange:this.handleInputChange,myMetis:this.state.myMetis,dispatch:this.state.dispatch,diagramStyle:this.state.diagramStyle,onExportSvgReady:this.state.onExportSvgReady}),(0,l.jsxs)(Y.A,{className:"",isOpen:this.state.showModal,children:[(0,l.jsxs)("div",{className:"modal-head",children:[(0,l.jsx)(Z.A,{className:"modal-button btn-sm float-right m-1",color:"link",onClick:()=>{this.handleCloseModal("x")},children:(0,l.jsx)("span",{children:"x"})}),(0,l.jsxs)(q.A,{className:"modal-header",children:[(0,l.jsxs)("span",{className:"text-secondary",children:[n," "]}),(0,l.jsxs)("span",{className:"modal-name ",children:[null===(e=this.state.selectedData)||void 0===e?void 0:e.name," "]}),(0,l.jsxs)("span",{className:"modal-objecttype float-right",children:[" ",s," "]})]})]}),(0,l.jsx)(X.A,{children:(0,l.jsx)("div",{className:"modal-body1",children:t})}),(0,l.jsx)($.A,{className:"modal-footer",children:(0,l.jsx)(Z.A,{className:"modal-button bg-link m-0 p-0",color:"link",onClick:()=>{this.handleCloseModal()},children:"Done"})})]})]})}constructor(e){var t,i;super(e),this.handleSelectDropdownChange=e=>{es&&console.log("94 handleSelectDropdownChange",this.state.myMetis);let t=this.state.myMetis,i=this.state.modalContext,l={myMetis:t,myMetamodel:i.myMetamodel,myModel:t.currentModel,myModelview:t.currentModelview,myGoModel:t.gojsModel,myDiagram:t.myDiagram,modalContext:i};el.Gd(e,l)},es&&console.log("62 GoJSApp",this.props.nodeDataArray,this.props),this.state={nodeDataArray:null===(t=this.props)||void 0===t?void 0:t.nodeDataArray,linkDataArray:null===(i=this.props)||void 0===i?void 0:i.linkDataArray,modelData:{canRelink:!0},selectedData:null,editedData:null,skipsDiagramUpdate:!1,metis:this.props.metis,myMetis:this.props.myMetis,phFocus:this.props.phFocus,dispatch:this.props.dispatch,modelType:this.props.phFocus.focusTab,showModal:!1,modalContext:null,selectedOption:null,diagramStyle:this.props.diagramStyle,onExportSvgReady:this.props.onExportSvgReady},es&&console.log("76 this.state: ",this.state.myMetis,this.state.nodeDataArray),this.handleDiagramEvent=this.handleDiagramEvent.bind(this),this.handleOpenModal=this.handleOpenModal.bind(this),this.handleCloseModal=this.handleCloseModal.bind(this),this.handleSelectDropdownChange=this.handleSelectDropdownChange.bind(this)}}let ed=ea;i(4797);let ep=!1,ec=(e,t)=>{function i(e,t){localStorage.setItem(e,JSON.stringify(t))}function l(e){try{var t;let i=null===(t=localStorage)||void 0===t?void 0:t.getItem(e);return i?JSON.parse(i):null}catch(e){return console.log("Error in getFromLocalStorage",e),null}}ep&&console.log("5 SaveAkmmUser akmmUser exists in localStorage, use it",t,e.phUser),null===l(t)||void 0===l(t)?(ep&&console.log("23 akmmUser exists in localStorage, use it",e.phUser),i(t,e.phUser)):"akmmUser"===l(t)?(ep&&console.log("26 SaveAkmmUser akmmUser does not exist in localStorage, create it",e.phUser),i(t,e)):ep&&console.log("29 SaveAkmmUser ",l(t))};var eu=i(5255),eh=i(3479);let em=!1;console.log.bind(console,"%c %s","background: blue; color: white");let ef=console.log.bind(console,"%c %s","background: red; color: white");console.trace.bind(console,"%c %s","background: green; color: white");let ey=e=>{var t,i,n,s,d,p,c,h,m,f,y,R,D,S,N,P,C,x,_,I,V,L,F,G;if(!e.metis)return(0,l.jsx)(l.Fragment,{children:" metis not found"});if(!(null===(t=e.myMetis)||void 0===t?void 0:t.currentModel))return(0,l.jsx)(l.Fragment,{children:" current model not found"});em&&console.log("39 Modeller: props",e);let K=(0,a.wA)(),[J,W]=(0,r.useState)(!1),[U,z]=(0,r.useState)(!1),[H,Y]=(0,r.useState)(!1),[Z,q]=(0,r.useState)(!1),[X,$]=(0,r.useState)(),[Q,ee]=(0,r.useState)("All"),[et,ei]=(0,r.useState)(!1),[el,eo]=(0,r.useState)(!1),[en,es]=(0,r.useState)(""),[er,ea]=(0,r.useState)(!1),[ep,ey]=(0,r.useState)(e.metis.name),[eg,ev]=(0,r.useState)(e.metis.name),[ew,eb]=(0,r.useState)(e.metis.name),[eT,ej]=(0,r.useState)(),[eO,ek]=(0,u.A)("akmmUser",""),[eM,eR]=(0,r.useState)(null),[eA,eE]=(0,r.useState)(!1),[eD,eS]=(0,r.useState)("Sorted alphabetical"),[eN,eP]=(0,r.useState)([]),[eC,ex]=(0,r.useState)({nodeDataArray:[],linkDataArray:[]});(0,r.useRef)(null);let e_=null===(i=e.phFocus)||void 0===i?void 0:i.focusModel,eI=null===(n=e.phFocus)||void 0===n?void 0:n.focusModelview,eV=0,eL=null===(s=e.metis)||void 0===s?void 0:s.models,eF=null==eL?void 0:eL.find(e=>(null==e?void 0:e.id)===(null==e_?void 0:e_.id)),eB=null==eL?void 0:eL.findIndex(e=>(null==e?void 0:e.id)===(null==e_?void 0:e_.id)),eG=null==eF?void 0:eF.modelviews,eK=null==eG?void 0:eG.find(e=>(null==e?void 0:e.id)===(null==eI?void 0:eI.id)),eJ=null==eG?void 0:eG.findIndex((e,t)=>t&&(null==e?void 0:e.id)===(null==eI?void 0:eI.id)),eW=null===(d=e.metis)||void 0===d?void 0:d.metamodels,eU=null==eW?void 0:eW.find(e=>(null==e?void 0:e.id)===(null==eF?void 0:eF.metamodelRef)),ez=(e,t)=>{eR(()=>e),eE(t)};(0,r.useEffect)(()=>{var t;em&&ef("91 Modeller useEffect 1 [props.phFocus.focusModelview?.id] : ",X,eV,null===(t=e.phFocus.focusModel)||void 0===t?void 0:t.name),$(eV)},[null===(c=e.phFocus)||void 0===c?void 0:null===(p=c.focusModelview)||void 0===p?void 0:p.id]),em&&console.log("102 Modeller: gojsmodel",e,gojsmodel,null===(h=gojsmodel)||void 0===h?void 0:h.nodeDataArray),null===(y=e.phUser)||void 0===y||null===(f=y.focusUser)||void 0===f||null===(m=f.diagram)||void 0===m||m.showDeleted;let eH=null===(S=e.phUser)||void 0===S?void 0:null===(D=S.focusUser)||void 0===D?void 0:null===(R=D.diagram)||void 0===R?void 0:R.showModified,eY=null!==(N=e.phUser)&&void 0!==N&&!!N.focusUser&&(null===(x=e.phUser)||void 0===x?void 0:null===(C=x.focusUser)||void 0===C?void 0:null===(P=C.diagram)||void 0===P?void 0:P.showDeleted),eZ=()=>{ea(!er)};function eq(){q(!Z),ei(!et)}(0,r.useEffect)(()=>{var e;em&&ef("122 Modeller useEffect 2 [] "),eS("Sorted alphabetical"),(null==eU?void 0:eU.name)==="AKM-OSDU_MM"?eS("OSDUType"):(null==eF?void 0:null===(e=eF.objects)||void 0===e?void 0:e.length)>500?eS("Sorted by type"):eS("Sorted alphabetical"),W(!0),ei(!1);let t=setTimeout(()=>{q(!Z)},250);return()=>clearTimeout(t)},[]),(0,r.useEffect)(()=>{em&&ef("142 Modeller useEffect 3 [model.objects.length === 0] "),0===eF.objects.length?"In this modelview"===eD?eS("Sorted by type"):eS("Sorted alphabetical"):"Sorted by type"===eD&&eS("Sorted alphabetical"),q(!Z),em&&console.log("136 Modeller useEffect , selectedOption] : ",eD)},[0===eF.objects.length]),(0,r.useEffect)(()=>{var t;em&&ef("122 Modeller useEffect 4 [props.phFocus?.focusObjectview?.id] ");let i={phData:e.phData,phFocus:e.phFocus,phUser:e.phUser,phSource:e.phSource};em&&console.log("163 Modeller useEffect 2, props.phFocus.focusModelview?.id] : ",null===(t=e.phFocus.focusModelview)||void 0===t?void 0:t.id,i),e.userSetting&&setMemoryLocState(i);let l=setTimeout(()=>{ec(e,"akmmUser")},250);return()=>clearTimeout(l)},[null===(I=e.phFocus)||void 0===I?void 0:null===(_=I.focusObjectview)||void 0===_?void 0:_.id]);let eX=eL?[eL[eB],...eL.slice(0,eB),...eL.slice(eB+1,eL.length)]:[],e$=eG;em&&console.log("180 Modeller",eU,eI,eX,e$);let eQ=null==eX?void 0:eX.filter(e=>e&&!e.markedAsDeleted),e0=e=>{es(e.target.value)},e1=()=>{try{let e=JSON.parse(en);if(!Array.isArray(e.objects))throw Error("ParsedData.object is not an array");if(!Array.isArray(e.relationships))throw Error("ParsedData.relationships is not an array");e.objects.forEach(e=>{em&&console.log("236 Updating object:",e);let t={id:e.id,name:e.name,description:e.description,proposedType:e.proposedType,typeName:e.typeName,typeRef:e.typeRef};K({type:"UPDATE_OBJECT_PROPERTIES",data:t})}),e.relationships.forEach(e=>{let t={id:e.id,name:e.name,fromobjectRef:e.fromobjectRef,toobjectRef:e.toobjectRef,typeRef:e.typeRef};em&&console.log("243 Updating relationship:",e,t),K({type:"UPDATE_RELSHIP_PROPERTIES",data:t})}),eo(!1),es(""),alert("Data imported successfully!")}catch(e){console.error("Error importing data:",e),alert("Invalid JSON format. Please check your input.")}},e2=()=>{eo(!0)},e5=()=>{eo(!1),es("")};function e3(e){let t={};for(let i in e){if(!e.hasOwnProperty(i))continue;let l=i,n=e[i];"object"!=typeof e[i]&&(t={...t,[l]:n},em&&console.log("130",i,e[i],t),em&&console.log("513 :",e,t))}return t}eQ&&eQ.map((t,i)=>t&&t.name!=="Select "+e.selName+"..."&&(0,l.jsx)("option",{value:JSON.stringify({id:t.id,name:t.name}),children:t.name},t.id+i)),eV=eJ<0?0:eJ,em&&console.log("78 Modeller",null==e_?void 0:e_.name,null==eI?void 0:eI.name,eV);let e6=null===(V=e.myMetis)||void 0===V?void 0:V.findModel(eF.id),e4=E.vi(null==e6?void 0:e6.objects,e.myMetis),e7=null==e4?void 0:e4.map(e=>e3(e)),e8=[],e9=[...new Set(null==e7?void 0:e7.map(e=>e.typename))].sort(),te=e7;null==te||te.forEach(e=>{var t;let i=(0,eh.k)(null===(t=e.object)||void 0===t?void 0:t.osduType);i&&(e.fillcolor=i)});let tt=null==te?void 0:te.filter(e=>e&&!1===e.markedAsDeleted);em&&console.log("350 nodeArray_all",te,tt),(0,r.useEffect)(()=>{em&&console.log("300 Modeller useEffect 5 [selectedOption] ");let e=tt;if(em&&console.log("455 Modeller ofilteredOnTypes",e,e9,eD),"In this modelview"===eD){let t=null==eK?void 0:eK.objectviews,i=null==eF?void 0:eF.objects.filter(e=>null==t?void 0:t.find(t=>(null==t?void 0:t.objectRef)===(null==e?void 0:e.id))),l=null==i?void 0:i.map(t=>null==e?void 0:e.find(e=>e&&(null==e?void 0:e.typename)===(null==t?void 0:t.typeName)&&(null==e?void 0:e.name)===(null==t?void 0:t.name)));em&&console.log("365 Modeller ofilteredOnTypes",l),ex({nodeDataArray:l,linkDataArray:e8})}else if("Sorted alphabetical"===eD){let t=null==e?void 0:e.sort((e,t)=>e.name>t.name?1:-1);ex({nodeDataArray:t,linkDataArray:e8}),em&&console.log("370 Modeller ofilteredOnTypes",t)}else if("Sorted by type"===eD){var t;let i=e9.map(t=>null==e?void 0:e.filter(e=>e&&e.typename===t)),l=null==i?void 0:i.map(e=>e.sort((e,t)=>e.typename>t.typename?1:-1)).flat(),n=null==e?void 0:e.find(e=>e&&(null==e?void 0:e.typename)==="OSDUType"),s=n?null==l?void 0:null===(t=l.sort((e,t)=>{var i,l;let n=(null===(i=e.object)||void 0===i?void 0:i.osduType)||"",s=(null===(l=t.object)||void 0===l?void 0:l.osduType)||"";return n.localeCompare(s)}))||void 0===t?void 0:t.sort((e,t)=>{var i,l,n,s;let r={MasterData:0,WorkProductComponent:1,ReferenceData:2,Abstract:3,OSDUType:4,Proxy:5,Property:6,Array:7,Item:8};return(null!==(n=r[null===(i=e.object)||void 0===i?void 0:i.osduType])&&void 0!==n?n:Number.MAX_SAFE_INTEGER)-(null!==(s=r[null===(l=t.object)||void 0===l?void 0:l.osduType])&&void 0!==s?s:Number.MAX_SAFE_INTEGER)}):l;em&&console.log("399 Palette ofilteredOnTypes",n,s),ex({nodeDataArray:s,linkDataArray:e8})}else{let t=null==e?void 0:e.filter(e=>e&&e.typename===eD);em&&console.log("376 Modeller ofilteredOnTypes",t,e9,eD),ex({nodeDataArray:t,linkDataArray:e8})}q(!Z)},[eD]);let ti=e$?e$.map((e,t)=>{if(e&&!e.markedAsDeleted){let i=t.toString(),n={id:e.id,name:e.name};return Math.random().toString(36).substring(7),(0,l.jsx)(w.A,{className:"model-selection","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Description: ".concat(null==eK?void 0:eK.description,"\n\nTo change Modelview name, rigth click the background below and select 'Edit Modelview'."),children:(0,l.jsx)(b.A,{style:{paddingTop:"0px",paddingBottom:"6px",paddingLeft:"8px",paddingRight:"8px",border:"solid px",borderBottom:"none",borderColor:"#eee gray white #eee",color:"black"},className:A()({active:X==i}),onClick:()=>{K({type:"SET_FOCUS_MODELVIEW",data:n})},children:e.name})},i)}}):(0,l.jsx)(l.Fragment,{}),tl=e=>{var t;em&&console.log("495 Palette handleSelectOTypes",null===(t=e.target)||void 0===t?void 0:t.value),eS(e)},to=(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("select",{className:"select-field mx-1 text-secondary",style:{width:"98%"},onChange:e=>tl(e.target.value),children:[(0,l.jsx)("option",{value:"In this modelview",children:"Filter/Sort"},"01"),(0,l.jsx)("option",{value:"In this modelview",children:"Objects in this Modelview *"},"02"),(0,l.jsx)("option",{value:"Sorted alphabetical",children:"All Sorted Alphabetical *"},"03"),(0,l.jsx)("option",{value:"Sorted by type",children:"All Sorted by Type *"},"04"),e9.map((e,t)=>(0,l.jsx)("option",{value:e,children:e},t))]})}),tn=e6.metamodel,ts=E.vv(tn,eY,eH),tr=()=>{if(eF&&eF.objects){let e=eF.objects.map(e=>' - "'.concat(e.id,'" | "').concat(e.name,'" | "').concat(e.description?e.description:"(empty)",'" | "(').concat(e.proposedType,')" | "(').concat(e.typeName,')"')).join("\n").replace(/\|/g,",")+"\n",t=eF.relships.map(e=>' - "'.concat(e.id,'" | "').concat(e.name,'"  | "').concat(e.typeRef,'" | "').concat(e.fromobjectRef,'" | "').concat(e.toobjectRef,'"')).join("\n").replace(/\|/g,",")+"\n";navigator.clipboard.writeText("Objects: ".concat(e," \n Relships: ").concat(t,"\n")).then(()=>{alert("Objects and relships copied to clipboard!")}).catch(e=>{console.error("Failed to copy objects to clipboard: ",e)})}},ta=(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"workpad p-1 m-1 border",style:{backgroundColor:"#7b8",outline:"0",borderStyle:"none",width:er?"20hw":"auto"},children:[(0,l.jsxs)("div",{className:"modellingtask bg-light",children:[to,(0,l.jsx)("div",{className:"mmname mx-0 px-2 mb-1 bg-white text-secondary",style:{fontSize:"14px",mimWidth:"120px"},children:eD})]}),(0,l.jsx)(B,{divClassName:"diagram-component-objects",nodeDataArray:eC.nodeDataArray,linkDataArray:eC.linkDataArray,metis:e.metis,myMetis:e.myMetis,phFocus:e.phFocus,dispatch:e.dispatch,diagramStyle:{height:"68vh"}})]})}),td=(0,l.jsx)("div",{className:"modeller--footer-buttons d-flex justify-content-end","data-placement":"top",title:"Modelview footer area"}),tp=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(T.A,{tabs:!0,children:[" ",ti," ",(0,l.jsxs)(w.A,{children:[" ",(0,l.jsx)("button",{className:"btn p-2 border-white text-white float-right","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:" Modelling: Insert an Object: Click on an Object Type in the Palette (the left) and drag and drop it into the Modelling area below.   Connect two objects:  Position the cursor on on the edge of one object (An arrow appears) and drag and drop to another object to make a relationshop between them.",style:{background:"#aaccdd"},children:" ?"})]}),(0,l.jsx)("button",{className:"btn  btn-sm bg-transparent text-light ms-auto me-0","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Open Modeller right sidepanel with Object details!",onClick:()=>"function"==typeof e.setVisibleFocusDetails&&e.setVisibleFocusDetails(!e.visibleFocusDetails),children:e.visibleFocusDetails?(0,l.jsxs)("span",{className:"fs-8",children:["Object Details",(0,l.jsx)("i",{className:"fa fa-lg fa-angle-right  pull-right-container ms-1"})," "]}):(0,l.jsxs)("span",{className:"fs-8",children:["Object Details",(0,l.jsx)("i",{className:"fa fa-lg fa-angle-left pull-left-container ms-1"})]})})]}),(0,l.jsx)(M.A,{className:" p-0 m-0 border border-white",children:(0,l.jsx)(j.A,{className:"",children:(0,l.jsxs)(O.A,{className:"m-1 rounded",style:{backgroundColor:"#a0caca",outline:"0",borderStyle:"none"},children:[(0,l.jsxs)(k.A,{className:"me-2 my-1 p-1 border",xe:"auto",children:[(0,l.jsx)("div",{className:"workpad bg-white border-light mt-0 pe-0",children:(0,l.jsx)(ed,{nodeDataArray:null===(L=e.myMetis.gojsModel)||void 0===L?void 0:L.nodes,linkDataArray:null===(F=e.myMetis.gojsModel)||void 0===F?void 0:F.links,metis:e.metis,myMetis:e.myMetis,phFocus:e.phFocus,dispatch:e.dispatch,modelType:e.phFocus.focusTab,onExportSvgReady:ez,diagramStyle:{height:"77vh"}})}),(0,l.jsx)("div",{className:"smaller-div m-0 p-0",children:td})]}),(0,l.jsx)(k.A,{className:"me-1 my-1 p-1 border ",xs:"auto",children:(0,l.jsx)("div",{className:"",style:{backgroundColor:"#cdd"},children:e.visibleFocusDetails?(0,l.jsx)(eu.A,{props:e,reportType:"object",edit:!0,modelInFocusId:null===(G=e.phFocus.focusModel)||void 0===G?void 0:G.id,exportTab:e.exportTab}):(0,l.jsx)(l.Fragment,{})})})]})})})]}),tc=(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"workpad",children:(0,l.jsx)(ed,{nodeDataArray:null==ts?void 0:ts.nodes,linkDataArray:null==ts?void 0:ts.links,metis:e.metis,myMetis:e.myMetis,phFocus:e.phFocus,dispatch:e.dispatch,modelType:e.phFocus.focusTab,onExportSvgReady:ez,diagramStyle:{height:"77vh"}})})});em&&console.log("372 Modeller ",e.modelType);let tu=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(k.A,{className:"p-0 m-0 my-0 ",xs:"auto",children:(0,l.jsx)("div",{className:"btn-horizontal bg-light",style:{fontSize:"14px",minWidth:"14rem"},children:ta})}),(0,l.jsxs)("button",{className:"btn d-flex justify-content-center align-items-center w-100 bg-secondary my-1",onClick:tr,style:{fontSize:"10px"},children:[(0,l.jsx)("i",{className:"fas fa-copy me-2"}),"Copy obj / rel (Json)"]}),(0,l.jsxs)("button",{className:"btn me-1 d-flex justify-content-center align-items-center w-100  bg-secondary my-1",onClick:e2,style:{fontSize:"10px"},children:[(0,l.jsx)("i",{className:"fas fa-paste me-2"})," Paste obj / rel (Json)"]}),(0,l.jsxs)(g.A,{show:el,onHide:e5,children:[(0,l.jsx)(g.A.Header,{closeButton:!0,children:(0,l.jsx)(g.A.Title,{children:"Paste and Import JSON"})}),(0,l.jsx)(g.A.Body,{children:(0,l.jsx)("textarea",{value:en,onChange:e0,placeholder:"Paste your JSON here",rows:"10",cols:"50",style:{width:"100%"}})}),(0,l.jsxs)(g.A.Footer,{children:[(0,l.jsx)(v.A,{variant:"secondary",onClick:e5,children:"Cancel"}),(0,l.jsx)(v.A,{variant:"primary",onClick:e1,children:"Import"})]})]})]}),th="model"===e.modelType?(0,l.jsxs)("div",{className:"modeller-workarea w-100 d-flex flex-col",children:[(0,l.jsxs)("div",{className:"modeller--objects me-1 \n                    ".concat(et?er?"col-2":"col-1":"col-0"," "),style:{minWidth:et?"228px":"16px",backgroundColor:"#7b8"},children:[(0,l.jsxs)("div",{className:"modeller--objects-top d-flex flex-row justify-content-between me-1 p-0",style:{backgroundColor:"#7b8"},children:[(0,l.jsx)("button",{className:"btn-sm p-0 m-0 text-left bg-transparent",style:{backgroundColor:"#7b8",outline:"0",borderStyle:"none"},onClick:eq,"data-toggle":"tooltip","data-placement":"top",title:"List of all the Objects in this Model (This also include object with no Objectviews)  Drag objects from here to the modelling area to include it in current Objectview",children:et?(0,l.jsx)("span",{children:" <- Objects "}):(0,l.jsxs)("span",{children:[" ",(0,l.jsx)("span",{style:{whiteSpace:"nowrap"},children:"->"}),"\xa0 ",(0,l.jsx)("span",{style:{whiteSpace:"normal",letterSpacing:"0.5em"},children:" O b j e c t s"})]})}),(0,l.jsx)("button",{className:"btn-sm ps-0 pe-4 m-0 text-left bg-transparent",style:{backgroundColor:"#a0caca",outline:"0",borderStyle:"none"},onClick:eZ,"data-toggle":"tooltip","data-placement":"top",title:"   ",children:et?er?(0,l.jsx)("span",{children:" < - > "}):(0,l.jsx)("span",{children:"< -- >"}):(0,l.jsx)("span",{})})]}),(0,l.jsx)("div",{className:"modeller--objects m-1 ",style:{minWidth:"20px"},children:et?Z?(0,l.jsx)(l.Fragment,{children:tu}):(0,l.jsxs)(l.Fragment,{children:[" ",tu," "]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(k.A,{className:"p-0 m-0 my-0",xs:"auto",children:(0,l.jsx)("div",{className:"btn-horizontal",style:{fontSize:"10px"}})})," "]})})]}),(0,l.jsx)("div",{className:"modeller--workarea m-0 p-0 ".concat(et?er?"col-8":"col-10":"col-12"),style:{minWidth:et?"48%":"28%",overflow:"hidden",whiteSpace:"nowrap",flexGrow:1},children:tp})]}):(0,l.jsxs)("div",{className:"modeller-workarea w-100",children:[" ",(0,l.jsxs)("div",{className:"modeller--topbar mt-1 p-0",children:[(0,l.jsx)("span",{className:"modeller--heading float-left text-dark m-0 p-0 ms-2 mr-2 fs-6 fw-bold lh-2",style:{minWidth:"8%"},children:"Meta Model"}),(0,l.jsx)("div",{className:""}),(0,l.jsx)("div",{children:tc})]}),(0,l.jsx)("div",{className:"",children:td})]});return(0,l.jsx)("div",{className:"",style:{display:"flex",flexDirection:"row"},children:H?(0,l.jsxs)(l.Fragment,{children:[" ",th," "]}):(0,l.jsx)(l.Fragment,{children:th})})};class eg extends r.Component{refreshNodeIndex(e){this.mapNodeKeyIdx.clear(),null==e||e.forEach((e,t)=>{this.mapNodeKeyIdx.set(e.key,t)})}refreshLinkIndex(e){this.mapLinkKeyIdx.clear(),null==e||e.forEach((e,t)=>{this.mapLinkKeyIdx.set(e.key,t)})}handleDiagramEvent(e){if("ChangedSelection"===e.name){let t=e.subject.first();this.setState((0,D.jM)(e=>{if(t){if(t instanceof S.bP){let i=this.mapNodeKeyIdx.get(t.key);if(void 0!==i&&i>=0){let t=e.nodeDataArray[i];e.selectedData=t}}else if(t instanceof S.N_){let i=this.mapLinkKeyIdx.get(t.key);if(void 0!==i&&i>=0){let t=e.linkDataArray[i];e.selectedData=t}}}else e.selectedData=null}))}}handleModelChange(e){let t=e.insertedNodeKeys,i=e.modifiedNodeData,l=e.removedNodeKeys,n=e.insertedLinkKeys,s=e.modifiedLinkData,r=e.removedLinkKeys,a=e.modelData,d=new Map,p=new Map;this.setState((0,D.jM)(e=>{let c=e.nodeDataArray;i&&i.forEach(t=>{d.set(t.key,t);let i=this.mapNodeKeyIdx.get(t.key);void 0!==i&&i>=0&&(c[i]=t,e.selectedData&&e.selectedData.key===t.key&&(e.selectedData=t))}),t&&t.forEach(e=>{let t=d.get(e),i=this.mapNodeKeyIdx.get(e);t&&void 0===i&&(this.mapNodeKeyIdx.set(t.key,c.length),c.push(t))}),l&&(e.nodeDataArray=c=c.filter(e=>!l.includes(e.key)),this.refreshNodeIndex(c));let u=e.linkDataArray;s&&s.forEach(t=>{p.set(t.key,t);let i=this.mapLinkKeyIdx.get(t.key);void 0!==i&&i>=0&&(u[i]=t,e.selectedData&&e.selectedData.key===t.key&&(e.selectedData=t))}),n&&n.forEach(e=>{let t=p.get(e),i=this.mapLinkKeyIdx.get(e);t&&void 0===i&&(this.mapLinkKeyIdx.set(t.key,u.length),u.push(t))}),r&&(e.linkDataArray=u=u.filter(e=>!r.includes(e.key)),this.refreshLinkIndex(u)),a&&(e.modelData=a),e.skipsDiagramUpdate=!0}))}handleInputChange(e,t,i){this.setState((0,D.jM)(l=>{let n=l.selectedData;if(n[e]=t,i){let e=n.key;if(e<0){let t=this.mapLinkKeyIdx.get(e);void 0!==t&&t>=0&&(l.linkDataArray[t]=n,l.skipsDiagramUpdate=!1)}else{let t=this.mapNodeKeyIdx.get(e);void 0!==t&&t>=0&&(l.nodeDataArray[t]=n,l.skipsDiagramUpdate=!1)}}}))}handleRelinkChange(e){let t=e.target.checked;this.setState({modelData:{canRelink:t},skipsDiagramUpdate:!1})}render(){let e;return null!==this.state.selectedData&&(e=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{children:"Selected Object Properties:"}),(0,l.jsx)(I.E,{selectedData:this.state.selectedData,onInputChange:this.handleInputChange}),";"]})),(0,l.jsx)("div",{children:(0,l.jsx)(_,{divClassName:"diagram-component-target",nodeDataArray:this.state.nodeDataArray,linkDataArray:this.state.linkDataArray,modelData:this.state.modelData,skipsDiagramUpdate:this.state.skipsDiagramUpdate,onDiagramEvent:this.handleDiagramEvent,onModelChange:this.handleModelChange})})}constructor(e){var t,i;super(e),this.state={nodeDataArray:null===(t=this.props)||void 0===t?void 0:t.nodeDataArray,linkDataArray:null===(i=this.props)||void 0===i?void 0:i.linkDataArray,modelData:{canRelink:!1},selectedData:null,skipsDiagramUpdate:!1,metis:this.props.metis,myMetis:this.props.myMetis,myGoModel:this.props.myGoModel,phFocus:this.props.phFocus,dispatch:this.props.dispatch},this.mapNodeKeyIdx=new Map,this.mapLinkKeyIdx=new Map,this.refreshNodeIndex(this.state.nodeDataArray),this.refreshLinkIndex(this.state.linkDataArray),this.handleDiagramEvent=this.handleDiagramEvent.bind(this)}}let ev=eg,ew=!1,eb=e=>{var t,i,n;let d=(0,a.wA)();ew&&console.log("10 TargetMeta",e);let p=null===(t=e.phFocus)||void 0===t?void 0:t.focusModel,c=null===(i=e.metis)||void 0===i?void 0:i.models,u=null===(n=e.metis)||void 0===n?void 0:n.metamodels,h=null==c?void 0:c.find(e=>(null==e?void 0:e.id)===(null==p?void 0:p.id)),m=null==u?void 0:u.find(e=>(null==e?void 0:e.id)===(null==h?void 0:h.targetMetamodelRef)),f=null==c?void 0:c.find(e=>(null==e?void 0:e.id)===(null==h?void 0:h.targetModelRef)),y=e.myMetis.findMetamodel(h.targetMetamodelRef),g=E.S4(y,e.myMetis);ew&&console.log("22 TargetMeta",g,g.nodes);let v=["Container","OSDUType","Property","Proxy","DataType","Value","Fieldtype","InputPattern","ViewFormat"];g.nodes.sort((e,t)=>{let i=v.indexOf(null==e?void 0:e.name),l=v.indexOf(null==t?void 0:t.name);return -1===i?1:-1===l?-1:i-l});let[w,b]=(0,r.useState)(!1);function T(){b(!w)}if((0,r.useEffect)(()=>{ew&&console.log("35 TargetMeta useEffect",null==h?void 0:h.targetMetamodelRef,"targetmm",null==m?void 0:m.id,null==m?void 0:m.name),(null==m?void 0:m.id)===void 0?ew&&console.log("39 TargetMeta useEffect",null==m?void 0:m.id,null==m?void 0:m.name):(null==m?void 0:m.id)===""?ew&&console.log("41 TargetMeta useEffect",null==m?void 0:m.id,null==m?void 0:m.name):(ew&&console.log("43 TargetMeta useEffect",null==m?void 0:m.id,null==m?void 0:m.name),d({type:"SET_FOCUS_TARGETMETAMODEL",data:{id:null==m?void 0:m.id,name:null==m?void 0:m.name}}))},[void 0!==m&&(null==m?void 0:m.id)!==""]),ew&&console.log("33 TargetMeta",e,g,g.nodeDataArray),!(null==h?void 0:h.targetMetamodelRef))return(0,l.jsx)(l.Fragment,{});let j=g&&(0,l.jsx)(ev,{nodeDataArray:g.nodes,linkDataArray:[],metis:e.metis,myMetis:e.myMetis,myGoModel:e.myGoModel,phFocus:e.phFocus,dispatch:e.dispatch}),O=m?(0,l.jsx)("div",{className:"mmname bg-transparent mx-0 px-1 my-0",children:null==m?void 0:m.name}):(0,l.jsx)("span",{children:"No target metamodel"}),k=f?(0,l.jsxs)("span",{children:["Target model: ",null==f?void 0:f.name]}):(0,l.jsx)("span",{children:"No target model"}),M=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{className:"btn-sm text-light bg-transparent border border-0 border-transparent",onClick:T,children:[" ",w?(0,l.jsxs)("span",{className:"ps-1 fs-8",children:[(0,l.jsx)("i",{className:"fa fa-lg fa-angle-right pull-right-container"}),"  Target Metamodel - -"]}):(0,l.jsx)("i",{className:"fa fa-lg fa-angle-left pull-right-container"})]}),w?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"mmname bg-transparent fs-6",style:{fontSize:"10px"},children:O}),(0,l.jsxs)("div",{className:"m-1",children:[" ",j," "]}),(0,l.jsx)("div",{className:"mmname bg-light m-0 mx-1",style:{fontSize:"10px"},children:k})]}):(0,l.jsx)("div",{className:"btn-vertical m-0 pl-2",style:{textAlign:"center",verticalAlign:"baseline",maxWidth:"3px",paddingLeft:"1px",fontSize:"12px",display:"flex",alignItems:"center"},children:(0,l.jsx)("span",{children:" T a r g e t - M e t a m o d e l"})})]});return(0,l.jsxs)("div",{className:"jsx-29cec1c42cd7217f py-1",children:[M,(0,l.jsx)(s(),{id:"29cec1c42cd7217f",children:""})]})},eT=!1,ej=console.log.bind(console,"%c %s","background: green; color: white"),eO=console.log.bind(console,"%c %s","background: blue; color: white");console.trace.bind(console,"%c %s","background: green; color: white"),i(1457);let ek=async(e,t)=>{var i,l,n,s,r,a,d,p,c,u,h,m,f,y,g,v,w,b,T,j,O,k,M,R,A,D;let S;eT&&console.log("28 GenGojsModel started",e,t);let N=null!==(i=e.phUser)&&void 0!==i&&!!i.focusUser&&(null===(s=e.phUser)||void 0===s?void 0:null===(n=s.focusUser)||void 0===n?void 0:null===(l=n.diagram)||void 0===l?void 0:l.showDeleted),P=null!==(r=e.phUser)&&void 0!==r&&!!r.focusUser&&(null===(p=e.phUser)||void 0===p?void 0:null===(d=p.focusUser)||void 0===d?void 0:null===(a=d.diagram)||void 0===a?void 0:a.showDeleted);null!==(c=e.phUser)&&void 0!==c&&c.focusUser&&null!==(m=e.phUser)&&void 0!==m&&null!==(h=m.focusUser)&&void 0!==h&&null!==(u=h.diagram)&&void 0!==u&&u.showDeleted,eT&&console.log("32 GenGojsModel showDeleted",N,null===(g=e.phUser)||void 0===g?void 0:null===(y=g.focusUser)||void 0===y?void 0:null===(f=y.diagram)||void 0===f?void 0:f.showModified);let C=null!==(v=e.phUser)&&void 0!==v&&!!v.focusUser&&(null===(T=e.phUser)||void 0===T?void 0:null===(b=T.focusUser)||void 0===b?void 0:null===(w=b.diagram)||void 0===w?void 0:w.showModified),x=e.phData&&e.phData.metis,_=x&&x.models.filter(e=>e&&e),I=null===(j=e.phFocus)||void 0===j?void 0:j.focusModel;I||(I=_&&_[0]);let V=null===(O=e.phFocus)||void 0===O?void 0:O.focusModelview;V||(V=I&&I.modelviews[0]),eT&&console.log("37 GenGojsModel focusModel",I,V),null===(k=e.phFocus)||void 0===k||k.focusObject;let L=null===(M=e.phFocus)||void 0===M?void 0:M.focusObjectview;if(x&&x.metamodels.filter(e=>e&&e),null!=x){ej("43 GenGojsModel: props",e),eT&&ej("44 GenGojsModel: metis",e.phData.metis);let i=_&&(null==I?void 0:I.id)&&_.find(e=>e.id===I.id),l=i&&(null==V?void 0:V.id)&&(null===(R=i.modelviews)||void 0===R?void 0:R.find(e=>e.id===V.id))?null==i?void 0:null===(A=i.modelviews)||void 0===A?void 0:A.find(e=>e.id===V.id):null==i?void 0:i.modelviews[0],n=e.phFocus&&e.phFocus.focusTargetModel,s=e.phFocus&&e.phFocus.focusTargetModelview,r=_&&(null==n?void 0:n.id)&&_.find(e=>e.id===(null==i?void 0:i.targetModelRef)),a=r&&(null==s?void 0:s.id)&&r.modelviews.find(e=>e.id===(null==s?void 0:s.id))||(null==r?void 0:r.modelviews[0]);if(eT&&console.log("54 GenGojsModel: curmodview",l,i,V,null==i?void 0:i.modelviews),eT&&console.log("51 GenGojsModel: metis",x,t),null==t||t.importData(x,!0),S=E.Pw(t),eO("83 GenGojsModel :",t),eT&&eO("88 GenGojsModel :","\n currentModelview :",null===(D=t.currentModelview)||void 0===D?void 0:D.name,",\n props :",e,"\n myMetis :",t),i&&i.id){let n=null==t?void 0:t.findModel(i.id);eT&&console.log("71 myModel :",n);let d=l&&(null==n?void 0:n.findModelView(null==l?void 0:l.id));eT&&console.log("73 myModelview",d);let p=E.sC(t,n,d,N,P,C);eT&&console.log("75 GenGojsModel myGoModel",p,null==p?void 0:p.nodes);let c=null==n?void 0:n.metamodel;eT&&console.log("77 myMetamodel :",c);let u=E.vv(c,N,C);eT&&console.log("79 myGoMetamodel",u),c&&E.Bv(),eT&&console.log("83 myMetamodelPalette",myMetamodelPalette),c&&E.S4(c,t),eT&&console.log("85 myPalette",myPalette);let h=null==t?void 0:t.findModel(null==r?void 0:r.id),m=a&&t.findModelView(null==s?void 0:s.id),f=t.findMetamodel(i.targetMetamodelRef)||null;E.S4(f,t),eT&&console.log("81 myTargetMetamodel :",i,i.targetMetamodelRef,r,f),f&&E.S4(f,t),eT&&console.log("90 myTargetModelPalette",f,myTargetMetamodelPalette);let y=E.sC(t,h,m,N,P);if(eT&&console.log("113 GenGojsModel myGoModel",t,y,h,m),L.id&&(null==d||d.setFocusObjectview(L)),null==t||t.setGojsModel(p),null==t||t.setCurrentMetamodel(c),null==t||t.setCurrentModel(n),null==t||t.setCurrentModelview(d),eT&&console.log("81 GenGojsModel: metis",t.gojsModel),eT&&console.log("121 GenGojsModel  myMetis",t),eT&&console.log("211 Modelling ",e,t,n,d,c),!t&&!n&&!d&&!c)return console.error("187 One of the required variables is undefined: myMetis: ",t,"myModel: ","myModelview: ",d,"myMetamodel: ",c),null}}eT||console.log("114 GenGojsModel myMetis",t)};var eM=i(3278),eR=i(7725),eA=i(6167),eE=i(1910),eD=i(1758);let eS=!1;var eN=i(7276),eP=i(7705);let eC=!1;console.log.bind(console,"%c %s","background: blue; color: white");let ex=console.log.bind(console,"%c %s","background: red; color: white");console.trace.bind(console,"%c %s","background: blue; color: white");let e_=e=>{var t,i,n,s,d,p,c;eC&&console.log("55 Modelling:",e);let m=(0,a.wA)(),f=(0,r.useRef)(null),[y,R]=(0,r.useState)(!0),[E,D]=(0,u.A)("memorystate",null),[S,N]=(0,h.A)("memorystate",{}),[P,C]=(0,u.A)("akmmUser",""),[x,_]=(0,r.useState)(),[I,V]=(0,r.useState)(!1),[L,F]=(0,r.useState)(!0),[B,G]=(0,r.useState)(!0),[K,J]=(0,r.useState)(!1),[W,z]=(0,r.useState)(!1),[H,Y]=(0,r.useState)(!1),[Z,q]=(0,r.useState)(!1),X=(0,a.d4)(t=>{var i;return null===(i=e.phFocus)||void 0===i?void 0:i.focusModel}),$=(0,a.d4)(t=>{var i;return null===(i=e.phFocus)||void 0===i?void 0:i.focusModelview});(0,a.d4)(t=>{var i;return null===(i=e.phFocus)||void 0===i?void 0:i.focusObjectview}),(0,a.d4)(t=>{var i;return null===(i=e.phFocus)||void 0===i?void 0:i.focusRelshipview}),(0,a.d4)(t=>{var i;return null===(i=e.phFocus)||void 0===i?void 0:i.focusObjecttype}),(0,a.d4)(t=>{var i;return null===(i=e.phFocus)||void 0===i?void 0:i.focusRelshiptype});let Q=(0,a.d4)(t=>e.phSource);eC&&console.log("69 Modelling",X,$);let et=null===(t=e.phData)||void 0===t?void 0:t.metis,ei=null==et?void 0:null===(i=et.models)||void 0===i?void 0:i.filter(e=>e),el=ei&&(null==X?void 0:X.id)&&(null==ei?void 0:ei.find(e=>(null==e?void 0:e.id)===(null==X?void 0:X.id)));el||(el=ei[0]);let eo=null==el?void 0:null===(n=el.modelviews)||void 0===n?void 0:n.filter(e=>e),en=el&&eo&&(null==$?void 0:$.id)&&eo.find(e=>e.id===$.id);en||(en=eo[0]),eC&&console.log("130 Modelling curmodview",el,en,ei,null==X?void 0:X.name,null==$?void 0:$.name);let es=e.phFocus&&e.phFocus.focusTargetModel,er=e.phFocus&&e.phFocus.focusTargetModelview,ea=ei&&(null==es?void 0:es.id)&&ei.find(e=>e.id===(null==el?void 0:el.targetModelRef));ea&&(null==er?void 0:er.id)&&ea.modelviews.find(e=>e.id===(null==er?void 0:er.id))||null==ea||ea.modelviews[0];let ed=ei&&ei.sort((e,t)=>e.name.startsWith("_")&&!t.name.startsWith("_")?1:!e.name.startsWith("_")&&t.name.startsWith("_")?-1:e.name.endsWith("_SM")&&!t.name.endsWith("_SM")?1:!e.name.endsWith("_SM")&&t.name.endsWith("_SM")?-1:e.name.localeCompare(t.name)),ep=ed.length<0?0:ed.findIndex(e=>e.id===X.id),ec=new ee.KU;(0,r.useEffect)(()=>{eC&&console.log("Modelling 126",B),m({type:"TAB",data:B?"model":"metamodel"})},[B]),ek(e,ec),(0,r.useEffect)(()=>{eC&&ex("223 Modelling useEffect 1 []",ec),eC&&console.log("226 ",ec,x,ep),ek(e,ec),R(!y),_(ep),J(!0)},[]);let eu=()=>{Y(!0)},eh=()=>Y(!1),em=t=>{e.onSubmit(t)},ef=(0,l.jsxs)(g.A,{show:H,onHide:eh,className:"projectModalOpen ".concat(Z?"d-none":"d-block"),style:{marginLeft:"200px",marginTop:"100px",backgroundColor:"#fee",zIndex:"9999"},ref:f,children:[(0,l.jsx)(g.A.Header,{closeButton:!0,children:"GitHub Settings: "}),(0,l.jsx)(g.A.Body,{children:(0,l.jsx)(eP.A,{props:e,onSubmit:em})}),(0,l.jsx)(g.A.Footer,{children:(0,l.jsx)(v.A,{color:"link",onClick:eh,children:"Exit"})})]});function eg(){N(e),D(e);let t=setTimeout(()=>{R(!y)},1e3);return()=>clearTimeout(t)}if((0,r.useEffect)(()=>{eC&&ex("157 Modelling useEffect 2 [props.phSource]",e.phSource),e.phSource.includes("Template_PR.json")&&eu()},[e.phSource]),(0,r.useEffect)(()=>{eC&&ex("163 Modelling useEffect 3 [props.phSource]",e.phSource),setTimeout(()=>{var t,i,l,n;eg(),eC&&console.log("226 ",null===(t=e.phFocus.focusModel)||void 0===t?void 0:t.name,null===(i=e.phFocus.focusModelview)||void 0===i?void 0:i.name,null===(n=e.phFocus)||void 0===n?void 0:null===(l=n.focusRefresh)||void 0===l?void 0:l.name)},50)},[null===(d=e.phFocus)||void 0===d?void 0:null===(s=d.focusRefresh)||void 0===s?void 0:s.id]),(0,r.useEffect)(()=>{var t,i,l,n;eC&&ex("223 Modelling useEffect 4 [props.phFocus?.focusModelview.id]",null===(t=e.phFocus.focusModel)||void 0===t?void 0:t.name,null===(i=e.phFocus.focusModelview)||void 0===i?void 0:i.name,null===(n=e.phFocus)||void 0===n?void 0:null===(l=n.focusRefresh)||void 0===l?void 0:l.name);let s=setTimeout(()=>{var t,i,l,n;eC&&console.log("226 ",null===(t=e.phFocus.focusModel)||void 0===t?void 0:t.name,null===(i=e.phFocus.focusModelview)||void 0===i?void 0:i.name,null===(n=e.phFocus)||void 0===n?void 0:null===(l=n.focusRefresh)||void 0===l?void 0:l.id),R(!y)},50);return()=>clearTimeout(s)},[null===(c=e.phFocus)||void 0===c?void 0:null===(p=c.focusModelview)||void 0===p?void 0:p.id]),K){let t=e.phFocus,i=e.phData,n=e.phUser;eC&&console.log("255 Modelling",et.metamodels,et.models,el,en,X),eC&&console.log("256 Modelling",el,en);let s=ed?ed.filter(e=>(null==e?void 0:e.markedAsDeleted)===!1):[],r=s?s.map((e,t)=>{if(e&&!e.markedAsDeleted){let i=t.toString(),n={id:e.id,name:e.name},s=e.modelviews?e.modelviews[0]:null,r={id:null==s?void 0:s.id,name:null==s?void 0:s.name};return(0,l.jsx)(w.A,{className:"model-selection","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:"Description: ".concat(null==e?void 0:e.description,"\n\nTo change Model name, right click the background below and select 'Edit Model'."),children:(0,l.jsx)(b.A,{style:{paddingTop:"0px",paddingBottom:"2px",paddingLeft:"8px",paddingRight:"8px",border:"solid 1px",borderBottom:"none",borderColor:"#eee gray white #eee",color:"black"},className:A()({active:x==i}),onClick:()=>{m({type:"SET_FOCUS_MODEL",data:n}),m({type:"SET_FOCUS_MODELVIEW",data:r}),eg(),_(t)},children:e.name.startsWith("_A")?(0,l.jsx)("span",{className:"text-secondary",style:{scale:"0.8",whiteSpace:"nowrap"},"data-toggle":"tooltip","data-placement":"top","data-bs-html":"_ADMIN_MODEL",children:"_AM"}):e.name})},i)}}):(0,l.jsx)(l.Fragment,{}),a=(0,l.jsx)(U,{myMetis:ec,metis:et,phFocus:t,dispatch:m,modelType:"metamodel"}),d=(0,l.jsx)(ey,{myMetis:ec,metis:et,phData:i,phFocus:t,dispatch:m,phUser:n,modelType:"metamodel",phSource:Q,userSettings:P,visibleFocusDetails:e.visibleFocusDetails,setVisibleFocusDetails:e.setVisibleFocusDetails}),p=(null==el?void 0:el.targetMetamodelRef)!==""?(0,l.jsx)(eb,{myMetis:ec,phFocus:t,metis:et,dispatch:m,modelType:"model"}):(0,l.jsx)(l.Fragment,{}),c=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(T.A,{tabs:!0,style:{minWidth:"350px"},children:(0,l.jsx)("span",{className:"ms-1 me-5",children:(0,l.jsx)("button",{className:"mb-1 pb-4 ms-0 me-5","data-toggle":"tooltip","data-placement":"top",title:"Click to toggle between Metamodel and Model",onClick:()=>G(!B),style:{borderColor:"transparent",width:"116px",height:"20px",fontSize:"16px",backgroundColor:"#77aacc"},children:"< Metamodel >"})})}),(0,l.jsxs)(j.A,{tabId:"1",children:["   ",(0,l.jsx)("div",{className:"workpad p-1 pt-2 bg-white",children:(0,l.jsxs)(O.A,{className:"row",style:{height:"100%",marginRight:"2px",backgroundColor:"#7ac",border:"solid 1px black"},children:[(0,l.jsx)(k.A,{className:"col1 m-0 p-0 pl-3",xs:"auto",children:(0,l.jsx)("div",{className:"myPalette px-1 mt-0 mb-0 pt-0 pb-1",style:{marginRight:"2px",backgroundColor:"#7ac",border:"solid 1px black"},children:a})}),(0,l.jsx)(k.A,{className:"col2",style:{paddingLeft:"1px",marginLeft:"1px",paddingRight:"1px",marginRight:"1px"},children:(0,l.jsx)("div",{className:"myModeller pl-0 mb-0 pr-1",style:{backgroundColor:"#7ac",width:"100%",border:"solid 1px black"},children:d})})]})})]})]});l.Fragment;let u=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(T.A,{tabs:!0,style:{minWidth:"50px",borderBottom:"white"},children:[(0,l.jsx)("span",{className:"ms-1 me-5",children:(0,l.jsx)("button",{className:"p-0 ms-0 me-5","data-toggle":"tooltip","data-placement":"top",title:"Click to toggle between Metamodel and Model",onClick:()=>G(!B),style:{borderColor:"transparent",width:"116px",height:"24px",fontSize:"16px",backgroundColor:"#a0caca"},children:"< Model >"})}),r]}),(0,l.jsx)(M.A,{children:(0,l.jsxs)(j.A,{children:["   ",(0,l.jsx)("div",{className:"workpad p-1 pt-2 bg-white",children:(0,l.jsxs)(O.A,{className:"row1",children:[(0,l.jsxs)(k.A,{className:"col1 m-0 p-0 pl-0",xs:"auto",children:[" ",(0,l.jsx)("div",{className:"myPalette px-1 mt-0 mb-0 pt-0 pb-1",style:{marginRight:"2px",minHeight:"7vh",backgroundColor:"#7ac",border:"solid 1px black"},children:(0,l.jsx)(U,{myMetis:ec,metis:et,phFocus:t,dispatch:m,modelType:"model",phUser:n})})]}),(0,l.jsx)(k.A,{className:"col2",style:{paddingLeft:"1px",marginLeft:"1px",paddingRight:"1px",marginRight:"1px"},children:(0,l.jsx)("div",{className:"myModeller pl-0 mb-0 pr-1",style:{backgroundColor:"#acc",minHeight:"7vh",width:"100%",height:"100%",border:"solid 1px black"},children:(0,l.jsx)(ey,{myMetis:ec,metis:et,phData:i,phFocus:t,dispatch:m,phUser:n,modelType:"model",phSource:Q,userSettings:P,visibleFocusDetails:e.visibleFocusDetails,setVisibleFocusDetails:e.setVisibleFocusDetails,exportTab:e.exportTab})})}),(0,l.jsxs)(k.A,{className:"col3 mr-0 p-0 ",xs:"auto",children:[" ",(0,l.jsx)("div",{className:"myTargetMeta px-0 mb-1 mr-3 pt-0 float-right",style:{minHeight:"6h",height:"100%",marginRight:"0px",backgroundColor:"#8ce",border:"solid 1px black"},children:p})]})]})})]})})]});l.Fragment,eC&&console.log("583 Modelling",x);let h=(0,l.jsx)(eN.A,{buttonLabel:"OSDU Import",className:"ContextModal",ph:e,refresh:y,setRefresh:R});eR.A,eA.A;let f=(0,l.jsx)(eM.A,{buttonLabel:"",className:"ContextModal",ph:e,refresh:y,setRefresh:R}),g=(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"buttonrow d-flex justify-content-between align-items-center",style:{maxHeight:"22px",minHeight:"18px",whiteSpace:"nowrap"},children:[(0,l.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,l.jsx)("span",{className:"btn bg-success me-1 d-flex justify-content-center align-items-center","data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Load downloaded Schema from OSDU (Jsonfiles)",children:h}),(0,l.jsx)("span",{"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Save and Load models (import/export) from/to files",style:{whiteSpace:"nowrap",marginRight:"6px"},children:f})]}),(0,l.jsxs)("span",{className:"btn ps-auto mt-0 pt-1 text-light",onClick:eg,"data-toggle":"tooltip","data-placement":"top",title:"Reload the model",children:[" ","reload"," "]})]})});return ec&&l.Fragment,B?ec&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"diagramtabs pb-0",children:[(0,l.jsx)("div",{className:"position-relative float-end",style:{transform:"scale(0.8)",marginRight:"64px"},children:g}),(0,l.jsx)("div",{className:"modellingContent mt-1 ",children:y?(0,l.jsxs)(l.Fragment,{children:[" ",u," "]}):(0,l.jsx)(l.Fragment,{children:u})})]}),ef]}):(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"diagramtabs pb-0 ",children:(0,l.jsx)("div",{className:"modellingContent mt-1",children:y?(0,l.jsxs)(l.Fragment,{children:[" ",c," "]}):(0,l.jsx)(l.Fragment,{children:c})})})})}};var eI=i(5690),eV=i(1124),eL=i(2287);let eF=!1,eB=console.log.bind(console,"%c %s","background: red; color: white"),eG=e=>{var t;let i=(0,a.wA)(),[n,d]=(0,r.useState)(!1),[m,g]=(0,r.useState)(!1),[v,w]=(0,r.useState)(!1),[b,T]=(0,r.useState)(!1),[j,O]=(0,r.useState)(!0),[k,M]=(0,r.useState)(!1),[R,A]=(0,r.useState)(0);function E(e){let t=e.phData.metis,l=e.phData.metis.metamodels.filter(e=>e),n=e.phData.metis.models.filter(e=>e);t={...t,models:n,metamodels:l};let s={...e.phData,metis:t},r=n.find(e=>{var t;return e.id===(null===(t=q.focusModel)||void 0===t?void 0:t.id)})||n[0],a=r.modelviews.find(e=>{var t;return e.id===(null===(t=q.focusModelview)||void 0===t?void 0:t.id)})||r.modelviews[0],d={...e.phFocus,focusModel:r,focusModelview:a};i({type:"LOAD_TOSTORE_PHDATA",data:s}),i({type:"LOAD_TOSTORE_PHFOCUS",data:d}),i({type:"LOAD_TOSTORE_PHSOURCE",data:e.phSource}),i({type:"LOAD_TOSTORE_PHUSER",data:e.phUser})}let{query:D}=(0,c.useRouter)();eF&&console.log("51 modelling",e);let[S,N]=(0,r.useState)(!1),[P,C]=(0,r.useState)(!1),[x,_]=(0,r.useState)(!0),[I,V]=(0,r.useState)(null),[L,F]=(0,r.useState)(!0),[B,G]=(0,r.useState)(!0),[K,J]=(0,h.A)("memorystate",[]),[W,U]=(0,u.A)("memorystate",[]),[z,H]=(0,h.A)("akmmUser",""),[Y,Z]=(0,r.useState)(!1),q=(0,a.d4)(e=>e.phFocus);(0,r.useEffect)(()=>{eF&&eB("71 modelling useEffect 0 [] ");let t=()=>{let t=K;if(eF&&console.log("81 modelling page reloaded",K),K||(t=W),eF&&console.log("79modelling 1 ",t),t&&t.phData){let e=t;return eF&&console.log("87 modelling ",e),E(e),()=>clearTimeout(timer)}if(eF&&console.log("92 modelling page not reloaded",K[0]),window.confirm("No recovery model.  \n\n  Click 'OK' to recover or 'Cancel' to open initial project.")&&"AKM-INIT-Startup_PR.json"===e.phFocus.focusProj.file){P||(C(!0),window.location.reload());let e=setTimeout(()=>{_(!x)},100);return()=>clearTimeout(e)}};0!==Object.keys(D).length&&K[0],t(),D.org},[]);let X=D.org,$=D.repo,Q=D.path,ee=D.branch,et=D.file,ei=D.model,el=D.modelview;(0,r.useEffect)(()=>{eF&&console.log("118 modelling useEffect 1",D);let t=async()=>{let t=null;try{if(0!==Object.keys(D).length){eF&&console.log("120 modelling query",D,D),X=e.phFocus.focusProj.org,$=e.phFocus.focusProj.repo,Q=e.phFocus.focusProj.path,ee=e.phFocus.focusProj.branch,et=e.phFocus.focusProj.file,ei=e.phFocus.focusProj.model,el=e.phFocus.focusProj.modelview,eF&&console.log("132 modelling query",X,$,Q,ee,et,ei,el);let l=await (0,eD.YK)(X+"/"+$,Q,et,ee,"file"),n=await (null==l?void 0:l.data),s=await (null==l?void 0:l.data.sha);eF&&console.log("138 modelling githubData:",n,s),i({type:"LOAD_TOSTORE_DATA",data:n}),setTimeout(()=>{_(!x)},200);let r=n.phData.metis.models.find(e=>e.id===ei);r||(r=n.phData.metis.models.find(e=>e.name===ei)),eF&&console.log("83 model curmodel",r.modelviews,el);let a=r.modelviews.find(e=>e.id===el);a||(a=r.modelviews.find(e=>e.name===el));let d=I&&{phFocus:{...e.phFocus,focusProj:t,focusModel:I.focusModel,focusModelview:I.focusModelview,focusObject:I.focusObject,focusObjectview:I.focusObjectview,focusRole:I.focusRole,focusTask:I.focusTask}};i({type:"LOAD_TOSTORE_PHFOCUS",data:d})}else X=e.phFocus.focusProj.org,$=e.phFocus.focusProj.repo,Q=e.phFocus.focusProj.path,ee=e.phFocus.focusProj.branch,et=e.phFocus.focusProj.file,ei=e.phFocus.focusProj.model,el=e.phFocus.focusProj.modelview}catch(e){eF&&console.log("174 modelling query error ",e)}};eF&&console.log("178 modelling useEffect 1",D,X,e);let l=setTimeout(()=>{t()},1e3);return eF&&console.log("172 modelling useEffect 1",D,X,e),N(!0),()=>clearTimeout(l)},[]),(0,r.useEffect)(()=>{J({...e,phMymetis:null})},[e.phSource]);let eo=(0,l.jsx)("div",{className:"",style:{backgroundColor:"#bdd"},children:(0,l.jsx)(eI.A,{ph:e,showModal:n,setShowModal:d,showIssueModal:m,setShowIssueModal:g})}),en=S?(0,l.jsx)("div",{children:(0,l.jsx)(f.A,{user:null===(t=e.phUser)||void 0===t?void 0:t.focusUser,children:(0,l.jsx)("div",{id:"index",children:(0,l.jsxs)("div",{className:"wrapper",children:[(0,l.jsx)(eL.U,{...e,expanded:v,setExpanded:w,focusExpanded:b,setFocusExpanded:T,refresh:x,setRefresh:_,visibleFocusDetails:k,setVisibleFocusDetails:M,exportTab:R,setExportTab:A}),(0,l.jsx)("div",{className:"context-bar  pt-0",style:{backgroundColor:"#b0cfcf"},children:b&&(0,l.jsxs)("div",{className:"d-flex justify-content-start align-items-center",style:{backgroundColor:"#fffffd"},children:[(0,l.jsx)("div",{className:"issuesarea",children:(0,l.jsx)(eV.A,{...e,showModal:n,setShowModal:d,showIssueModal:m,setShowIssueModal:g,minimized:j,setMinimized:O,expanded:v})}),(0,l.jsx)("div",{className:"contextarea",children:eo})]})}),(0,l.jsxs)("div",{className:"workplace d-flex",style:{backgroundColor:"#b0cfcf",zIndex:1},children:[(0,l.jsx)(p(),{className:"link ",href:"/model?org=".concat(q.focusProj.org,"&repo=").concat(q.focusProj.repo,"&path=").concat(q.focusProj.path,"&branch=").concat(q.focusProj.branch,"&file=").concat(q.focusProj.file,"&model=").concat(q.focusModel.name,"&modelview=").concat(q.focusModelview.name),target:"_blank",style:{position:"absolute",marginRight:"9px",marginTop:"8px",right:"0",top:"",color:"lightgray"},children:(0,l.jsx)("i",{className:"fas fa-external-link-alt","aria-hidden":"true"})}),(0,l.jsx)("div",{className:"workarea p-1 w-100",style:{backgroundColor:"#bcc"},children:(0,l.jsx)(e_,{...e,visibleFocusDetails:k,setVisibleFocusDetails:M,exportTab:R})})]}),(0,l.jsx)("div",{className:"footer me-4 w-100",children:(0,l.jsx)(y.A,{...e})})]})})})}):(0,l.jsx)(l.Fragment,{children:"No model loaded"});return(0,l.jsxs)(l.Fragment,{children:[x?(0,l.jsxs)(l.Fragment,{children:[" ",en," "]}):(0,l.jsx)(l.Fragment,{children:en}),(0,l.jsx)(s(),{id:"f0f10dd8f37716de",children:""})]})},eK=(0,m.A)((0,a.Ng)(e=>e)(eG))},1166:(e,t,i)=>{"use strict";i.d(t,{UF:()=>l}),i(7876);let l=()=>[{value:"https://img.icons8.com/color/2x/object.png",label:"Object"},{value:"https://img.icons8.com/clouds/2x/services.png",label:"Services"},{value:"https://img.icons8.com/color/2x/important-property.png",label:"Important-property"},{value:"https://img.icons8.com/color/2x/urgent-property.png",label:"Urgent-property"},{value:"property.png",label:"Property"},{value:"https://img.icons8.com/color/2x/information.png",label:"Info"},{value:"https://img.icons8.com/color/2x/admin-settings-male.png",label:"Role"},{value:"https://img.icons8.com/color/2x/task.png",label:"Task"},{value:"https://img.icons8.com/color/2x/view-file.png",label:"View"},{value:"https://img.icons8.com/cotton/72/tear-off-calendar.png",label:"Event"},{value:"https://img.icons8.com/color/2x/rules-book.png",label:"Rule"},{value:"https://img.icons8.com/color/2x/approve.png",label:"Decision"},{value:"https://img.icons8.com/color/2x/energy-meter.png",label:"Unittype"},{value:"https://img.icons8.com/color/2x/data-.png",label:"Datatype"},{value:"https://img.icons8.com/color/2x/variable.png",label:"Datavalue"},{value:"https://img.icons8.com/color/2x/person-male.png",label:"Person"},{value:"https://img.icons8.com/color/search",label:"Search"},{value:"Organisation1.png",label:"Organisation1.png"},{value:"Organisation2.png",label:"Organisation2.png"},{value:"OrganisationUnit.png",label:"OrganisationUnit.png"},{value:"Method.png",label:"Method.png"},{value:"Format.png",label:"Format.png"},{value:"Select.png",label:"Select.png"},{value:"RegExp.png",label:"RegExp.png"},{value:"analyse.png",label:"Analyse.png"},{value:"automated.jfif",label:"Inclusive.png"},{value:"book.png",label:"Book.png"},{value:"carpark.png",label:"Carpark.png"},{value:"car.png",label:"Car.png"},{value:"default.png",label:"Default.png"},{value:"E-Scooter.png",label:"E-Scooter.png"},{value:"exclusive.png",label:"Exclusive.png"},{value:"inclusive.png",label:"Inclusive.png"},{value:"info.svg",label:"Info.svg"},{value:"parallel.png",label:"Parallel.png"},{value:"task1.jfif",label:"Task1.jfif"},{value:"tiger.svg",label:"tiger.svg"},{value:"file-earmark-image.svg",label:"file-earmark-image.svg"},{value:"bug.svg",label:"bug.svg"},{value:"ui-checks.svg",label:"ui-checks.svg"},{value:"youtube.svg",label:"youtube.svg"},{value:"speedometer.svg",label:"speedometer.svg"},{value:"person-square.svg",label:"person-square.svg"},{value:"palette.svg",label:"palette.svg"},{value:"layers.svg",label:"layers.svg"},{value:"inboxes.svg",label:"inboxes.svg"},{value:"house-door.svg",label:"house-door.svg"},{value:"hand-thumbs-up.svg",label:"hands-thumbs-up.svg"},{value:"folder-check.svg",label:"folder-check.svg"},{value:"exclamation-triangle.svg",label:"exclamation-triangle.svg"},{value:"chat-square-text.svg",label:"chat-square-text.svg"},{value:"check-square-fill.svg",label:"check-square-fill.svg"},{value:"check-square.svg",label:"check-square.svg"},{value:"braces.svg",label:"braces.svg"},{value:"bug.svg",label:"bug.svg"},{value:"blank.png",label:"blank.png"},{value:"bullseye.svg",label:"bullseye.svg"}]},2210:(e,t,i)=>{"use strict";i.d(t,{A1:()=>V,AC:()=>j,C2:()=>eo,Di:()=>H,G$:()=>en,He:()=>k,I6:()=>v,JH:()=>g,Lb:()=>w,NQ:()=>z,SV:()=>O,Sy:()=>el,TL:()=>M,UF:()=>$,V_:()=>x,Xi:()=>Z,_3:()=>E,a2:()=>ei,aH:()=>h,aW:()=>y,ad:()=>Q,aw:()=>b,cH:()=>T,ci:()=>R,fs:()=>f,g3:()=>G,hG:()=>es,hh:()=>A,jq:()=>m,kj:()=>C,oK:()=>I,os:()=>N,pH:()=>q,tX:()=>S,vn:()=>ee,xw:()=>D,y8:()=>P,yu:()=>B});var l=i(2588),n=i(7089),s=i(6196),r=i(7662),a=i(3022),d=i(1457),p=i(1324),c=i.n(p);let u=!1;function h(e,t){let i=t.myMetamodel,s=t.myMetis,a=t.myGoMetamodel,p=t.myDiagram;if(e.category===d.gojs.C_OBJECTTYPE){let t;u&&console.log("170 createObjectType",e);let c=e.type,h=e.name;if(c===d.types.OBJECTTYPE_ID){if(h!==d.types.OBJECTTYPE_NAME||h!==d.types.CONTAINERTYPE_NAME){if(t=i.findObjectTypeByName(h)){let r=t.getDefaultTypeView();r||((r=new n.GC(l.gj(),t.name,t,"")).setModified(),t.setDefaultTypeView(r),t.setModified(),i.setModified(),i.addObjectTypeView(r),s.addObjectTypeView(r));let c=new n.Ah(l.gj(),i,t,e.loc,e.size);c&&(i.addObjtypeGeo(c),s.addObjtypeGeo(c)),p.model.setDataProperty(e,"category",d.gojs.C_OBJECTTYPE),p.model.setDataProperty(e,"objecttype",t),ee(e,r,p,a)}else{let c=d.gojs.C_OBJECTTYPE;h="New Type",e.viewkind===d.viewkinds.CONT&&(h="New Container"),t=new n.$$(l.gj(),h,"");{t.setModified(),t.setViewKind(e.viewkind),i.addObjectType(t),i.setModified(),s.addObjectType(t);let u=new n.GC(l.gj(),t.name,t,"");if(u){u.setModified(),u.setViewKind(e.viewkind);let m=u.getData();for(let t in m)"icon"!==t&&"isGroup"!==t&&"group"!==t&&(m[t]=e[t]);i.objtypegeos||(i.objtypegeos=[]);let f=i.findObjtypeGeoByType(t);f||(f=new n.Ah(l.gj(),i,t,e.loc,e.size),i.objtypegeos.push(f)),t.setDefaultTypeView(u),i.addObjectTypeView(u),i.setModified(),s.addObjectTypeView(u),p.model.setDataProperty(e,"category",d.gojs.C_OBJECTTYPE),p.model.setDataProperty(e,"objecttype",t),p.model.setDataProperty(e,"name",h),p.model.setDataProperty(e,"typename",c);let y=l.gj();e.id=y;let g=new r._e(y,t);a.addNode(g),ee(e,u,p,a)}}}}return t}}}function m(e,t,i,l){if(null!==e&&e.objRef){let t=l.myMetis,n=e.object;if(n||(n=t.findObject(e.objRef)),n){t.addObject(n);let l=e.objectview;l||(l=t.findObjectView(e.key)),t.addObjectView(l),n.setName(i),n.setModified(),l&&(l.setName(i),l.setModified(),n.addObjectView(l))}return n}}function f(e,t,i,s){if(null!==e&&"name"===t){let t=s.myMetis,r=s.myMetamodel,a=e.objecttype;a=t.findObjectType(a.id);let d=e.name;if(a){if("New Type"===a.name||"New Container"===a.name){let e=t.findObjectTypeByName(d);if(e){let i=a.getId();a=e,l.WC(r.getObjectTypes(),i),r.addObjectType(a),l.WC(t.getObjectTypes(),i),t.addObjectType(a)}else a.setName(d),a.setModified(),r.setModified()}else a.setName(d),a.setModified(),r.setModified();let p=a.getDefaultTypeView();e.typeview=p,p?(a.setName(d),a.setModified(),r.setModified(),p.setName(d),p.setModified()):((p=new n.GC(l.gj(),d,a,"")).setModified(),a.setDefaultTypeView(p),a.setModified(),r.setModified(),r.addObjectTypeView(p),t.addObjectTypeView(p)),s.myDiagram.model.setDataProperty(e,"name",i)}s.myDiagram.requestUpdate()}}function y(e,t,i,l){let n=i.myMetis,s=i.myDiagram;if(t){let i=t.getDefaultTypeView(),d=n.findObjectView(e.key),p=null==d?void 0:d.object;if(p){var r;let c=p.name!==(null===(r=p.type)||void 0===r?void 0:r.name);if(p.setType(t),p.setModified(),d){d.setTypeView(i),d.setModified(),d.setObject(p),c||s.model.setDataProperty(e,"name",t.name),s.model.setDataProperty(e,"typename",t.name),l||(d.template=e.template,d.template2=e.template2,d.figure=e.figure,d.fillcolor=e.fillcolor,d.strokecolor=e.strokecolor,d.strokewidth=e.strokewidth,d.icon=e.icon),e.objtypeRef=t.id,e.typename=t.name,e.typeview=i,ee(e,i,s,n.gojsModel),u&&console.log("394 node",e);let r=new a.g_(d);u&&console.log("397 jsnObjview",r);let h=[];h.push(r),h.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),s.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})})}let h=p&&new a.pJ(p);u&&console.log("407 jsnObject",h);let m=[];return m.push(h),m.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),s.dispatch({type:"UPDATE_OBJECT_PROPERTIES",data:t})}),d}}}function g(e){let t;for(let i in t=new n.Jo(l.gj(),e.name,e.type,e.description),e)"id"!==i&&"name"!==i&&"description"!==i&&"inputrels"!==i&&"outputrels"!==i&&"objectviews"!==i&&"relshipviews"!==i&&"modified"!==i&&"generatedTypeId"!==i&&(t[i]=e[i]);return t.copiedFromId=e.id,t}function v(e,t,i){u&&console.log("457 fromRel, fromObj, toObj",e,t,i);let s=e.type,r=new n.CK(l.gj(),s,t,i,e.name,e.description);for(let l in u&&console.log("459 toRel",r),r.fromObject=t,r.toObject=i,e)"id"!==l&&"name"!==l&&"description"!==l&&"modified"!==l&&"generatedTypeId"!==l&&"fromObject"!==l&&"toObject"!==l&&"relshipviews"!==l&&(r[l]=e[l]);return r}function w(e,t){for(let i in t)"id"!==i&&"inputrels"!==i&&"outputrels"!==i&&"objectviews"!==i&&"relshipviews"!==i&&"modified"!==i&&"generatedTypeId"!==i&&V(i,e.type)&&(e[i]=t[i])}function b(e,t){try{e.isGroup=t.isGroup,e.groupLayout=t.groupLayout,e.size=t.size,e.scale=t.scale,e.memberscale=t.memberscale,e.arrowscale=t.arrowscale,e.image=t.image,e.icon=t.icon,e.geometry=t.geometry,e.figure=t.figure,e.routing=t.routing,e.linkcurve=t.linkcurve,e.fillcolor=t.fillcolor,e.fillcolor1=t.fillcolor1,e.fillcolor2=t.fillcolor2,e.strokecolor=t.strokecolor,e.strokecolor1=t.strokecolor1,e.strokecolor2=t.strokecolor2,e.strokewidth=t.strokewidth,e.textcolor=t.textcolor,e.textcolor2=t.textcolor2,e.textscale=t.textscale}catch(e){}}function T(e,t){e&&(e.markedAsDeleted=t)}function j(e,t,i){let l=i.myMetis,n=i.myMetamodel;i.myModelview;let s=i.myDiagram;if(e.category===d.gojs.C_OBJECTTYPE){let l=i.myGoMetamodel;if(null==l?void 0:l.findNode(e.key)){let i=e.name,l=n.findObjectTypeByName(i);if(l){l.markedAsDeleted=t;let e=l.getDefaultTypeView();e&&(e.markedAsDeleted=t)}}}else if(e.category===d.gojs.C_OBJECT){let n=i.myGoModel,r=null==n?void 0:n.findNode(e.key);if(r){r.markedAsDeleted=t,r.group="";let i=r.objectview;if(i||(i=l.findObjectView(e.key)),!i)return;i.markedAsDeleted=t;let a=i.object;if(a||(a=l.findObject(i.objectRef)),r.isGroup&&(s.findNodeForKey(e.key).ungroupable=!0),l.deleteViewsOnly)return;if(a){a.removeObjectView(i),i.markedAsDeleted=t;let e=s.findNodeForKey(i.id);e&&(s.startTransaction("remove node"),s.remove(e),s.commitTransaction("remove node"))}s.requestUpdate();let d=null==a?void 0:a.inputrels;for(let e=0;e<(null==d?void 0:d.length);e++){let i=d[e];if(i.markedAsDeleted!==t){i.markedAsDeleted=t;let e=i.relshipviews;for(let i=0;i<(null==e?void 0:e.length);i++){let i=e[0];if(i){let e=n.findLinkByViewId(i.id);e&&(e.markedAsDeleted=t,s.findLinkForKey(i.id),s.model.removeLinkData(e)),i.markedAsDeleted=t}}}}d=null==a?void 0:a.outputrels;for(let e=0;e<(null==d?void 0:d.length);e++){let i=d[e];if(i.markedAsDeleted!==t){i.markedAsDeleted=t;let e=i.relshipviews;for(let i=0;i<(null==e?void 0:e.length);i++){let i=e[0];if(i){let e=n.findLinkByViewId(i.id);e&&(e.markedAsDeleted=t),i.markedAsDeleted=t}}}}}}}function O(e,t,i){let l=i.myMetis;i.myMetamodel,i.myModel;let n=i.myModelview,s=i.myGoModel,r=i.myDiagram,a=[];for(let e=0;e<(null==s?void 0:s.links.length);e++){let t=s.links[e];a.push(t)}s.links=a;let d=null==s?void 0:s.findLink(e.key);if(d){let i=n.findRelationshipView(e.key);if(i){let e=i.relship;if(l.deleteViewsOnly){i.markedAsDeleted=t,u&&console.log("707 deleteLink",e,i),d.markedAsDeleted=t;let l=r.findLinkForKey(i.id);r.startTransaction("remove link"),r.remove(l),r.commitTransaction("remove link"),r.remove(l);return}if(e){e.markedAsDeleted=t,i.markedAsDeleted=t;let n=null==l?void 0:l.getRelationshipViewsByRelship(e.id);if(n)for(let e=0;e<n.length;e++){let i=n[e];u&&console.log("721 rview",i),!i.markedAsDeleted&&(i.markedAsDeleted=t,u&&console.log("725 rview",i))}}}}}function k(e,t,i){let n,s;let r=i.myDiagram,a=i.myGoModel,p=i.myMetis;p.findObjectTypeByName(d.types.AKM_ENTITY_TYPE);let c=p.currentMetamodel,u=i.myModelview,h=i.fromObjView,m=h.object;m||(m=p.findObject(h.objectRef));let f=i.toObjView,y=f.object;y||(y=p.findObject(f.objectRef));let g="",v="";null==m||!m.typeRef||(n=c.findObjectType(null==m?void 0:m.typeRef))||(n=p.findObjectType(null==m?void 0:m.typeRef)),null==y||!y.typeRef||(s=c.findObjectType(null==y?void 0:y.typeRef))||(s=p.findObjectType(null==y?void 0:y.typeRef));let w=c,b=c,T=c.submetamodelRefs;if(!n)for(let e=0;e<(null==T?void 0:T.length);e++){let t=T[e],i=p.findMetamodel(t);if(n=i.findObjectType(null==m?void 0:m.typeRef)){w=i;break}}if(!s)for(let e=0;e<(null==T?void 0:T.length);e++){let t=T[e],i=p.findMetamodel(t);if(s=i.findObjectType(null==y?void 0:y.typeRef)){b=i;break}}c=w;let j=w.relshiptypes;for(let e=0;e<j.length;e++){let t=j[e];p.fixObjectTypeRefs(t)}if(n&&s){let h=n.name===d.types.AKM_LABEL?d.types.AKM_ANNOTATES:"",m=!1;u.includeInheritedReltypes&&(m=!0);let f=[];if(u.isMetamodel){let e=!1;if("Property"===n.name&&"Method"===s.name&&(e=!0),f=c.findRelationshipTypesBetweenTypes(n,s,e),n.name===d.types.AKM_OSDUTYPE){if(s.name===d.types.AKM_PROPERTY){let e=c.findRelationshipTypeByName(d.types.AKM_HAS_PROPERTY);f.push(e)}}else if(n.name===d.types.AKM_ENTITY_TYPE&&s.name===d.types.AKM_ENTITY_TYPE){f=[];let e=c.findRelationshipTypeByName(d.types.AKM_IS);f.push(e),e=c.findRelationshipTypeByName(d.types.AKM_RELATIONSHIP_TYPE),f.push(e)}}else{if(w.id===b.id){if(f=w.findRelationshipTypesBetweenTypes(n,s,m),n.name===d.types.AKM_OSDUTYPE&&s.name===d.types.AKM_PROPERTY){let e=w.findRelationshipTypeByName(d.types.AKM_HAS_PROPERTY);f.push(e)}}else{let e=p.findRelationshipTypesBetweenTypes(n,s,m);for(let t=0;t<e.length;t++){let i=e[t];f.push(i)}}if(!u.isMetamodel){if(w.id===b.id){if(m=!0,f=w.findRelationshipTypesBetweenTypes(n,s,m),n.name===d.types.AKM_OSDUTYPE&&s.name===d.types.AKM_PROPERTY){let e=w.findRelationshipTypeByName(d.types.AKM_HAS_PROPERTY);f.push(e)}if(n.name===d.types.AKM_ENTITY_TYPE&&s.name===d.types.AKM_ENTITY_TYPE){let e=p.findRelationshipTypeByName(d.types.AKM_IS);f.push(e),e=p.findRelationshipTypeByName(d.types.AKM_RELATIONSHIP_TYPE),f.push(e)}}else{let e=p.findRelationshipTypesBetweenTypes(n,s,m);for(let t=0;t<e.length;t++){let i=e[t];f.push(i)}}}}if(f){let c=p.findRelationshipTypeByName(d.types.AKM_REFERS_TO);if(f.push(c),f){let p=[];h.length>0&&p.push(h);let c=[];for(let e=0;e<f.length;e++){let t=f[e];t&&(null==t?void 0:t.name)!==d.types.AKM_GENERIC_REL&&c.push(t.name)}(c=[...new Set(c)]).sort();let u=p.concat(c);u=l.EL(u);let m={what:"selectDropdown",title:"Select Relationship Type",case:"Create Relationship",myDiagram:r,myGoModel:a,myMetamodel:w,context:i,data:i.data,typename:h,fromType:n,toType:s,gjsFromNode:e,portFrom:g,gjsToNode:t,portTo:v};i.handleOpenModal(u,m)}}}}function M(e){let t,i,s,r,a;let p=e.context.myDiagram,c=e.context.myGoModel,u=e.context.myMetis,h=e.metamodel,m=e.context.myModel,f=u.currentModelview,y=f.askForRelshipName,g=e.context.gjsData,v=e.typename,w=g.from,b=e.fromPort,T=g.to,j=e.toPort;e.context;let O=(i=f.findObjectView(w)).object;O||(O=u.findObject(i.objectRef));let k=(s=f.findObjectView(T)).object;k||(k=u.findObject(s.objectRef));let M=e.fromType,A=e.toType,E=h.findRelationshipTypesBetweenTypes(M,A,!0);if(E||(E=u.findRelationshipTypesBetweenTypes(M,A,!0)),E)for(let e=0;e<E.length&&((r=E[e]).name===d.types.AKM_GENERIC_REL||r.name!==v);e++);if(r&&r.name===v||(r=u.findRelationshipTypeByName2(v,M,A)),!r){alert("Relationship type given does not exist!"),p.model.removeLinkData(g);return}let D=m.findRelationship2(O,k,v,r,b,j);if(D&&!D.markedAsDeleted){let e=f.findRelationshipViewsByRel(D,!0);for(let t=0;t<e.length;t++)if(!e[t].markedAsDeleted)return alert("Relationship already exists!\nOperation is cancelled."),e[t]}else D=new n.CK(l.gj(),r,O,k,v,""),y&&(a=prompt("Enter relationship name:",v),D.name=a),O.addOutputrel(D),k.addInputrel(D),m.addRelationship(D),u.addRelationship(D);return D&&(t=R(D,{myDiagram:p,myMetis:u,myModelview:f,myGoModel:c,fromObjview:i,toObjview:s,gjsFromKey:w,gjsToKey:T,reltype:r,data:g,relname:a})),t}function R(e,t){var i,p;let c=[],u=[],h=t.myDiagram,m=t.myMetis,f=t.myModelview,y=m.gojsModel,g=t.gjsFromKey,v=t.gjsToKey;g||(g=t.nodeFrom.key),v||(v=t.nodeTo.key),t.goFromNode;let w=t.fromObjview,b=w.object;t.goToNode;let T=t.toObjview,j=t.reltype,O=t.relname,k=j.typeview,M=t.data;j.name;let R=new n.Zc(l.gj(),O,e,"");R.fromObjview=w,R.toObjview=T,e.addRelationshipView(R),(null===(i=t.reltype)||void 0===i?void 0:i.name)===d.types.AKM_HAS_MEMBER&&(null==b?void 0:b.type.name)===d.types.AKM_CONTAINER&&(R.strokecolor="#dddddd50",R.textcolor="#dddddd50"),w.addOutputRelview(R),T.addInputRelview(R);let A=new r.gR(R.id,y,R);f.addRelationshipView(R),m.addRelationshipView(R),y.addLink(A);let E={key:null==R?void 0:R.id,name:e.name,category:d.gojs.C_RELATIONSHIP,from:g,to:v,relshipRef:null==e?void 0:e.id,relviewRef:null==R?void 0:R.id,reltypeRef:null==j?void 0:j.id,reltypeview:null==j?void 0:null===(p=j.typeview)||void 0===p?void 0:p.id},D=null==k?void 0:k.data;for(let e in D)"id"!==e&&"name"!==e&&"nameId"!==e&&"category"!==e&&"abstract"!==e&&"class"!==e&&"sourceUri"!==e&&"markedAsDeleted"!==e&&"modified"!==e&&"typeRef"!==e&&"data"!==e&&(E[e]=D[e]);return M&&h.model.removeLinkData(M),h.model.addLinkData(E),s.au(E,A,R,h),c.push(new a.w(e)),u.push(new a.GI(R)),c.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),h.dispatch({type:"UPDATE_RELSHIP_PROPERTIES",data:t})}),u.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),h.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})}),R}function A(e,t,i,s){let r=s.myMetis,a=s.myMetamodel,p=s.myGoMetamodel,c=s.myDiagram,h=prompt("Enter type name:","typename");if(u&&console.log("1215 typename",h,a),i.key=l.gj(),c.model.setDataProperty(i,"name",h),null==i.name){c.model.removeLinkData(i),u&&console.log("1220 data",i);return}if(c.model.setDataProperty(i,"category",d.gojs.C_RELSHIPTYPE),h=i.name,u&&console.log("1225 data",i,p),h&&(u&&console.log("1227 from and to type nodes",e,t),e&&t)){let s=e.objecttype,p=t.objecttype,m=r.findRelationshipTypeByName1(h,s,p);if(u&&console.log("1230 reltype",m),m){let e=m.getRelshipKind(),t=new n.MX(l.gj(),m.name,s,p,"");t.setModified(),t.setRelshipKind(e),c.model.setDataProperty(i,"reltype",t),c.model.setDataProperty(i,"category",d.gojs.C_RELSHIPTYPE),a.addRelationshipType(t),r.addRelationshipType(t),u&&console.log("1242 reltype2",t);let h=m.getDefaultTypeView();if(h){let s=l.gj(),d=t.name+"_"+e,p=new n.Fu(s,d,t,"");u&&console.log("1249 reltypeView2",p),p.setModified(),p.setRelshipKind(e);let m=h.getData();u&&console.log("1253 viewdata",m);let f=p.getData();for(let e in m)f[e]=m[e];u&&console.log("1258 reltypeView2",f,p),t.setDefaultTypeView(p),a.addRelationshipTypeView(p),r.addRelationshipTypeView(p),et(i,p,c),c.model.setDataProperty(i,"typeview",p),c.requestUpdate()}return u&&console.log("1266 reltype2",t,r),t}{u&&console.log("1269 reltype",m);let e=l.gj();m=new n.MX(e,i.name,null,null,"");{u&&console.log("1273 reltype",m),c.model.setDataProperty(i,"reltype",m),c.model.setDataProperty(i,"category",d.gojs.C_RELSHIPTYPE),m.setModified(),m.setFromObjtype(s),m.setToObjtype(p),u&&console.log("1279 reltype",m),a.addRelationshipType(m),r.addRelationshipType(m);let e=m.name+"_"+m.getRelshipKind(),t=new n.Fu(l.gj(),e,m,"");return t&&(u&&console.log("1285 reltypeView",t),t.setModified(),c.model.setDataProperty(i,"typeview",t),m.setDefaultTypeView(t),a.addRelationshipTypeView(t),r.addRelationshipTypeView(t),et(i,t,c),c.requestUpdate(),u&&console.log("1293 myMetamodel",a)),u&&console.log("1295 reltype",m),m}}}return null}function E(e,t,i,s){if(u&&console.log("1305 updateRelationshipType",t,i),null!==e&&"name"===t){let r=s.myMetis,a=s.myMetamodel;s.myGoMetamodel;let d=s.myDiagram,p=i,c=r.findRelationshipType(e.reltype.id);if(u&&console.log("1316 updateRelationshipType",c),c){if("New Type"===c.name){let e=r.findRelationshipTypeByName(p);if(e){let t=c.getId();c=e,l.WC(a.getRelationshipTypes(),t),a.addRelationshipType(c),l.WC(r.getRelationshipTypes(),t),r.addRelationshipType(c)}else c.setName(p),c.setModified(),a.setModified()}else c.setName(p),c.setModified(),u&&console.log("1341 updateRelationshipType",c),a.setModified();let s=c.getDefaultTypeView();if(!s){let e=p+"_"+c.getRelshipKind();(s=new n.Fu(l.gj(),e,c,"")).setModified(),c.setDefaultTypeView(s),c.setModified(),a.setModified(),a.addRelationshipTypeView(s),r.addRelationshipTypeView(s)}if(s){let l,n=s.getData();for(l in n)if(l===t){n[l]=i,"abstract"===l&&s.setAbstract(i),"relshipkind"===l&&s.setRelshipKind(i);break}et(e,s,d),d.requestUpdate()}}}}function D(e,t,i){let l=i.myMetis;i.myGoMetamodel;let n=i.myDiagram;if(t){let i=t.getDefaultTypeView(),s=l.findRelationship(e.relship.id);if(s){let r=e.name,d=r!==s.type.name;u&&console.log("1665 data, nameIsChanged, name, currentRelship",e,d,r,s),s.setType(t),s.setModified();let p=l.findRelationshipView(e.relshipview.id);if(p){p.setTypeView(i),p.setName(r),p.setModified(),p.setRelationship(s),e.relshiptype=t,p.strokecolor=i.strokecolor,p.strokewidth=i.strokewidth,p.dash=i.dash,p.fromArrow=i.fromArrow,p.toArrow=i.toArrow,p.fromArrowColor=i.fromArrowColor,p.toArrowColor=i.toArrowColor,et(e,i,n),n.model.setDataProperty(e,"name",r);let l=new a.GI(p);u&&console.log("1687 SetReltype",l),[].map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),n.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})})}let c=s&&new a.w(s),h=[];return h.push(c),h.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),e&&n.dispatch({type:"UPDATE_RELSHIP_PROPERTIES",data:t})}),p}}}function S(e){if(e){e.textscale||(e.textscale=1),e.arrowscale||(e.arrowscale=1.3);let t=e.typeview;if(t){let i=t.data;for(let t in i)e[t]===i[t]&&(e[t]="")}e.strokewidth||(e.strokewidth=1)}return e}function N(e,t){let i=t.myDiagram,l=t.gojsModel,n=e.relshipviews,s=[],r=[];for(let e=0;e<(null==n?void 0:n.length);e++){let t=n[e];if(t.visible)continue;t.visible=!0;let s=l.findLinkByViewId(t.id);i.model.addLinkData(s);let d=new a.GI(t);r.push(d)}return r.map(e=>{let i=e;i=JSON.parse(JSON.stringify(i)),t.myDiagram.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:i})}),s}function P(e,t){let i=t.myDiagram,d=t.gojsModel,p=t.currentModel,c=e.objectviews,h=e.relshipviews;e.relshipviews=l.EL(h);let m=[],f=[],y=[];for(let t=0;t<(null==c?void 0:c.length);t++){let h;let T=c[t];if(T.markedAsDeleted)continue;let j=null==T?void 0:T.object,O=null==j?void 0:j.outputrels;for(let t=0;t<(null==O?void 0:O.length);t++){var g,v,w,b;if((h=O[t]).markedAsDeleted||!(h=p.findRelationship(h.id)))continue;null==h||h.type;let c=null==h?void 0:h.fromObject,T=e.findObjectViewsByObject(c),j=null==h?void 0:h.toObject,k=e.findObjectViewsByObject(j);if(0==T.length||0==k.length)continue;let M=e.findRelationshipViewsByRel(h,!0);if((null==M?void 0:M.length)>0){let e;let t=M[0],l=t.fromObjview,n=t.toObjview;t.markedAsDeleted=!1,s.av(t.id,i)&&(e=i.findLinkForKey(t.id))&&e.from&&e.to&&(e.fromNode||(e.fromNode=i.findNodeForKey(l.id)),e.toNode||(e.toNode=i.findNodeForKey(n.id))),e&&e.fromNode&&e.toNode||((e=new r.gR(t.id,d,t)).loadLinkContent(d),e.fromNode=s.Sr(l.id,i),e.from=null===(g=e.fromNode)||void 0===g?void 0:g.key,e.toNode=s.Sr(n.id,i),e.to=null===(v=e.toNode)||void 0===v?void 0:v.key,d.addLink(e),m.push(e),i.model.addLinkData(e));let p=new a.GI(t);y.push(p);continue}{let t=new n.Zc(l.gj(),h.name,h,h.description),p=null;for(let t=0;t<(null==T?void 0:T.length);t++){let i=T[t];e.repairObjectView(i);let l=e.objectviews;for(let e=0;e<(null==l?void 0:l.length);e++)if(l[e].id===i.id){p=i;break}}let c=null;for(let t=0;t<(null==k?void 0:k.length);t++){let i=k[t];e.repairObjectView(i);let l=e.objectviews;for(let e=0;e<l.length;e++)if(l[e].id===i.id){c=i;break}}if(p&&c){t.setFromObjectView(p),t.setToObjectView(c),h.addRelationshipView(t),u&&console.log("1682 relview",t),e.addRelationshipView(t);let l=new r.gR(t.id,d,t);l.loadLinkContent(d),l.fromNode=s.Sr(p.id,i),l.from=null===(w=l.fromNode)||void 0===w?void 0:w.key,l.toNode=s.Sr(c.id,i),l.to=null===(b=l.toNode)||void 0===b?void 0:b.key,d.addLink(l),m.push(l),i.model.addLinkData(l);let n=new a.g_(p);f.push(n),n=new a.g_(c),f.push(n);let g=new a.GI(t);y.push(g)}}}}return f.map(e=>{let i=e;i=JSON.parse(JSON.stringify(i)),t.myDiagram.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:i})}),y.map(e=>{let i=e;i=JSON.parse(JSON.stringify(i)),t.myDiagram.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:i})}),m}function C(e,t,i,n){if(!t)return;let s=null==t?void 0:t.split(" "),r=parseInt(s[0]),a=parseInt(s[1]),d=null==i?void 0:i.split(" "),p=parseInt(d[0]),c=parseInt(d[1]),h=e.nodes,m=l.Ip(h,"key");h=m,u&&console.log("794 nodes, loc, siz, nod",h,t,i,n);let f=[];for(let e=0;e<(null==h?void 0:h.length);e++){let t=h[e];if(u&&console.log("798 node",t),t.key!==(null==n?void 0:n.key)&&t.isGroup){var y,g;let e=1,i=1,l=t,n=null===(y=l.loc)||void 0===y?void 0:y.split(" "),s=null===(g=l.size)||void 0===g?void 0:g.split(" ");if(!n)return;let d=parseInt(n[0]),u=parseInt(n[1]),h=parseInt(s[0]),m=parseInt(s[1]);if(r>d&&r+p*e<=d+h*i&&a>u&&a+c*e<=u+m*i){let e={name:t.name,groupId:t.key,group:t,size:h*i*m*i};f.push(e)}}}if((f=m=l.Ip(f,"groupId")).sort(function(e,t){return e.size-t.size}),!(f.length>0))return null;{let t=f[0],i=e.findNode(t.groupId);if(i)return i}}function x(e,t,i,l,n,s,r){if("Object"===e.category){let t;let s=null==l?void 0:l.findNode(e.key);if(s||(s=e),s){s.loc=i,s.size=e.size;try{s.scale=s.getMyScale(l)}catch(e){u&&console.log("1181 e",e)}if(s.isGroup){let e=s,i=null==l?void 0:l.nodes;for(let s=0;s<i.length;s++){let r=i[s];if(r.key===e.key)continue;let a=C(l,r.loc,r.size,r);if(r&&a){u&&console.log("960 grp, nod",a,r),r.group=a.key,_(a,r);let e=n.findNodeForKey(r.key);if(null==e?void 0:e.data)try{n.model.setDataProperty(e.data,"group",r.group),u&&console.log("968 n.data",e.data)}catch(e){u&&console.log("970 e",e)}}else r.group="";(t=r.objectview)&&(t.loc=r.loc,t.size=r.size,t.modified=!0,r.group?t.group=a.objviewRef:t.group="")}}if(t){let e=new a.g_(t);r.push(e)}}return s}}function _(e,t){var i;let l=null===(i=e.loc)||void 0===i?void 0:i.split(" ");if(!l)return;let n=parseInt(l[0]),s=parseInt(l[1]),r=t.loc.split(" "),a=parseInt(r[0]),d=parseInt(r[1]),p=a-n,c=d-s,h=t.scale;p*=h,c*=h;let m={x:a=n+p,y:d=s+c};return u&&console.log("921 node, node.loc, loc",t,t.loc,m),m}function I(e,t){for(let i=0;i<(null==e?void 0:e.length);i++)if(e[i].id===t.id){e[i]=t;return}null==e||e.push(t)}function V(e,t){let i=!0;return"__gohashid"===e&&(i=!1),"defaultValueset"===e&&(i=!1),"queries"===e&&(i=!1),"properties"===e&&(i=!1),"ports"===e&&(i=!1),"fromObjtype"===e&&(i=!1),"toObjtype"===e&&(i=!1),"objtypegeos"===e&&(i=!1),"inputreltypes"===e&&(i=!1),"outputreltypes"===e&&(i=!1),"allObjecttypes"===e&&(i=!1),"allRelationshiptypes"===e&&(i=!1),"methods"===e&&(i=!1),"methodRefs"===e&&(i=!1),"propertyRefs"===e&&(i=!1),"attributes"===e&&(i=!1),"allowedValues"===e&&(i=!1),"allProperties"===e&&(i=!1),"cardinality"===e&&(i=!1),"currentTargetModelview"===e&&(i=!1),"category"===e&&(i=!1),"class"===e&&(i=!1),"data"===e&&(i=!1),"defaultValue"===e&&(i=!1),"deleted"===e&&(i=!1),"deleteViewsOnly"===e&&(i=!1),"from"===e&&(i=!1),"fromNode"===e&&(i=!1),"fromObject"===e&&(i=!1),"fromobjectRef"===e&&(i=!1),"fromObjview"===e&&(i=!1),"fromObjviewRef"===e&&(i=!1),"fromPort"===e&&(i=!1),"fs_collection"===e&&(i=!1),"generatedTypeId"===e&&(i=!1),"group"===e&&(i=!1),"groupLayout"===e&&(i=!1),"inputrels"===e&&(i=!1),"isExpanded"===e&&(i=!1),"isGroup"===e&&(i=!1),"isMetamodel"===e&&(i=!1),"isTemplate"===e&&(i=!1),"key"===e&&(i=!1),"layer"===e&&(i=!1),"metamodelRef"===e&&(i=!1),"modeltype"===e&&(i=!1),"modified"===e&&(i=!1),"nameId"===e&&(i=!1),"object"===e&&(i=!1),"objectview"===e&&(i=!1),"objectviews"===e&&(i=!1),"objectRef"===e&&(i=!1),"outputrels"===e&&(i=!1),"objecttype"===e&&(i=!1),"parent"===e&&(i=!1),"parentModel"===e&&(i=!1),"parentModelRef"===e&&(i=!1),"pasteViewsOnly"===e&&(i=!1),"points"===e&&(i=!1),"propertyValues"===e&&(i=!1),"relship"===e&&(i=!1),"relshipRef"===e&&(i=!1),"relshiptype"===e&&(i=!1),"relview"===e&&(i=!1),"relviewRef"===e&&(i=!1),"relshipview"===e&&(i=!1),"reltype"===e&&(i=!1),"reltypeRef"===e&&(i=!1),"relshipviews"===e&&(i=!1),"size"===e&&(i=!1),"sourceModelRef"===e&&(i=!1),"sourceUri"===e&&(i=!1),"targetMetamodelRef"===e&&(i=!1),"targetModelRef"===e&&(i=!1),"supertypes"===e&&(i=!1),"supertypeRefs"===e&&(i=!1),"to"===e&&(i=!1),"toNode"===e&&(i=!1),"toObject"===e&&(i=!1),"toobjectRef"===e&&(i=!1),"toObjview"===e&&(i=!1),"toObjviewRef"===e&&(i=!1),"fromPortid"===e&&(i=!1),"toPortid"===e&&(i=!1),"toPort"===e&&(i=!1),"type"===e&&(i=!1),"typeRef"===e&&(i=!1),"toobjtypeRef"===e&&(i=!1),"fromobjtypeRef"===e&&(i=!1),"typeview"===e&&(i=!1),"typeviewRef"===e&&(i=!1),"valueset"===e&&(i=!1),"visible"===e&&(i=!1),"relshipkind"===e&&(i=!1),(null==t?void 0:t.name)!=="ViewFormat"&&(null==t?void 0:t.name)!=="Datatype"&&(null==t?void 0:t.name)!=="Property"&&"viewFormat"===e&&(i=!1),(null==t?void 0:t.name)!=="InputPattern"&&(null==t?void 0:t.name)!=="Datatype"&&(null==t?void 0:t.name)!=="Property"&&("inputPattern"===e&&(i=!1),"inputExample"===e&&(i=!1)),(null==t?void 0:t.name)!=="FieldType"&&(null==t?void 0:t.name)!=="Datatype"&&"fieldType"===e&&(i=!1),i}function L(e,t){let i=e.metamodels;for(let e=0;e<(null==i?void 0:i.length);e++){let l=i[e].objecttypes;for(let e=0;e<(null==l?void 0:l.length);e++){let i=l[e].properties;for(let e=0;e<(null==i?void 0:i.length);e++)if(i[e].id===t.id)return!0}}return!1}function F(e){let t=[],i=e.properties;for(let l=0;l<(null==i?void 0:i.length);l++){let n=i[l];L(e,n)&&t.push(n)}e.properties=t;let l=e.metamodels;for(let t=0;t<(null==l?void 0:l.length);t++){let i=l[t],n=[],s=i.properties;for(let t=0;t<(null==s?void 0:s.length);t++){let i=s[t];L(e,i)&&n.push(i)}i.properties=n}}function B(e,t,i){let l=e.metamodels,n=[],s=e.objecttypes;for(let e=0;e<(null==s?void 0:s.length);e++){let t=s[e];t.markedAsDeleted||n.push(t)}e.objecttypes=n;let r=[],d=e.objecttypeviews;for(let e=0;e<(null==d?void 0:d.length);e++){let t=d[e];t.markedAsDeleted||r.push(t)}e.objecttypeviews=r;let p=[],c=e.objtypegeos;for(let e=0;e<(null==c?void 0:c.length);e++){let t=c[e];t.markedAsDeleted||p.push(t)}e.objtypegeos=p;let h=[],m=e.relshiptypes;for(let e=0;e<(null==m?void 0:m.length);e++){let t=m[e];t.markedAsDeleted||h.push(t)}e.relshiptypes=h;let f=[],y=e.relshiptypeviews;for(let e=0;e<(null==y?void 0:y.length);e++){let t=y[e];t.markedAsDeleted||f.push(t)}e.relshiptypeviews=f,e.metamodels=[];for(let t=0;t<(null==l?void 0:l.length);t++){let i=l[t];i.markedAsDeleted||e.metamodels.push(i)}for(let e=0;e<(null==l?void 0:l.length);e++){let i=l[e];if(i.markedAsDeleted)continue;let n=JSON.parse(JSON.stringify(new a.YS(i,!0)));u&&console.log("2291 data",n),t.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:n})}}function G(e,t){F(e);let i=e.models,l=[],n=[];for(let e=0;e<(null==i?void 0:i.length);e++){let t=i[e],s=null==t?void 0:t.modelviews;for(let e=0;e<(null==s?void 0:s.length);e++){let t=s[e],i=t.objectviews;u&&console.log("2324",i);let r=[];for(let e=0;e<(null==i?void 0:i.length);e++){let t=i[e];t.markedAsDeleted||(r.push(t),l.push(t))}u&&console.log("2332",r),t.objectviews=r;let a=t.relshipviews,d=[];for(let e=0;e<(null==a?void 0:a.length);e++){let t=a[e];t.markedAsDeleted||(d.push(t),n.push(t))}t.relshipviews=d,u&&console.log("2345 mview",t)}let r=t.objects;u&&console.log("2339",r);let a=[];for(let e=0;e<(null==r?void 0:r.length);e++){let t=r[e];t.markedAsDeleted||a.push(t)}u&&console.log("2361",a),t.objects=a;let d=t.relships,p=[];for(let e=0;e<(null==d?void 0:d.length);e++){let t=d[e];t.markedAsDeleted||p.push(t)}t.relships=p,u&&console.log("2373",t)}let s=e.objectviews;for(let e=0;e<(null==s?void 0:s.length);e++){let t=s[e];t.markedAsDeleted||l.push(t)}e.objectviews=l;let r=[],d=e.objects;for(let e=0;e<(null==d?void 0:d.length);e++){let t=d[e];t.markedAsDeleted||r.push(t)}e.objects=r;let p=e.relshipviews;for(let e=0;e<(null==p?void 0:p.length);e++){let t=p[e];t.markedAsDeleted||n.push(t)}e.relshipviews=n;let c=[],h=e.relships;for(let e=0;e<(null==h?void 0:h.length);e++){let t=h[e];t.markedAsDeleted||c.push(t)}e.relships=c;let m={metis:new a.io(e,!0)};m=JSON.parse(JSON.stringify(m)),t.dispatch({type:"LOAD_TOSTORE_PHDATA",data:m})}function K(e){var t,i;let l=e.metamodels,n=e.relshiptypes;for(let e=0;e<(null==n?void 0:n.length);e++){let t=n[e],i=!1;for(let e=0;e<(null==l?void 0:l.length);e++)if(l[e].findRelationshipType(t.id)){i=!0;break}i||(t.markedAsDeleted=!0)}{let i=null===(t=e.relshiptypes)||void 0===t?void 0:t.length;for(let e=i-1;e>=0;e--)n[e].markedAsDeleted&&n.splice(e,1)}let s=e.objecttypes;for(let e=0;e<(null==s?void 0:s.length);e++){let t=s[e],i=!1;for(let e=0;e<(null==l?void 0:l.length);e++)if(l[e].findObjectType(t.id)){i=!0;break}i||(t.markedAsDeleted=!0)}{let t=null===(i=e.objecttypes)||void 0===i?void 0:i.length;for(let e=t-1;e>=0;e--)s[e].markedAsDeleted&&s.splice(e,1)}}function J(e){let t=e.outputrelviews,i=e.outputrelviews,l=[];for(let e=0;e<(null==t?void 0:t.length);e++){let n=t[e];if(n.markedAsDeleted)continue;let s=n.relship,r=!1;for(let e=0;e<(null==i?void 0:i.length);e++){let t=i[e];if(t.markedAsDeleted)continue;let a=t.relship;(null==a?void 0:a.id)===(null==s?void 0:s.id)&&(r?t.markedAsDeleted=!0:r=!0,l.push(n))}}e.outputrelviews=l}function W(e,t){if(null==t?void 0:t.group){let l=t.modelview;if(!l){let l=t.object;l||(l=e.findObject(t.objectRef));let n=e.models;for(let t=0;t<(null==n?void 0:n.length);t++)if(n[t]){let t=e.modelviews;for(let e=0;e<(null==t?void 0:t.length);e++){let n=t[e].objectviews;for(let e=0;e<(null==n?void 0:n.length);e++){var i;let t=n[e];if((null==t?void 0:null===(i=t.object)||void 0===i?void 0:i.id)===(null==l?void 0:l.id))return!0}}}}let n=null==l?void 0:l.findObjectView(t.group),s=null==n?void 0:n.object;if(s&&s.type.name===d.types.AKM_MODEL)return!0}return!1}function U(e,t,i){let l=t.submetamodelRefs;for(let t=0;t<(null==l?void 0:l.length);t++){let n=l[t],s=e.findMetamodel(n);if(null==s?void 0:s.findObjectType(i.id))return!0}return!1}function z(e,t,i,s,r){var p,h,m,f,y,g,v,w,b;u&&console.log("2412 verifyAndRepairModel STARTED");let T="%s\n",j="Verification report\n",O=c()(T,j);j="First do some initial checks\n";let k=r.metamodels,M=[];for(let e=0;e<(null==k?void 0:k.length);e++){let t=k[e],i=t.relshiptypes;for(let e=0;e<(null==i?void 0:i.length);e++){let l=i[e];for(let n=e+1;n<(null==i?void 0:i.length);n++){let e=i[n];(null===(p=l.fromObjtype)||void 0===p?void 0:p.id)===(null===(h=e.fromObjtype)||void 0===h?void 0:h.id)&&(null===(m=l.toObjtype)||void 0===m?void 0:m.id)===(null===(f=e.toObjtype)||void 0===f?void 0:f.id)&&l.name===e.name&&(u&&console.log("Removing duplicate relship type",l,e),j+="A duplicate relship type, '"+e.name+"', has been removed from the metamodel, '"+t.name+"'\n",i.splice(n,1),n--)}}}u&&console.log("2437 metamodels",k),u&&console.log("2439 model, modelviews",e,i,r);for(let e=0;e<(null==i?void 0:i.length);e++){let t=i[e].objectviews;for(let e=0;e<(null==t?void 0:t.length);e++){let i=t[e];"Container"!==i.viewkind||i.isGroup||(i.isGroup=!0,j+="The container view '"+i.name+"' is now a group (isGroup = true)\n");let l=i.object;l&&(null===(y=l.type)||void 0===y?void 0:y.name)===d.types.AKM_MODEL&&(i.viewkind="Container",i.isGroup=!0)}}j+="The initial checks are completed\n",O+=c()(T,j);let R=null==s?void 0:s.myGoModel,A="Generic",E=e.objects;j="Verifying objects\n";for(let i=0;i<(null==E?void 0:E.length);i++){let l=E[i];if(!l.type){u&&console.log("2434 obj, myMetis",l,r);let e=r.findObjectTypeByName(A);e&&(l.type=e,l.typeRef=e.id,l.typeName=e.name,j+="	Verifying object '"+l.name+"' ( without type )\n"+("	Object type has been set to '"+A)+"'\n",u&&console.log("2443 msg",j))}if(l.type.name===d.types.AKM_MODEL)continue;let n=!1,a=l.objectviews;for(let e=0;e<(null==a?void 0:a.length);e++)if(W(r,a[e])){n=!0;continue}let p=l.type;if(p&&U(r,t,p))continue;l.inputrels=[],l.outputrels=[];let h=l.typeRef,m=l.typeName;u&&console.log("2450 obj",l,e);let f=t.findObjectType(h);j+="	Verifying object ("+l.name+") of type ("+m+")\n";let y=!1;if(!f&&(j+="	Object type '"+h+"' ('"+m+"') was not found\n",u&&console.log("2458 Type of object not found:",l),(f=t.findObjectTypeByName(m))||n||(f=r.findObjectTypeByName(A)),f&&(l.type=f,l.typeRef=f.id,l.typeName=f.name,y=!0,j+="	Object type changed to: '"+f.name+"'\n",O+=c()(T,j),j="")),f){let e=l.objectviews;for(let t=0;t<(null==e?void 0:e.length);t++){let i=e[t];i.name=l.name,l.markedAsDeleted&&!i.markedAsDeleted&&(i.markedAsDeleted=!0,j+="	Verifying object '"+l.name+"("+l.id+") that is deleted, but objectview is not.\n	Is repaired by deleting object view\n"),i.typeview?y&&(i.fillcolor="red"):(i.typeview=f.typeview,j+="Object typeview of : '"+f.name+"' set to default\n");let n=R.findNodeByViewId(i.id);if(n){n.name=i.name;let e=s.findNodeForKey(null==n?void 0:n.key);e&&(e.data=n)}}s.requestUpdate()}}j+="Verifying objects and object types are completed\n",O+=c()(T,j);{j="Verifying object views\n";let e=[];for(let t=0;t<(null==i?void 0:i.length);t++){let l=[],n=i[t],s=n.objectviews,r=[];for(let e=0;e<(null==s?void 0:s.length);e++){let t=s[e];t.object&&(u&&console.log("2970 oview",t.name),r.push(t))}n.objectviews=l=0==t?r:null==l?void 0:l.concat(r),e=null==e?void 0:e.concat(l)}u&&console.log("2515 objectviews",objectviews);let t=[];for(let i=0;i<(null==e?void 0:e.length);i++){let l=e[i];if(l){let e=l.object;if(e&&e.type.name===d.types.AKM_MODEL)continue;if(!l.id){j+="	Object view '"+l.name+"' has no id\n";continue}if(!l.name){j+="	Object view '"+l.id+"' has no name\n";continue}if(!l.typeview){j+="	Object view '"+l.name+"' has no typeview\n";continue}if(!l.object){j+="	Object view '"+l.name+"' has no object\n";continue}t.push(l)}}e=t,u&&console.log("2515 objectviews",e);for(let t=0;t<(null==e?void 0:e.length);t++){let i=e[t];!i||(i.markedAsDeleted?!i.object&&(i.name?j+="	Verifying object view without object'"+i.name+"' ("+i.id+")\n	Doing nothing\n":i.markedAsDeleted=!0):(u&&console.log("2520 oview, object:",i,i.object),(null===(g=i.object)||void 0===g?void 0:g.markedAsDeleted)?(i.object.markedAsDeleted=!1,j+="	Verifying object view '"+i.name+"' ( with object deleted)\n	Object has been undeleted"):i.object||(i.markedAsDeleted=!0,j+="	Verifying objectview '"+i.name+"NaN"+i.id+" ( without object )\n	Objectview has been deleted")))}r.objectviews=e,j+="Verifying object views is completed\n",O+=c()(T,j)}{j="Verifying relationships\n	Checking for duplicate relationships. \n	If found, they are deleted, including their relationship views.\n";let i=e.relships;if(i)for(let t=0;t<(null==i?void 0:i.length);t++){let l=i[t],n=l.fromObject,s=l.toObject,r=l.type,a=[];if(r){let t=e.findRelationships(n,s,r);for(let e=0;e<(null==t?void 0:t.length);e++){let i=t[e];(null==i?void 0:null===(v=i.type)||void 0===v?void 0:v.id)===r.id&&i.name===l.name&&a.push(i)}for(let e=0;e<a.length;e++){if(0==e)continue;let t=a[e];t.markedAsDeleted=!0;let i=t.relshipviews;for(let e=0;e<(null==i?void 0:i.length);e++)i[e].markedAsDeleted=!0;1==e&&(j+="	Duplicated relationship '"+t.name+"' with views are deleted\n")}}}let l=d.types.AKM_GENERIC_REL;if(i)for(let e=0;e<(null==i?void 0:i.length);e++){let n=i[e];u&&console.log("2283 rel",n);let s=n.fromObject,a=n.toObject,d=null==s?void 0:s.type,p=null==a?void 0:a.type,c=n.typeRef,h=n.typeName;if(n.typeName,h||(h=n.name),!n.type){let e=r.findRelationshipTypeByName(l);e&&(n.type=e,n.typeRef=e.id,n.typeName=e.name,j+="	Verifying relationship '"+n.name+"' ( without type )\n"+("	Relationship type has been set to '"+l)+"'\n")}c||(c=n.type.id);let m=t.findRelationshipType(c);if(u&&console.log("2304 fromType and toType",c,h,d,p,m),j+="		Verifying relationship type '"+h+"' ('"+c+"')\n",!m){j+="	Relationship type '"+h+"' ('"+c+"') was NOT found\n",u&&console.log("2309 Relationship with unknown type:",h),"hasProperty"===h?(h="has",p=t.findObjectTypeByName("Property")):"hasValue"===h?(h="has",p=t.findObjectTypeByName("Value")):"hasAllowedValue"===h?(h="hasAllowed",p=t.findObjectTypeByName("Value")):"isOfDatatype"===h?(h="isOf",p=t.findObjectTypeByName("Datatype")):"hasUnittype"===h&&(h="has",p=t.findObjectTypeByName("Unittype"));let e=t.findRelationshipTypesByName(h);if(u&&console.log("2331 Relationship type with name:",h,e),e)for(let i=0;i<(null==e?void 0:e.length);i++){let l=e[i],s=d;s||(s=l.fromObjtype);let r=p;if(r||(r=l.toObjtype),u&&console.log("2339 fromType and toType",h,s,r),s&&r){u&&console.log("2341 findreltypebyname",h,s.name,r.name);let e=t.findRelationshipTypeByName2(h,s,r);if(e){n.type=m=e,n.name=h,j+="	Relationship type changed to: '"+h+"' ( '"+m.id+"' )\n",u&&console.log("2349 Found relationship type:",m);break}}}!m&&(m=t.findRelationshipTypeByName(l))&&(n.type=m,n.name=h,j+="	Verifying relationship '"+(null==n?void 0:n.name)+"' ( without type )\n"+("	Relationship type has been set to "+l)+"\n")}let f=n.relshipviews;for(let e=0;e<(null==f?void 0:f.length);e++)f[e].name=n.name}O+=c()(T,j)}j="Verifying Relationship views\n";for(let e=0;e<(null==i?void 0:i.length);e++){let t=i[e];if(t){let e=t.relshipviews;u&&console.log("2690 modelview",t);for(let i=0;i<(null==e?void 0:e.length);i++){let l=e[i],n=l.relship,r=l.fromObjview,d=l.toObjview,p=t.findRelationshipViewsByRel2(n,r,d,!0);if(u&&console.log("2697 rel, relviews",n,p),p.length>1){j+="	Verifying relationship '"+n.name+"' with multiple relationshipviews.\n";let e=0,t=[];for(let i=0;i<(null==p?void 0:p.length);i++){let l=p[i];!l.markedAsDeleted&&(t.push(l),e++)}if(u&&console.log("2708 n, rel, rvs",e,n,t),e>1)for(let e=0;e<(null==t?void 0:t.length);e++)0!=e&&(t[e].markedAsDeleted=!0);j+="	Is repaired by deleting all relationship views but the first one\n"}if(u&&console.log("2719 relshipview",l),l&&!l.markedAsDeleted){let e=l.relship;if(e&&e.type){u&&console.log("2723 relshipview",e),e.markedAsDeleted&&!l.markedAsDeleted&&(l.markedAsDeleted=!0,j+="	Verifying relationship '"+e.name+"' that is deleted, but relationship view is not.\n	Is repaired by deleting the relationship view\n"),l.typeview?j+="	Relationship typeview of '"+(null===(b=e.type)||void 0===b?void 0:b.name)+"' found\n":(l.typeview=e.type.typeview,j+="	Relationship typeview of "+(null===(w=e.type)||void 0===w?void 0:w.name)+" set to default\n");let t=R.findLinkByViewId(l.id);if(t){t.name=l.name;let e=s.findLinkForKey(null==t?void 0:t.key);e&&(e.data=t)}}}let c=new a.GI(l);M.push(c)}e=l.EL(e)}}j+="\nVerifying relationship views is completed\n",O+=c()(T,j),j="Verifying relationships is completed\n",O+=c()(T,j);let D=r.findObjectTypeByName(d.types.AKM_MODEL),S=r.findObjectTypeByName(d.types.AKM_METAMODEL),N=r.findRelationshipTypeByName1(d.types.AKM_HAS_SUBMETAMODEL,S,S),P=r.findRelationshipTypeByName1(d.types.AKM_HAS_SUBMODEL,S,D);e.getRelationshipsByType(N);let C=e.getRelationshipsByType(P);for(let e=0;e<(null==i?void 0:i.length);e++){let t=i[e];for(let e=0;e<C.length;e++){let i=C[e],s=t.findRelationshipViewsByRel(i,!0);if(!s||0===s.length){let e=new n.Zc(l.gj(),i.name,i,i.description);t.relshipviews.push(e),r.relshipviews.push(e)}}}u&&console.log("2825 myMetis",r);let x={metis:new a.io(r,!0)};x=JSON.parse(JSON.stringify(x)),s.dispatch({type:"LOAD_TOSTORE_PHDATA",data:x}),j="End Verification\n",O+=c()(T,j),u&&console.log(O),s.requestUpdate(),u&&console.log("2841 verifyAndRepairModel ENDED, myMetis",r)}function H(e,t){var i,l;u&&console.log("2829 verifyAndRepairMetamodels STARTED");let n="%s\n",s="Verification report\n",r=c()(n,s);{let t=e.metamodels;u&&console.log("2837 metamodels",t);for(let e=0;e<(null==t?void 0:t.length);e++){let i=t[e];if(i.id){i.objtypegeos=i.purgeObjtypeGeos();let e=i.objecttypeviews;for(let t=0;t<(null==e?void 0:e.length);t++){let l=e[t];if(l){let e=i.findObjectType(l.typeRef);e&&e.name===d.types.AKM_CONTAINER&&(l.image="./../images/blank.png")}}}else u&&console.log("Removing corrupt metamodel",i),t.splice(e,1),s+="A corrupt metamodel has been removed\n",e--}}K(e),Y(e,t),u&&console.log("2852 myMetis",e),q(e,null,t),X(e,t);let p=[],h=[],m=e.findMetamodelByName("AKM-Core_MM"),f=er(m);m.objecttypeviews=f,h.push(m);let y=new a.YS(m,!0);p.push(y);for(let t=0;t<(null===(i=e.metamodels)||void 0===i?void 0:i.length);t++){let i=e.metamodels[t];if("AKM-Core_MM"===i.name)continue;let l=er(i);i.objecttypeviews=l,h.push(i);let n=new a.YS(i,!0);p.push(n)}e.metamodels=h;for(let t=0;t<(null===(l=e.metamodels)||void 0===l?void 0:l.length);t++){let i=e.metamodels[t].objecttypeviews;for(let t=0;t<(null==i?void 0:i.length);t++){let l=i[t];e.addObjectTypeView(l)}}p.map(e=>{let i=e;i=JSON.parse(JSON.stringify(i)),t.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:i})}),r+=c()(n,s),u&&console.log(r),t.requestUpdate(),u&&console.log("2866 verifyAndRepairMetamodel ENDED, myMetis",e)}function Y(e,t){var i,n,s,r;let a=[];for(let t=0;t<(null===(i=e.metamodels)||void 0===i?void 0:i.length);t++){let i=e.metamodels[t],l=i.relshiptypes;for(let e=0;e<(null==l?void 0:l.length);e++){let t=l[e],n=t.typeview;n&&(n.name=t.name+"_"+t.relshipkind,a.push({metamodel:i,reltype:t,reltypeview:n}))}}u&&console.log("2868 myArray",a);let d=e.relshiptypeviews;for(let e=0;e<(null==d?void 0:d.length);e++){let t=d[e],i=!1;for(let e=0;e<(null==a?void 0:a.length);e++)if(a[e].reltypeview.id===t.id){i=!0;break}i||(t.markedAsDeleted=!0)}{let t=e.relshiptypeviews,i=null===(n=e.relshiptypeviews)||void 0===n?void 0:n.length;for(let e=i-1;e>=0;e--)t[e].markedAsDeleted&&t.splice(e,1)}let p=[];for(let e=0;e<(null==d?void 0:d.length);e++){let t=d[e];" "===t.fromArrow&&(t.fromArrow="")," "===t.toArrow&&(t.toArrow="")," "===t.fromArrowColor&&(t.fromArrowColor="")," "===t.toArrowColor&&(t.toArrowColor=""),p.push(t)}null==p||p.map(e=>{let i=e&&e;i=JSON.parse(JSON.stringify(i)),t.dispatch({type:"UPDATE_RELSHIPTYPEVIEW_PROPERTIES",data:i})}),u&&console.log("2896 myMetis",e);{a=[];let t=e.metamodels;for(let i=0;i<(null===(s=e.relshiptypes)||void 0===s?void 0:s.length);i++){let l=e.relshiptypes[i],n=l.fromobjtypeRef,s=l.toobjtypeRef,r=e.findObjectType(n),d=e.findObjectType(s),p=null;for(let e=0;e<(null==t?void 0:t.length);e++){let i=t[e];if(i.findRelationshipType(l.id)){p=i;break}}if(!p){l.markedAsDeleted=!0;continue}a.push({name:null==r?void 0:r.name,relName:null==l?void 0:l.name,toName:null==d?void 0:d.name,metamodel:p?p.name:null,fromObjtype:r,reltype:l,toObjtype:d})}a.sort(l.UD),u&&console.log("2904 myArray",a)}{let t=e.relshiptypes,i=null===(r=e.relshiptypes)||void 0===r?void 0:r.length;for(let e=i-1;e>=0;e--)t[e].markedAsDeleted&&t.splice(e,1)}}function Z(e,t){let i=[],l=e.metamodels;for(let e=0;e<(null==l?void 0:l.length);e++){let t=l[e].properties;for(let e=0;e<(null==t?void 0:t.length);e++){let l=t[e];i.push(l)}}e.properties=i;let n={metis:new a.io(e,!0)};n=JSON.parse(JSON.stringify(n)),t.dispatch({type:"LOAD_TOSTORE_PHDATA",data:n})}function q(e,t,i){let l=e.findObjectTypeByName(d.types.AKM_ENTITY_TYPE),n=e.findObjectTypeByName(d.types.AKM_RELSHIPTYPE);if(t&&(null==(l=t.findObjectTypeByName(d.types.AKM_ENTITY_TYPE))||l.removeDuplicateProperties()),l){let n=l.typeviewRef;if(n){let l;if(l=t?t.findObjectTypeView(n):e.findObjectTypeView(n),i&&l){l.icon="";let e=new a.mX(l);e=JSON.parse(JSON.stringify(e)),i.dispatch({type:"UPDATE_OBJECTTYPEVIEW_PROPERTIES",data:e})}}}if(n){let l=n.typeviewRef;if(l){let n;if(n=t?t.findObjectTypeView(l):e.findObjectTypeView(l),i&&n){n.icon="";let e=new a.mX(n);e=JSON.parse(JSON.stringify(e)),i.dispatch({type:"UPDATE_OBJECTTYPEVIEW_PROPERTIES",data:e})}}}}function X(e,t){let i=e.findObjectTypeByName(d.types.AKM_RELSHIP_TYPE);if(i){let l=i.typeviewRef;if(l){let i=e.findObjectTypeView(l);i.icon="";let n=new a.mX(i);n=JSON.parse(JSON.stringify(n)),t.dispatch({type:"UPDATE_OBJECTTYPEVIEW_PROPERTIES",data:n})}}}function $(e,t,i){let l=e.findRelationshipTypeByName(d.types.AKM_CONTAINS);if(t&&(l=t.findRelationshipTypeByName(d.types.AKM_CONTAINS)).removeDuplicateProperties(),l){let n=l.typeviewRef;if(n){let l;if(l=t?t.findRelationshipTypeView(n):e.findRelationshipTypeView(n),i&&l){l.strokecolor="lightgrey";let e=new a.KW(l);e=JSON.parse(JSON.stringify(e)),i.dispatch({type:"UPDATE_RELSHIPTYPEVIEW_PROPERTIES",data:e})}}}}function Q(e,t,i){let l=e.relshiptypes;for(let e=0;e<(null==l?void 0:l.length);e++){let t=l[e],i=t.typeview;i&&(i.markedAsDeleted=!0),t.typeview=null}{var n;let e=i.relshiptypeviews,t=null===(n=i.relshiptypeviews)||void 0===n?void 0:n.length;for(let i=t-1;i>=0;i--)e[i].markedAsDeleted&&e.splice(i,1)}let s=new a.io(i,!0),r={metis:s};r=JSON.parse(JSON.stringify(r)),u&&console.log("2858 jsnMetis",s,i),t.dispatch({type:"LOAD_TOSTORE_PHDATA",data:r}),u&&console.log("2860 data",r,i)}function ee(e,t,i,l){if(u&&console.log("2471 updateNode",e,i),t){let n,s=t.data;for(n in s)"abstract"!==n&&"class"!==n&&"group"!==n&&"isGroup"!==n&&"viewkind"!==n&&(null!=s[n]&&(null==i||i.model.setDataProperty(e,n,s[n])),u&&console.log("2483 prop, node[prop]",n,e[n]));let r=e.objectview;if(r)for(n in u&&console.log("2487 viewdata, objview",s,r),s)r[n]&&""!==r[n]&&i.model.setDataProperty(e,n,r[n]);i.model.setDataProperty(e,"typename",e.typename),l&&(l.updateNode(e),u&&console.log("2500 updateNode",e,l)),u&&console.log("2502 updateNode",e,i)}}function et(e,t,i){let l;if(t){let n=t.getData();if(u&&console.log("3096 data, viewdata",e,n),l=e.relshipview)for(let t in n)"abstract"!==t&&"relshipkind"!==t&&"class"!==t&&"name"!==t&&(l[t]&&""!==l[t]&&(i.model.setDataProperty(e,t,l[t]),u&&console.log("2904 updateLink",t,n[t],l[t])),"strokewidth"===t?l[t]||l[t]:"fromArrowColor"===t?""!==l[t]&&l[t]||l[t]:"toArrowColor"!==t||""!==l[t]&&l[t]||l[t],i.model.setDataProperty(e,t,n[t]),u&&console.log("2916 updateLink",t,n[t],l[t]))}if(l){let t=i.findLinkForKey(e.key);t&&(u&&console.log("3329 data, link, relview",e,t,l),l.arrowscale=1.3*l.textscale,i.model.setDataProperty(t.data,"relship",l.relship),i.model.setDataProperty(t.data,"name",l.name),i.model.setDataProperty(t.data,"textscale",l.textscale),i.model.setDataProperty(t.data,"textcolor",l.textcolor),i.model.setDataProperty(t.data,"strokecolor",l.strokecolor),i.model.setDataProperty(t.data,"strokewidth",l.strokewidth),i.model.setDataProperty(t.data,"arrowscale",l.arrowscale),i.model.setDataProperty(t.data,"fromArrow",l.fromArrow),i.model.setDataProperty(t.data,"toArrow",l.toArrow),i.model.setDataProperty(t.data,"fromArrowColor",l.fromArrowColor),i.model.setDataProperty(t.data,"toArrowColor",l.toArrowColor))}}function ei(e,t,i){let l=["Details"];if(e){if(t.includeConnected){l.push(e.name);let i=e.getConnectedObjects2(t.myMetis);u&&console.log("3006 connectedObjects",i);for(let e=0;e<(null==i?void 0:i.length);e++){let t=i[e];l.push(null==t?void 0:t.name)}}let s=[];if(t.includeInherited)try{let t=null==e?void 0:e.getInheritedTypes();u&&console.log("3015 inheritedTypes",t);for(let e=0;e<(null==t?void 0:t.length);e++){let l=t[e];if(l.name!==d.types.AKM_ENTITY_TYPE&&"Details"!==l.name&&"Type"!==l.name){if(i){var n;(null===(n=l.properties)||void 0===n?void 0:n.length)>0&&s.push(l.name)}else s.push(l.name)}}s=[...new Set(s)]}catch(e){u&&console.log("3029 error",e)}return s.length>0&&(l=l.concat(s)),l.push("Type"),u&&console.log("3031 namelist",l),l}}function el(e){return"GENERIC_MM"===e.currentMetamodel.name}function eo(e,t){e.object;let i=e.objectview,l=e.typeview;for(let n in null==l?void 0:l.data)i[n]&&""!==i[n]?t.model.setDataProperty(e,n,i[n]):(null==l?void 0:l.data[n])&&(null==l?void 0:l.data[n])!==""&&t.model.setDataProperty(e,n,l[n]);return i}function en(e,t){let i=e.relshipview,l=e.typeview;for(let n in null==l?void 0:l.data)i[n]&&""!==i[n]?t.model.setDataProperty(e,n,i[n]):(null==l?void 0:l.data[n])&&(null==l?void 0:l.data[n])!==""&&t.model.setDataProperty(e,n,l[n]);return i}function es(e,t,i,l,n){if(t){let s="",r="",a="";t.fillcolor?s=t.fillcolor:i.fillcolor1?s=i.fillcolor1:(null==l?void 0:l.fillcolor)&&(s=l.fillcolor),t.strokecolor?r=t.strokecolor:i.strokecolor2?r=i.strokecolor2:(null==l?void 0:l.strokecolor)&&(r=l.strokecolor),t.textcolor?a=t.textcolor:i.textcolor2?a=i.textcolor2:(null==l?void 0:l.textcolor)&&(a=l.textcolor),e.fillcolor=s,n.model.setDataProperty(e,"fillcolor",s),e.strokecolor=r,n.model.setDataProperty(e,"strokecolor",r),e.textcolor=a,n.model.setDataProperty(e,"textcolor",a)}return i}function er(e){let t=[],i=e.objecttypes;for(let e=0;e<(null==i?void 0:i.length);e++){let l=i[e].typeview;l&&t.push(l)}return t}},2629:(e,t,i)=>{"use strict";i.d(t,{QA:()=>v,eT:()=>O,rG:()=>j,xE:()=>c});var l=i(2588),n=i(7089),s=i(2210),r=i(3022),a=i(1457);let d=!1,p=!1;function c(e,t){let i=e.myMetis,s=e.myMetamodel,r=i.metamodels,d="";for(let e=0;e<r.length;e++){let t=r[e];t.name!==a.admin.AKM_ADMIN_MM&&(0==e?d="'"+t.name+"'":d+=",'"+t.name+"'")}let p="";if(null==(p=t?prompt("Enter Metamodel name"):prompt("Enter Metamodel as one of "+d,s.name))||""==p){alert("Operation was cancelled!");return}{let e=i.findMetamodelByName(p);if(t&&e){alert("Metamodel already exists");return}if(!e){if(confirm("Create new metamodel '"+p+"' ?"))e=new n.E7(l.gj(),p,""),i.addMetamodel(e);else{alert("Operation was cancelled!");return}}return e}}function u(e,t){let i=[],l=[];t&&(l.push(a.types.AKM_ELEMENT),l.push(a.types.AKM_ENTITY_TYPE),l.push(a.types.AKM_GENERIC)),l.push(a.types.AKM_LABEL),l.push(a.types.AKM_CONTAINER);for(let t=0;t<(null==l?void 0:l.length);t++){let n=l[t],s=e.findObjectTypeByName(n);s&&i.push(s)}return i}function h(e,t){let i=[],n=e.relshiptypes;for(let e=0;e<n.length;e++){let l=n[e];m(l,t)&&i.push(l)}return l.Ip(i,"id")}function m(e,t,i){let l=e.name;switch(l){case a.types.AKM_REFERS_TO:case a.types.AKM_ANNOTATES:case a.types.AKM_GENERIC_REL:return!0}if(t){switch(l){case a.types.AKM_IS:case a.types.AKM_CONTAINS:case a.types.AKM_HAS_SUBMODEL:case a.types.AKM_HAS_SUBMETAMODEL:case a.types.AKM_IS_OF_DATATYPE:case a.types.AKM_IS_DEFAULTVALUE:case a.types.AKM_HAS_PORT:case a.types.AKM_HAS_METHOD:case a.types.AKM_HAS_METHODTYPE:case a.types.AKM_RELATIONSHIP_TYPE:case a.types.AKM_HAS_PROPERTY:case a.types.AKM_HAS_FIELDTYPE:case a.types.AKM_HAS_INPUTPATTERN:case a.types.AKM_HAS_VIEWFORMAT:case a.types.AKM_HAS_VALUE:case a.types.AKM_ANNOTATES:return!0}let t=e.toObjtype,i=e.fromObjtype;if(l===a.types.AKM_IS&&(null==t?void 0:t.name)===a.types.AKM_ELEMENT||l===a.types.AKM_IS&&(null==i?void 0:i.name)===a.types.AKM_GENERIC||l===a.types.AKM_IS&&(null==i?void 0:i.name)===a.types.AKM_CONTAINER)return!0}return!1}function f(e,t,i){var s,d;let p;if(!e)return;let c=i.myMetis,u=i.myTargetMetamodel,h=e.generatedTypeId,m=i.myModel,f=i.myCurrentModelview,y=c.findObject(e.id),g=null,v=e.name,w="";v=l.PT(v);let b=v=l.Zr(v);if(h&&(p=u.findObjectType(h))&&(w=p.getName(),p.setName(v),p.setDescription(e.description),p.typeDescription=y.typeDescription,p.attributes=[],p.properties=[]),!p&&(p=u.findObjectTypeByName(v))&&(h=p.getId()),!p){let e;let t=["EntityType"];for(let i=0;i<t.length;i++){let l=t[i];if(u.findObjectTypeByName(l)){e=l;break}}if(y.type.name===e||y.isOfSystemType(e)){let e=b;h||(h=l.gj()),p=new n.$$(h,e,y.description),y.generatedTypeId=h}}if(!p)return null;if(p){let t,s=y.getViewKind();if(y.objectviews&&(t=y.objectviews[0]),!t)return;"SwimPool"===y.name?(s="Container",t.template="SwimPool"):t&&"SwimLane"===y.name?(s="Container",t.template="SwimLane"):s=t.isGroup?"Container":y.getViewKind(),t.template2&&(t.template=t.template2),t.viewkind=s,e.viewkind=s,e.generatedTypeId=p.getId(),p.setViewKind(s),p.setAbstract(y.getAbstract()),p.setModified(),p.markedAsDeleted=e.markedAsDeleted;{let e=y.getInheritanceObjects(m);for(let t=0;t<e.length;t++){let i=e[t],s=c.findObjectType(i.generatedTypeId);if(s){let e=u.findRelationshipTypeByName2(a.types.AKM_IS,p,s);e||(e=new n.MX(l.gj(),a.types.AKM_IS,p,s,""),p.addOutputreltype(e),s.addInputreltype(e),e.setModified(),e.setRelshipKind("Generalization"),u.addRelationshipType(e),c.addRelationshipType(e))}}}p.abstract=y.abstract,null==u||u.addObjectType(p),c.addObjectType(p),e.generatedTypeId=p.getId();{let e,a=p.typeview;a&&(e=a.id),a||(e=l.gj()),(a=new n.GC(e,p.name,p,y.description)).applyObjectViewParameters(t),p.typeview=a,a.viewkind=s,p.setModified(),u.addObjectTypeView(a),c.addObjectTypeView(a);let d=new r.mX(a);i.dispatch({type:"UPDATE_OBJTYPEVIEW_PROPERTIES",data:d})}}{let e=null;if(p&&(p.setModified(),!e&&(e=y.type)&&(e=u.findObjectTypeByName(e.name)),g||(g=u.findRelationshipTypeByName2(a.types.AKM_IS,p,e)),!g)){g=new n.MX(l.gj(),a.types.AKM_IS,p,e,""),p.addOutputreltype(g),e.addInputreltype(g),g.setModified(),g.setRelshipKind("Generalization"),u.addRelationshipType(g),c.addRelationshipType(g);let t=new r.Mq(g);i.dispatch({type:"UPDATE_RELSHIPTYPE_PROPERTIES",data:t})}}{let e="EntityType",t=c.findObjectTypeByName(e),i=c.findObjectTypeByName(a.types.AKM_METHOD),l=c.findRelationshipTypeByName2(a.types.AKM_HAS_METHOD,t,i),n=[],r=y.outputrels;for(let e=0;e<(null==r?void 0:r.length);e++){let t=r[e];if((null==t?void 0:null===(s=t.type)||void 0===s?void 0:s.id)===(null==l?void 0:l.id)){let e=t.toObject;if(e){let t=u.findMethodByName(e.name);t&&n.push(t)}}}p.methods=n}{let e=[];_(p,e=P(y,e,m),i)}{let t=c.findObjectTypeByName(a.types.AKM_PORT),i=[],l=e.outputrels;for(let e=0;e<(null==l?void 0:l.length);e++){let n=l[e];if((null==n?void 0:null===(d=n.type)||void 0===d?void 0:d.name)===a.types.AKM_HAS_PORT){let e=n.toObject;if(e){let l=f.findObjectViewsByObj(e);if((null==l?void 0:l.length)>0){let i=l[0];i&&(e.color=i.fillcolor),e.type=t}i.push(e)}}}i&&(p.ports=i)}let T=new r.pJ(e);return i.dispatch({type:"UPDATE_OBJECT_PROPERTIES",data:T}),p}function y(e,t,i){let s,r,a;if(!e)return;let d=i.myMetis;i.myDiagram;let c=i.myTargetMetamodel,u=i.myModel;i.myCurrentModelview;let h=d.findRelationship(e.id),m=null==h?void 0:h.name.split("/"),f=m?m[0]:null==h?void 0:h.name,y="";(null==m?void 0:m.length)>0&&(y=m[1]);let g=null==h?void 0:h.getFromObject(),v=null==g?void 0:g.name;v=l.PT(v),v=l.Zr(v);let w=null==c?void 0:c.findObjectTypeByName(v),b=null==h?void 0:h.getToObject(),T=null==b?void 0:b.name;T=l.PT(T),T=l.Zr(T);let j=null==c?void 0:c.findObjectTypeByName(T),O=f;(null==y?void 0:y.length)>0&&(O=O+"/"+y);let k="",M=O;if((a=p?"":null==h?void 0:h.generatedTypeId)||(a=l.gj()),a?((s=d.findRelationshipType(a))&&(k=null==s?void 0:s.getName(),s.setName(O)),s&&(s.markedAsDeleted=e.markedAsDeleted,null==c||c.addRelationshipType(s))):!p&&(s=d.findRelationshipTypeByName2(M,w,j))&&(s.markedAsDeleted=e.markedAsDeleted,null==c||c.addRelationshipType(s),s.relshipkind=e.relshipkind,s.cardinality=e.cardinality),!s&&M&&w&&j&&(s=new n.MX(a,M,w,j,h.description))){let t=M.split("/");t.length>1&&(s.nameFrom=t[0],s.nameTo=t[1]),s.relshipkind=e.relshipkind,s.cardinality=e.cardinality}if(s){{var R;let e=null==h?void 0:null===(R=h.type)||void 0===R?void 0:R.getProperties(!1);null!=e&&e.length>0?s.properties=e:s.properties=[];let t=[];for(let i=0;i<(null==e?void 0:e.length);i++){let l=e[i];null==t||t.push(l)}s.properties=t}if(null==c||c.addRelationshipType(s),d.addRelationshipType(s),h){let e=h.relshipviews[0];e.template2&&(e.template=e.template2),h.generatedTypeId=s.id,u.addRelationship(h),d.addRelationship(h)}if(!(r=s.typeview)){let e=l.gj(),t=s.name+"_"+s.getRelshipKind();r=new n.Fu(e,t,s,"")}r.applyRelationshipViewParameters(t),r.setRelshipKind(s.relshipkind),s.typeview=r,s.setModified(),null==c||c.addRelationshipTypeView(r),d.addRelationshipTypeView(r)}return s}function g(e,t,i,s){if(!e)return;s.myDiagram;let r=s.myMetis,d=s.myTargetMetamodel,p=s.myModel,c=e.name,u=null;if(c===a.types.AKM_RELATIONSHIP_TYPE){let e=r.findObjectTypeByName(a.types.AKM_ENTITY_TYPE),t=e;(u=r.findRelationshipTypeByName2(c,e,t)).properties=[]}else(u=r.findRelationshipTypeByName2(c,t,i))||(u=new n.MX(l.gj(),c,t,i,e.description));null==d||d.addRelationshipType(u),r.addRelationshipType(u);{let t=[];P(e,t,p),_(u,t,s)}{let e=u.typeview;if(!e){let t=l.gj(),i=u.name+"_"+u.getRelshipKind();e=new n.Fu(t,i,u,"")}u.typeview=e,null==d||d.addRelationshipTypeView(e),r.addRelationshipTypeView(e),u.setModified()}return u}function v(e,t){let i=t.myMetis,s=t.myModel;t.myDiagram;let r=i.findObject(e.id),d=r.name,p=r.description,c=t.myTargetMetamodel;if(!c)return null;let u=null==c?void 0:c.findDatatypeByName(d);if(!u){let e=i.findDatatypeByName(d);e?c.addDatatype(e):(u=new n.qx(l.gj(),d,p),c.addDatatype(u),i.addDatatype(u))}if(u){let e=r.getOutputRelships(s,a.relkinds.REL);if(e){let t=[];for(let t=0;t<e.length;t++){let l=e[t].toObject;if(l.type.name===a.types.AKM_DATATYPE){let e=i.findDatatypeByName(l.name);u.setIsOfDatatype(e),u.setInputPattern(null==e?void 0:e.inputPattern),u.setViewFormat(null==e?void 0:e.viewFormat),u.setFieldType(null==e?void 0:e.fieldType)}}for(let i=0;i<e.length;i++){let l=e[i];if(l.name===a.types.AKM_HAS_ALLOWED_VALUE){let e=l.toObject;for(let i=0;i<t.length;i++)if(e.name===t[i].value)continue;t.push(e.name)}else if(l.getName()===a.types.AKM_IS_DEFAULTVALUE){let e=l.toObject;e&&(u.setDefaultValue(e.name),t.push(e.name))}for(let e=0;e<t.length;e++)u.addAllowedValue(t[e]);t.length>0&&"text"===u.getFieldType()&&u.setFieldType("radio")}for(let t=0;t<e.length;t++){let l=e[t];if(l.getName()===a.types.AKM_IS_OF_DATATYPE){let e=l.getToObject();if(e.type.name===a.types.AKM_DATATYPE){let t=e,l=i.findDatatypeByName(t.name);l&&u.setIsOfDatatype(l)}}if(l.getName()===a.types.AKM_HAS_INPUTPATTERN){let e=l.getToObject();if(e.type.name===a.types.AKM_INPUTPATTERN){let t=e;t.pattern&&u.setInputPattern(t.pattern)}}if(l.getName()===a.types.AKM_HAS_VIEWFORMAT){let e=l.getToObject();if(e.type.name===a.types.AKM_VIEWFORMAT){let t=e;t.viewFormat&&u.setViewFormat(t.viewFormat)}}if(l.getName()===a.types.AKM_HAS_FIELDTYPE){let e=l.getToObject();if(e.type.name===a.types.AKM_FIELDTYPE){let t=e;t.name&&u.setFieldType(t.name)}}c.addDatatype(u)}return u}}}function w(e,t){let i=t.myMetis,s=t.myModel,r=i.findObject(e.id),a=r.name,d=r.description,p=t.myTargetMetamodel;if(!p)return null;let c=null==p?void 0:p.findMethodTypeByName(a);if(c?c.properties=[]:(c=new n.Rb(l.gj(),a,d),p.addMethodType(c),i.addMethodType(c)),c){let i=[];return P(e,i,s),_(c,i,t),c}}function b(e,t){let i=t.myMetis;t.myModel,t.myDiagram;let s=i.findObject(e.id),r=s.name,a=s.description,d=t.myMetamodel,p=t.myTargetMetamodel,c=null==p?void 0:p.findMethodByName(r);c||((c=i.findMethodByName(r))||(c=new n.pF(l.gj(),r,a)),p.addMethod(c),i.addMethod(c));let u=s.methodtype,h=d.findMethodTypeByName(u);if(c&&h){c.methodtype=h.name;let e=h.properties;for(let t=0;t<(null==e?void 0:e.length);t++){let i=e[t].name;c[i]=s[i]}}return c}function T(e,t,i){let l=null;for(let n=e.iterator;null==n?void 0:n.next();){let e=n.value.data.object;if((null==e?void 0:e.type.name)===a.types.AKM_METAMODEL){let n=null==(e=i.findObject(e.id))?void 0:e.getOutputRelshipsByType(t);if((null==n?void 0:n.length)>0){l=e;break}}}return l}function j(e,t,i){let s,r;let d=i.nodes,p=t.findObjectTypeByName(a.types.AKM_METAMODEL),c=t.findObjectTypeByName(a.types.AKM_ENTITY_TYPE),u=t.findRelationshipTypeByName1(a.types.AKM_CONTAINS,p,c),h="";for(let e=d.iterator;null==e?void 0:e.next();){let i=e.value,a=i.data.object;i.data.objectview;let p=T(d,u,t);if(!p)continue;h=p.name,(r=t.findMetamodelByName(h))||(r=new n.E7(l.gj(),h,a.description),t.addMetamodel(r));let c=(s=t.currentModelview.findObjectViewByName(p.name)).object;c=t.findObject(c.id),s.object=c;break}h===a.core.AKM_CORE_MM?t.currentModel.includeSystemtypes=!0:t.currentModel.includeSystemtypes=!1;let m={metamodel:t.currentTargetMetamodel,modelview:t.currentModelview,node:t.currentNode};O({myMetis:t,myMetamodel:t.currentMetamodel,myModel:t.currentModel,myGoModel:t.gojsModel,myCurrentModelview:t.currentModelview,myCurrentObjectview:s,myDiagram:i,case:"Generate Target Metamodel",title:"Select Target Metamodel",dispatch:i.dispatch,postOperation:M,args:m})}function O(e){let t=e.myMetis,i=e.myMetamodel,n=e.myMetis.currentModelview,s=e.myDiagram,r={what:"selectDropdown",title:e.title,case:e.case,modelview:n,myDiagram:s,context:e},d=[],p=n.objectviews;for(let e=0;e<(null==p?void 0:p.length);e++){var c,u;let i=p[e];if(!i)continue;let n=i.object;if(!n){let e=i.objectRef;e&&(n=t.getObject(e))}if((null==n?void 0:null===(c=n.type)||void 0===c?void 0:c.name)===a.types.AKM_METAMODEL){let e=i.getInputRelviews();for(let t=0;t<(null==e?void 0:e.length);t++){let i=e[t].relship;if((null==i?void 0:null===(u=i.type)||void 0===u?void 0:u.name)===a.types.AKM_CONTAINS){let e=i.fromObject;e.type.name===a.types.AKM_METAMODEL&&(null==d||0==d.length)&&d.push(e.name);break}}null==d||0==d.length?d.push(n.name):d=l.EL(d)}}if(null==d||0==d.length){let e=t.metamodels;for(let l=0;l<e.length;l++){let n=e[l];if(n.id&&n.name!==a.admin.AKM_ADMIN_MM){if(!t.allowGenerateCurrentMetamodel&&n.id===i.id)continue;d.push(n.nameId)}}}s.handleOpenModal(d,r)}function k(e,t){for(let i=0;i<e.length;i++){let l=t.findObjectTypeByName(e[i]);l&&(l.attributes=[],l.properties=[])}}function M(e){let t=[],i=e.myDiagram,d=e.myMetis,p=e.myCurrentModelview;e.args;let c=e.myTargetMetamodel;if(!c||!p)return!1;if(c.name===a.core.AKM_CORE_MM){let e=[];e.push("Default"),e.push("Entity Type"),e.push("$Type"),k(e,d)}else null==(c=d.findMetamodel(c.id))||c.clearContent();(null==c?void 0:c.name)!==a.core.AKM_CORE_MM?(t=[]).push(p.name):t=a.core.AKM_MODELVIEWS;let u=e.myModel;for(let i=0;i<t.length;i++){let s=null,r=u.findModelViewByName(t[i]);if(r){var h,m,f,y,g,v,w;let t=r.objectviews;for(let e=0;e<t.length;e++){let i=t[e];if((null==i?void 0:null===(m=i.object)||void 0===m?void 0:null===(h=m.type)||void 0===h?void 0:h.name)===a.types.AKM_METAMODEL){s=i.object;break}}let i=0,p=[];for(let e=0;e<t.length;e++){let l=t[e];(null==l?void 0:null===(y=l.object)||void 0===y?void 0:null===(f=y.type)||void 0===f?void 0:f.name)===a.types.AKM_ENTITY_TYPE&&(p.push(l),i++)}if(0===i)continue;let u=[],b=s.getOutputRelships(e.myModel,a.relkinds.REL);for(let e=0;e<(null==b?void 0:b.length);e++){let t=b[e];if((null==t?void 0:null===(g=t.type)||void 0===g?void 0:g.name)===a.types.AKM_CONTAINS){let e=t.toObject;e.type.name===a.types.AKM_ENTITY_TYPE&&u.push(e)}}if(i>u.length&&!confirm("The number of EntityType objects in the metamodel is less than in the modelview. Continue?"))return!1;for(let t=0;t<p.length;t++){let l=p[t].object;if(l&&l.type){if((null===(v=l.type)||void 0===v?void 0:v.name)===a.types.AKM_METAMODEL){let t=l.getOutputRelships(e.myModel,a.relkinds.REL);for(let e=0;e<(null==b?void 0:b.length);e++){let i=t[e];if((null==i?void 0:null===(w=i.type)||void 0===w?void 0:w.name)===a.types.AKM_CONTAINS){let e=i.toObject;e.type.name===a.types.AKM_ENTITY_TYPE&&u.push(e)}}if(i>u.length&&!confirm("The number of EntityType objects in the metamodel is less than in the modelview. Continue?"))return!1}l.type.name===a.types.AKM_RELSHIP_TYPE&&u.push(l)}}let T=r.relshipviews;for(let e=0;e<T.length;e++){let t=T[e],i=null==t?void 0:t.relship;b.push(i)}b=[...new Set(b)];for(let e=0;e<=(null==u?void 0:u.length);e++){let t=u[e];if(t&&t.isOfType("Metamodel")){let e=t.type,i=d.findObjectTypeByName(a.types.AKM_METAMODEL),s=A(t,d.findRelationshipTypeByName1(a.types.AKM_HAS_SUBMETAMODEL,e,i));for(let e=0;e<(null==s?void 0:s.length);e++){let t=s[e];if(t){let e=d.findMetamodelByName(t.name);e&&c.addSubMetamodel(e)}}i=d.findObjectTypeByName(a.types.AKM_MODEL);let r=E(t,d.findRelationshipTypeByName1(a.types.AKM_HAS_SUBMODEL,e,i));for(let e=0;e<(null==r?void 0:r.length);e++){let t=r[e];if(t){let e=d.findModelByName(t.name);e||(e=new n.DM(l.gj(),t.name,t.description),d.addModel(e))}}}}e.myTargetMetamodel=c,e.firstTime=!0,console.log("1021 Target metamodel: ",c=D(u,b,e))}r&&console.log("1024 sourcemodelview has been generated: "+r.name)}alert("The metamodel "+c.name+" has been successfully generated!"),s.pH(d,c,i),s.UF(d,null,i);let b=new r.YS(c,!0);return i.dispatch({type:"UPDATE_TARGETMETAMODEL_PROPERTIES",data:b}),!0}function R(e,t){if(!e||!t)return null;{let i=[],l=e.object;if(l&&l instanceof n.Jo){let e=l.getOutputRelshipsByType(t);for(let t=0;t<(null==e?void 0:e.length);t++){let l=e[t].toObject,n=l.type;if((null==n?void 0:n.name)===a.types.AKM_ENTITY_TYPE){let e=l.name;i.push(e)}}}else{let t=e.getOutputRelviews();for(let e=0;e<(null==t?void 0:t.length);e++){let l=t[e].toObjview,n=null==l?void 0:l.object,s=null==n?void 0:n.type;if((null==s?void 0:s.name)===a.types.AKM_ENTITY_TYPE){let e=n.name;i.push(e)}}}return i}}function A(e,t){if(!e||!t)return null;{let i=[],l=e.getOutputRelshipsByType(t);for(let e=0;e<(null==l?void 0:l.length);e++){let t=l[e],n=null==t?void 0:t.toObject,s=null==n?void 0:n.type;(null==s?void 0:s.name)===a.types.AKM_METAMODEL&&i.push(n)}return i}}function E(e,t){if(!e||!t)return null;{let i=[],l=e.getOutputRelshipsByType(t);for(let e=0;e<(null==l?void 0:l.length);e++){let t=l[e],n=null==t?void 0:t.toObject,s=null==n?void 0:n.type;(null==s?void 0:s.name)===a.types.AKM_MODEL&&i.push(n)}return i}}function D(e,t,i){var r,p,c,m,T;let j,O;let k=i.myMetis,M=i.myMetamodel,E=i.myModel;i.myGoModel;let D=i.myDiagram,P=i.myCurrentModelview,x=i.myCurrentObjectview,I=M.findObjectTypeByName(a.types.AKM_METAMODEL),V=M.findObjectTypeByName(a.types.AKM_ENTITY_TYPE),L=E.includeSystemtypes,F=i.myTargetMetamodel;if(!F)return null;{(F=k.findMetamodel(F.id)).properties=M.properties;let e=k.findObjectTypeByName(a.types.AKM_ENTITY_TYPE);F.addObjectType(e)}E.targetMetamodelRef=F.id,F.generatedFromModelRef=E.id;let B=F.name;d&&console.log("1268 generateMetamodel 1"),F.name,a.core.AKM_CORE_MM;let G=B+"_Viewstyle",K=F.viewstyle;K||(K=new n._6(l.gj(),G,""),F.viewstyle=K,F.addViewStyle(K),k.addViewStyle(K));let J=null==E?void 0:E.getObjectsByTypename("Datatype",!1);if(J)for(let e=0;e<J.length;e++){let t=J[e];if(t&&!t.markedAsDeleted){let e=v(t,i);e&&M.addDatatype(e)}}let W=M.methodtypes;if(W&&(F.methodtypes=W),J=null==E?void 0:E.getObjectsByTypename("MethodType",!1))for(let e=0;e<J.length;e++){let t=J[e];if(t&&!t.markedAsDeleted){let e=F.findMethodTypeByName(t.name);e&&(e.id,e.properties=[],(e=w(t,i))&&(F.addMethodType(e),k.addMethodType(e)))}}if(J=null==E?void 0:E.getObjectsByTypename("Method",!1))for(let e=0;e<J.length;e++){let t=J[e];if(t&&!t.markedAsDeleted){let e=b(t,i),l=e.methodtype,n=M.findMethodTypeByName(l);if(d&&console.log("1325 methodType",n),e&&n){e.methodtype=n.name;let t=n.properties;for(let e=0;e<(null==t?void 0:t.length);e++)t[e].name;d&&console.log("1334 method",e)}}}let U=["cardinality","viewkind","relshipkind","fieldtype","layout","routing","linkcurve","integer","string","number","boolean","date","reldir","actiontype"];if(L)j=M.datatypes;else{j=[];for(let e=0;e<U.length;e++){let t=U[e],i=M.findDatatypeByName(t);j.push(i)}}for(let e=0;e<j.length;e++){let t=j[e];t&&F.addDatatype(t)}let z=i.firstTime,H=[],Y=[],Z=k.findMetamodelByName("AKM-Core_MM"),q=null==Z?void 0:Z.findRelationshipTypeByName1(a.types.AKM_CONTAINS,I,V);null==q||q.typeview;let X=null==Z?void 0:Z.findRelationshipTypeByName1(a.types.AKM_HAS_SUBMETAMODEL,I,I);null==X||X.typeview;let $=R(x,q);if((null==$?void 0:$.length)>0){for(let e=0;e<(null==$?void 0:$.length);e++){let t=$[e],i=F.findObjectTypeByName(t);i&&(H.push(i),Y.push(i))}let e=u(k,!1);Y=[...e,...Y],F.objecttypes0=Y,H=[...e=u(k,!0),...H],F.objecttypes=H}F.relshiptypes=h(M,!0);for(let t=0;t<=(null==e?void 0:e.length);t++){let l=e[t];if(l&&l&&l&&l instanceof n.Jo&&(l.isOfType("Model")&&N(F,l,i),l.isOfType("Metamodel"))){let e=l.type,t=e,i=A(l,k.findRelationshipTypeByName1(a.types.AKM_CONTAINS,e,t));for(let e=0;e<(null==i?void 0:i.length);e++){let t=i[e];if(t){let e=k.findMetamodelByName(t.name);e&&(F.addContainedMetamodel(e),S(l,k,D),F.addMetamodelContent(e))}}}}let Q=["EntityType"];for(let e=0;e<Q.length;e++){let t=Q[e];if(M.findObjectTypeByName(t)){O=t;break}}if(e){let t=[];d&&console.log("1270 objects",e);for(let s=0;s<e.length;s++){let d=e[s];if(!d)continue;switch(null===(r=d.type)||void 0===r?void 0:r.name){case"Datatype":case"Value":case"FieldType":case"InputPattern":case"ViewFormat":case"MethodType":case"Method":case"Label":continue;default:if(d.isOfType("Property"))continue}let u=[];d.name===(null===(p=d.type)||void 0===p?void 0:p.name)&&u.push(d.type.name),u.push(O);for(let e=0;e<u.length;e++){if(u[e]===a.types.AKM_ENTITY_TYPE){let t=k.findObjectTypeByName(u[e]);z&&(t.properties=[],z=!1),F.addObjectTypeByName(t),t&&t.name!==a.types.AKM_ENTITY_TYPE&&F.addObjectType0ByName(t)}let s=M.findObjectTypeByName(u[e]);if(s&&d&&d.type){let e;if(s.markedAsDeleted)continue;if(d.type.name===O&&((e=f(d,x,i))&&F.addObjectTypeByName(e),e)){F.addObjectType0ByName(e);let i=F.relshiptypes,s=!1;for(let t=0;t<i.length;t++){let l=i[t];if(l.name===a.types.AKM_IS&&(null===(c=l.fromObjtype)||void 0===c?void 0:c.name)===e.name&&(null===(m=l.toObjtype)||void 0===m?void 0:m.name)===a.types.AKM_ENTITY_TYPE){s=!0;break}}if(!s){let t=l.gj(),i=F.findObjectTypeByName(a.types.AKM_ENTITY_TYPE),s=new n.MX(t,a.types.AKM_IS,e,i);k.addRelationshipType(s),F.addRelationshipType(s)}let r=e.typeview,p=P.findObjectViewsByObject(d);for(let i=0;i<(null==p?void 0:p.length);i++){let n=p[i];if(n){let i=n.name;if(i=l.PT(i),n.name=l.Zr(i),n.name===e.name){r.applyObjectViewParameters(n),n.template=r.template,t.push(r);break}}}}}t=l.EL(t),F.objecttypeviews=t}}}{let t=[];for(let l=0;l<(null==e?void 0:e.length);l++){let s,r,d,p,c,u;let h=e[l];if(!h||!h||!(h instanceof n.Jo)||h.type.name!==a.types.AKM_RELSHIP_TYPE)continue;let m=h.getOutputRelships(E,a.relkinds.REL),f=[],y=[],v=[],w=[],b=[],T=h.name,j=null==m?void 0:m.length;for(let e=0;e<j;e++){let t=m[e];"from"===t.name?(c=null==(d=t.toObject)?void 0:d.name,f.push(d),s=F.findObjectTypeByName(c),v.push(s)):"to"===t.name&&(p=t.toObject,y.push(p),u=null==p?void 0:p.name,r=F.findObjectTypeByName(u),w.push(r))}let O=[T,c,u];t.push(O),m=h.getOutputRelships(E,a.relkinds.GEN);for(let e=0;e<m.length;e++){let t=m[e];(null==t?void 0:t.name)==="Is"&&(t.relshipkind=a.relkinds.GEN,c=null==(d=t.fromObject)?void 0:d.name,u=null==(p=t.toObject)?void 0:p.name,r=F.findObjectTypeByName(u),b.push(r))}t=[...new Set(t)],b=[...new Set(b)];for(let e=0;e<t.length;e++){let t=k.findRelationshipTypeByName1(T,v[e],w[e]);if(t||(t=g(h,s,r,i)),t){let e=t.typeview;e&&F.addRelationshipTypeView(e);let l=[];C(h,l,E),_(t,l,i),F.addRelationshipType(t),k.addRelationshipType(t)}}}d&&console.log(relshiptypes)}if(t)for(let e=0;e<t.length;e++){let l=t[e],s=P.findRelationshipViewsByRel(l)[0];if(!s||(d&&console.log("1427 rel.name",l.name),l.isSystemRel()||l.name===a.types.AKM_CONTAINS))continue;let r=l.fromObject;if(!r)continue;let p=l.toObject;if(p){if(l.name===a.types.AKM_IS)for(let e=0;e<H.length;e++){let t=H[e];if((null==r?void 0:r.id)===(null==t?void 0:t.id))for(let t=0;t<H.length;t++){let t=H[e];if((null==p?void 0:p.id)===(null==t?void 0:t.id))continue}}if(r&&r instanceof n.Jo&&p&&p instanceof n.Jo&&(null==r?void 0:r.isOfSystemType(O))&&(null==p?void 0:p.isOfSystemType(O))){let e=k.findRelationshipTypeByNames(l.name,r.name,p.name);if(e||(e=y(l,s,i)),(null===(T=l.relshipviews)||void 0===T?void 0:T.length)>0){let e=l.relshipviews[0];e.template2&&(e.template=e.template2)}if(e){k.addRelationshipType(e),F.addRelationshipType(e),e.name!==a.types.AKM_RELSHIP_TYPE&&e.name!==a.types.AKM_IS&&F.addRelationshipType0(e);let t=null==e?void 0:e.typeview,i=F.removeAllRelshipTypeViewsByRelshipType(e);t&&i.push(t),F.relshiptypeviews=i;let l=e.typeview;l&&(l.applyRelationshipViewParameters(s),F.addRelationshipTypeView(l),k.addRelationshipTypeView(l),e.setDefaultTypeView(l))}}}}{let e=null==E?void 0:E.getRelationshipsByTypeName(a.types.AKM_IS,a.relkinds.GEN);d&&console.log("1346 myModel, rels",E,e);let t=[];if(e){for(let i=0;i<e.length;i++){let l=e[i],n=P.findRelationshipViewsByRel(l);for(let e=0;e<(null==n?void 0:n.length);e++){let i=n[e];t.push(i)}}for(let e=0;e<t.length;e++){let i=t[e].relship,s=i.fromObject,r=i.toObject;if(s&&r){let e=F.findObjectTypeByName(s.name),t=F.findObjectTypeByName(r.name);if(e&&t){let i=!1,s=F.findRelationshipTypesBetweenTypes(e,t,!1);if(d&&console.log("1360 targetMetamodel, reltypes",F,s),s){for(let e=0;e<s.length;e++)if(s[e].name===a.types.AKM_IS){i=!0;break}}if(!i){let i=new n.MX(l.gj(),a.types.AKM_IS,e,t,"");i.relshipkind=a.relkinds.GEN,e.addOutputreltype(i),d&&console.log("1374 fromType, toType, reltype",e,t,i),F.addRelationshipType(i)}}}}}}F.includeInheritedReltypes=E.includeSystemtypes,k.currentTargetMetamodel=F,k.currentTargetModel=E;{let e=F.relshiptypes;for(let t=0;t<(null==e?void 0:e.length);t++){let i=e[t];for(let l=t+1;l<(null==e?void 0:e.length);l++){let t=e[l];i.fromobjtypeRef===t.fromobjtypeRef&&i.toobjtypeRef===t.toobjtypeRef&&i.name===t.name&&(e.splice(l,1),l--)}}for(let t=0;t<(null==e?void 0:e.length);t++){let i=e[t];F.addRelationshipType(i),k.addRelationshipType(i)}}s.pH(k,F,D),k.addMetamodel(F),k.metamodels=[...new Set(k.metamodels)];let ee=k.metamodels;for(let e=0;e<(null==ee?void 0:ee.length);e++){let t=ee[e],i=t.submetamodels;for(let e=0;e<(null==i?void 0:i.length);e++)i[e].id===F.id&&(i.splice(e,1),e--);t.submetamodels=i}return F}function S(e,t,i){let s=e.name,d=t.currentModelview,p=t.findMetamodelByName(s),c=t.findObjectTypeByName(a.types.AKM_ENTITY_TYPE);if(p)p.description=e.description;else{p=new n.E7(l.gj(),e.name,e.description),t.addMetamodel(p);let i=t.findObjectTypeByName(a.types.AKM_ELEMENT);p.addObjectType(i),p.addObjectType(c);let s=t.findObjectTypeByName(a.types.AKM_CONTAINER);p.addObjectType(s);let r=t.findObjectTypeByName(a.types.AKM_GENERIC);p.addObjectType(r);let d=t.findObjectTypeByName(a.types.AKM_LABEL);p.addObjectType(d);let u=t.findRelationshipTypesBetweenTypes1(i,i,!1);for(let e=0;e<(null==u?void 0:u.length);e++){let t=u[e];p.addRelationshipType(t)}u=t.findRelationshipTypesBetweenTypes1(d,i,!1);for(let e=0;e<(null==u?void 0:u.length);e++){let t=u[e];p.addRelationshipType(t)}u=t.findRelationshipTypesBetweenTypes1(r,i,!1);for(let e=0;e<(null==u?void 0:u.length);e++){let t=u[e];p.addRelationshipType(t)}u=t.findRelationshipTypesBetweenTypes1(s,i,!1);for(let e=0;e<(null==u?void 0:u.length);e++){let t=u[e];p.addRelationshipType(t)}u=t.findRelationshipTypesBetweenTypes1(c,i,!1);for(let e=0;e<(null==u?void 0:u.length);e++){let t=u[e];p.addRelationshipType(t)}u=t.findRelationshipTypesBetweenTypes1(c,c,!1);for(let e=0;e<(null==u?void 0:u.length);e++){let t=u[e];t.name!==a.types.AKM_RELATIONSHIP_TYPE&&p.addRelationshipType(t)}}let u=t.findRelationshipTypeByName(a.types.AKM_IS),h=t.findRelationshipTypeByName(a.types.AKM_CONTAINS),m=t.findRelationshipTypeByName(a.types.AKM_HAS_SUBMETAMODEL),f=t.findObject(e.id),y=null==f?void 0:f.getOutputRelshipsByType(h);for(let e=0;e<(null==y?void 0:y.length);e++){let s=y[e].toObject;s.type.name===a.types.AKM_METAMODEL&&(S(s,t,i),p.addContainedMetamodel(s));let r=p.findObjectTypeByName(s.name);if(r&&r.name!==a.types.AKM_METAMODEL){p.addObjectType(r),p.addObjectType0(r);let e=t.findRelationshipTypeByName1(u.name,r,c);e||(e=new n.MX(l.gj(),u.name,r,c,u.description)),e&&(p.addRelationshipType(e),t.addRelationshipType(e))}if(s&&s.type.name===a.types.AKM_METAMODEL){let e=t.findMetamodelByName(s.name);p.addContainedMetamodel(e)}p.embedContainedMetamodels()}y=f.getOutputRelshipsByType(m);for(let e=0;e<(null==y?void 0:y.length);e++){let i=y[e].toObject;if(i.type.name===a.types.AKM_METAMODEL){let e=t.findMetamodelByName(i.name);e&&p.addSubMetamodel(e)}}let g=p.objecttypes0;for(let e=0;e<(null==g?void 0:g.length);e++){let t=g[e].getOutputReltypes();for(let e=0;e<(null==t?void 0:t.length);e++){let i=t[e];i.name!==a.types.AKM_IS&&(p.addRelationshipType(i),p.addRelationshipType0(i))}}let v=null==d?void 0:d.objectviews;for(let e=0;e<(null==v?void 0:v.length);e++){let t=v[e].getOutputRelviews();for(let e=0;e<(null==t?void 0:t.length);e++){let i=t[e],l=i.toObjview;for(let e=0;e<(null==v?void 0:v.length);e++){let t=v[e];if(l.id===t.id){let e=i.relship.type;if(e.name===a.types.AKM_IS)continue;p.addRelationshipType(e),p.addRelationshipType0(e)}}}}let w=new r.YS(p,!0);i.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:w})}function N(e,t,i){let s,a,d;let p=i.myMetis,c=i.myDiagram,u=e.submetamodels,h=i.myCurrentModelview,m=t.type,f=h.objectviews;for(let e=0;e<(null==f?void 0:f.length);e++){var y;let i=f[e];if((null===(y=i.object)||void 0===y?void 0:y.id)===t.id){s=i;break}}let g=u[0];for(let e=0;e<(null==u?void 0:u.length);e++){let t=u[e];if(t.findObjectTypeByName(m.name)){g=t;break}}if(a=p.findModelByName(t.name)){let e=a.modelviews;(null==e?void 0:e.length)?d=e[0]:(d=new n.it(l.gj(),t.name,a,""),a.addModelView(d)),d=a.modelviews[0]}else a=new n.DM(l.gj(),t.name,g,t.description),d=new n.it(l.gj(),t.name,a,"");let v=s;if(v){let e=v.getGroupMembers(h);for(let t=0;t<(null==e?void 0:e.length);t++){let i=e[t],l=i.object;l&&(a.addObject(l),d.addObjectView(i))}let t=h.getRelshipviewsInGroup(v);for(let e=0;e<(null==t?void 0:t.length);e++){let i=t[e],l=i.relship;l&&(a.addRelationship(l),d.addRelationshipView(i))}}e.addSubModel(a),a.addModelView(d),p.addModel(a),p.addModelView(d);let w={metis:new r.io(p,!0)};w=JSON.parse(JSON.stringify(w)),c.dispatch({type:"LOAD_TOSTORE_PHDATA",data:w})}function P(e,t,i){let l=null==e?void 0:e.getOutputRelships(i,a.relkinds.GEN);if(l)for(let e=0;e<l.length;e++){let n=l[e],s=null==n?void 0:n.toObject;s&&P(s,t,i)}return C(e,t,i)}function C(e,t,i){let l=null==e?void 0:e.getOutputRelships(i,a.relkinds.REL);for(let e=0;e<(null==l?void 0:l.length);e++){var n,s,r,d,p,c,u;let h=l[e],m=null==h?void 0:h.getToObject();if((null===(n=m.type)||void 0===n?void 0:n.name)===a.types.AKM_PROPERTY){let e=null==h?void 0:h.getToObject();for(let i=0;i<t.length;i++)if(e.name===t[i].name)continue;t.push(e)}if((null==h?void 0:null===(s=h.type)||void 0===s?void 0:s.name)===a.types.AKM_HAS_COLLECTION&&(null===(d=m.type)||void 0===d?void 0:d.name)===a.types.AKM_COLLECTION){let e=m.outputrels;for(let i=0;i<(null==e?void 0:e.length);i++){let l=e[i];if((null==l?void 0:null===(p=l.type)||void 0===p?void 0:p.name)===a.types.AKM_CONTAINS){let e=l.toObject;(null==e?void 0:null===(c=e.type)||void 0===c?void 0:c.name)===a.types.AKM_PROPERTY&&t.push(e)}}}if((null==h?void 0:null===(r=h.type)||void 0===r?void 0:r.name)===a.types.AKM_HAS_PROPERTIES&&((null===(u=m.type)||void 0===u?void 0:u.name)===a.types.AKM_CONTAINER||m.type.viewkind===a.viewkinds.CONT)){let e=m.objectviews;for(let l=0;l<e.length;l++)x(e[l].id,t,i)}}return t}function x(e,t,i){let l=i.getObjects();for(let i=0;i<(null==l?void 0:l.length);i++){var n;let s=l[i];if((null==s?void 0:null===(n=s.type)||void 0===n?void 0:n.name)!==a.types.AKM_PROPERTY)continue;let r=null==s?void 0:s.objectviews;for(let i=0;i<(null==r?void 0:r.length);i++){let l=r[i];l&&l.group===e&&t.push(s)}}return t}function _(e,t,i){let s=i.myMetis,r=i.myModel,d=i.myTargetMetamodel;i.myDiagram;for(let i=0;i<t.length;i++){let p=t[i];if(p&&p instanceof n.Jo){let t=p.readOnly,i=e.findPropertyByName(p.name);if(i&&(i=s.findProperty(i.id)),i)i.readOnly=t,e.addProperty(i),d.addProperty(i),s.addProperty(i);else{i=new n.$s(l.gj(),p.name,p.description);let t=s.findDatatypeByName("string");i.setDatatype(t),e.addProperty(i),d.addProperty(i),s.addProperty(i)}if(i&&p&&p instanceof n.Jo){let t=p.getOutputRelships(r,a.relkinds.REL);if(i&&t)for(let l=0;l<t.length;l++){let n=t[l];if(!n.markedAsDeleted&&n.name===a.types.AKM_IS_OF_DATATYPE){let e=n.toObject;if(e){let t=s.findDatatypeByName(e.name);t&&i.setDatatype(t)}}e.addProperty(i),null==d||d.addProperty(i),s.addProperty(i)}if(t=p.getOutputRelships(r,a.relkinds.REL),i&&t)for(let e=0;e<t.length;e++){let l=t[e];if(!l.markedAsDeleted&&l.type.name===a.types.AKM_HAS_METHOD&&l.name===a.types.AKM_HAS_METHOD){let e=l.toObject;if(e.type.name===a.types.AKM_METHOD){let t=e;if(t){let e=s.findMethodByName(t.name);e&&i.setMethod(e)}}}}}}}}},3022:(e,t,i)=>{"use strict";i.d(t,{DY:()=>c,GI:()=>E,IB:()=>f,KW:()=>y,Mq:()=>u,YS:()=>p,Yp:()=>R,bp:()=>T,gD:()=>r,g_:()=>A,io:()=>s,mX:()=>m,pJ:()=>O,w:()=>k}),i(7089);var l=i(2588);i(1457);let n=!1;class s{addMetamodel(e,t){if(e){let i=new p(e,t);this.metamodels.push(i)}}addModel(e,t){if(e&&e.metamodel){let i=new T(e,t);this.models.push(i)}}addSubModel(e,t){if(e&&e.metamodel){let i=new T(e,t);this.submodels.push(i)}}constructor(e,t){if(this.id=e.id,this.name=e.name,this.description=e.description,this.allowGenerateCurrentMetamodel=e.allowGenerateCurrentMetamodel,this.metamodels=[],this.models=[],this.submodels=[],this.currentMetamodelRef="",this.currentModelRef="",this.currentModelviewRef="",this.currentTemplateModelRef="",this.currentTargetMetamodelRef="",this.currentTargetModelRef="",this.currentTargetModelviewRef="",this.currentTaskModelRef="",e){let i=e.getMetamodels();if(i){let e=i.length;for(let l=0;l<e;l++){let e=i[l];this.addMetamodel(e,t)}}let l=e.getModels();if(l){let e=l.length;for(let i=0;i<e;i++){let e=l[i];this.addModel(e,t)}}let n=e.getSubModels();if(n){let e=n.length;for(let i=0;i<e;i++){let e=n[i];this.addSubModel(e,t)}}e.currentMetamodel&&(this.currentMetamodelRef=e.currentMetamodel.id),e.currentModel&&(this.currentModelRef=e.currentModel.id),e.currentModelview&&(this.currentModelviewRef=e.currentModelview.id),e.currentTargetMetamodel&&(this.currentTargetMetamodelRef=e.currentTargetMetamodel.id),e.currentTargetModel&&(this.currentTargetModelRef=e.currentTargetModel.id),e.currentTargetModelview&&(this.currentTargetModelviewRef=e.currentTargetModelview.id),e.currentTemplateModel&&(this.currentTemplateModelRef=e.currentTemplateModel.id),e.currentTaskModel&&(this.currentTaskModelRef=e.currentTaskModel.id)}}}class r{constructor(e){var t;if(this.id=e.id,this.name=e.name,this.description="",this.datatypeRef=null===(t=e.isOfDatatype)||void 0===t?void 0:t.id,this.allowedValues=e.allowedValues,this.defaultValue=e.defaultValue,this.readOnly=e.readOnly,this.value=e.value,this.inputPattern=e.inputPattern,this.viewFormat=e.viewFormat,this.fieldType=e.fieldType,this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified,l.y9(e.description)&&(this.description=e.description),e.getIsOfDatatype()){let t=e.getIsOfDatatype();this.datatypeRef=null==t?void 0:t.id}}}class a{constructor(e){this.id=e.id,this.name=e.name,this.description="",this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified,e.description&&(this.description=e.description)}}class d{constructor(e){this.id=e.id,this.name=e.name,this.description="",this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified,e.description&&(this.description=e.description)}}class p{addMetamodel(e){e&&this.metamodelRefs.push(e.id)}addSubModel(e){if(e){for(let t=0;t<this.subModelRefs.length;t++)if(this.subModelRefs[t]===e.id)return;this.subModelRefs.push(e.id)}}addObjectType(e,t){if(l.y9(e)&&!e.isDeleted()){let i=new c(e,t);this.objecttypes.push(i)}}addObjectType0(e,t){if(l.y9(e)&&!e.isDeleted()){let i=new c(e,t);this.objecttypes0.push(i)}}addRelationshipType(e,t){if(l.y9(e)&&!e.isDeleted()&&l.y9(e.fromObjtype)&&l.y9(e.toObjtype)){let i=new u(e,t);this.relshiptypes.push(i)}}addRelationshipType0(e,t){if(l.y9(e)&&!e.isDeleted()&&l.y9(e.fromObjtype)&&l.y9(e.toObjtype)){let i=new u(e,t);this.relshiptypes0.push(i)}}addDataType(e){if(l.y9(e)&&!e.isDeleted()){let t=new r(e);this.datatypes.push(t)}}addProperty(e){if(l.y9(e)&&!e.isDeleted()){let t=new g(e);this.properties.push(t)}}addMethodType(e){if(e&&!e.isDeleted()){let t=new w(e);this.methodtypes.push(t)}}addMethod(e){if(l.y9(e)&&!e.isDeleted()){let t=new b(e);this.methods.push(t)}}addUnit(e){if(l.y9(e)){let t=new h(e);this.units.push(t)}}addViewStyle(e){if(e&&!e.isDeleted()){let t=new a(e);this.viewstyles.push(t)}}addGeometry(e){if(e&&!e.isDeleted()){let t=new d(e);this.geometries.push(t)}}addObjectTypeView(e){if(e&&!e.isDeleted()&&e.typeRef){let t=new m(e);this.objecttypeviews.push(t)}}addObjtypeGeo(e){if(e){let t=new f(e);this.objtypegeos.push(t)}}addRelshipTypeView(e){if(e&&!e.isDeleted()&&e.typeRef){let t=new y(e);this.relshiptypeviews.push(t)}}findObjectType(e){let t=this.objecttypes;for(let i=0;i<t.length;i++){let l=t[i];if(l.id===e)return l}return null}findRelationshipType(e){let t=this.relshiptypes;for(let i=0;i<t.length;i++){let l=t[i];if(l.id===e)return l}return null}findRelationshipType0(e){let t=this.relshiptypes0;for(let i=0;i<t.length;i++){let l=t[i];if(l.id===e)return l}return null}findMethod(e){let t=this.methods;for(let i=0;i<(null==t?void 0:t.length);i++){let l=t[i];if(l.id===e)return l}return null}updateMethods(e){let t=e.methods,i=null;for(let l=0;l<(null==t?void 0:t.length);l++){let s=t[l];if(s){let t=this.findMethod(s.id),l=s.methodtype;if(l){let r=e.findMethodTypeByName(l);if(r){i=r.properties,n&&console.log("359 this",i);for(let e=0;e<(null==i?void 0:i.length);e++){let l=i[e];t[l.name]=s[l.name]}}}}}}constructor(e,t){this.id=e.id,this.name=e.name,this.description=e.description?e.description:"",this.metamodelRefs=[],this.subMetamodelRefs=[],this.subModelRefs=[],this.subModels=[],this.viewstyles=[],this.geometries=[],this.objecttypes=[],this.relshiptypes=[],this.objecttypes0=[],this.relshiptypes0=[],this.properties=[],this.datatypes=[],this.methodtypes=[],this.methods=[],this.units=[],this.objecttypeviews=[],this.objtypegeos=[],this.relshiptypeviews=[],this.generatedFromModelRef=e.generatedFromModelRef,this.includeInheritedReltypes=e.includeInheritedReltypes,this.includeSystemtypes=e.includeSystemtypes,this.layout=e.layout,this.routing=e.routing,this.linkcurve=e.linkcurve,this.markedAsDeleted=e.markedAsDeleted,this.modified=!1;{let t=e.getContainedMetamodels();if(t){let e=t.length;for(let i=0;i<e;i++){let e=t[i];if(!e)break;this.metamodelRefs.push(e.id)}}this.subMetamodelRefs=e.getSubMetamodelRefs();let i=e.getSubModels();if(i){let e=i.length;for(let t=0;t<e;t++){let e=i[t];this.subModelRefs.push(e.id);let l=new T(e,!1);this.subModels.push(l)}}}let i=e.getObjectTypes();if(i){let e=i.length;for(let l=0;l<e;l++){let e=i[l];this.addObjectType(e,t)}}let l=e.getObjectTypes0();if(l){let e=l.length;for(let i=0;i<e;i++){let e=l[i];this.addObjectType0(e,t)}}let s=e.getObjtypeGeos();if(s){let e=s.length;for(let t=0;t<e;t++){let e=s[t];this.addObjtypeGeo(e)}}let r=e.getRelshipTypes();if(r){n&&console.log("195 reltypes",r);let i=r.length;for(let l=0;l<i;l++){let i=r[l];if(!i.fromObjtype&&i.fromobjtypeRef){let t=e.findObjectType(i.fromobjtypeRef);i.fromObjtype=t}if(!i.toObjtype&&i.toobjtypeRef){let t=e.findObjectType(i.toobjtypeRef);i.toObjtype=t}this.addRelationshipType(i,t)}n&&console.log("200 jsnMetaModel",this)}let a=e.getRelshipTypes0();if(a){n&&console.log("195 reltypes0",a);let i=a.length;for(let l=0;l<i;l++){let i=a[l];if(i){if(!i.fromObjtype&&i.fromobjtypeRef){let t=e.findObjectType(i.fromobjtypeRef);i.fromObjtype=t}if(!(null==i?void 0:i.toObjtype)&&(null==i?void 0:i.toobjtypeRef)){let t=e.findObjectType(i.toobjtypeRef);i.toObjtype=t}this.addRelationshipType0(i,t)}}n&&console.log("200 jsnMetaModel",this)}let d=e.getDatatypes();if(d){let e=d.length;for(let t=0;t<e;t++){let e=d[t];this.addDataType(e)}}let p=e.getProperties();if(p){let e=p.length;for(let t=0;t<e;t++){let e=p[t];this.addProperty(e)}}let c=e.getMethodTypes();if(c){let e=c.length;for(let t=0;t<e;t++){let e=c[t];this.addMethodType(e)}}let u=e.getMethods();if(u){let e=u.length;for(let t=0;t<e;t++){let e=u[t];this.addMethod(e)}}if(this.updateMethods(e),t){let t=e.getViewStyles();if(t){let e=t.length;for(let i=0;i<e;i++){let e=t[i];this.addViewStyle(e)}}let i=e.getGeometries();if(i){let e=i.length;for(let t=0;t<e;t++){let e=i[t];this.addGeometry(e)}}let l=e.getObjectTypeViews();if(l){let e=l.length;for(let t=0;t<e;t++){let e=l[t];this.addObjectTypeView(e)}}let n=e.getObjtypeGeos();if(n){let e=n.length;for(let t=0;t<e;t++){let e=n[t];this.addObjtypeGeo(e)}}let s=e.getRelshipTypeViews();if(s){let e=s.length;for(let t=0;t<e;t++){let e=s[t];this.addRelshipTypeView(e)}}}}}class c{addProperty(e){if(e){let t=new g(e);n&&console.log("465 prop, gProperty",e,t),this.properties.push(t)}}addMethod(e){if(e){let t=new b(e);n&&console.log("352 mtd, gProperty",e,t),this.methods.push(t)}}addAttribute(e){if(e){let t=new v(e);n&&console.log("479 jAttr, jAttr",e,t),this.attributes.push(t)}}addPort(e){let t,i;this.ports||(this.ports=[]),i=null==(t=this.ports)?void 0:t.length;for(let l=0;l<i;l++){if(t[l].id===e.id)return;t.push(e)}}getPortsBySide(e){let t=[],i=this.ports.length;for(let l=0;l<i;l++){let i=this.ports[l];i.side===e&&t.push(i)}return t}constructor(e,t){let i,l,s,r;this.id=e.id,this.name=e.name,this.abstract=e.abstract,this.viewkind=e.viewkind,this.typename="Object type",this.typedescription="",this.typeviewRef=e.typeview?e.typeview.id:"",this.description=e.description?e.description:"",this.properties=[],this.attributes=[],this.methods=[],this.ports=[],this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified;try{i=null==e?void 0:e.getProperties(!1)}catch(e){i=[]}let a=null==i?void 0:i.length;for(let e=0;e<a;e++){let t=i[e];this.addProperty(t)}try{l=null==e?void 0:e.getAttributes()}catch(e){l=[]}a=null==l?void 0:l.length;for(let e=0;e<a;e++){let t=l[e];this.addAttribute(t)}try{let t=e.getPorts();for(let e=0;e<a;e++){let i=t[e];this.addPort(i)}}catch(e){s=[]}a=null==s?void 0:s.length;for(let e=0;e<a;e++){let t=s[e];this.addPort(t)}try{r=e.getMethods()}catch(e){r=[]}a=null==r?void 0:r.length;for(let e=0;e<a;e++){let t=r[e];this.addMethod(t)}n&&console.log("610 objtype, props, this",e,i,this)}}class u{addProperty(e){if(e){let t=new g(e);this.properties.push(t)}}addSupertype(e){if(e){let t=new c(e);this.supertypes.push(t)}}constructor(e,t){var i,l;let n,s;this.id=e.id,this.name=e.name,this.relshipkind=e.relshipkind,this.viewkind=e.viewkind,this.fromobjtypeRef=e.fromobjtypeRef?e.fromobjtypeRef:null===(i=e.fromObjtype)||void 0===i?void 0:i.id,this.toobjtypeRef=e.toobjtypeRef?e.toobjtypeRef:null===(l=e.toObjtype)||void 0===l?void 0:l.id,this.typeviewRef="",this.description=e.description?e.description:"",this.supertypes=[],this.properties=[],this.cardinality=e.cardinality,this.cardinalityFrom=e.cardinalityFrom,this.cardinalityTo=e.cardinalityTo,this.nameFrom=e.nameFrom,this.nameTo=e.nameTo,this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified,t&&(this.typeviewRef=e.typeview?e.typeview.id:"");try{n=null==e?void 0:e.getProperties(!1)}catch(e){n=[]}let r=null==n?void 0:n.length;for(let e=0;e<r;e++){let t=n[e];this.addProperty(t)}try{s=e.getSupertypes()}catch(e){s=[]}for(let e=0;e<s.length;e++){let t=s[e];t&&this.addSupertype(t)}}}class h{constructor(e){this.id=e.id,this.name=e.name,this.description="",this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified,l.y9(e.description)&&(this.description=e.description)}}class m{constructor(e){this.id=e.id,this.name=e.name,this.description="",this.typeRef=e.typeRef,this.viewkind=e.getViewKind(),this.template=e.getTemplate(),this.figure=e.getFigure(),this.geometry=e.getGeometry(),this.fillcolor=e.getFillcolor(),this.fillcolor2=e.getFillcolor2(),this.strokecolor=e.getStrokecolor(),this.strokecolor1=this.strokecolor,this.strokecolor2=e.getStrokecolor2(),this.strokewidth=e.getStrokewidth(),this.textcolor=e.getTextcolor(),this.textcolor2=e.getTextcolor2(),this.textscale=e.getTextscale(),this.memberscale=e.getMemberscale(),this.icon=e.getIcon(),this.image=e.getImage(),this.grabIsAllowed=e.grabIsAllowed,this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified,e.description&&(this.description=e.description)}}class f{constructor(e){this.id=e.id,this.name=e.name,this.typeRef=e.type?e.type.id:"",this.metamodelRef=e.metamodel?e.metamodel.id:"",this.loc=e.getLoc(),this.size=e.getSize(),this.description=e.description?e.description:"",this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified}}class y{constructor(e){this.id=e.id,this.name=e.name,this.description=e.description?e.description:"",this.typeRef=e.getTypeRef(),this.template=e.getTemplate(),this.strokecolor=e.getStrokecolor(),this.strokecolor1=this.strokecolor1,this.strokewidth=e.getStrokewidth(),this.textcolor=e.getTextcolor(),this.textscale=e.getTextscale(),this.dash=e.getDash(),this.fromArrow=e.getFromArrow(),this.toArrow=e.getToArrow(),this.fromArrowColor=e.getFromArrowColor(),this.toArrowColor=e.getToArrowColor(),this.routing=e.getRouting(),this.corner=e.getCorner(),this.curve=e.getCurve(),this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified}}class g{constructor(e){this.id=e.id,this.name=e.name,this.defaultValue="",this.inputPattern="",this.viewFormat="",this.example="",this.readOnly=e.readOnly,this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified,this.description=e.description?e.description:"",e.datatype?this.datatypeRef=e.datatype.id:this.datatypeRef=e.datatypeRef,e.method?this.methodRef=e.method.id:this.methodRef=e.methodRef,e.unitCategory?this.unitCategoryRef=e.unitCategory.id:this.unitCategoryRef=e.unitCategoryRef,e.unitCategory?this.unitCategoryRef=e.unitCategory.id:this.unitCategoryRef=e.unitCategoryRef,e.defaultValue&&(this.description=e.defaultValue),n&&console.log("612 this",this)}}class v{constructor(e){this.typeName=e.typeName,this.propName=e.propName,this.name=e.name,this.propRef=e.propRef}}class w{constructor(e){this.id=e.id,this.name=e.name,this.description=e.description?e.description:"",this.properties=e.properties,this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified}}class b{constructor(e){this.id=e.id,this.name=e.name,this.methodtype=e.methodtype?e.methodtype:"",this.expression=e.expression,this.description=e.description?e.description:"",this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified}}class T{addModelView(e){if(n&&console.log("569 addModelView",e),e&&!e.isDeleted()){let t=new R(e);this.modelviews.push(t),n&&console.log("572 addModelView",this.modelviews);let i=null==e?void 0:e.objecttypeviews;if(i){let e=i.length;for(let l=0;l<e;l++){let e=i[l];t.addObjectTypeView(e)}}let l=null==e?void 0:e.relshiptypeviews;if(l){let e=l.length;for(let i=0;i<e;i++){let e=l[i];t.addRelshipTypeView(e)}}if(0==t.objectviews.length){let i=null==e?void 0:e.getObjectViews();if(i){let e=i.length;for(let l=0;l<e;l++){let e=i[l];t.addObjectView(e)}}}if(0==t.relshipviews.length){let i=null==e?void 0:e.getRelationshipViews();if(i){let e=i.length;for(let l=0;l<e;l++){let e=i[l];t.addRelshipView(e)}}}n&&console.log("613 addModelView",t)}}addObject(e){if(e&&e.type){let t=new O(e);this.objects.push(t)}}addRelationship(e){if(e&&e.type&&e.fromObject&&e.toObject){let t=new k(e);this.relships.push(t)}}addTemplate(e){if(e){let t=new R(e);this.templates.push(t)}}constructor(e,t){var i;this.id=e.id,this.name=e.name,this.description=e.description?e.description:"",this.metamodelRef=null===(i=e.metamodel)||void 0===i?void 0:i.id,this.sourceMetamodelRef=e.sourceMetamodelRef,this.targetMetamodelRef=e.targetMetamodelRef,this.sourceModelRef=e.sourceModelRef,this.targetModelRef=e.targetModelRef,this.includeSystemtypes=e.includeSystemtypes,this.includeRelshipkind=e.includeRelshipkind,this.isTemplate=e.isTemplate,this.templates=[],this.objects=[],this.relships=[],this.modelviews=[],this.markedAsDeleted=e.markedAsDeleted,this.modified=e.modified,this.args1=e.args1,this.args2=e.args2,e.description&&(this.description=e.description);let l=e.getObjects();if(l){let e=l.length;for(let t=0;t<e;t++){let e=l[t];e&&e.type&&this.addObject(e)}}let n=e.getRelationships();if(n){let e=n.length;for(let t=0;t<e;t++){let e=n[t];e&&e.type&&this.addRelationship(e)}}let s=e.getTemplates();if(s){let e=s.length;for(let t=0;t<e;t++){let e=s[t];e&&this.addTemplate(e)}}if(t){let t=e.getModelViews();if(t){let e=t.length;for(let i=0;i<e;i++){let e=t[i];this.addModelView(e)}}}}}class j{constructor(e){this.id=e.id,this.name=e.name,this.side=e.side,this.color=e.color,this.description=e.description}}class O{constructor(e){for(let t in this.id=e.id,this.name=e.name,this.description=e.description?e.description:"",this.abstract=e.abstract,this.viewkind=e.viewkind,this.parentModelRef=e.parentModelRef,this.typeRef=e.type?e.type.id:"",this.typeName=e.type?e.type.name:"",this.typeDescription=e.type?e.type.description:"",this.propertyValues=[],this.ports=[],this.markedAsDeleted=e.markedAsDeleted,this.generatedTypeId=e.generatedTypeId,this.modified=e.modified,n&&console.log("876 this, object",this,e),e){switch(t){case"id":case"name":case"description":case"abstract":case"viewkind":case"allProperties":case"fromObject":case"parentModel":case"propertyValues":case"toObject":case"type":case"typeview":case"typeName":case"typeRef":case"markedAsDeleted":case"modified":case"inputrels":case"outputrels":case"objectviews":case"ports":continue}this[t]=e[t]}let t=e.allProperties;if(n&&console.log("879 object, properties",e,t),t)for(let i=0;i<(null==t?void 0:t.length);i++){let l=t[i];if(!l)continue;let s=l.name,r=e.getStringValue2(s);n&&console.log("885 propname, value",s,r),this[s]=r}n&&console.log("888 this",this);let i=e.ports;if(i){this.ports=[];for(let e=0;e<i.length;e++){let t=new j(i[e]);this.ports.push(t)}}}}class k{addPropertyValue(e){if(l.y9(e)){let t=new M(e);this.propvalues.push(t)}}constructor(e){this.id=e.id,this.name=e.name,this.description=e.description,this.relshipkind=e.relshipkind,this.fromobjectRef=e.fromObject?e.fromObject.id:"",this.toobjectRef=e.toObject?e.toObject.id:"",this.typeRef=e.type?e.type.id:"",this.propvalues=[],this.cardinality=e.cardinality,this.cardinalityFrom=e.cardinalityFrom,this.cardinalityTo=e.cardinalityTo,this.nameFrom=e.nameFrom,this.nameTo=e.nameTo,this.fromPortid=e.fromPortid,this.toPortid=e.toPortid,this.markedAsDeleted=e.markedAsDeleted,this.generatedTypeId=e.generatedTypeId,this.modified=e.modified;let t=e.allProperties;n&&console.log("879 relship, properties",e,t);for(let i=0;i<(null==t?void 0:t.length);i++){let l=t[i];if(!l)continue;let s=l.name,r=e.getStringValue2(s);n&&console.log("885 propname, value",s,r),this[s]=r}}}class M{constructor(e){this.property=e.property,this.value=e.value}}class R{addObjectView(e){if(e){let t=new A(e);this.objectviews.push(t)}}addRelshipView(e){if(e&&e.relship&&e.fromObjview&&e.toObjview){let t=new E(e);this.relshipviews.push(t)}}addObjectTypeView(e){if(e){let t=new m(e);this.objecttypeviews.push(t)}}addRelshipTypeView(e){if(e){let t=new y(e);this.relshiptypeviews.push(t)}}constructor(e){var t,i,l,n,s;this.id=null==e?void 0:e.id,this.name=null==e?void 0:e.getName(),this.description=null==e?void 0:e.description,this.layout=null==e?void 0:e.layout,this.routing=null==e?void 0:e.routing,this.linkcurve=null==e?void 0:e.linkcurve,this.modelRef=null==e?void 0:null===(t=e.getModel())||void 0===t?void 0:t.id,this.showCardinality=null==e?void 0:e.showCardinality,this.showRelshipNames=null==e?void 0:e.showRelshipNames,this.askForRelshipName=null==e?void 0:e.askForRelshipName,this.includeInheritedReltypes=null==e?void 0:e.includeInheritedReltypes,this.UseUMLrelshipkinds=null==e?void 0:null===(i=e.getModel())||void 0===i?void 0:i.includeRelshipkind,this.viewstyleRef=null==e?void 0:null===(l=e.getViewStyle())||void 0===l?void 0:l.getId(),this.objectviews=[],this.relshipviews=[],this.objecttypeviews=[],this.relshiptypeviews=[],this.focusObjectviewRef=null==e?void 0:null===(n=e.focusObjectview)||void 0===n?void 0:n.id,this.markedAsDeleted=null==e?void 0:e.markedAsDeleted,this.modified=null==e?void 0:e.modified,this.viewstyleRef=null==e?void 0:null===(s=e.getViewStyle())||void 0===s?void 0:s.getId();let r=null==e?void 0:e.getObjectViews();if(r){let e=r.length;for(let t=0;t<e;t++){let e=r[t];this.addObjectView(e)}}let a=null==e?void 0:e.getRelationshipViews();if(a){let e=a.length;for(let t=0;t<e;t++){let e=a[t];this.addRelshipView(e)}}let d=null==e?void 0:e.objecttypeviews;if(d){let e=d.length;for(let t=0;t<e;t++){let e=d[t];this.addObjectTypeView(e)}}let p=null==e?void 0:e.relshiptypeviews;if(p){let e=p.length;for(let t=0;t<e;t++){let e=p[t];this.addRelshipTypeView(e)}}}}class A{constructor(e){var t,i;this.id=null==e?void 0:e.id,this.name=null==e?void 0:e.name,this.description=null==e?void 0:e.description,this.objectRef=null==e?void 0:null===(t=e.object)||void 0===t?void 0:t.id,this.objectRef||(this.objectRef=null==e?void 0:e.objectRef),this.typeviewRef=null==e?void 0:null===(i=e.typeview)||void 0===i?void 0:i.id,this.group=null==e?void 0:e.group,this.groupLayout=null==e?void 0:e.groupLayout,this.viewkind=null==e?void 0:e.viewkind,this.isGroup=null==e?void 0:e.isGroup,this.isExpanded=null==e?void 0:e.isExpanded,this.isSelected=null==e?void 0:e.isSelected,this.loc=null==e?void 0:e.loc,this.template=null==e?void 0:e.template,this.template2=null==e?void 0:e.template2,this.figure=null==e?void 0:e.figure,this.geometry=null==e?void 0:e.geometry,this.fillcolor=null==e?void 0:e.fillcolor,this.fillcolor2=null==e?void 0:e.fillcolor2,this.strokecolor=null==e?void 0:e.strokecolor,this.strokecolor2=null==e?void 0:e.strokecolor2,this.strokewidth=null==e?void 0:e.strokewidth,this.textcolor=null==e?void 0:e.textcolor,this.textcolor2=null==e?void 0:e.textcolor2,this.icon=null==e?void 0:e.icon,this.image=null==e?void 0:e.image,this.size=null==e?void 0:e.size,this.scale=null==e?void 0:e.scale,this.memberscale=null==e?void 0:e.memberscale,this.textscale=null==e?void 0:e.textscale,this.arrowscale=null==e?void 0:e.arrowscale,this.markedAsDeleted=null==e?void 0:e.markedAsDeleted,this.modified=null==e?void 0:e.modified}}class E{constructor(e){this.id=null==e?void 0:e.id,this.name=null==e?void 0:e.name,this.description="",this.relshipRef="",this.typeviewRef="",this.template=null==e?void 0:e.template,this.template2=null==e?void 0:e.template2,this.arrowscale=null==e?void 0:e.arrowscale,this.strokecolor=null==e?void 0:e.strokecolor,this.strokewidth=null==e?void 0:e.strokewidth,this.textcolor=null==e?void 0:e.textcolor,this.textscale=null==e?void 0:e.textscale,this.dash=null==e?void 0:e.dash,this.fromArrow=null==e?void 0:e.fromArrow,this.toArrow=null==e?void 0:e.toArrow,this.fromArrowColor=null==e?void 0:e.fromArrowColor,this.toArrowColor=null==e?void 0:e.toArrowColor,this.fromobjviewRef=e&&e.fromObjview?e.fromObjview.id:"",this.toobjviewRef=e&&e.toObjview?e.toObjview.id:"",this.fromPortid=null==e?void 0:e.fromPortid,this.toPortid=null==e?void 0:e.toPortid,this.points=null==e?void 0:e.points,this.routing=null==e?void 0:e.routing,this.curve=null==e?void 0:e.curve,this.corner=null==e?void 0:e.corner,this.markedAsDeleted=null==e?void 0:e.markedAsDeleted,this.modified=null==e?void 0:e.modified,this.visible=null==e?void 0:e.visible,(null==e?void 0:e.description)&&(this.description=e.description),(null==e?void 0:e.relship)&&(this.relshipRef=e.relship.id),(null==e?void 0:e.typeview)&&(this.typeviewRef=e.typeview.id)}}},5092:(e,t,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/modelling",function(){return i(679)}])},6046:(e,t,i)=>{"use strict";let l;i.d(t,{F1:()=>Q,J9:()=>Y,Kl:()=>X,XC:()=>et,ZQ:()=>h,_k:()=>I,b0:()=>_,bP:()=>V,hr:()=>F,ki:()=>B,t:()=>L,tV:()=>x,zk:()=>q});var n=i(7621),s=i(6196);let r=!1,a=n.Ke.make;function d(){return new n.or(200,100)}function p(e){switch(e){case"Normal":default:return n.N_.Normal;case"Orthogonal":return n.N_.Orthogonal;case"AvoidsNodes":return n.N_.AvoidsNodes}}function c(e){switch(e){case"Bezier":return n.N_.Bezier;case"JumpOver":return n.N_.JumpOver;case"JumpGap":return n.N_.JumpGap;default:return""}}n.yp.defineFigureGenerator("Annotation",function(e,t,i){let l=Math.min(t,10),s=Math.max(t,10);return new n.V2().add(new n.aX(l,0).add(new n.pD(n.pD.Line,0,0)).add(new n.pD(n.pD.Line,0,i)).add(new n.pD(n.pD.Line,l,i)).add(new n.pD(n.pD.Move,s-l,0)))});let u=["Circle","Diamond","LineH","LineV","MinusLine","PlusLine","XLine","Rectangle","RoundedRectangle","Square","Triangle","TriangleRight","TriangleLeft","TriangleUp","TriangleDown"];function h(){return u}let m=[],f=[],y=[];function g(){return a(n.VI,new n.Of("source","icon",Q),{name:"Picture",column:2,margin:new n.R5(2,0,0,0),desiredSize:new n.or(25,25),alignment:n.P1.Right},new n.Of("visible","isSubGraphExpanded").ofObject())}function v(){return a(n.yp,new n.Of("geometryString","geometry"),new n.Of("fill","fillcolor2"),{column:2,margin:new n.R5(2,0,0,0),desiredSize:new n.or(20,20),alignment:n.P1.Right},new n.Of("visible","isSubGraphExpanded").ofObject())}function w(){return a(n.yp,new n.Of("figure","figure"),new n.Of("fill","fillcolor2"),{column:2,margin:new n.R5(2,0,0,0),desiredSize:new n.or(20,20),alignment:n.P1.Right},new n.Of("visible","isSubGraphExpanded").ofObject())}function b(e){switch(e){case"Icon":default:return g();case"Geometry":return v();case"Figure":return w()}}function T(e){switch(e){case"Image":return j();case"Icon":default:return O();case"Geometry":return k();case"Figure":return M()}}function j(){return a(n.VI,new n.Of("source","image",Q),{column:2,margin:new n.R5(2,0,0,0),desiredSize:new n.or(25,25),alignment:n.P1.Right,imageStretch:n.Ke.Uniform,cursor:"move"},new n.Of("visible","isSubGraphExpanded",function(e){return!e}).ofObject(),new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify))}function O(){return a(n.VI,new n.Of("source","icon",Q),{column:2,margin:new n.R5(2,0,0,0),desiredSize:new n.or(25,25),alignment:n.P1.Right,imageStretch:n.Ke.Uniform,cursor:"move"},new n.Of("visible","isSubGraphExpanded",function(e){return!e}).ofObject(),new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify))}function k(){return a(n.yp,new n.Of("geometryString","geometry"),new n.Of("fill","fillcolor2"),{column:2,margin:new n.R5(2,0,0,0),desiredSize:new n.or(25,25),alignment:n.P1.Right,imageStretch:n.Ke.Uniform,cursor:"move"},new n.Of("visible","isSubGraphExpanded",function(e){return!e}).ofObject(),new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify))}function M(){return a(n.yp,new n.Of("figure","figure"),new n.Of("fill","fillcolor2"),{column:2,margin:new n.R5(2,0,0,0),desiredSize:new n.or(20,20),alignment:n.P1.Right,imageStretch:n.Ke.Uniform,cursor:"move"},new n.Of("visible","isSubGraphExpanded",function(e){return!e}).ofObject(),new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify))}function R(e,t){return a(n.Zk,"Auto",{row:1,column:1,name:"BODY",stretch:n.Ke.Fill},a(n.yp,"RoundedRectangle",{cursor:"alias",fill:"white",shadowVisible:!0,minSize:new n.or(160,65),portId:"",fromLinkable:!0,fromLinkableSelfNode:!1,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!1,toLinkableDuplicates:!0},new n.Of("fill","fillcolor"),new n.Of("stroke","strokecolor")),a(n.Zk,"Vertical",{name:"HEADER",defaultAlignment:n.P1.TopLeft},a(n.Zk,"Table",{contextMenu:e,cursor:"move",stretch:n.Ke.Horizontal},a("SubGraphExpanderButton",{column:0,margin:new n.R5(-2,2,2,0),alignment:n.P1.Left,scale:1.2}),a(n.VJ,{row:0,column:1,isMultiline:!1,maxLines:1,editable:!0,font:"Bold 14pt Sans-Serif",textAlign:"left",alignment:n.P1.Left,margin:new n.R5(0,0,0,10),wrap:n.VJ.None,overflow:n.VJ.OverflowEllipsis,stretch:n.Ke.Horizontal,name:"name"},new n.Of("fill","fillcolor"),new n.Of("text","name").makeTwoWay(),new n.Of("stroke","textcolor").makeTwoWay(),new n.Of("visible","isSubGraphExpanded").ofObject()),a(n.VJ,et(),{row:0,column:1,isMultiline:!1,maxLines:1,editable:!0,font:"Bold 28pt Sans-Serif",textAlign:"left",alignment:n.P1.Left,margin:new n.R5(0,0,0,10),wrap:n.VJ.None,overflow:n.VJ.OverflowEllipsis,stretch:n.Ke.Horizontal,name:"name"},new n.Of("fill","fillcolor"),new n.Of("text","name").makeTwoWay(),new n.Of("stroke","textcolor").makeTwoWay(),new n.Of("visible","isSubGraphExpanded",function(e){return!e}).ofObject()),b(t)),a(n.yp,{name:"SHAPE",fill:"lightyellow",opacity:.95,minSize:new n.or(200,100),margin:new n.R5(0,10,10,10),cursor:"move",stroke:"transparent"},new n.Of("fill","fillcolor2"),new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify),new n.Of("visible","isSubGraphExpanded").ofObject()),T("Image"),a(n.VJ,et(),{row:2,stretch:n.Ke.Fill,isMultiline:!1,editable:!1,minSize:new n.or(10,4),margin:new n.R5(0,0,0,2),textAlign:"left",cursor:"move"},new n.Of("text","typename"))))}function A(e,t){return a(n.Zk,"Auto",{row:1,column:1,name:"BODY",stretch:n.Ke.Fill},a(n.yp,"RoundedRectangle",{cursor:"alias",fill:"white",shadowVisible:!0,minSize:new n.or(160,65),portId:"",fromLinkable:!0,fromLinkableSelfNode:!1,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!1,toLinkableDuplicates:!0},new n.Of("fill","fillcolor"),new n.Of("stroke","strokecolor")),a(n.yp,"RoundedRectangle",{cursor:"move",fill:"transparent",stroke:"transparent",margin:new n.R5(30,12,12,12),minSize:new n.or(150,55),stretch:n.Ke.Fill},new n.Of("fill","fillcolor")),a(n.Zk,"Table",{stretch:n.Ke.Fill,defaultAlignment:n.P1.TopLeft},a(n.Gk,{row:0,sizing:n.Gk.None}),a(n.Zk,"Table",{row:0,contextMenu:e,cursor:"move",stretch:n.Ke.Horizontal},a(n.Gk,{column:0,sizing:n.Gk.None}),a("SubGraphExpanderButton",{column:0,margin:new n.R5(-2,2,2,0),alignment:n.P1.Left,scale:1.5}),a(n.VJ,et(),{row:0,column:1,isMultiline:!1,maxLines:1,editable:!0,font:"Bold 14pt Sans-Serif",textAlign:"left",alignment:n.P1.Left,margin:new n.R5(0,0,0,10),wrap:n.VJ.None,overflow:n.VJ.OverflowEllipsis,name:"name"},new n.Of("fill","fillcolor"),new n.Of("text","name").makeTwoWay(),new n.Of("stroke","textcolor").makeTwoWay(),new n.Of("visible","isSubGraphExpanded").ofObject()),a(n.VJ,et(),{row:0,column:1,isMultiline:!1,maxLines:1,editable:!0,font:"Bold 28pt Sans-Serif",textAlign:"left",alignment:n.P1.Left,margin:new n.R5(0,0,0,10),wrap:n.VJ.None,overflow:n.VJ.OverflowEllipsis,name:"name"},new n.Of("fill","fillcolor"),new n.Of("text","name").makeTwoWay(),new n.Of("stroke","textcolor").makeTwoWay(),new n.Of("visible","isSubGraphExpanded",function(e){return!e}).ofObject()),b(t)),a(n.yp,{row:1,stretch:n.Ke.Fill,fill:"rgba(128,128,128,0.33)",stroke:"black",opacity:.75,margin:new n.R5(1,4,1,4),cursor:"move"},new n.Of("fill","fillcolor2"),new n.Of("visible","isSubGraphExpanded").ofObject()),a(n.VI,new n.Of("source","image",Q),{row:1,stretch:n.Ke.Fill,margin:new n.R5(2,10,5,10),alignment:n.P1.Center,imageStretch:n.Ke.Uniform},new n.Of("visible","isSubGraphExpanded",function(e){return!e}).ofObject()),a(n.Gk,{row:2,sizing:n.Gk.None}),a(n.VJ,et(),{row:2,stretch:n.Ke.Horizontal,isMultiline:!1,editable:!1,minSize:new n.or(10,2),margin:new n.R5(0,0,0,0),cursor:"move"},new n.Of("text","typename"))))}function E(e){return a(n.Zk,"Table",{contextMenu:e,cursor:"move"},{defaultRowSeparatorStroke:"black",desiredSize:new n.or(136,60),maxSize:new n.or(136,60),margin:new n.R5(2),defaultAlignment:n.P1.Center},a(n.VJ,et(),{isMultiline:!1,editable:!0,row:0,column:0,columnSpan:6,font:"bold 10pt Segoe UI,sans-serif",minSize:new n.or(120,36),textAlign:"center",height:46,width:120,verticalAlignment:n.P1.Center,margin:new n.R5(0,3,0,0),name:"name"},new n.Of("text","name").makeTwoWay(),new n.Of("stroke","textcolor").makeTwoWay()),a(n.VJ,et(),{row:1,column:1,columnSpan:6,editable:!1,isMultiline:!1,minSize:new n.or(10,4),margin:new n.R5(0,0,0,2),textAlign:"center"},new n.Of("text","typename"),new n.Of("stroke","textcolor2").makeTwoWay()))}function D(e){return a(n.Zk,"Vertical",new n.Of("itemArray","leftPorts"),{row:1,column:0,itemTemplate:C("left",!0,e),alignment:n.P1.Left})}function S(e){return a(n.Zk,"Horizontal",new n.Of("itemArray","topPorts"),{row:0,column:1,itemTemplate:C("top",!0,e),alignment:n.P1.Top})}function N(e){return a(n.Zk,"Vertical",new n.Of("itemArray","rightPorts"),{row:1,column:2,itemTemplate:C("right",!0,e),alignment:n.P1.Right})}function P(e){return a(n.Zk,"Horizontal",new n.Of("itemArray","bottomPorts"),{row:0,column:1,itemTemplate:C("bottom",!0,e),alignment:n.P1.Bottom})}function C(e,t,i){let l="right"===e,s="left"===e,r="top"===e,d="bottom"===e,p=l||t,c=s||r||d||t,u="F1 m 0,0 l 5,0 1,4 -1,4 -5,0 1,-4 -1,-4 z";u.normalize();let h="F1 m 0,0 l 6,0 0,8  2,0  -5,4  -5,-4 2,0 0,-8 z";h.normalize();let m="F1 m 0,0 l 6,0 0,-8  2,0  -5,-4  -5,4 2,0 0,8 z";m.normalize(),"F1 m 0,0 l 5,0 0,3 5,-7 -5,-7 0,3 -5,0 0,5 z".normalize();let f="10pt serif",y="12pt FontAwesome",g=t?y:f,v=new n.or(30,15),w=new n.or(40,20),b=t?w:v,T,j,O=0;r?(j=n.P1.Top,T=n.P1.Bottom):d?(j=n.P1.Bottom,T=n.P1.Top):s?(j=n.P1.Left,T=n.P1.Right):l&&(j=n.P1.Left,T=n.P1.Right);let k=u;return r?k=h:d&&(k=m),a(n.Zk,"Spot",{margin:new n.R5(1,1),contextMenu:i},a(n.yp,{name:"SHAPE",fill:"white",stroke:"gray",strokeWidth:1,geometryString:k,toSpot:j,portId:"",toLinkable:c,fromSpot:T,fromLinkable:p,cursor:"alias",desiredSize:b},new n.Of("portId","id"),new n.Of("fill","color")),a(n.VJ,{font:g,angle:O},new n.Of("text","name"),new n.Of("scale","textscale").makeTwoWay()))}function x(){return m}function _(){return f}function I(){return y}function V(e,t,i){i.startTransaction("changePortName");let l=e.data;r&&console.log("394 port, data",e,l),i.model.setDataProperty(l,"name",t),i.commitTransaction("changePortName")}function L(e,t,i){i.startTransaction("colorPort");let l=e.data;r&&console.log("403 port, data",e,l),i.model.setDataProperty(l,"color",t),i.commitTransaction("colorPort")}function F(e,t){t.startTransaction("addPort");let i=e.id,l=e.side,n=e.name,s=e.color;r&&console.log("301 side, name",l,n);let a=t.selection;r&&console.log("304 sel",a),a.each(e=>{r&&console.log("306 node, portId: ",e,i);let a=e.data[l+"Ports"];if(r&&console.log("315 arr: ",a),a){let e={portId:i,name:n,color:s};r&&console.log("323 newportdata: ",e),t.model.insertArrayItem(a,-1,e)}}),t.commitTransaction("addPort")}function B(e,t){r&&console.log("436 port, myDiagram",e,t),t.startTransaction("removePort");let i=e.data.id,l=e.panel.itemArray;r&&console.log("440 port, pid, arr",e,i,l);for(let e=0;e<(null==l?void 0:l.length);e++)if(l[e].id===i){t.model.removeArrayItem(l,e);break}t.commitTransaction("removePort")}function G(e){if(0==m.length){m.push(e);return}let t=[...new Set(m)];for(let i=0;i<(null==t?void 0:t.length);i++)if(t[i]!=e){t.push(e);break}m=[...new Set(t)]}function K(e){if(0==y.length){y.push(e);return}let t=[...new Set(y)];for(let i=0;i<(null==t?void 0:t.length);i++)if(t[i]!=e){t.push(e);break}y=[...new Set(t)]}function J(e){if(0==f.length){f.push(e);return}let t=[...new Set(f)];for(let i=0;i<(null==t?void 0:t.length);i++)if(t[i]!=e){t.push(e);break}f=[...new Set(t)],r&&console.log("216 linkTemplateNames: ",f)}a(n.vM,"Linear",{0:"LightGoldenRodYellow",1:"#FFFF66"}),a(n.vM,"Linear",{0:"#E0FEE0",1:"PaleGreen"}),a(n.vM,"Linear",{0:"White",1:"#DADADA"});let W=200,U=20;function z(e){return e.isSubGraphExpanded?new n.or(W,U):new n.or(W,1)}function H(e){if(l.startTransaction("addLane"),null!=e&&"Lane"===e.data.category){let t=e.findObject("SHAPE"),i=new n.or(t?t.width:W,U),s={category:"Lane",text:"New Lane",color:"white",isGroup:!0,loc:n.bR.stringify(new n.bR(e.location.x,e.location.y+1)),size:n.or.stringify(i),group:e.data.group};l.model.addNodeData(s)}l.commitTransaction("addLane")}function Y(e,t,i,l){l.myDiagram,r&&console.log("981 addNodeTemplates",l,t,i);let d=a(n.bP,"Auto",{mouseEnter:(e,t)=>t.isHighlighted=!0,mouseLeave:(e,t)=>t.isHighlighted=!1},new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("stroke","strokecolor"),new n.Of("layerName","layer"),new n.Of("deletable"),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("scale","scale1").makeTwoWay(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){let t=s.rz(e,l);return r&&console.log("234 tooltip",t),t})))},a(n.yp,"RoundedRectangle",{cursor:"alias",fill:"yellow",stroke:"#fff",strokeWidth:2,margin:new n.R5(1,1,1,1),shadowVisible:!0,desiredSize:new n.or(160,70),portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new n.Of("fill","fillcolor"),new n.Of("stroke","strokecolor"),new n.Of("stroke","isHighlighted",function(e,t){return e?"lightblue":t.part.data.strokecolor||"black"}).ofObject()),a(n.yp,"RoundedRectangle",{cursor:"move",fill:"transparent",stroke:"transparent",strokeWidth:10,margin:new n.R5(1,1,1,1),shadowVisible:!1,desiredSize:new n.or(136,60)}),E(t));e.add("",d),e.add("textOnly",d),G("textOnly");let p=a(n.bP,"Auto",new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("stroke","strokecolor"),new n.Of("layerName","layer"),new n.Of("deletable"),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("scale","scale1").makeTwoWay(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){return s.rz(e,l)})))},{selectionObjectName:"SHAPE",resizable:!0,resizeObjectName:"SHAPE"},a(n.yp,"RoundedRectangle",{cursor:"alias",name:"SHAPE",fill:"red",stroke:"#fff",strokeWidth:2,margin:new n.R5(1,1,1,1),shadowVisible:!0,minSize:new n.or(158,68),desiredSize:new n.or(158,68),portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify),new n.Of("fill","fillcolor"),new n.Of("stroke","strokecolor"),new n.Of("stroke","isHighlighted",function(e,t){return e?"lightblue":t.part.data.strokecolor||"black"}).ofObject(),{contextMenu:t}),a(n.yp,"RoundedRectangle",{name:"SHAPE",cursor:"move",fill:"transparent",stroke:"transparent",strokeWidth:10,margin:new n.R5(1,1,1,1),shadowVisible:!1,desiredSize:new n.or(136,48)}),a(n.Zk,"Table",{defaultAlignment:n.P1.Left,margin:2,cursor:"move"},a(n.Gk,{column:1,width:4}),a(n.Zk,"Horizontal",{defaultAlignment:n.P1.Center},a(n.Zk,"Table",{contextMenu:t,cursor:"move"},{defaultRowSeparatorStroke:"black",defaultAlignment:n.P1.Center},a(n.VJ,et(),{isMultiline:!1,editable:!0,row:0,column:0,columnSpan:6,font:"bold 10pt Segoe UI,sans-serif",minSize:new n.or(120,36),desiredSize:new n.or(200,60),textAlign:"center",height:46,verticalAlignment:n.P1.Center,margin:new n.R5(2,2,2,2),stretch:n.Ke.Fill,name:"name"},new n.Of("text","name").makeTwoWay(),new n.Of("stroke","textcolor").makeTwoWay()),a(n.VJ,et(),{row:1,column:1,columnSpan:6,stretch:n.Ke.Horizontal,editable:!1,isMultiline:!1,minSize:new n.or(10,4),margin:new n.R5(0,0,0,2),textAlign:"center"},new n.Of("text","typename"))))));e.add("textOnly1",p),G("textOnly1");let c=a(n.bP,"Auto",new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("stroke","strokecolor"),new n.Of("layerName","layer"),new n.Of("deletable"),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("scale","scale1").makeTwoWay(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){return s.rz(e,l)})))},{selectionObjectName:"SHAPE",resizable:!0,resizeObjectName:"SHAPE"},a(n.yp,"RoundedRectangle",{cursor:"alias",name:"SHAPE",fill:"red",stroke:"#fff",strokeWidth:2,margin:new n.R5(1,1,1,1),shadowVisible:!0,minSize:new n.or(158,68),desiredSize:new n.or(158,68),portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify),new n.Of("fill","fillcolor"),new n.Of("stroke","strokecolor"),new n.Of("stroke","isHighlighted",function(e,t){return e?"lightblue":t.part.data.strokecolor||"black"}).ofObject(),{contextMenu:t}),a(n.yp,"RoundedRectangle",{name:"SHAPE",cursor:"move",fill:"transparent",stroke:"transparent",strokeWidth:10,margin:new n.R5(1,1,1,1),shadowVisible:!1,desiredSize:new n.or(136,48)}),a(n.Zk,"Table",{defaultAlignment:n.P1.Left,margin:2,cursor:"move"},a(n.Gk,{column:1,width:4}),a(n.Zk,"Horizontal",{defaultAlignment:n.P1.Center},a(n.Zk,"Table",{contextMenu:t,cursor:"move"},{defaultRowSeparatorStroke:"black",defaultAlignment:n.P1.Center},a(n.VJ,et(),{isMultiline:!0,editable:!0,row:0,column:0,columnSpan:6,font:"bold 10pt Segoe UI,sans-serif",minSize:new n.or(120,36),desiredSize:new n.or(400,100),textAlign:"center",width:400,height:100,verticalAlignment:n.P1.Center,margin:new n.R5(2,2,2,2),name:"name"},new n.Of("text","name").makeTwoWay(),new n.Of("stroke","textcolor").makeTwoWay())))));e.add("textOnly2",c),G("textOnly2");let u=a(n.bP,"Auto",new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("stroke","strokecolor"),new n.Of("layerName","layer"),new n.Of("deletable"),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("scale","scale1").makeTwoWay(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){return s.rz(e,l)})))},{selectionObjectName:"SHAPE",resizable:!0,resizeObjectName:"SHAPE"},a(n.yp,"RoundedRectangle",{cursor:"alias",name:"SHAPE",fill:"red",stroke:"#fff",strokeWidth:2,margin:new n.R5(1,1,1,1),shadowVisible:!0,minSize:new n.or(158,68),desiredSize:new n.or(158,68),portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify),new n.Of("fill","fillcolor"),new n.Of("stroke","strokecolor"),new n.Of("stroke","isHighlighted",function(e,t){return e?"lightblue":t.part.data.strokecolor||"black"}).ofObject(),{contextMenu:t}),a(n.yp,"RoundedRectangle",{name:"SHAPE",cursor:"move",fill:"transparent",stroke:"transparent",strokeWidth:10,margin:new n.R5(1,1,1,1),shadowVisible:!1,desiredSize:new n.or(136,48)}),a(n.Zk,"Table",{defaultAlignment:n.P1.Left,margin:2,cursor:"move"},a(n.Gk,{column:0,width:9}),a(n.Zk,"Horizontal",{defaultAlignment:n.P1.Center},a(n.Zk,"Table",{contextMenu:t,cursor:"move"},{defaultRowSeparatorStroke:"black",defaultAlignment:n.P1.Center},a(n.VJ,et(),{isMultiline:!1,editable:!0,row:0,column:0,columnSpan:6,font:"bold 10pt Segoe UI,sans-serif",minSize:new n.or(120,36),desiredSize:new n.or(200,60),textAlign:"center",height:46,verticalAlignment:n.P1.Center,margin:new n.R5(2,2,2,2),name:"name"},new n.Of("text","name").makeTwoWay(),new n.Of("stroke","textcolor").makeTwoWay())))),a(n.Zk,"Table",{contextMenu:t,cursor:"move"},a(n.VI,{name:"Picture",desiredSize:new n.or(48,48),row:2,column:0,columnSpan:6},new n.Of("source","icon",Q)),a(n.VJ,et(),{row:3,column:0,columnSpan:6,stretch:n.Ke.Horizontal,editable:!1,isMultiline:!1,minSize:new n.or(10,4),margin:new n.R5(0,0,0,2),textAlign:"center"},new n.Of("text","findImage"))),a(n.VJ,et(),{row:3,column:0,columnSpan:6,stretch:n.Ke.Horizontal,editable:!1,isMultiline:!1,minSize:new n.or(10,4),margin:new n.R5(0,0,0,2),textAlign:"center"},new n.Of("text","typename")));e.add("textOnly3",u),G("textOnly3"),e.add("textAndIcon",a(n.bP,"Auto",new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("stroke","strokecolor"),new n.Of("layerName","layer"),new n.Of("deletable"),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("scale","scale1").makeTwoWay(),{mouseEnter:(e,t)=>t.isHighlighted=!0,mouseLeave:(e,t)=>t.isHighlighted=!1},{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){let t=s.rz(e,l);return r&&console.log("234 tooltip",t),t})))},a(n.yp,"RoundedRectangle",{cursor:"alias",name:"SHAPE",fill:"transparent",stroke:"#aaa",strokeWidth:2,margin:new n.R5(1,1,1,1),shadowVisible:!0,desiredSize:new n.or(198,68),portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new n.Of("fill","fillcolor"),new n.Of("stroke","strokecolor"),new n.Of("stroke","isHighlighted",function(e,t){return e?"lightblue":t.part.data.strokecolor||"black"}).ofObject()),a(n.yp,"RoundedRectangle",{cursor:"move",fill:"transparent",stroke:"transparent",strokeWidth:10,margin:new n.R5(1,1,1,1),shadowVisible:!1}),a(n.Zk,"Table",{defaultAlignment:n.P1.Left,margin:1,cursor:"move"},a(n.Gk,{column:1,width:4}),a(n.Zk,"Horizontal",{defaultAlignment:n.P1.Center},a(n.Zk,"Vertical",{contextMenu:t,cursor:"move"},a(n.Zk,"Spot",{contextMenu:t,cursor:"move"},a(n.yp,{fill:"white",stroke:"black",opacity:.9,desiredSize:new n.or(52,52),margin:new n.R5(0,2,0,16)},new n.Of("fill","fillcolor2"),new n.Of("stroke","strokecolor2"),new n.Of("template","template")),a(n.yp,{fill:"transparent",stroke:"transparent",strokeWidth:4,desiredSize:new n.or(56,56),margin:new n.R5(0,2,0,16),shadowVisible:!0},new n.Of("stroke","strokecolor2"),new n.Of("template","template")),a(n.VI,{name:"Picture",desiredSize:new n.or(48,48)},new n.Of("source","icon",Q)),a(n.VJ,et(),{background:"transparent",textAlign:"center",stroke:"black",desiredSize:new n.or(48,36),font:"38px 'FontAwesome'",editable:!1,isMultiline:!1},new n.Of("stroke","strokecolor2",$),new n.Of("text","icon",ee)))),E(t))))),G("textAndIcon"),e.add("textAndGeometry",a(n.bP,"Auto",new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("stroke","strokecolor"),new n.Of("layerName","layer"),new n.Of("deletable"),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("scale","scale1").makeTwoWay(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){let t=s.rz(e,l);return r&&console.log("234 tooltip",t),t})))},a(n.yp,"RoundedRectangle",{cursor:"alias",name:"SHAPE",fill:"red",stroke:"#000",strokeWidth:2,margin:new n.R5(1,1,1,1),shadowVisible:!0,desiredSize:new n.or(198,68),portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new n.Of("fill","fillcolor"),new n.Of("stroke","strokecolor"),new n.Of("stroke","isHighlighted",function(e,t){return e?"lightblue":t.part.data.strokecolor||"black"}).ofObject(),{contextMenu:t}),a(n.yp,"RoundedRectangle",{cursor:"move",fill:"transparent",stroke:"transparent",strokeWidth:10,margin:new n.R5(1,1,1,1),shadowVisible:!1,desiredSize:new n.or(136,48)}),a(n.Zk,"Table",{defaultAlignment:n.P1.Left,margin:2,cursor:"move"},a(n.Gk,{column:1,width:4}),a(n.Zk,"Horizontal",{defaultAlignment:n.P1.Center},a(n.Zk,"Vertical",{contextMenu:t,cursor:"move"},a(n.yp,new n.Of("stroke","strokecolor2"),new n.Of("template","template"),new n.Of("geometryString","geometry"),new n.Of("fill","fillcolor2"),{name:"SHAPE",strokeWidth:2,stroke:"blue",fill:"lightyellow",cursor:"alias",margin:new n.R5(1,1,1,1),shadowVisible:!0,desiredSize:new n.or(48,48)})),E(t))))),G("textAndGeometry"),e.add("textAndFigure",a(n.bP,"Auto",new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("stroke","strokecolor"),new n.Of("layerName","layer"),new n.Of("deletable"),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("scale","scale1").makeTwoWay(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){let t=s.rz(e,l);return r&&console.log("234 tooltip",t),t})))},a(n.yp,"RoundedRectangle",{cursor:"alias",name:"SHAPE",fill:"red",stroke:"#000",strokeWidth:2,margin:new n.R5(1,1,1,1),shadowVisible:!0,desiredSize:new n.or(198,68),portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new n.Of("fill","fillcolor"),new n.Of("stroke","isHighlighted",function(e,t){return e?"lightblue":t.part.data.strokecolor||"black"}).ofObject(),{contextMenu:t}),a(n.yp,"RoundedRectangle",{cursor:"move",fill:"transparent",stroke:"transparent",strokeWidth:10,margin:new n.R5(1,1,1,1),shadowVisible:!1,desiredSize:new n.or(136,48)}),a(n.Zk,"Table",{defaultAlignment:n.P1.Left,margin:2,cursor:"move"},a(n.Gk,{column:1,width:4}),a(n.Zk,"Horizontal",{defaultAlignment:n.P1.Center},a(n.Zk,"Vertical",{contextMenu:t,cursor:"move"},a(n.yp,{name:"SHAPE",strokeWidth:2,stroke:"blue",fill:"lightyellow",cursor:"alias",margin:new n.R5(1,1,1,1),shadowVisible:!0,desiredSize:new n.or(48,48)},new n.Of("stroke","strokecolor2"),new n.Of("fill","fillcolor2"),new n.Of("figure","figure"))),E(t))))),G("textAndFigure"),a(n.bP,"Table",new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("stroke","strokecolor"),new n.Of("layerName","layer"),new n.Of("deletable"),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("scale","scale1").makeTwoWay(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){return s.rz(e,l)})))},{locationSpot:n.P1.Center,movable:!0,resizable:!0},a(n.Zk,"Auto",a(n.yp,"RoundedRectangle",{cursor:"alias",fill:"white",stroke:"black",strokeWidth:1,portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0}),new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify),a(n.Zk,"Vertical",{defaultAlignment:n.P1.Left,margin:2,cursor:"move"},a(n.VJ,{isMultiline:!1,editable:!0,row:0,column:0,columnSpan:6,font:"bold 10pt Segoe UI,sans-serif",minSize:new n.or(120,36),desiredSize:new n.or(200,60),textAlign:"center",height:46,verticalAlignment:n.P1.Center,margin:new n.R5(2,2,2,2),stretch:n.Ke.Fill,name:"name"},new n.Of("text","name").makeTwoWay(),new n.Of("stroke","textcolor").makeTwoWay()),a(n.VI,{name:"Picture",desiredSize:new n.or(100,80),row:1,column:0,columnSpan:6,margin:new n.R5(12,12,12,12),alignment:n.P1.Center,cursor:"move"},new n.Of("source","icon",Q))),a(n.VJ,et(),{row:2,column:1,columnSpan:6,stretch:n.Ke.Horizontal,editable:!1,isMultiline:!1,minSize:new n.or(10,4),margin:new n.R5(0,0,0,2),textAlign:"center"},new n.Of("text","typename")))),e.add("nodeWithPorts",a(n.bP,"Table",{contextMenu:t,selectionObjectName:"BODY",resizeObjectName:"BODY",resizable:!0,selectionAdorned:!1},new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("scale","scale1").makeTwoWay(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){let t=s.rz(e,l);return r&&console.log("234 tooltip",t),t})))},a(n.Zk,"Auto",{name:"BODY",row:1,column:1,minSize:new n.or(150,60),stretch:n.Ke.Fill},a(n.yp,"RoundedRectangle",{cursor:"alias",fill:"white",stroke:"black",strokeWidth:2,parameter1:5,portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new n.Of("fill","fillcolor"),new n.Of("stroke","strokecolor")),a(n.yp,"RoundedRectangle",{cursor:"move",fill:"transparent",stroke:"transparent",desiredSize:new n.or(110,40)}),a(n.VJ,{cursor:"move",margin:10,textAlign:"center",font:"bold 14px Segoe UI,sans-serif",stroke:"#484848",editable:!0,isMultiline:!0},new n.Of("text","name").makeTwoWay())),a(n.Zk,"Vertical",new n.Of("itemArray","leftPorts"),{row:1,column:0,itemTemplate:C("left",!1,i),alignment:n.P1.Left}),a(n.Zk,"Horizontal",new n.Of("itemArray","topPorts"),{row:0,column:1,itemTemplate:C("top",!1,i),alignment:n.P1.Top}),a(n.Zk,"Vertical",new n.Of("itemArray","rightPorts"),{row:1,column:2,itemTemplate:C("right",!1,i),alignment:n.P1.Right}),a(n.Zk,"Horizontal",new n.Of("itemArray","bottomPorts"),{row:2,column:1,itemTemplate:C("bottom",!1,i),alignment:n.P1.Bottom}))),G("nodeWithPorts"),e.add("nodeWithNoPorts",a(n.bP,"Table",{contextMenu:t,selectionObjectName:"BODY",resizeObjectName:"BODY",resizable:!0,selectionAdorned:!1},new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("scale","scale1").makeTwoWay(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){let t=s.rz(e,l);return r&&console.log("234 tooltip",t),t})))},a(n.Zk,"Auto",{name:"BODY",row:1,column:1,minSize:new n.or(150,60),stretch:n.Ke.Fill},a(n.yp,"RoundedRectangle",{cursor:"alias",fill:"white",stroke:"black",strokeWidth:2,parameter1:5,portId:"",fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new n.Of("fill","fillcolor"),new n.Of("stroke","strokecolor"),new n.Of("strokeWidth","strokewidth")),a(n.yp,"RoundedRectangle",{cursor:"move",fill:"transparent",stroke:"transparent",desiredSize:new n.or(110,40)}),a(n.VJ,{cursor:"move",margin:10,textAlign:"center",font:"bold 14px Segoe UI,sans-serif",stroke:"#484848",editable:!0,isMultiline:!0},new n.Of("text","name").makeTwoWay())))),G("nodeWithNoPorts"),e.add("label",a(n.bP,"Auto",new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("layerName","layer"),new n.Of("deletable"),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),{contextMenu:t},{selectionObjectName:"SHAPE",resizable:!0,resizeObjectName:"SHAPE"},a(n.yp,{name:"SHAPE",strokeWidth:2,geometryString:"F M0 0 L80 0 B-90 90 80 20 20 20 L100 100 20 100 B90 90 20 80 20 20z",cursor:"alias",margin:new n.R5(1,1,1,1),shadowVisible:!0,minSize:new n.or(150,60),desiredSize:new n.or(150,60),portId:"",toLinkable:!0,toLinkableSelfNode:!1,toLinkableDuplicates:!1},new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify),new n.Of("fill","fillcolor"),new n.Of("stroke","strokecolor2")),a(n.yp,"RoundedRectangle",{cursor:"move",fill:"transparent",stroke:"transparent",strokeWidth:10,margin:new n.R5(1,1,1,1),shadowVisible:!1,desiredSize:new n.or(136,48)}),a(n.Zk,"Table",{defaultAlignment:n.P1.Left,margin:4,cursor:"pointer"},a(n.Gk,{column:1,width:4}),a(n.Zk,"Horizontal",{defaultAlignment:n.P1.Center},a(n.Zk,"Table",{defaultRowSeparatorStroke:"black",defaultAlignment:n.P1.Center},a(n.VJ,et(),{stretch:n.Ke.Fill,alignment:n.P1.Center,isMultiline:!0,editable:!0,font:"bold 10pt Segoe UI,sans-serif",textAlign:"left",wrap:n.VJ.WrapBreakAll,overflow:n.VJ.OverflowClip,margin:10,text:"label"},new n.Of("text","text").makeTwoWay())))))),e.add("Annotation",a(n.bP,"Auto",new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("layerName","layer"),new n.Of("deletable"),{contextMenu:t},{background:"transparent",locationSpot:n.P1.Center},new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),a(n.yp,"Annotation",{portId:"",fromLinkable:!0,toLinkable:!0,toLinkableSelfNode:!1,toLinkableDuplicates:!1,cursor:"alias",fromSpot:n.P1.AllSides,strokeWidth:2,stroke:"gray"},new n.Of("fill","fillcolor"),new n.Of("background","fillcolor")),a(n.VJ,{margin:5,cursor:"move",editable:!0,text:"Annotation",alignment:n.P1.Left,scale:1},new n.Of("text","text").makeTwoWay(),new n.Of("scale","textscale").makeTwoWay(),new n.Of("stroke","strokecolor")))),G("Annotation"),e.add("ActivityNode",a(n.bP,"Spot",new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("layerName","layer"),new n.Of("deletable"),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("scale","scale1").makeTwoWay(),{contextMenu:t},{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){return s.rz(e,l)})))},{locationObjectName:"SHAPE",locationSpot:n.P1.Center,resizable:!0,resizeObjectName:"PANEL",selectionAdorned:!1},a(n.Zk,"Auto",{name:"PANEL",minSize:new n.or(160,80),desiredSize:new n.or(160,80)},new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify),a(n.Zk,"Spot",a(n.yp,"RoundedRectangle",{cursor:"alias",name:"SHAPE",fill:a(n.vM,"Linear",{0:"OldLace",1:"PapayaWhip"}),stroke:"#CDAA7D",parameter1:10,portId:"",fromLinkable:!0,fromSpot:n.P1.RightSide,toLinkable:!0,toSpot:n.P1.LeftSide,fromLinkable:!0,fromLinkableSelfNode:!0,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!0},new n.Of("fill","fillcolor"),new n.Of("stroke","strokecolor")))),a(n.Zk,"Auto",a(n.yp,"Rectangle",{fill:"transparent",stroke:null,strokeWidth:1,cursor:"move",desiredSize:new n.or(80,50)})),a(n.VJ,{alignment:n.P1.Center,cursor:"move",textAlign:"center",margin:2,editable:!0},new n.Of("text","name").makeTwoWay()))),G("ActivityNode"),e.add("EventNode",a(n.bP,"Vertical",new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("layerName","layer"),new n.Of("deletable"),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),{contextMenu:t},{selectionObjectName:"SHAPE",resizable:!0,resizeObjectName:"SHAPE"},{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){let t=s.rz(e,l);return r&&console.log("234 tooltip",t),t})))},a(n.Zk,"Spot",a(n.yp,{figure:"Circle",fill:"white",stroke:"blue",strokeWidth:4,cursor:"alias",minSize:new n.or(60,60),desiredSize:new n.or(60,60),portId:"",fromLinkable:!0,fromSpot:n.P1.RightSide,toLinkable:!0,toSpot:n.P1.AllSides,toLinkableSelfNode:!1,toLinkableDuplicates:!1},new n.Of("fill","fillcolor"),new n.Of("stroke","strokecolor")),a(n.yp,{figure:"Circle",fill:"transparent",stroke:"transparent",strokeWidth:1,cursor:"move",minSize:new n.or(40,40),desiredSize:new n.or(40,40)})),a(n.VJ,et(),{margin:0,isMultiline:!0,editable:!0},new n.Of("text","name").makeTwoWay(),new n.Of("stroke","textcolor").makeTwoWay()))),G("EventNode"),e.add("GatewayNode",a(n.bP,"Vertical",new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("layerName","layer"),new n.Of("deletable"),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("scale","scale1").makeTwoWay(),{selectionObjectName:"SHAPE",resizable:!0,resizeObjectName:"SHAPE",contextMenu:t},{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){let t=s.rz(e,l);return r&&console.log("234 tooltip",t),t})))},a(n.Zk,"Spot",a(n.yp,{figure:"Diamond",stroke:"black",strokeWidth:1,cursor:"alias",minSize:new n.or(70,70),desiredSize:new n.or(70,70),portId:"",fromLinkable:!0,toLinkable:!0,toLinkableSelfNode:!0,toLinkableDuplicates:!1,fromSpot:n.P1.NotLeftSide,toSpot:n.P1.NotRightSide},new n.Of("fill","fillcolor"),new n.Of("stroke","strokecolor")),a(n.yp,{cursor:"move",figure:"XLine",fill:"transparent",stroke:"black",strokeWidth:3,minSize:new n.or(25,25),desiredSize:new n.or(25,25)},new n.Of("stroke","strokecolor"),new n.Of("figure","figure")),a(n.yp,{figure:"Diamond",fill:"transparent",stroke:"transparent",strokeWidth:1,cursor:"move",minSize:new n.or(50,50),desiredSize:new n.or(50,50)})),a(n.VJ,et(),{margin:0,isMultiline:!0,editable:!0},new n.Of("text","name").makeTwoWay(),new n.Of("stroke","textcolor").makeTwoWay()))),G("GatewayNode")}function Z(e,t,i){return a(n.N_,new n.Of("deletable"),{selectable:!0},{toShortLength:3,relinkableFrom:!0,relinkableTo:!0,adjusting:n.N_.Stretch,reshapable:!0,resegmentable:!0},{routing:n.N_.Normal,corner:10},new n.Of("routing","routing",function(e){return p(e)}),new n.Of("curve","curve",function(e){return c(e)}),new n.Of("points").makeTwoWay(),{contextMenu:t},a(n.yp,{stroke:"black",strokeWidth:1,strokeDashArray:null,shadowVisible:!0},new n.Of("stroke","strokecolor"),new n.Of("strokeWidth","strokewidth"),new n.Of("strokeDashArray","dash",function(e){return ei(e)})),a(n.yp,{fromArrow:"None"},{scale:1.3,fill:"transparent"},new n.Of("fromArrow","fromArrow"),new n.Of("fill","fromArrowColor"),new n.Of("stroke","strokecolor"),new n.Of("scale","arrowscale").makeTwoWay()),a(n.yp,{toArrow:"None"},{scale:1.3,fill:"white"},new n.Of("toArrow","toArrow"),new n.Of("fill","toArrowColor"),new n.Of("stroke","strokecolor"),new n.Of("scale","arrowscale").makeTwoWay()),a(n.VJ,"",{segmentIndex:NaN,segmentFraction:.15},{segmentOffset:new n.bR(0,10)},new n.Of("text","cardinalityFrom"),new n.Of("scale","textscale").makeTwoWay()),a(n.VJ,"",{segmentIndex:NaN,segmentFraction:.85},{segmentOffset:new n.bR(0,-10)},new n.Of("text","cardinalityTo"),new n.Of("scale","textscale").makeTwoWay()),a(n.VJ,"",{isMultiline:!1,editable:!0},{segmentOffset:new n.bR(0,10)},new n.Of("text","name").makeTwoWay(),new n.Of("stroke","textcolor").makeTwoWay(),new n.Of("scale","textscale").makeTwoWay()),{toolTip:a(n.h2,"Auto",{background:"transparent"},a(n.yp,{fill:"#FFFFCC"}),a(n.VJ,{margin:4},new n.Of("text","",function(e){return s.FU(e,i)})))})}function q(e,t,i){let l=Z("",t,i);e.add("linkTemplate1",l),J("linkTemplate1");let d=a(n.N_,new n.Of("deletable"),{contextMenu:t},{selectable:!0},{toShortLength:3,relinkableFrom:!0,relinkableTo:!0,reshapable:!0,resegmentable:!0},{routing:n.N_.AvoidsNodes,curve:n.N_.JumpGap,corner:10,adjusting:n.N_.Stretch,reshapable:!0,relinkableFrom:!0,relinkableTo:!0,toEndSegmentLength:20},new n.Of("points").makeTwoWay(),a(n.yp,{stroke:"black",strokeWidth:1,strokeDashArray:null,shadowVisible:!0},new n.Of("stroke","strokecolor"),new n.Of("strokeWidth","strokewidth"),new n.Of("strokeDashArray","dash",function(e){return ei(e)})),a(n.yp,{fromArrow:"None"},{scale:1.3,fill:"transparent"},new n.Of("fromArrow","fromArrow"),new n.Of("fill","fromArrowColor"),new n.Of("stroke","strokecolor"),new n.Of("scale","arrowscale").makeTwoWay()),a(n.yp,{toArrow:"None"},{scale:1.3,fill:"white"},new n.Of("toArrow","toArrow"),new n.Of("fill","toArrowColor"),new n.Of("stroke","strokecolor"),new n.Of("scale","arrowscale").makeTwoWay()),a(n.VJ,"",{segmentIndex:NaN,segmentFraction:.15},{segmentOffset:new n.bR(0,10)},new n.Of("text","cardinalityFrom"),new n.Of("scale","textscale").makeTwoWay()),a(n.VJ,"",{segmentIndex:NaN,segmentFraction:.85},{segmentOffset:new n.bR(0,-10)},new n.Of("text","cardinalityTo"),new n.Of("scale","textscale").makeTwoWay()),new n.Of("segmentOffset","isDefault",function(e){return e?new n.bR(5,0):new n.bR(0,0)}),a(n.VJ,"",{isMultiline:!0,editable:!0},{segmentOffset:new n.bR(-10,-10)},new n.Of("text","name").makeTwoWay(),new n.Of("stroke","textcolor").makeTwoWay(),new n.Of("scale","textscale").makeTwoWay()),{toolTip:a(n.h2,"Auto",{background:"transparent"},a(n.yp,{fill:"#FFFFCC"}),a(n.VJ,{margin:4},new n.Of("text","",function(e){return s.FU(e,i)})))});e.add("linkTemplate2",d),J("linkTemplate2");let p=a(n.N_,{contextMenu:t,reshapable:!0,relinkableFrom:!0,relinkableTo:!0,fromSpot:n.P1.AllSides,toSpot:n.P1.AllSides,toEndSegmentLength:20},new n.Of("points").makeTwoWay(),a(n.yp,{stroke:"black",strokeWidth:1,strokeDashArray:[1,3]}),a(n.yp,{toArrow:"OpenTriangle",scale:1,stroke:"black"}),new n.Of("stroke","textcolor").makeTwoWay(),new n.Of("scale","textscale").makeTwoWay());e.add("AnnotationLink",p),J("AnnotationLink"),r&&console.log("1514 linkTemplateMap, linkTemplateNames",e,f);let c=a(n.N_,{contextMenu:t,routing:n.N_.AvoidsNodes,corner:10,reshapable:!0,relinkableFrom:!0,relinkableTo:!0,toEndSegmentLength:20},new n.Of("points").makeTwoWay(),a(n.yp,{stroke:"black",strokeWidth:1}),a(n.yp,{toArrow:"Triangle",scale:1.2,fill:"black",stroke:null}),a(n.yp,{fromArrow:"",scale:1.5,stroke:"black",fill:"white"},new n.Of("fromArrow","isDefault",function(e){return null===e?"":e?"BackSlash":"StretchedDiamond"}),new n.Of("segmentOffset","isDefault",function(e){return e?new n.bR(5,0):new n.bR(0,0)})),a(n.VJ,"",{isMultiline:!0,editable:!0,segmentOffset:new n.bR(-10,-10)},new n.Of("text","name").makeTwoWay(),new n.Of("stroke","textcolor").makeTwoWay(),new n.Of("scale","textscale").makeTwoWay()),{toolTip:a(n.h2,"Auto",{background:"transparent"},a(n.yp,{fill:"#FFFFCC"}),a(n.VJ,{margin:4},new n.Of("text","",function(e){return s.FU(e,i)})))});e.add("sequenceLinkTemplate",c),J("sequenceLinkTemplate")}function X(e,t,i,l){let r=a(n.YJ,"Auto",{resizable:!0,minSize:d(),contextMenu:t,selectionAdorned:!0},new n.Of("isSubGraphExpanded","isExpanded").makeTwoWay(),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify),new n.Of("layout","groupLayout").makeTwoWay(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){return s.rz(e,l)})))},A(t,"Icon"));e.add("Container0",r);let p=a(n.YJ,"Spot",{name:"GROUP",resizable:!0,minSize:d(),selectionAdorned:!0,contextMenu:t},new n.Of("isSubGraphExpanded","isExpanded").makeTwoWay(),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify),new n.Of("layout","groupLayout").makeTwoWay(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){return s.rz(e,l)})))},A(t,"Icon"));e.add("",p),e.add("Container1",p),K("Container1");{let r=a(n.YJ,"Spot",{name:"GROUP",resizable:!0,minSize:d(),resizeObjectName:"SHAPE",selectionObjectName:"GROUP",selectionAdorned:!0,contextMenu:t},new n.Of("isSubGraphExpanded","isExpanded").makeTwoWay(),new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("scale","scale1").makeTwoWay(),new n.Of("layout","groupLayout").makeTwoWay(),new n.Of("background","isHighlighted",function(e){return e?"rgba(255,0,0,0.2)":"transparent"}).ofObject(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){return s.rz(e,l)})))},R(t,"Icon"),D(i),S(i),N(i),P(i));e.add("groupWithPorts",r),K("groupWithPorts"),e.add("groupWithIconAndPorts",r),K("groupWithIconAndPorts");let p=a(n.YJ,"Spot",{name:"GROUP",resizable:!0,minSize:d(),resizeObjectName:"SHAPE",selectionObjectName:"GROUP",selectionAdorned:!0,contextMenu:t},new n.Of("isSubGraphExpanded","isExpanded").makeTwoWay(),new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("scale","scale1").makeTwoWay(),new n.Of("layout","groupLayout").makeTwoWay(),new n.Of("background","isHighlighted",function(e){return e?"rgba(255,0,0,0.2)":"transparent"}).ofObject(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){return s.rz(e,l)})))},R(t,"Geometry"),D(i),S(i),N(i),P(i));e.add("groupWithGeoAndPorts",p),K("groupWithGeoAndPorts");let c=a(n.YJ,"Spot",{name:"GROUP",resizable:!0,minSize:d(),resizeObjectName:"SHAPE",selectionObjectName:"GROUP",selectionAdorned:!0,contextMenu:t},new n.Of("isSubGraphExpanded","isExpanded").makeTwoWay(),new n.Of("isSelected","isSelected").makeTwoWay(),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("scale","scale1").makeTwoWay(),new n.Of("layout","groupLayout").makeTwoWay(),new n.Of("background","isHighlighted",function(e){return e?"rgba(255,0,0,0.2)":"transparent"}).ofObject(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){return s.rz(e,l)})))},R(t,"Figure"),D(i),S(i),N(i),P(i));e.add("groupWithFigAndPorts",c),K("groupWithFigAndPorts")}{let i=a(n.YJ,"Spot",{name:"GROUP",resizable:!0,minSize:d(),resizeObjectName:"SHAPE",selectionObjectName:"GROUP",selectionAdorned:!0,contextMenu:t},new n.Of("isSubGraphExpanded","isExpanded").makeTwoWay(),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify),new n.Of("layout","groupLayout").makeTwoWay(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){return s.rz(e,l)})))},A(t,"Icon"));e.add("groupNoPorts",i),K("groupNoPorts"),e.add("groupIconNoPorts",i),K("groupIconNoPorts");let r=a(n.YJ,"Spot",{name:"GROUP",resizable:!0,minSize:d(),resizeObjectName:"SHAPE",selectionObjectName:"GROUP",selectionAdorned:!0,contextMenu:t},new n.Of("isSubGraphExpanded","isExpanded").makeTwoWay(),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify),new n.Of("layout","groupLayout").makeTwoWay(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){return s.rz(e,l)})))},A(t,"Geometry"));e.add("groupGeoNoPorts",r),K("groupGeoNoPorts");let p=a(n.YJ,"Spot",{name:"GROUP",resizable:!0,minSize:d(),resizeObjectName:"SHAPE",selectionObjectName:"GROUP",selectionAdorned:!0,contextMenu:t},new n.Of("isSubGraphExpanded","isExpanded").makeTwoWay(),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify),new n.Of("layout","groupLayout").makeTwoWay(),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){return s.rz(e,l)})))},A(t,"Figure"));e.add("groupFigNoPorts",p),K("groupFigNoPorts")}function c(){return[{layerName:"Background",background:"transparent",movable:!0,copyable:!1,avoidable:!1},new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify)]}{let i=a(n.YJ,"Horizontal",c(),{name:"Lane",contextMenu:t,selectionObjectName:"SHAPE",resizable:!0,resizeObjectName:"SHAPE",resizeObjectName:"SHAPE",selectionObjectName:"SHAPE"},new n.Of("isSubGraphExpanded","expanded").makeTwoWay(),a(n.Zk,"Horizontal",{name:"HEADER",angle:270,alignment:n.P1.Center},a(n.Zk,"Horizontal",new n.Of("visible","isSubGraphExpanded").ofObject(),a(n.yp,"Diamond",{width:8,height:8,fill:"white"},new n.Of("fill","color")),a(n.VJ,{font:"bold 13pt sans-serif",editable:!0,margin:new n.R5(2,0,0,0)},new n.Of("text","text").makeTwoWay())),a("SubGraphExpanderButton",{margin:5})),a(n.Zk,"Auto",a(n.yp,"Rectangle",{name:"SHAPE",fill:"white"},new n.Of("fill","color"),new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify)),a(n.Or,{padding:12,alignment:n.P1.TopLeft}),a(n.VJ,{name:"LABEL",font:"bold 13pt sans-serif",editable:!0,angle:0,alignment:n.P1.TopLeft,margin:new n.R5(2,0,0,4)},new n.Of("visible","isSubGraphExpanded",e=>!e).ofObject(),new n.Of("text","text").makeTwoWay())));e.add("Lane",i),K("Lane"),e.get("Lane").resizeAdornmentTemplate=a(n.h2,"Spot",a(n.Or),a(n.yp,{alignment:n.P1.Right,desiredSize:new n.or(7,50),fill:"lightblue",stroke:"dodgerblue",cursor:"col-resize"},new n.Of("visible","",e=>null!==e.adornedPart&&e.adornedPart.isSubGraphExpanded).ofObject()),a(n.yp,{alignment:n.P1.Bottom,desiredSize:new n.or(50,7),fill:"lightblue",stroke:"dodgerblue",cursor:"row-resize"},new n.Of("visible","",e=>null!==e.adornedPart&&e.adornedPart.isSubGraphExpanded).ofObject()))}let u=a(n.YJ,"Auto",c(),{name:"Pool",contextMenu:t,resizable:!0,minSize:new n.or(50,100),resizeObjectName:"SHAPE",selectionObjectName:"SHAPE",selectionAdorned:!0},new n.Of("isSubGraphExpanded","isExpanded").makeTwoWay(),new n.Of("location","loc",n.bR.parse).makeTwoWay(n.bR.stringify),new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify),new n.Of("layout","groupLayout").makeTwoWay(),new n.Of("fill","fillcolor"),{toolTip:a(n.h2,"Auto",a(n.yp,{fill:"lightyellow"}),a(n.VJ,{margin:8},new n.Of("text","",function(e){return s.rz(e,l)})))},{selectionObjectName:"SHAPE",resizable:!0,resizeObjectName:"SHAPE"},a(n.yp,{cursor:"alias",fill:"white",shadowVisible:!0,minSize:new n.or(160,65),portId:"",fromLinkable:!0,fromLinkableSelfNode:!1,fromLinkableDuplicates:!0,toLinkable:!0,toLinkableSelfNode:!1,toLinkableDuplicates:!0},new n.Of("fill","fillcolor")),new n.Of("stroke","strokecolor"),new n.Of("desiredSize","size",n.or.parse).makeTwoWay(n.or.stringify),a(n.Zk,"Table",{defaultColumnSeparatorStroke:"black"},a(n.Zk,"Horizontal",{column:0,angle:270},a(n.VJ,{name:"LABEL",editable:!0,visible:!0,angle:0,margin:new n.R5(5,0,5,0)},new n.Of("text","name").makeTwoWay())),a(n.Or,{background:"darkgray",column:1})));e.add("Pool",u),K("Pool")}function $(e){return r&&console.log("3567 defaultStrokeColor: ",e),""===e?e:"#466"}function Q(e){if(r&&console.log("3238 findImage: ",e),""==e)return"";if(null==e?void 0:e.includes("//"))return r&&console.log("3249 Diagram",e),e;if(null==e?void 0:e.includes("/"))return r&&console.log("3250 Diagram",e),e;if(null==e?void 0:e.startsWith("<i ")){let t=e;return r&&console.log("3244",t),t}if(null==e?void 0:e.includes("<svg")){let e={image:"data:image/svg+xml;charset=UTF-8,image"};return r&&console.log("3269",e),e}{if(!(!(null==e?void 0:e.includes("images/"))&&(null==e?void 0:e.includes(".png"))))return"";let t="./../images/types/"+e;return r&&console.log("3273 Diagram",e,t),t}}function ee(e){return e.includes("\\u")?String.fromCharCode(parseInt(e.slice(2),16)).toLowerCase():""}function et(){return{font:"9pt  Segoe UI,sans-serif",stroke:"black"}}function ei(e){let t=[3,3],i=[5,5];switch(e){case"dotted":case"Dotted":case"Dotted Line":return t;case"dashed":case"Dashed":case"Dashed Line":return i;default:return null}}function el(){n.PE.call(this)}a("ContextMenu",a("ContextMenuButton",a(n.VJ,"Add Lane"),{click:function(e,t){H(t.part.adornedObject)}})),n.JT,el.prototype=Object.create(n.PE.prototype),el.prototype.constructor=el,el.prototype.doLayout=function(e){e=this.collectParts(e);let t=2,i=60,l=0,s=0,r=0,a=0,d=0,p=0;e.each(function(e){e instanceof n.N_||(e.data._in?(l++,s=Math.max(s,e.actualBounds.width),r+=e.actualBounds.height):(a++,d=Math.max(d,e.actualBounds.width),p+=e.actualBounds.height))}),l>0&&(r+=t*(l-1)),a>0&&(p+=t*(a-1));let c=new n.bR(0,0);null!==this.group&&this.group.location.isReal()&&(c=this.group.location);let u=c.y-r/2;if(e.each(function(e){!(e instanceof n.N_)&&e.data._in&&(e.position=new n.bR(c.x-i/2-s,u),u+=e.actualBounds.height+t)}),u=c.y-p/2,e.each(function(e){!(e instanceof n.N_)&&(e.data._in||(e.position=new n.bR(c.x+i/2+d-e.actualBounds.width,u),u+=e.actualBounds.height+t))}),null!==this.group){this.group.location=c;let e=this.group.findObject("ICON");null!==e&&(e.desiredSize=new n.or(i+s/2+d/2,Math.max(r,p)+10))}}},6196:(e,t,i)=>{"use strict";i.d(t,{Bq:()=>v,CH:()=>er,De:()=>k,Dh:()=>W,FU:()=>es,HE:()=>N,HV:()=>B,Hs:()=>K,Hw:()=>D,IB:()=>z,KL:()=>y,Mq:()=>g,N$:()=>eg,QK:()=>b,Rt:()=>M,S0:()=>V,Sr:()=>H,UD:()=>ef,UN:()=>J,VZ:()=>I,au:()=>ey,av:()=>Y,bb:()=>U,g_:()=>C,iY:()=>j,jM:()=>_,kY:()=>S,mW:()=>G,my:()=>T,pn:()=>x,q9:()=>ev,qF:()=>w,rz:()=>en,sS:()=>P,tO:()=>ej,uY:()=>ec,wK:()=>F,wc:()=>O,wr:()=>eh,xW:()=>em});var l=i(7621),n=i(2588),s=i(2210),r=i(6046),a=i(9619),d=i(7089),p=i(3022),c=i(7662),u=i(1457),h=i(1324),m=i.n(h);let f=!1;function y(e){e&&(e.focusObjectview=null)}function g(e,t){let i=e.nodes,l=[];for(let e=i.iterator;null==e?void 0:e.next();){let i=e.value;if(i.data.isGroup){i.isSubGraphExpanded=t;let e=i.data.objectview;e.isExpanded=t;let n=new p.g_(e,!0);l.push(n)}}l.map(t=>{let i=t;i=JSON.parse(JSON.stringify(i)),e.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:i})})}function v(e,t){let i=prompt("Enter Metamodel name");if(null==i||""==i){alert("Operation was cancelled!");return}{let l=e.findMetamodelByName(i);if(l){alert("Metamodel already exists");return}if(confirm("Create new metamodel '"+i+"' ?"))l=new d.E7(n.gj(),i,""),e.addMetamodel(l);else{alert("Operation was cancelled!");return}if(l){let e=new p.YS(l,!0),i=[];i.push(e),i.map(e=>{let i=e;i=JSON.parse(JSON.stringify(i)),t.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:i})})}}}function w(e,t){let i={metamodel:"",metamodels:""};Z({myMetis:e,myCurrentMetamodel:e.currentMetamodel,myCurrentModel:e.currentModel,myDiagram:t,case:"Replace Metamodel",title:"Select Metamodel to Use",dispatch:t.dispatch,postOperation:q,args:i})}function b(e,t,i){let l={metamodel:"",metamodels:""},n={myMetis:e,myCurrentMetamodel:e.currentMetamodel,myCurrentModel:e.currentModel,myDiagram:t,isSubMetamodel:i,case:"Add Metamodel",title:"Select Metamodel to Add",dispatch:t.dispatch,postOperation:X,args:l};f&&console.log("88 context",n),Z(n)}function T(e,t){let i={metamodel:""};Z({myMetis:e,myCurrentMetamodel:e.currentMetamodel,myDiagram:t,case:"Delete Metamodel",title:"Select Metamodel to Delete",dispatch:t.dispatch,postOperation:$,args:i})}function j(e,t){let i={metamodel:""};Z({myMetis:e,myCurrentMetamodel:e.currentMetamodel,myDiagram:t,case:"Clear Metamodel",title:"Select Metamodel to Clear",dispatch:t.dispatch,postOperation:Q,args:i})}function O(e,t){let i={metamodel:e.currentTargetMetamodel};Z({myMetis:e,myCurrentMetamodel:e.currentMetamodel,myModel:e.currentModel,myCurrentModelview:e.currentModelview,myDiagram:t,case:"New Model",title:"Select Metamodel",dispatch:t.dispatch,postOperation:ee,args:i})}function k(e,t){let i={model:""};et({myMetis:e,myCurrentModel:e.currentModel,myDiagram:t,case:"Delete Model",title:"Select Model to Delete",dispatch:t.dispatch,postOperation:ei,args:i})}function M(e,t,i){var l;let n={objectview:t.findObjectView(null===(l=e.objectview)||void 0===l?void 0:l.id),model:""};et({myMetis:t,myCurrentModel:t.currentModel,myDiagram:i,case:"Export Task Model",title:"Select Model to Export to",dispatch:i.dispatch,postOperation:E,args:n})}function R(e,t){let i=t.myMetis,l=t.args.model;if(!(l=i.findModel(l.id)).findObjectByTypeAndName(e.type,e.name)){let t=s.JH(e);l.addObject(t),i.addObject(t),f&&console.log("189 copiedObj",t)}let n=e.outputrels;for(let e=0;e<(null==n?void 0:n.length);e++){let t=n[e],r=l.getCopiedFromObject(t.fromObject.id),a=l.getCopiedFromObject(t.toObject.id);if(f&&console.log("196 rel, fromObj, toObj",t,r,a),r&&a&&!l.findRelationships(r,a,t.type)){let e=s.I6(t,r,a);r.addOutputrel(e),a.addInputrel(e),l.addRelationship(e),i.addRelationship(e)}}}function A(e,t){let i=t.myMetis,l=t.myCurrentModel;l=i.findModel(l.id);let n=t.args.model;n=i.findModel(n.id);let s=e.getParentModelView(l),r=e.getGroupMembers(s);for(let e=0;e<r.length;e++){let i=r[e],l=i.object,n=l.type.name;"Container"===n?A(i,t):("Task"===n||"Role"===n)&&R(l,t)}}function E(e){let t=e.myMetis,i=e.myDiagram;f&&console.log("183 context",e);let l=e.myCurrentModel;l=t.findModel(l.id);let n=e.args.model;n=t.findModel(n.id),t.setCurrentTaskModel(n);let r=e.args.objectview,a=r.getParentModelView(l),d=r.getGroupMembers(a);for(let t=0;t<d.length;t++){let i=d[t],l=i.object,n=l.type.name;"Container"===n?A(i,e):("Task"===n||"Role"===n)&&R(l,e)}f&&console.log("205 toModel",n);for(let e=0;e<d.length;e++){let i=d[e].object,l=i.type.name;if("Task"===l||"Role"===l){let e=i.outputrels;for(let i=0;i<(null==e?void 0:e.length);i++){let l=e[i],r=n.getCopiedFromObject(l.fromObject.id),a=n.getCopiedFromObject(l.toObject.id);if(f&&console.log("215 rel, fromObj, toObj",l,r,a),r&&a){let e=s.I6(l,r,a);r.addOutputrel(e),a.addInputrel(e),n.addRelationship(e),t.addRelationship(e)}}}}f&&console.log("220 toModel",n);let c=new p.io(t,!0);f&&console.log("1402 jsnMetis: ",c);let u={metis:c};u=JSON.parse(JSON.stringify(u)),i.dispatch({type:"LOAD_TOSTORE_PHDATA",data:u}),alert("The task model has been successfully exported!")}function D(e,t){e.currentMetamodel;let i=e.currentModel,l=prompt("Enter Modelview name:","");if(null==l||""===l)alert("New operation was cancelled");else if("_INSTANCES"===l)a.tF(e,t.dispatch,i);else{let s=new d.it(n.gj(),l,i,"");s.diagram=t,i.addModelView(s),e.addModelView(s),f&&console.log("102 myMetis",e);let r=new p.bp(i,!0);r=JSON.parse(JSON.stringify(r)),f&&console.log("104 NewModelView",r),t.dispatch({type:"LOAD_TOSTORE_NEWMODELVIEW",data:r})}}function S(e,t,i){e.markedAsDeleted=!0;let l=new p.Yp(e),n=e.objectviews;for(let e=0;e<(null==n?void 0:n.length);e++){let i=n[e];i.markedAsDeleted=!0;let l=i.object;l||(l=t.findObject(i.objectRef));let s=null==l?void 0:l.objectviews;(null==s?void 0:s.length)==1&&(l.markedAsDeleted=!0)}let r=e.relshipviews;for(let e=0;e<(null==r?void 0:r.length);e++)r[e].markedAsDeleted=!0;f&&console.log("1808 myMetis",t);let a=[];a.push(l),a.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),i.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:t})}),s.g3(t,i)}function N(e,t){if(confirm("Do you really want to delete all invisible objects?")){let i=[],l=e.objects;for(let t=0;t<l.length;t++){let n=l[t],s=null==n?void 0:n.type;if(n.name===(null==s?void 0:s.name)&&null==n.objectviews){n.markedAsDeleted=!0;let t=e.findObject(n.id);t&&(t.markedAsDeleted=!0);let l=new p.pJ(n);i.push(l)}}f&&console.log("156 modifiedObjects",i),i.map(e=>{let i=e;i=JSON.parse(JSON.stringify(i)),t.dispatch({type:"UPDATE_OBJECT_PROPERTIES",data:i})});let n=[],s=e.objectviews;for(let t=0;t<s.length;t++){let i=s[t];if(null==(null==i?void 0:i.object)){i.markedAsDeleted=!0;let t=e.findObjectView(i.id);t&&(t.markedAsDeleted=!0);let l=new p.g_(i);n.push(l)}}f&&console.log("175 modifiedObjviews",s,n),n.map(e=>{let i=e;i=JSON.parse(JSON.stringify(i)),t.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:i})}),f&&console.log("180 myMetis",e)}}function P(e,t,i){f&&console.log("417 myMetis",t);let l=e.objviewRef,n=t.findObjectView(l),s=t.findObject(n.objectRef),a=e.objtypeRef,d=t.findObjectType(a),p=null==d?void 0:d.typeview,c=null==d?void 0:d.supertypes,u=r.F1(e.icon);if(t.myDiagram=i,n&&s){t.addObject(s),t.addObjectView(n);let l={object:s,objectview:n,objecttype:d,objecttypeview:p,supertypes:c,includeInherited:!1,includeConnected:!1,relship:null,relshipview:null,relshiptype:null,relshiptypeview:null,model:t.currentModel,modelview:t.currentModelview,metamodel:t.currentMetamodel};f&&console.log("490 myMetis",t);let r={what:"editObject",title:"Edit Object",icon:u,myDiagram:i,myContext:l};f&&console.log("498 ui_diagram: gjsNode, modalContext",e,r),i.handleOpenModal(e,r)}else alert("Object not found")}function C(e,t,i){let l={what:"editObjectType",title:"Edit Object Type",icon:r.F1(null==e?void 0:e.icon),myMetis:t,myDiagram:i};t.currentNode=e,t.myDiagram=i,f&&console.log("230 editObjectType"),i.handleOpenModal(e,l)}function x(e,t,i){f&&console.log("597 gjsNode, myMetis",e,t);let l=t.currentModelview,n=t.currentMetamodel,s=l.model,a=t.gojsModel,d=e.key,p=l.findObjectView(d);p&&(p.viewkind=e.viewkind);let c=null==p?void 0:p.object;c||(c=s.findObject(null==e?void 0:e.objRef));let u=null==c?void 0:c.type;u=t.findObjectType(null==u?void 0:u.id);let h=a.findNode(d);t.currentNode=h,t.myDiagram=i;let m=r.F1(null==h?void 0:h.icon);c||(c=s.findObject(null==h?void 0:h.objRef)),p||(p=l.findObjectView(null==h?void 0:h.objviewRef)),u||(u=n.findObjectType(null==h?void 0:h.objtypeRef));let y=null==u?void 0:u.typeview,g={what:"editObjectview",title:"Edit Object View",icon:m,myDiagram:i,myContext:{object:c,objectview:p,objecttype:u,objecttypeview:y,relship:null,relshipview:null,relshiptype:null,relshiptypeview:null,model:t.currentModel,modelview:t.currentModelview,metamodel:t.currentMetamodel}};f&&console.log("566 ui_diagram: gjsNode, modalContext",e,g),i.handleOpenModal(e,g)}function _(e,t,i){f&&console.log("680 gjsNode, myMetis",e,t);let l=t.currentModelview,n=t.gojsModel,s=e.key,a=l.findObjectView(s);a.viewkind=e.viewkind;let d=null==a?void 0:a.object;d||(d=t.findObject(null==e?void 0:e.objRef));let p=null==d?void 0:d.type,c=null==(p=t.findObjectType(null==p?void 0:p.id))?void 0:p.typeview;c.viewkind=e.viewkind;let u=n.findNode(s);t.currentNode=u,t.myDiagram=i;let h={what:"editTypeview",title:"Edit Object Typeview",icon:r.F1(u.icon),myDiagram:i,myContext:{object:d,objectview:a,objecttype:p,objecttypeview:c,relship:null,relshipview:null,relshiptype:null,relshiptypeview:null,model:t.currentModel,modelview:t.currentModelview,metamodel:t.currentMetamodel}};f&&console.log("566 ui_diagram: gjsNode, modalContext",e,h),i.handleOpenModal(e,h)}function I(e,t,i){var l,n,s;f&&console.log("682 link, myMetis",e,t),t.myDiagram=i,t.currentLink=e;let r=t.findRelationship(null==e?void 0:null===(l=e.relship)||void 0===l?void 0:l.id),a=t.findRelationshipView(null==e?void 0:null===(n=e.relshipview)||void 0===n?void 0:n.id),d=t.findRelationshipType(null==r?void 0:null===(s=r.type)||void 0===s?void 0:s.id),p=null==d?void 0:d.typeview,c={what:"editTypeview",title:"Edit Typeview",icon:null,myDiagram:i,myContext:{object:null,objectview:null,objecttype:null,objecttypeview:null,relship:r,relshipview:a,relshiptype:d,relshiptypeview:p,model:t.currentModel,modelview:t.currentModelview,metamodel:t.currentMetamodel}};f&&console.log("710 ui_diagram: link, modalContext",e,c),i.handleOpenModal(e,c)}function V(e,t,i){let l=i.findNodeForKey(null==e?void 0:e.key);if(l){let n=t.findObjectView(e.key);n.applyTypeview();let s=n.typeview,r=null==s?void 0:s.data;if(!r)return;for(let e in r)n[e]=r[e],i.model.setDataProperty(l.data,e,n[e]);let a=new p.g_(n),d=[];d.push(a),d.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),i.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})})}let n=i.findLinkForKey(null==e?void 0:e.key);if(n){f&&console.log("463 goInst",e);let l=t.findRelationshipView(e.key);if(l){let e=l.typeview;if(e&&e.data){let t=e.data;for(let s in f&&console.log("467 rview, rtview, rtdata",l,e,t),t){switch(s){case"name":case"nameId":case"description":case"category":case"fs_collection":case"markedAsDeleted":case"modified":case"sourceUri":case"typeRef":case"class":case"relshipkind":continue}l[s]=e[s],f&&console.log("471 prop, rview[prop]",s,l[s]),i.model.setDataProperty(n.data,s,e[s])}let s=new p.GI(l),r=[];r.push(s),r.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),f&&console.log("494 data",t),i.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})})}}}}l.Ke.make;function L(){return new l.jg({isOngoing:!1,treeStyle:l.jg.StyleRootOnly,angle:0,layerSpacing:100,nodeSpacing:50,setsPortSpot:!1,setsChildPortSpot:!1,alternateSetsChildPortSpot:!1,alternateSetsPortSpot:!1,sorting:l.jg.SortingDescending,alternateSorting:l.jg.SortingDescending,arrangement:l.jg.ArrangementFixedRoots,alignment:l.jg.AlignmentStart})}function F(e,t,i){let l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=[],s=[];L().doLayout(e);let r=e.iterator;for(;null==r?void 0:r.next();){let e=r.value.data;if("Object"===e.category){let i=e,l=i.loc,s=i.key,r=t.findObjectView(s);r.loc=l;let a=new p.g_(r);n.push(a)}}for(r=e.iterator;null==r?void 0:r.next();){let e=r.value.data;if("Relationship"===e.category){let n=e,r=l?[]:n.points;i.model.setDataProperty(n,"points",r);let a=t.findRelationshipView(n.key);a.points=n.points;let d=a.relship.type;(null==d?void 0:d.name)===u.types.AKM_RELATIONSHIP_TYPE&&Y(a.id,i);let c=new p.GI(a);s.push(c)}}n.map(e=>{let t=e&&e;e.id&&(t=JSON.parse(JSON.stringify(t)),i.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t}))}),s.map(e=>{let t=e&&e;e.id&&(t=JSON.parse(JSON.stringify(t)),i.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t}))})}function B(e,t,i,l){let n;let r=l.findNodeForKey(e.key),a=[],d=[];i.myDiagram=l;let u=i.currentModelview;if(!u)return;u=i.findModelView(u.id);let h=i.gojsModel;n=i.findObjectView(e.key),a.push(n);let m=t.noLevels,f=t.reltypes,y=t.reldir;l.startTransaction("addConnectedObjects"),"All"===y&&(ed(u,n,h,i,m,f,"out",a,d),ed(u,n,h,i,m,f,"in",a,d)),l.commitTransaction("addConnectedObjects"),l.startTransaction("generateNodesAndLinks");let g=[],v=[];r&&(r.isSelected=!0);for(let e=1;e<a.length;e++){let t=a[e],i=new c.mC(t.id,h,t);t=s.C2(i,l);let n=new p.g_(t);g.push(n),l.model.addNodeData(i),l.findNodeForData(i).isSelected=!0}for(let e=0;e<d.length;e++){var w,b;let t=d[e],n=t.fromObjview,r=t.toObjview,a=new c.gR(t.id,h,t);a.loadLinkContent(h),a.fromNode=H(n.id,l),a.from=null===(w=a.fromNode)||void 0===w?void 0:w.key,a.toNode=H(r.id,l),a.to=null===(b=a.toNode)||void 0===b?void 0:b.key,t=s.G$(a,l),V(a,i,l);let u=new p.GI(t);v.push(u),l.findLinkForKey(a.key).isSelected=!0}l.commitTransaction("generateNodesAndLinks"),l.startTransaction("selectNodesAndLinks"),l.commitTransaction("selectNodesAndLinks"),l.startTransaction("layoutNodesAndLinks"),F(l.selection,u,l,!0),l.commitTransaction("layoutNodesAndLinks");let T=[];T.push(new p.Yp(u)),T.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),i.myDiagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:t})})}function G(e,t,i){t.myDiagram=i;let n=t.currentModelview;n=t.findModelView(n.id);let s=t.gojsModel,r=null==e?void 0:e.key,a=t.findObjectView(r),p=[],c=[],u=new d.T6(n,p,c),h="1",m="All",f="All";confirm("Use default parameters?")?(h=9,m="All"):(h=prompt("Enter no of sublevels to follow",h),"All"===(m=prompt("Enter relationship type to follow",m))&&(m=""),f=prompt("Enter relationship direction to follow (in | out | All)",f)),"All"===f?(ep(n,a,s,t,h,m,"out",u),ep(n,a,s,t,h,m,"in",u)):ep(n,a,s,t,h,m,f,u);let y=new l.NZ;p=u.objectviews,c=u.relshipviews;for(let e=0;e<p.length;e++){let t=p[e],l=s.findNodeByViewId(t.id);if(t.id!==r){let e=i.findNodeForKey(null==l?void 0:l.key);y.add(e)}}for(let e=0;e<c.length;e++){let t=c[e],l=s.findLinkByViewId(t.id),n=i.findLinkForKey(null==l?void 0:l.key);y.add(n)}i.selectCollection(y)}function K(e,t,i){t.gojsModel;let l=e.data.objectview,n=t.currentModelview.relshipviews,s=[],r=[];for(let e=0;e<(null==n?void 0:n.length);e++){let t=n[e];if(t){let e=t.fromObjview,i=t.toObjview;((null==e?void 0:e.id)===l.id||(null==i?void 0:i.id)===l.id)&&r.push(t)}}for(let e=0;e<(null==r?void 0:r.length);e++){let t=r[e];t.visible=!1;let i=new p.GI(t);s.push(i)}let a=e.findLinksOutOf();i.removeParts(a),s.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),i.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})})}function J(e){let t=e.selection,i=[],l=[];for(let e=t.iterator;null==e?void 0:e.next();){var s;let t=e.value;i.push(t.data);let n=null===(s=t.data.loc)||void 0===s?void 0:s.split(" "),r=parseInt(n[0]),a=parseInt(n[1]),d={name:a,loc:t.data.loc,nx:r,ny:a};l.push(d)}let r=[];i.sort(n.UD),l.sort(n.UD);for(let e=1;e<l.length;e++){let t=l[e];l[e].ny===l[e-1].ny&&t.name<l[e-1].name&&(l[e]=l[e-1],l[e-1]=t)}for(let e=0;e<i.length;e++){let t=i[e];t.loc=l[e].loc;let n=t.objectview;n.loc=t.loc;let s=new p.g_(n);r.push(s)}r.map(t=>{let i=t&&t;t.id&&(i=JSON.parse(JSON.stringify(i)),e.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:i}))})}function W(e,t){let i=new l.NZ,n=e.part?e.part:e,s=t.findPartForKey(n.key);if(s)i.add(s.part);else{let e=t.findLinkForKey(n.key);i.add(e.part)}let r=t.selection;for(let e=r.iterator;null==e?void 0:e.next();){let t=e.value;i.add(t.part)}t.selectCollection(i)}function U(e,t){e.findMetamodelByName(u.admin.AKM_ADMIN_MM);let i=e.findModelByName(u.admin.AKM_ADMIN_MODEL),l=e.findObjectTypeByName(u.admin.AKM_PROJECT),s=e.findObjectTypeByName(u.admin.AKM_METAMODEL),r=e.findObjectTypeByName(u.admin.AKM_MODEL),a=e.findObjectTypeByName(u.admin.AKM_MODELVIEW),c=i.getObjectsByType(l)[0];e.name=c.name,e.description=c.description;let h=l.getProperties(!0);for(let t=0;t<h.length;t++){let i=h[t];e[i.name]=c[i.name]}let m=i.getObjectsByType(s);for(let t=0;t<m.length;t++){let i;let l=m[t];if(l.metamodelId&&((i=e.findMetamodel(l.metamodelId)).name=l.name,i.description=l.description),i){let e=s.getProperties(!0);for(let t=0;t<e.length;t++){let n=e[t];i[n.name]=l[n.name]}}else{i=new d.E7(n.gj(),l.name,l.description),e.addMetamodel(i);let t=s.getProperties(!0);for(let e=0;e<t.length;e++){let n=t[e];i[n.name]=l[n.name]}}}let y=i.getObjectsByType(r);for(let t=0;t<y.length;t++){let i;let l=y[t];if(l.modelId)(i=e.findModel(l.modelId)).name=l.name,i.description=l.description;else{i=new d.DM(n.gj(),l.name,l.description),e.addModel(i);let t=l.outputrels;for(let l=0;l<t.length;l++){let n=t[l];if(n.name===u.admin.AKM_REFERSTO_METAMODEL){let t=n.toObject,l=e.findMetamodel(t.metamodelId);i.metamodel=l;break}}}if(i){let t=r.getProperties(!0);for(let e=0;e<t.length;e++){let n=t[e];i[n.name]=l[n.name]}let s=l.outputrels;for(let t=0;t<s.length;t++){let r=s[t];if(r.name===u.admin.AKM_HAS_MODELVIEW){let t=r.toObject;if(t.type.name===u.admin.AKM_MODELVIEW){let s;if(t.modelviewId?((s=e.findModelView(t.modelviewId)).name=t.name,s.description=t.description):(s=new d.it(n.gj(),t.name,l,t.description),i.addModelView(s),e.addModelView(s)),s){let e=a.getProperties(!0);for(let i=0;i<e.length;i++){let l=e[i];s[l.name]=t[l.name]}}}}}}}let g={metis:new p.io(e,!0)};g=JSON.parse(JSON.stringify(g)),t.dispatch({type:"LOAD_TOSTORE_PHDATA",data:g}),f&&console.log("362 myMetis, data",e,g)}function z(e,t,i,l){let s=[u.types.AKM_REFERS_TO],r=i.currentMetamodel,a=i.currentModelview,d=i.gojsModel,p=d.findNodeByViewId(e.key),c=p.objecttype;c||(c=r.findObjectType(p.objtypeRef));let h=[],m=[];for(let i=t.iterator;null==i?void 0:i.next();){let t=i.value;if(t.data.key===e.key)continue;let l=d.findNode(t.data.key);if(l){let e=l.objecttype;e||(e=r.findObjectType(l.objtypeRef)),e&&(m.push(e),h.push(e.name))}}let f=n.EL(h);h=f,m=f=n.Ip(m,"id");let y=a.includeInheritedReltypes,g=[];if(a.isMetamodel){if(c.name!==u.types.AKM_METAMODEL){let e=i.findRelationshipTypeByName(u.types.AKM_IS);s.push(e.name),e=i.findRelationshipTypeByName(u.types.AKM_RELATIONSHIP_TYPE),s.push(e.name)}else{let e=i.findRelationshipTypeByName(u.types.AKM_CONTAINS);s.push(e.name)}}else for(let e=0;e<m.length;e++){let t=m[e];t=r.findObjectType(t.id);let i=r.findRelationshipTypesBetweenTypes(c,t,y);g=0==e?i:n._N(g,i);for(let e=0;e<(null==g?void 0:g.length);e++){let t=g[e].name;t!==u.types.AKM_GENERIC_REL&&s.push(t)}}return s.length>0&&(s=f=n.EL(s)).sort(),s}function H(e,t){let i=null;for(let l=t.nodes;null==l?void 0:l.next();){let t=l.value;if(t.data.objviewRef===e){i=t.data;break}}return i}function Y(e,t){let i=null;for(let l=t.links;null==l?void 0:l.next();){let t=l.value;if(t.data.relviewRef===e){i=t.data;break}}return i}function Z(e){f&&console.log("750 context",e);let t=e.myMetis,i=e.myCurrentMetamodel,l=e.myDiagram,n=[],s=t.metamodels;f&&console.log("756 allMetaModels",s,i);for(let t=0;t<s.length;t++){let l=s[t];if(l&&l.id&&!l.markedAsDeleted&&l.name!==u.admin.AKM_ADMIN_MM){if(i&&l.id===(null==i?void 0:i.id)&&"New Model"!==e.case)continue;switch(e.case){case"New model":case"Add Metamodel":case"Delete Metamodel":case"Clear Metamodel":case"Replace Metamodel":case"Generate Target Metamodel":if(l.id===(null==i?void 0:i.id))continue}n.push(l)}}e.args.metamodels=n;let r={what:"selectDropdown",title:e.title,case:e.case,myMetis:t,myDiagram:l,context:e};f&&console.log("790 modalContext",r);let a=n.map(e=>e&&e.nameId);l.handleOpenModal(a,r)}function q(e){var t,i,l,n,s,r;e.myCurrentMetamodel;let a=e.args.metamodel,d=e.myMetis,c=e.myCurrentModel,h=e.myDiagram,m=d.findObjectTypeByName(u.types.AKM_GENERIC),y=d.findRelationshipTypeByName(u.types.AKM_GENERIC_REL);f&&console.log("634 context",e),c.metamodel=a;let g=c.objects;for(let e=0;e<(null==g?void 0:g.length);e++){let i;let l=g[e];if(!l)continue;let n=null===(t=l.type)||void 0===t?void 0:t.name,s=a.findObjectTypeByName(n);s?(l.type=s,l.typeRef=s.id):(l.type=m,l.typeRef=m.id),i=s?s.typeview:l.type.typeview;let r=l.objectviews;for(let e=0;e<(null==r?void 0:r.length);e++){let t=r[e];t.typeview=i,t.typeviewRef=i.id}}let v=c.relships;for(let e=0;e<(null==v?void 0:v.length);e++){let t=v[e];if(!t)continue;let d=null===(l=t.toObject)||void 0===l?void 0:null===(i=l.type)||void 0===i?void 0:i.name,p=null===(s=t.fromObject)||void 0===s?void 0:null===(n=s.type)||void 0===n?void 0:n.name,c=null===(r=t.type)||void 0===r?void 0:r.name,u=a.findRelationshipTypeByNames(c,d,p);u?t.type=u:t.type=u=y,t.typeRef=u.id;let h=u.typeview,m=t.relshipviews;for(let e=0;e<(null==m?void 0:m.length);e++)m[e].typeview=h}f&&console.log("685 newMetamodel",a);let w=[],b=new p.YS(a,!0);f&&console.log("688 jsnMetaModel",b),w.push(b),w.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),h.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:t})});let T=[],j=new p.bp(c,!0);f&&console.log("697 jsnModel",j),T.push(j),T.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),h.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:t})}),f&&console.log("703 myMetis",d)}function X(e){let t=e.myCurrentMetamodel,i=e.args.metamodel,l=e.myMetis,n=e.myDiagram,s=e.isSubMetamodel;if(f&&console.log("271 currentMetamodel, metamodel",t,i),s)t.addSubMetamodel(i);else{let e=i.objecttypes;for(let i=0;i<(null==e?void 0:e.length);i++){let l=e[i];if(l){if(t.findObjectType(l.id))continue;t.addObjectType(l)}}let l=i.relshiptypes;for(let e=0;e<(null==l?void 0:l.length);e++){let i=l[e];if(i){if(t.findRelationshipType(i.id))continue;t.addRelationshipType(i)}}let n=i.objecttypes0;for(let e=0;e<(null==n?void 0:n.length);e++){let i=n[e];if(i){if(t.findObjectType0(i.id))continue;t.addObjectType0(i)}}let s=i.relshiptypes0;for(let e=0;e<(null==s?void 0:s.length);e++){let i=s[e];if(i){if(t.findRelationshipType0(i.id))continue;t.addRelationshipType0(i)}}}let r=new p.YS(t,!0);f&&console.log("293 jsnMetamodel",r);let a=[];a.push(r),a.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),n.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:t})}),f&&console.log("302 myMetis",l),alert("The metamodel has been successfully added!")}function $(e){var t;let i=e.args.metamodel;if(!i)return;let l=e.myMetis,n=e.myDiagram;f&&console.log("271 metamodel, myMetis",i,l);let r=l.getModelsByMetamodel(i,!1);f&&console.log("274 models",r);let a=!1;if(r.length>0){let e="There are models based on the metamodel '"+i.name+"'.\n";e+="The models will also be deleted!\nDo you still want to continue?",a=confirm(e)}else a=confirm("Do you really want to delete the metamodel '"+i.name+"'?");if(!a)return;{for(let e=0;e<r.length;e++)el(r[e],l,n);i.markedAsDeleted=!0;let e=l.getMetamodels(),t=i.relshiptypes;for(let i=0;i<(null==t?void 0:t.length);i++){let l=t[i],n=!1;for(let t=0;t<e.length;t++){let i=e[t];if(!i.markedAsDeleted&&i.findRelationshipType(l.id)){n=!0;break}}n||(l.markedAsDeleted=!0)}let s=i.relshiptypeviews;for(let t=0;t<(null==s?void 0:s.length);t++){let i=s[t],l=!1;for(let t=0;t<e.length;t++){let n=e[t];if(!n.markedAsDeleted&&n.findRelationshipTypeView(i.id)){l=!0;break}}l||(i.markedAsDeleted=!0)}let a=i.objecttypes;for(let t=0;t<(null==a?void 0:a.length);t++){let i=a[t],l=!1;for(let t=0;t<e.length;t++){let n=e[t];if(!n.markedAsDeleted&&n.findObjectType(i.id)){l=!0;break}}l||(i.markedAsDeleted=!0)}let d=i.objecttypeviews;for(let t=0;t<(null==d?void 0:d.length);t++){let i=d[t],l=!1;for(let t=0;t<e.length;t++){let n=e[t];if(!n.markedAsDeleted&&n.findObjectTypeView(i.id)){l=!0;break}}l||(i.markedAsDeleted=!0)}let c=l.findModel(i.generatedFromModelRef);if(c){let e=c.objects;for(let t=0;t<(null==e?void 0:e.length);t++)e[t].generatedTypeId="";let t=c.relationships;for(let e=0;e<(null==t?void 0:t.length);e++)t[e].generatedTypeId="";let i=JSON.parse(JSON.stringify(new p.bp(c,!0)));n.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:i})}}(null===(t=l.currentTargetMetamodel)||void 0===t?void 0:t.id)===i.id&&(l.currentTargetMetamodel=null,l.currentTargetMetamodelRef=""),s.yu(l,n),f&&console.log("302 myMetis",l);let d={metis:new p.io(l,!0)};d=JSON.parse(JSON.stringify(d)),n.dispatch({type:"LOAD_TOSTORE_PHDATA",data:d})}function Q(e){let t=e.myMetis,i=e.args.metamodel;i=t.findMetamodel(i.id);let l=e.myDiagram;f&&console.log("271 metamodel, myMetis",i,t);let n=t.getModelsByMetamodel(i,!1);f&&console.log("274 models",n);let r=!1;if(n.length>0){let e="There are models based on the metamodel '"+i.name+"'.\n";(r=confirm("Do you really want to clear the metamodel '"+i.name+"'?"))&&(e+="Do you want to clear the models as well?",e=((r=confirm(e))?"The models will be cleared!\n":"The models will be kept, but their metamodel will be cleared.\n")+"Do you still want to continue?",r=confirm(e))}else r=confirm("Do you really want to clear the metamodel '"+i.name+"'?");if(r){{i.clearContent();let e=new p.YS(i,!0);f&&console.log("654 jsnMetamodel",e);let n=JSON.parse(JSON.stringify(e));l.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:n}),s.yu(t,l)}f&&console.log("302 myMetis",t)}}function ee(e){let t,i,l,s;let r=e.args.metamodel;if(f&&console.log("51 Metamodel chosen: ",r),!r)return;let a=e.myMetis,c=e.myDiagram;if(r.name===u.admin.AKM_ADMIN_MM){if(i=u.admin.AKM_ADMIN_MODEL,s=u.admin.AKM_ADMIN_MODELVIEW,(t=a.findModelByName(i))||(t=new d.DM(n.gj(),i,r,""),a.addModel(t)),t){(l=t.findModelViewByName(s))||(l=new d.it(n.gj(),s,t,""),t.addModelView(modelView),a.addModelView(modelView));let e=new p.bp(t,!0);f&&console.log("35 jsnModel",e),e=JSON.parse(JSON.stringify(e)),c.dispatch({type:"LOAD_TOSTORE_NEWMODELVIEW",data:e});return}}else if(null==(i=prompt("Enter Model name:",""))||""===i)alert("New operation was cancelled");else{let e=new d.DM(n.gj(),i,r,"");a.addModel(e);let t=prompt("Enter Modelview name:","Main");if(null==t||""===t)alert("New operation was cancelled");else{let i=new d.it(n.gj(),t,e,"");(null==r?void 0:r.viewstyle)&&(i.viewstyle=r.viewstyle),e.addModelView(i),a.addModelView(i);let l=new p.bp(e,!0);f&&console.log("35 jsnModel",l),l=JSON.parse(JSON.stringify(l)),c.dispatch({type:"LOAD_TOSTORE_NEWMODELVIEW",data:l})}}}function et(e){f&&console.log("348 context",e);let t=e.myMetis,i=e.myCurrentModel,l=e.myDiagram,n={what:"selectDropdown",title:e.title,case:e.case,myMetis:t,myDiagram:l,context:e},s=[],r=t.models;for(let t=0;t<(null==r?void 0:r.length);t++){let l=r[t];if(l.name!==u.admin.AKM_ADMIN_MODEL&&!l.markedAsDeleted){if("Delete Model"===e.case&&l.id===i.id)continue;s.push(l)}}let a=s.map(e=>e&&e.nameId);f&&console.log("372",a,n,e),l.handleOpenModal(a,n)}function ei(e){let t=e.args.model;if(t){if(!confirm("Do you really want to delete '"+t.name+"'?"))return;let i=e.myMetis,l=e.myDiagram;f&&console.log("367 model, myMetis",t,i),el(t,i,l)}}function el(e,t,i){f&&console.log("372 model, myMetis",e,t);let l=[];e.markedAsDeleted=!0,l.map(t=>{let l={id:e.id,markedAsDeleted:!0};i.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:l})}),alert("The model '"+e.name+"' has been deleted!"),s.g3(t,i)}let eo=(e,t)=>{let i="";for(let l=0,n=0;l<e.length;l++)n>=t&&" "===e[l]?(n=0,i+="\n"):(n++,i+=e[l]);return i};function en(e,t){var i;let l;f&&console.log("1035 nodeInfo",e,e.object),f&&console.log("1136 nodeInfo",t.gojsModel.findNode(e.group));let n="%-10s: %s\n",s="%-10s: (%s)\n",r="";if(r+="- - - - - - - Object - - - - - - - -\n",r+=m()(n,"name",e.name),r+=m()(n,"descr.",eo(e.object.description,64)),null===(i=e.object.type.properties)||void 0===i||i.map(t=>{l=null==t?void 0:t.name,f&&console.log("1338 propval",l),r+=m()(n,t.name,e.object[l])}),r+="- - - - - - - ObjectType - - - - - - - -\n",r+=m()(s,"ObjectType",e.object.type.name),r+=m()(n," -Descr",eo(e.object.type.description,64)),e.group){let i=t.gojsModel.findNode(e.group);r+="\n",r+="- - - - - - - Parent Object - - - - - - -\n",r+=m()(n,"name",i.name),r+=m()(s,"ObjectType",i.typename),r+="\n"}return f&&console.log("1133 nodeInfo",r),r}function es(e,t){var i;f&&console.log("551 linkInfo",e,e.relshiptype);let l=null===(i=e.relshiptype)||void 0===i?void 0:i.name,n=t.findRelationshipTypeByName(l),s=e.fromNode,r=null==s?void 0:s.object;n.getFromObjType();let a=e.toNode,d=null==a?void 0:a.object;n.getToObjType(),f&&console.log("560 linkInfo",e);let p=" %-10s: %s\n",c="%-8s: %s\n",u="Relationship:\n";return u+="Attributes:\n",u+="---------------------\n",u+=m()(p,"-Name",e.name),u+=m()(p,"-Title",e.relship.title),u+=m()(p,"-Description",eo(e.relship.description,64)),u+=m()(c,"-from",null==r?void 0:r.name),u+=m()(p,"-to   ",null==d?void 0:d.name)}function er(e){f&&console.log("451 diagramInfo",e);let t="Model:\n";return t+(e.nodeDataArray.length+" nodes, "+e.linkDataArray.length+" links")}function ea(e,t){return e.length<2||null==e||e.sort((e,i)=>{let l,n,s,r;e.type.name,i.type.name;let a=e.name,d=i.name;return("in"===t&&e.fromObject.type&&i.fromObject.type?(s=e.fromObject.type.name,l=e.fromObject.name,r=i.fromObject.type.name,n=i.fromObject.name):e.toObject.type&&i.toObject.type&&(s=e.toObject.type.name,l=e.toObject.name,r=i.toObject.type.name,n=i.toObject.name),s<r)?1:s>r?-1:l<n?1:l>n?-1:a<d?1:a>d?-1:0}),e}function ed(e,t,i,l,r,a,h,m,y){if(r<1||!t)return;let g=[],v=[],w=[],b=l.myDiagram,T=t.object;T||(T=l.findObject(t.objectRef)),T&&(T=l.currentModel.findObject(T.id)),t&&(t=l.currentModelview.findObjectView(t.id));let j=0;if(t&&T&&t.loc){let r,O;let k=t.loc.split(" "),M=parseInt(k[0]);j+=parseInt(k[1]);let R=T.type;if((R=l.findObjectType(R.id))&&(null==R?void 0:R.isContainer())&&(t.viewkind=u.viewkinds.CONT),a){let e=a.split(",")[0];try{r=myMetamodel.findRelationshipTypeByName(e)}catch(t){r=l.findRelationshipTypeByName(e)}}let A="in"===h;if(A?(O=T.inputrels)&&(O=ea(O,h)):(O=T.outputrels)&&(O=ea(O,h)),O){let a=0;for(let h=0;h<O.length;h++){let T,k,R=O[h];if(!R||R.markedAsDeleted||(R=l.findRelationship(R.id),r&&(null==R?void 0:R.type.id)!==(null==r?void 0:r.id))||(T=A?R.fromObject:R.toObject,!(T=l.currentModel.findObject(T.id))||T.markedAsDeleted))continue;let E=T.type;E.typeview;let D=[],S=e.findObjectViewsByObject(T);if(S&&S.length>0){for(let e=0;e<S.length;e++){let t=S[e];t.markedAsDeleted&&(t.markedAsDeleted=!1),E.isContainer()&&(t.viewkind=u.viewkinds.CONT),k=t;let l=new c.mC(k.id,i,k);k=s.C2(l,b);let n=new p.g_(k);v.push(n),D.push(k),g.push(k)}let l=[];A?0==(l=e.findRelationshipViewsByRel2(R,k,t)).length&&h++:(null==(l=e.findRelationshipViewsByRel2(R,t,k))?void 0:l.length)==0&&h++,f&&console.log("1637 rel, relview",R,l);for(let e=0;e<l.length;e++){let t=l[e],i=new p.GI(t);w.push(i)}}else{a++;let s=n.gj();k=new d.wN(s,T.name,T,""),T.addObjectView(k),e.addObjectView(k),l.addObjectView(k);{let e=(A?M-300:M+300)+" "+(j+(a-1)*100);k.loc=e,S.push(k),g.push(k),m.push(k)}let r=new p.g_(k);v.push(r);let u=new c.mC(k.id,i,k);i.addNode(u);let h=A?k:t,f=A?t:k,O=e.findRelationshipViewsByRel2(R,h,f);if(!O||(null==O?void 0:O.length)==0){b.startTransaction("AddLink");let t=n.gj(),s=new d.Zc(t,R.name,R,"");s.fromObjview=h,s.toObjview=f,R.addRelationshipView(s),e.addRelationshipView(s),l.addRelationshipView(s),y.push(s);let r=new p.GI(s);w.push(r);let a=new c.gR(s.id,i,s);i.addLink(a),b.model.addLinkData(a),b.commitTransaction("AddLink"),b.requestUpdate()}}}}}if(v.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),b.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})}),w.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),b.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})}),r>1)for(let n=0;n<(null==g?void 0:g.length);n++){let s=g[n];f&&console.log("1945 objview, oview",t,s),ed(e,s,i,l,--r,a,h,m,y),r++}}function ep(e,t,i,l,n,s,r,a){if(n<1)return;l.myDiagram;let d=t.object;if(d||(d=l.findObject(t.objectRef)),d&&(d=l.findObject(d.id)),t&&d){let i;let n=d.type;if(n&&n.isContainer()&&(t.viewkind=u.viewkinds.CONT),s){let e=s.split(",")[0];try{i=myMetamodel.findRelationshipTypeByName(e)}catch(t){i=l.findRelationshipTypeByName(e)}}let p="in"===r;for(let n=0;n<2;n++){let s;if(0==n&&(s=d.inputrels),1==n&&(s=d.outputrels),s)for(let n=0;n<s.length;n++){let r,d=s[n];if(!d||d.markedAsDeleted||(d=l.findRelationship(d.id),i&&(null==d?void 0:d.type.id)!==(null==i?void 0:i.id))||(r=p?d.fromObject:d.toObject,!(r=l.findObject(r.id))||r.markedAsDeleted))continue;let c=e.findObjectViewsByObject(r),u=c.length>0?c[0]:null;if(u){a.addObjectView(u);let i=e.findRelationshipViewsByRel2(d,t,u);i.length>0&&a.addRelshipView(i[0])}}}}if(n>1){let t=a.objectviews;for(let d=0;d<(null==t?void 0:t.length);d++)ep(e,t[d],i,l,--n,s,r,a)}}function ec(e,t,i){let l={object:e,modelnames:""},n={myDiagram:i,myMetis:t,myCurrentModel:t.currentModel,myCurrentModelview:t.currentModelview,case:"Select Submodel to Add",title:"Select Submodel to Add",dispatch:i.dispatch,postOperation:eu,args:l};eu(n)}function eu(e){let t=e.myDiagram,i=e.myMetis,l=i.currentModelview,s=e.args.object,r=e.myCurrentModel,a=e.args.object,c=(a=r.findObject(a.id)).name,u=i.findMetamodelByName(c),h=eh(s,i);if(h.length>0){let e=h[0].name;for(let t=1;t<h.length;t++)e+=", "+h[t].name;if(prompt("Accept Generating the Submodel(s)",e)){let e=[],r=[],a=eh(s,i);u.submodels=[];for(let t=0;t<(null==a?void 0:a.length);t++){let s=a[t],c=new d.DM(n.gj(),s.name,u,"");u.addSubModel(c),i.addSubModel(c);let h=null,m=l.objectviews;for(let e=0;e<m.length;e++){let t=m[e],l=t.object;if(l||(l=i.findObject(t.objectRef)),(null==l?void 0:l.name)===(null==s?void 0:s.name)){h=t;break}}if(h){for(let e=0;e<m.length;e++){let t=m[e],l=t.object;l||(l=i.findObject(t.objectRef)),((null==l?void 0:l.name)!==(null==s?void 0:s.name)||(null==l?void 0:l.name)!==(null==s?void 0:s.name))&&l&&t.group===(null==h?void 0:h.id)&&c.addObject(l)}let t=new p.bp(c,!0);e.push(t);let l=new p.YS(u,!0);r.push(l)}}r.map(e=>{let i=e;i=JSON.parse(JSON.stringify(i)),t.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:i})})}}}function eh(e,t){let i=[],l=t.findObjectTypeByName(u.types.AKM_METAMODEL),n=t.findObjectTypeByName(u.types.AKM_MODEL),s=t.findRelationshipTypeByName1(u.types.AKM_HAS_SUBMODEL,l,n),r=e.getOutputRelshipsByType(s);for(let e=0;e<(null==r?void 0:r.length);e++){let t=r[e].toObject;i.push(t)}return i}function em(e,t){}function ef(e,t,i,l){l.startTransaction("updateNode");let n=i.typeview;for(let s=l.nodes;null==s?void 0:s.next();){let r=s.value.data;if(r.key===t.key){for(let s in t)if("key"!==s){if("object"!=typeof s)try{n&&e[s]===n[s]&&""!==n[s]||(i[s]=e[s],t[s]=e[s],l.model.setDataProperty(r,s,e[s]))}catch(e){}"viewkind"===s&&("Object"===i[s]?(i.group="",i.isGroup=!1):"Container"===i[s]&&(i.isGroup=!0)),"isGroup"===s&&"0 0"==i.size&&(i.size="200 100")}t.removeClassInstances()}}l.commitTransaction("updateNode")}function ey(e,t,i,l){l.startTransaction("updateLink"),l.myModelView,i||(i=new d.Zc(e.key,e.name,e,""));for(let n=l.links;null==n?void 0:n.next();){let s=n.value.data;if(s.key===t.key){for(let n in t)if("key"!==n&&"object"!=typeof n){if("category"===n)continue;void 0!==e[n]&&null!==e[n]&&""!==e[n]&&(i[n]=e[n],s[n]=e[n],t[n]=e[n],l.model.setDataProperty(s,n,e[n]))}}}return l.commitTransaction("updateLink"),i}function eg(e,t,i,l){var n,r;let a=[],d=l.myDiagram,c=l.gojsModel,u=null===(n=e.loc)||void 0===n?void 0:n.split(" "),h=parseInt(u[0]),m=parseInt(u[1]);for(let e=0;e<t.length;e++){let n=t[e].data,u=null===(r=n.loc)||void 0===r?void 0:r.split(" ");if(!u)return;let f=parseInt(u[0]),y=parseInt(u[1]);"vertical"===i?(f=h,y=parseInt(u[1])):"horizontal"===i&&(f=parseInt(u[0]),y=m);let g=f+" "+y;n.loc=g;let v=c.findNode(n.key);if(v||(v=c.findNodeForKey(n.key)),!v)continue;d.startTransaction("moveNode"),v.loc=g,d.findNodeForKey(n.key).moveTo(f,y),d.commitTransaction("moveNode");let w=v.objectview;w||(w=l.currentModelview.findObjectView(n.key)),w.loc=g;let b=new p.g_(w);b&&s.oK(a,b)}a.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),d.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})})}function ev(e,t,i,l){var n,r,a;let d=[],c=l.myDiagram,u=l.gojsModel,h=t.length,m=eb(t,i),f=eT(t,i),y=null===(n=m.loc)||void 0===n?void 0:n.split(" "),g=parseInt(y[0]),v=parseInt(y[1]),w=null===(r=f.loc)||void 0===r?void 0:r.split(" "),b=parseInt(w[0]),T=parseInt(w[1]),j=b-g,O=T-v,k=0,M=ew(t,i);"vertical"===i?k=O:"horizontal"===i&&(k=j);let R=k/(h-1);for(let e=0;e<M.length;e++){let t=M[e].data,n=null===(a=t.loc)||void 0===a?void 0:a.split(" "),r=parseInt(n[0]),h=parseInt(n[1]);"vertical"===i?h=v+e*R:"horizontal"===i&&(r=g+e*R);let m=r+" "+h;t.loc=m;let f=u.findNode(t.key);if(f||(f=u.findNodeForKey(t.key)),!f)continue;c.startTransaction("moveNode"),f.loc=m,c.findNodeForKey(t.key).moveTo(r,h),c.commitTransaction("moveNode");let y=f.objectview;y||(y=l.currentModelview.findObjectView(t.key)),y.loc=m;let w=new p.g_(y);w&&s.oK(d,w)}d.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),c.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})})}function ew(e,t){let i=[];return"vertical"===t?i=e.sort((e,t)=>{var i,l;let n=null===(i=e.data.loc)||void 0===i?void 0:i.split(" "),s=null===(l=t.data.loc)||void 0===l?void 0:l.split(" ");return parseInt(n[1])-parseInt(s[1])}):"horizontal"===t&&(i=e.sort((e,t)=>{var i,l;let n=null===(i=e.data.loc)||void 0===i?void 0:i.split(" "),s=null===(l=t.data.loc)||void 0===l?void 0:l.split(" ");return parseInt(n[0])-parseInt(s[0])})),i}function eb(e,t){var i,l;let n=e[0].data,s=null===(i=n.loc)||void 0===i?void 0:i.split(" "),r=parseInt(s[0]),a=parseInt(s[1]);for(let i=1;i<e.length;i++){let d=e[i].data,p=null===(l=d.loc)||void 0===l?void 0:l.split(" "),c=parseInt(p[0]),u=parseInt(p[1]);"vertical"===t?u<a&&(n=d,s=p,r=c,a=u):"horizontal"===t&&c<r&&(n=d,s=p,r=c,a=u)}return n}function eT(e,t){var i,l;let n=e[0].data,s=null===(i=n.loc)||void 0===i?void 0:i.split(" "),r=parseInt(s[0]),a=parseInt(s[1]);for(let i=1;i<e.length;i++){let d=e[i].data,p=null===(l=d.loc)||void 0===l?void 0:l.split(" "),c=parseInt(p[0]),u=parseInt(p[1]);"vertical"===t?u>a&&(n=d,s=p,r=c,a=u):"horizontal"===t&&c>r&&(n=d,s=p,r=c,a=u)}return n}function ej(e,t,i){let l=t.currentModelview,n=[];for(let t=0;t<e.length;t++){let s;let r=e[t].data,a=r.from,d=r.to;if(s=l.findRelationshipView(r.key)){let e=s.fromObjview,t=s.toObjview;r.points=[],r.from=a,r.to=d,i.model.setDataProperty(r,"points",[]),s.points=[],s.fromObjview=e,s.toObjview=t;let l=new p.GI(s);n.push(l)}}n.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),i.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})})}},6248:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{j:()=>DiagramWrapper});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7876),styled_jsx_style__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4250),styled_jsx_style__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(styled_jsx_style__WEBPACK_IMPORTED_MODULE_1__),gojs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(7621),immer__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(4609),gojs_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2272),react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(4232),react_select__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(4987),react_select__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(2566),reactstrap__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(3060),reactstrap__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(5554),reactstrap__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(3172),reactstrap__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(1445),reactstrap__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(8466),reactstrap__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(1774),reactstrap__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(33),reactstrap__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(1597),reactstrap__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(9160),reactstrap__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(8801),classnames__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(5039),classnames__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_5__),_components_SelectionInspector__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(8044),_akmm_metamodeller__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(7089),_akmm_ui_gojs__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(7662),_akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(3022),_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(2210),_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(6196),_akmm_ui_modal__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(8296),_akmm_ui_templates__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(6046),_akmm_ui_methods__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(6671),_akmm_ui_generateTypes__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(2629),_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(2588),_akmm_constants__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(1457),regex_parser__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(7658),regex_parser__WEBPACK_IMPORTED_MODULE_18___default=__webpack_require__.n(regex_parser__WEBPACK_IMPORTED_MODULE_18__),_forms_selectIcons__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(1166);let linkToLink=!1,AllowTopLevel=!0;class DiagramWrapper extends react__WEBPACK_IMPORTED_MODULE_4__.Component{componentDidMount(){var e,t;if(!this.diagramRef.current)return;let i=null===(t=this.diagramRef)||void 0===t?void 0:null===(e=t.current)||void 0===e?void 0:e.getDiagram();i instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.yF&&(i.addDiagramListener("TextEdited",this.props.onDiagramEvent),i.addDiagramListener("SelectionMoved",this.props.onDiagramEvent),i.addDiagramListener("SelectionCopied",this.props.onDiagramEvent),i.addDiagramListener("SelectionDeleting",this.props.onDiagramEvent),i.addDiagramListener("ExternalObjectsDropped",this.props.onDiagramEvent),i.addDiagramListener("InitialLayoutCompleted",this.props.onDiagramEvent),i.addDiagramListener("LayoutCompleted",this.props.onDiagramEvent),i.addDiagramListener("LinkDrawn",this.props.onDiagramEvent),i.addDiagramListener("LinkRelinked",this.props.onDiagramEvent),i.addDiagramListener("LinkReshaped",this.props.onDiagramEvent),i.addDiagramListener("SelectionDeleted",this.props.onDiagramEvent),i.addDiagramListener("ClipboardChanged",this.props.onDiagramEvent),i.addDiagramListener("ClipboardPasted",this.props.onDiagramEvent),i.addDiagramListener("ObjectSingleClicked",this.props.onDiagramEvent),i.addDiagramListener("ObjectDoubleClicked",this.props.onDiagramEvent),i.addDiagramListener("ObjectContextClicked",this.props.onDiagramEvent),i.addDiagramListener("PartResized",this.props.onDiagramEvent),i.addDiagramListener("SubGraphExpanded",this.props.onDiagramEvent),i.addDiagramListener("SubGraphCollapsed",this.props.onDiagramEvent),i.addDiagramListener("BackgroundSingleClicked",this.props.onDiagramEvent),i.addDiagramListener("BackgroundDoubleClicked",this.props.onDiagramEvent),i.addModelChangedListener(this.props.onModelChange),this.props.onExportSvgReady&&this.props.onExportSvgReady(this.exportSvg,!0))}componentWillUnmount(){if(!this.diagramRef.current)return;let e=this.diagramRef.current.getDiagram();e instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.yF&&(e.removeDiagramListener("TextEdited",this.props.onDiagramEvent),e.removeDiagramListener("SelectionMoved",this.props.onDiagramEvent),e.removeDiagramListener("SelectionCopied",this.props.onDiagramEvent),e.removeDiagramListener("SelectionDeleting",this.props.onDiagramEvent),e.removeDiagramListener("ExternalObjectsDropped",this.props.onDiagramEvent),e.removeDiagramListener("LinkDrawn",this.props.onDiagramEvent),e.removeDiagramListener("InitialLayoutCompleted",this.props.onDiagramEvent),e.removeDiagramListener("LinkRelinked",this.props.onDiagramEvent),e.removeDiagramListener("LinkReshaped",this.props.onDiagramEvent),e.removeDiagramListener("SelectionDeleted",this.props.onDiagramEvent),e.removeDiagramListener("ClipboardChanged",this.props.onDiagramEvent),e.removeDiagramListener("ClipboardPasted",this.props.onDiagramEvent),e.removeDiagramListener("ObjectSingleClicked",this.props.onDiagramEvent),e.removeDiagramListener("ObjectDoubleClicked",this.props.onDiagramEvent),e.removeDiagramListener("ObjectContextClicked",this.props.onDiagramEvent),e.removeDiagramListener("PartResized",this.props.onDiagramEvent),e.removeDiagramListener("SubGraphExpanded",this.props.onDiagramEvent),e.removeDiagramListener("SubGraphCollapsed",this.props.onDiagramEvent),e.removeDiagramListener("BackgroundDoubleClicked",this.props.onDiagramEvent),e.removeDiagramListener("BackgroundSingleClicked",this.props.onDiagramEvent),e.removeChangedListener(this.props.onModelChange),this.props.onExportSvgReady&&this.props.onExportSvgReady(null,!1))}handleOpenModal(e,t){this.setState({selectedData:e,modalContext:t,selectedOption:null,showModal:!0,currentActiveTab:"0"})}handleCloseModal(e){let t=this.state.modalContext,i=t.context,l=t.myDiagram;if(l||(l=i.myDiagram),"x"===e){let e=t.links;for(let t=0;t<(null==e?void 0:e.length);t++){let i=e[t];l.model.removeLinkData(i)}this.setState({showModal:!1,selectedData:null,modalContext:null});return}let n=this.props;"Connect to Selected"===t.case&&(t.what="connectToSelected"),_akmm_ui_modal__WEBPACK_IMPORTED_MODULE_12__.wm(this.state.selectedData,n,t),this.setState({showModal:!1})}handleInputChange(e,t,i){let l=e.id;e.type,e.obj,e.context,e.pattern;let n=!1;this.setState((0,immer__WEBPACK_IMPORTED_MODULE_20__.jM)(e=>{!1===n&&(n=!0,e.selectedData[l]=t)})),_akmm_ui_modal__WEBPACK_IMPORTED_MODULE_12__.Pp(this.myMetis,e,t)}initDiagram(){let myDiagram;gojs__WEBPACK_IMPORTED_MODULE_2__.yF.licenseKey="73f944e5b16131b700ca0d2b113f69ef1bb37a619ed11ff55e5141f3ef586c102b9dec7a598099d0d4ac1ef41a7d978c89cc6b2f96440c32e330da8847e282fbb23574b7165a148ca00675919aad2df4f47b63e2c4e027a4da2adcf3f9b8c09d5feaecdd57c90a",null===(_this_diagramRef_current=this.diagramRef.current)||void 0===_this_diagramRef_current||_this_diagramRef_current.clear();let $=gojs__WEBPACK_IMPORTED_MODULE_2__.Ke.make,defPattern="",myMetis=this.myMetis;myMetis&&(myMetis.deleteViewsOnly=!1,myMetis.pasteViewsOnly=!1),myDiagram=$(gojs__WEBPACK_IMPORTED_MODULE_2__.yF,{initialContentAlignment:gojs__WEBPACK_IMPORTED_MODULE_2__.P1.Center,initialAutoScale:gojs__WEBPACK_IMPORTED_MODULE_2__.yF.Uniform,"contextMenuTool.standardMouseSelect":function(){this.diagram.lastInput.shift=!0,gojs__WEBPACK_IMPORTED_MODULE_2__.Z2.prototype.standardMouseSelect.call(this)},"toolManager.mouseWheelBehavior":gojs__WEBPACK_IMPORTED_MODULE_2__.cK.WheelZoom,scrollMode:gojs__WEBPACK_IMPORTED_MODULE_2__.yF.InfiniteScroll,"draggingTool.dragsTree":!1,"draggingTool.isGridSnapEnabled":!0,"linkingTool.portGravity":0,"linkingTool.archetypeLinkData":{key:_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.gj(),category:"Relationship",type:_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_GENERIC_REL,name:"",description:"",relshipkind:_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.relkinds.REL},"linkingTool.isUnconnectedLinkValid":!1,"relinkingTool.isUnconnectedLinkValid":!1,"relinkingTool.portGravity":20,"relinkingTool.fromHandleArchetype":$(gojs__WEBPACK_IMPORTED_MODULE_2__.yp,"Diamond",{segmentIndex:0,cursor:"pointer",desiredSize:new gojs__WEBPACK_IMPORTED_MODULE_2__.or(8,8),fill:"tomato",stroke:"darkred"}),"relinkingTool.toHandleArchetype":$(gojs__WEBPACK_IMPORTED_MODULE_2__.yp,"Diamond",{segmentIndex:-1,cursor:"pointer",desiredSize:new gojs__WEBPACK_IMPORTED_MODULE_2__.or(8,8),fill:"darkred",stroke:"tomato"}),"linkReshapingTool.handleArchetype":$(gojs__WEBPACK_IMPORTED_MODULE_2__.yp,"Diamond",{desiredSize:new gojs__WEBPACK_IMPORTED_MODULE_2__.or(7,7),fill:"lightblue",stroke:"deepskyblue"}),allowDrop:!0,grid:$(gojs__WEBPACK_IMPORTED_MODULE_2__.Zk,"Grid",$(gojs__WEBPACK_IMPORTED_MODULE_2__.yp,"LineH",{stroke:"lightgray",strokeWidth:.5}),$(gojs__WEBPACK_IMPORTED_MODULE_2__.yp,"LineH",{stroke:"gray",strokeWidth:.5,interval:10}),$(gojs__WEBPACK_IMPORTED_MODULE_2__.yp,"LineV",{stroke:"lightgray",strokeWidth:.5}),$(gojs__WEBPACK_IMPORTED_MODULE_2__.yp,"LineV",{stroke:"gray",strokeWidth:.5,interval:10})),model:$(gojs__WEBPACK_IMPORTED_MODULE_2__.D7,{nodeCategoryProperty:"template",linkCategoryProperty:"template",linkKeyProperty:"key"})}),myDiagram.click=function(e){e.diagram.commit(function(e){e.clearHighlighteds()},"no highlighteds")},myDiagram.myGoModel=this.myGoModel,myDiagram.myGoMetamodel=this.myGoMetamodel,myDiagram.dispatch=null===(_this_myMetis=this.myMetis)||void 0===_this_myMetis?void 0:_this_myMetis.dispatch,myDiagram.handleOpenModal=this.handleOpenModal,myDiagram.handleCloseModal=this.handleCloseModal,myDiagram.selectedOption=this.state.selectedOption,myDiagram.routing=gojs__WEBPACK_IMPORTED_MODULE_2__.N_.Normal,myDiagram.state=this.state,myDiagram.toolTip=$("ToolTip",{margin:4},$(gojs__WEBPACK_IMPORTED_MODULE_2__.VJ,new gojs__WEBPACK_IMPORTED_MODULE_2__.Of("text","",diagramInfo),{font:"bold 16pt sans-serif"})),myDiagram.grid.visible=!0,myDiagram.toolManager.draggingTool.isGridSnapEnabled=!0,myDiagram.toolManager.resizingTool.isGridSnapEnabled=!0,myMetis.myDiagram=myDiagram,myDiagram.model.linkFromPortIdProperty="fromPort",myDiagram.model.linkToPortIdProperty="toPort";let myModelview=myMetis.currentModelview;function nodeInfo(e){return _akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.rz(e,myMetis)}function linkInfo(e){return _akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.FU(e,myMetis)}function diagramInfo(e){return _akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.CH(e)}myModelview&&(myModelview.diagram=myDiagram),(null==myModelview?void 0:myModelview.name)===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.admin.AKM_ADMIN_MODELVIEW&&setLayout(myDiagram,null==myModelview?void 0:myModelview.layout);var _this_diagramRef_current,_this_myMetis,partContextMenu=$(gojs__WEBPACK_IMPORTED_MODULE_2__.h2,"Vertical",makeButton("Copy",function(e,t){let i=t.part;i=myDiagram.findNodeForKey(i.key);try{let e=i.findSubGraphParts();e.add(i),myDiagram.selectCollection(e)}catch(e){}myDiagram.findNodeForKey(null==i?void 0:i.key);let l=t.part.data,n=myDiagram.selection;0==n.count&&(l&&myDiagram.select(myDiagram.findPartForKey(l.key)),n=myDiagram.selection);let s=[],r=[];for(let e=n.iterator;null==e?void 0:e.next();){let t=e.value;t instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.bP?addSourceNode(s,t):t instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.N_&&addSourceLink(r,t)}n=[],e.diagram.selection.each(function(e){let t=e.data.key;e.data.fromModelview=myMetis.currentModelview,e.data.fromGoModel=myMetis.gojsModel,e.data.fromNode=getSourceNode(s,t),e.data.fromLink=getSourceLink(r,t),n.push(e.data)}),myMetis.currentSelection=n,e.diagram.commandHandler.copySelection()},function(e){let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT||t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP)return!0}),makeButton("Paste",function(e,t){myMetis.pasteViewsOnly=!1;let i=e.diagram.toolManager.contextMenuTool.mouseDownPoint;e.diagram.commandHandler.pasteSelection(i)},function(e){return e.diagram.commandHandler.canPasteSelection()}),makeButton("Paste View",function(e,t){myMetis.pasteViewsOnly=!0;let i=e.diagram.toolManager.contextMenuTool.mouseDownPoint;e.diagram.commandHandler.pasteSelection(i)},function(e){return e.diagram.commandHandler.canPasteSelection()}),makeButton("----------"),makeButton("Edit Attribute",function(e,t){let i=t.part.data;if(i.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let e=i.object;if(!e)return;let t=null==(e=myMetis.findObject(e.id))?void 0:e.type;if(t){let e=[];e.push("description"),"ViewFormat"===t.name&&e.push("viewFormat"),"InputPattern"===t.name&&e.push("inputPattern");let l=t.properties;for(let t=0;t<(null==l?void 0:l.length);t++){let i=l[t];e.push(i.name)}let n="";e.length>0&&(n=e[0]);let s={what:"selectDropdown",title:"Select Property",case:"Edit Attribute",myDiagram:myDiagram};myMetis.currentNode=i,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(e,s)}}},function(e){return!1}),makeButton("Edit Object",function(e,t){let i=t.part.data;_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.sS(i,myMetis,myDiagram)},function(e){let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT)return!!t.isSelected||(myDiagram.clearSelection(),t.isSelected=!0,_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.Dh(t,myDiagram),!0)}),makeButton("Edit Objectview",function(e,t){let i=t.part.data;_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.pn(i,myMetis,myDiagram)},function(e){let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT)return!!t.isSelected||(myDiagram.clearSelection(),t.isSelected=!0,_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.Dh(t,myDiagram),!0)}),makeButton("Connect to Selected",function(e,t){let i=t.part.data;i.isSelected=!1;let l=i.objtypeRef,n=myMetis.findObjectType(l),s=[],r=myDiagram.selection;for(let e=r.iterator;null==e?void 0:e.next();){let t=e.value;t.data.key!==i.key&&s.push(t.data)}let a=_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.IB(i,r,myMetis,myDiagram),d={what:"selectDropdown",title:"Select Relationship Type",case:"Connect to Selected",myDiagram:myDiagram,args:{fromType:n,nodeFrom:i,nodesTo:s,typeNames:a}};myMetis.currentNode=i,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(i,d)},function(e){return e.part.data.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT&&!!(myDiagram.selection.count>0)}),makeButton("Add Connected Objects",function(e,t){let i="9",l="All",n="All";if(confirm("Use default parameters?"))i=9,l="All";else{i=prompt("Enter no of sublevels to follow",i);let e="All";"All"===(e=prompt("Enter relationship type to follow",e))&&(e="");let t="All";t=prompt("Enter relationship direction to follow (in | out | All)",t)}let s={noLevels:i,reltypes:l,reldir:n},r=myDiagram.selection;for(let e=r.iterator;null==e?void 0:e.next();){let t=e.value.data;_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.HV(t,s,myMetis,myDiagram)}},function(e){return e.part.data.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT}),makeButton("Hide Connected Relationships",function(e,t){let i=t.part.data,l=myDiagram.findNodeForKey(i.key);_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.Hs(l,myMetis,myDiagram)},function(e){return e.part.data.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT}),makeButton("Change Icon",function(e,t){let i=t.part.data;i&&myDiagram.select(myDiagram.findPartForKey(i.key)),(0,_forms_selectIcons__WEBPACK_IMPORTED_MODULE_19__.UF)().map(e=>e&&e.label);let l={what:"selectDropdown",title:"Select Icon",case:"Change Icon",iconList:(0,_forms_selectIcons__WEBPACK_IMPORTED_MODULE_19__.UF)(),currentNode:i,myDiagram:myDiagram};myMetis.currentNode=i,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(i,l)},function(e){return e.part.data.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT}),makeButton("Test InputPattern",function(e,t){let i=t.part.data;if(i.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let e=i.object;null==(e=myMetis.findObject(e.id))||e.type;let t=defPattern;if((t=prompt("Enter input pattern",defPattern)).length>0){defPattern=t;let e=new regex_parser__WEBPACK_IMPORTED_MODULE_18__.RegexParser(t),i=prompt("Value to check");e.test(i)?alert("Value: "+i+" IS valid"):alert("Value: "+i+" IS NOT valid")}}},function(e){let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let e=t.object;if(!e)return;let i=null==(e=myMetis.findObject(e.id))?void 0:e.type;if((null==i?void 0:i.name)==="InputPattern"||(null==i?void 0:i.name)==="Datatype")return!0}return!1}),makeButton("Test Eval",function(e,obj){let node=obj.part.data;if(node.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let object=node.object;object=myMetis.findObject(object.id);let context={},result=eval('context.reldir === "out"');alert(result)}},function(e){return!1}),makeButton("Sort Selection",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.UN(myDiagram)},function(e){return myDiagram.selection.count>1}),makeButton("Add to Selection",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.Dh(t,myDiagram)},function(e){return!1}),makeButton("Cut",function(e,t){e.diagram.commandHandler.cutSelection()},function(e){return e.part.data.category!==_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT&&!1}),makeButton("Delete Selection",function(e,t){confirm("Do you really want to delete the current selection?")&&(myMetis.currentModel,myMetis.gojsModel,myMetis.deleteViewsOnly=!1,myDiagram.commandHandler.deleteSelection())},function(e){let t=myDiagram.selection;return!!e.part.data.isSelected&&t.count>1&&e.diagram.commandHandler.canDeleteSelection()}),makeButton("Delete",function(e,t){let i=t.part;if((i=myDiagram.findNodeForKey(i.key)).data.isGroup&&confirm("Do you want to also delete the content?"))try{let e=i.findSubGraphParts();e.add(i),myDiagram.selectCollection(e)}catch(e){}confirm("Do you really want to delete the current selection?")&&(myMetis.deleteViewsOnly=!1,myMetis.currentNode=t.part.data,myDiagram.commandHandler.deleteSelection())},function(e){let t=myDiagram.selection;return!!e.part.data.isSelected&&1==t.count&&e.diagram.commandHandler.canDeleteSelection()}),makeButton("Delete View",function(e,t){confirm("Do you really want to delete the current selection?")&&(myMetis.currentModel,myMetis.deleteViewsOnly=!0,myMetis.currentNode=t.part.data),myDiagram.commandHandler.deleteSelection()},function(e){let t=myDiagram.selection;return!!e.part.data.isSelected&&1==t.count&&e.diagram.commandHandler.canDeleteSelection()}),makeButton("Delete Selected Views",function(e,t){confirm("Do you really want to delete the current selection?")&&(myMetis.currentModel,myMetis.deleteViewsOnly=!0,myMetis.currentNode=t.part.data),myDiagram.commandHandler.deleteSelection()},function(e){let t=myDiagram.selection;return!!e.part.data.isSelected&&t.count>1&&e.diagram.commandHandler.canDeleteSelection()}),makeButton("----------"),makeButton("Add Port",function(e,t){let i=t.part.data,l=["left","right","top","bottom"],n="";l.length>0&&(n=l[0]);let s={what:"selectDropdown",title:"Select Side",case:"Add Port",node:i,myDiagram:myDiagram};myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(l,s)},function(e){if("Modelling"==myMetis.modelType)switch(e.part.data.template){case"Container1":case"nodeWithPorts":case"groupWithPorts":case"groupWithIconAndPorts":case"groupWithGeoAndPorts":case"groupWithFigAndPorts":return!0}return!1}),makeButton("Export Task Model",function(e,t){let i=o.part.data;_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.Rt(i,myMetis,myDiagram)},function(e){if("Modelling"==myMetis.modelType){let t=e.part.data.object,i=null==t?void 0:t.type;return(null==i?void 0:i.name)===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_CONTAINER}}),makeButton("Generate Datatype",function(e,t){let i={myMetis:myMetis,myMetamodel:myMetis.currentMetamodel,myTargetMetamodel:myMetis.currentTargetMetamodel,myModel:myMetis.currentModel,myModelview:myMetis.currentModelview,myDiagram:e.diagram,dispatch:e.diagram.dispatch};myMetis.currentTargetMetamodel||(myMetis.currentTargetMetamodel=myMetis.currentMetamodel);let l=t.part.adornedPart.data.object;i.myTargetMetamodel=_akmm_ui_generateTypes__WEBPACK_IMPORTED_MODULE_15__.xE(i,!0),myMetis.currentModel.targetMetamodelRef=i.myTargetMetamodel.id;let n=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.bp(i.myModel,!0),s=[];s.push(n),s.map(t=>{let i=t;i=JSON.parse(JSON.stringify(i)),e.diagram.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:i})});let r=_akmm_ui_generateTypes__WEBPACK_IMPORTED_MODULE_15__.QA(l,i);if(r){let t=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.gD(r),i=[];i.push(t),i.map(t=>{let i=t;i=JSON.parse(JSON.stringify(i)),e.diagram.dispatch({type:"UPDATE_DATATYPE_PROPERTIES",data:i})})}},function(e){let t=e.part.data.object,i=null==t?void 0:t.type;return(null==i?void 0:i.name)===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_DATATYPE}),makeButton("Generate Metamodel",function(e,t){myDiagram.dispatch=e.diagram.dispatch,_akmm_ui_generateTypes__WEBPACK_IMPORTED_MODULE_15__.rG(t,myMetis,myDiagram)},function(e){return"Metamodelling"!==myMetis.modelType&&!_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.Sy(myMetis)}),makeButton("Generate Submodel(s)",function(e,t){let i=t.part.data,l=myMetis.findObjectView(i.key).object;_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.uY(l,myMetis,myDiagram),myDiagram.requestUpdate()},function(e){if("Modelling"==myMetis.modelType){let t=e.part.data;myMetis.gojsModel.findNode(t.key);let i=myMetis.findObjectView(t.key),l=null==i?void 0:i.object,n=l.type;if((null==n?void 0:n.name)!==_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_METAMODEL)return!1;{let e=myMetis.currentModel,t=e.findObject(l.id);if(t=e.findObject(t.id))return _akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.wr(t,myMetis).length>0}}}),makeButton("Edit Object Type",function(e,t){let i=t.part.data,l={what:"editObjectType",title:"Edit Object Type",icon:_akmm_ui_templates__WEBPACK_IMPORTED_MODULE_13__.F1(i.icon),myDiagram:myDiagram};myMetis.currentNode=i,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(i,l)},function(e){return e.part.data.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECTTYPE}),makeButton("Change Object Type",function(e,t){let i=t.part.data;i.objecttype;let l=myMetis.currentMetamodel.getObjectTypes();if(i.choices=[],l)for(let e=0;e<l.length;e++){let t=l[e];if(!t.markedAsDeleted){if("Generic"===t.name||"Element"===t.name)continue;i.choices.push(t.name)}}let n={what:"selectDropdown",title:"Select Object Type",case:"Change Object type",myDiagram:myDiagram};myMetis.currentNode=i,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(i.choices,n)},function(e){return e.part.data.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT}),makeButton("Edit Typeview",function(e,t){let i=o.part.data;_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.jM(i,myMetis,myDiagram)},function(e){return!1}),makeButton("Reset to Typeview",function(e,t){let i=myDiagram.selection;if(0==i.count){let e=t.part.data;e&&myDiagram.select(myDiagram.findPartForKey(e.key)),i=myDiagram.selection}myMetis.gojsModel,myDiagram.selection.each(function(e){let t=e.data;t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT&&_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.S0(t,myMetis,myDiagram)})},function(e){let t=e.part.data;return t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT&&(!!t.isSelected||0==myDiagram.selection.count)}),makeButton("Convert to Group",function(e,t){let i=!confirm("No Ports (OK) or Allow Ports?"),l=t.part.data,n=myMetis.findObjectView(null==l?void 0:l.key);if(n){n.viewkind="Container";let e=l.template;switch(e){case"textAndGeometry":e=i?"groupWithGeoAndPorts":"groupGeoNoPorts";break;case"textAndFigure":e=i?"groupWithFigAndPorts":"groupFigNoPorts";break;default:e=i?"groupWithPorts":"groupNoPorts"}n.template=e,n.isGroup=!0,n.viewkind="Container",l.template=e,l.viewkind="Container";let t=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.g_(n);t.template=e;let s=JSON.parse(JSON.stringify(t));myDiagram.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:s}),myDiagram.model.setCategoryForNodeData(l.data,e)}else alert("You need to do a Reload to see the change!")},function(e){let t=e.part.data;return t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT&&"Container"!==t.viewkind}),makeButton("Convert to Node",function(e,t){let i=t.part.data,l=myMetis.findObjectView(null==i?void 0:i.key);(l=myMetis.findObjectView(null==l?void 0:l.id))&&(l.viewkind="Object",l.template="textAndIcon",l.isGroup=!1),i.viewkind="Object";let n=JSON.parse(JSON.stringify(new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.g_(l)));myDiagram.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:n}),alert("You need to a Reload to see the change!")},function(e){let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let e=t.objectview;if((null==e?void 0:e.viewkind)==="Container")return!0}return!1}),makeButton("Open Group",function(e,t){let i=t.part.data;i.isSubGraphExpanded=!0;let l=i.data;l.isExpanded=!0;let n=l.objectview;n.isExpanded=!0;let s=JSON.parse(JSON.stringify(new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.g_(n,!0)));myDiagram.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:s})},function(e){let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let e=t.objectview;if((null==e?void 0:e.viewkind)==="Container"&&(null==e?void 0:e.isExpanded)===!1)return!0}return!1}),makeButton("Align Vertical",function(e,t){let i=t.part.data,l=myDiagram.selection,n=[];l.each(function(e){!(e instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.N_)&&n.push(e)}),_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.N$(i,n,"vertical",myMetis);let s=[];l.each(function(e){!(e instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.bP)&&s.push(e)}),_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.tO(s,myMetis,myDiagram)},function(e){let t=myDiagram.selection,i=0;return t.count>1&&(t.each(function(e){!(e instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.N_)&&i++}),i>1||void 0)}),makeButton("Align Horizontal",function(e,t){let i=t.part.data,l=myDiagram.selection,n=[];l.each(function(e){!(e instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.N_)&&n.push(e)}),_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.N$(i,n,"horizontal",myMetis);let s=[];l.each(function(e){!(e instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.bP)&&s.push(e)}),_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.tO(s,myMetis,myDiagram)},function(e){let t=myDiagram.selection,i=0;return t.count>1&&(t.each(function(e){!(e instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.N_)&&i++}),i>1||void 0)}),makeButton("Spread Even Vertical",function(e,t){let i=t.part.data,l=myDiagram.selection,n=[];l.each(function(e){!(e instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.N_)&&n.push(e)}),_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.q9(i,n,"vertical",myMetis);let s=[];l.each(function(e){!(e instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.bP)&&s.push(e)}),_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.tO(s,myMetis,myDiagram)},function(e){let t=myDiagram.selection,i=0;return t.count>1&&(t.each(function(e){!(e instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.N_)&&i++}),i>1||void 0)}),makeButton("Spread Even Horizontal",function(e,t){let i=t.part.data,l=myDiagram.selection,n=[];l.each(function(e){!(e instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.N_)&&n.push(e)}),_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.q9(i,n,"horizontal",myMetis);let s=[];l.each(function(e){!(e instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.bP)&&s.push(e)}),_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.tO(s,myMetis,myDiagram)},function(e){let t=myDiagram.selection,i=0;return t.count>1&&(t.each(function(e){!(e instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.N_)&&i++}),i>1||void 0)}),makeButton("----------"),makeButton("Set Layout Scheme",function(e,t){let i=t.part.data,l=i.objectview;l=myModelview.findObjectView(i.key);let n={what:"selectDropdown",title:"Set Layout Scheme",case:"Set Layout Scheme",layoutList:[{value:"Circular",label:"Circular Layout"},{value:"Grid",label:"Grid Layout"},{value:"Tree",label:"Tree Layout"},{value:"ForceDirected",label:"ForceDirected Layout"},{value:"LayeredDigraph",label:"LayeredDigraph Layout"},{value:"Manual",label:"Manual Layout"}],myDiagram:myDiagram,myModelview:myModelview,objectview:l};myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(myDiagram,n)},function(e){let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let e=t.objectview;if((null==e?void 0:e.isGroup)&&(null==e?void 0:e.isExpanded)===!0)return!0}return!1}),makeButton("Do Layout",function(e,t){let i=t.part.data.key,l=myMetis.findObjectView(i);if(l){if(null==l?void 0:l.isGroup)(null==l?void 0:l.groupLayout)&&_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.xW(l,myDiagram);else{let e=myDiagram.selection;_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.wK(e,myModelview,myDiagram,!0),myDiagram.selection.each(function(e){let t=e.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP){let e=t.from,i=t.to,l=t.relshipview;if(l=myModelview.findRelationshipView(null==l?void 0:l.id)){let n=l.fromObjview,s=l.toObjview;t.points=[],t.from=e,t.to=i,myDiagram.model.setDataProperty(t,"points",t.points),l.points=[],l.fromObjview=n,l.toObjview=s}}})}}myDiagram.requestUpdate()},function(e){let t=e.part.data.key,i=myMetis.findObjectView(t);return null==i||!i.isGroup}),makeButton("Generate Target Object Type",function(e,t){let i={myMetis:myMetis,myMetamodel:myMetis.currentMetamodel,myTargetMetamodel:myMetis.currentTargetMetamodel,myModel:myMetis.currentModel,myCurrentModelview:myMetis.currentModelview,myDiagram:e.diagram,dispatch:e.diagram.dispatch};t.part.adornedPart.data.object,i.myTargetMetamodel=myMetis.currentTargetMetamodel,_akmm_ui_generateTypes__WEBPACK_IMPORTED_MODULE_15__.eT(i)},function(e){let t=e.part.data.object,i=null==t?void 0:t.type;return(null==i?void 0:i.name)!==_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_INFORMATION&&!1}),makeButton("----------"),makeButton("Select all objects of this type",function(e,t){let i=t.part.data.object.type,l=myDiagram.nodes;for(let e=l.iterator;null==e?void 0:e.next();){let t=e.value;t.data.object.type.id==i.id&&(t.isSelected=!0)}},function(e){return!0}),makeButton("Select Content",function(e,t){let i=t.part,l=(i=myDiagram.findNodeForKey(i.key)).findSubGraphParts();l.add(i);try{myDiagram.selectCollection(l)}catch(e){}},function(e){let t=e.part.data;return t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT&&!!t.isGroup}),makeButton("Select connected objects 1",function(e,t){let i=t.part.data;if(i.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let e=1;e=prompt("Enter no of sublevels to follow",1);let t="";t=prompt("Enter relationship direction to follow (in | out)",t);let l="";l=prompt("Enter relationship type to follow",l);let n=myMetis.currentModelview,s=i.objectview;s=n.findObjectView(i.key);let r=[];r.push(s);let a=[],d=new _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_7__.pF(_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.gj(),"selectConnected","");d.reldir="",d.objtypes="",d.reltypes=l,d.valuecondition=null,d.nolevels=e,d.preaction="Select",d.postaction="",d.propname="",d.noObjects=0;let p={method:d},c={myMetis:myMetis,myModel:myMetis.currentModel,myModelview:myMetis.currentModelview,myDiagram:myDiagram,args:p,objectviews:r,relshipviews:a,currentObjectview:s,traverseViews:!0,level:0};_akmm_ui_methods__WEBPACK_IMPORTED_MODULE_14__.PR(c)}},function(e){return!1}),makeButton("Select Connected Objects",function(e,t){let i=t.part.data;_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.mW(i,myMetis,myDiagram)},function(e){return e.part.data.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT}),makeButton("Generate osduIds",function(e,t){let i=t.part.data;if(i.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let e=i.object;if(!e)return;e=myMetis.findObject(e.id);let t=new _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_7__.pF(_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.gj(),"generateosduId","");t.reldir="out",t.objtypes="all",t.reltypes="hasPart",t.objtypecondition=null,t.reltypecondition=null,t.valuecondition=null,t.preaction="generateosduId",t.propname="osduId";let l={method:t},n={myMetis:myMetis,myModel:myMetis.currentModel,myDiagram:myDiagram,myObject:e,args:l};_akmm_ui_methods__WEBPACK_IMPORTED_MODULE_14__.PR(n)}},function(e){let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let e=t.object,i=null==e?void 0:e.type;i=myMetis.findObjectType(null==i?void 0:i.id);let l="osduId";if(i&&i.findPropertyByName2(l,!0))return!0}return!1}),makeButton("Execute Method",function(e,t){let i=t.part.data;if(i.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let e=i.object;e=myMetis.findObject(null==e?void 0:e.id);let t=i.objectview;t=myMetis.findObjectView(null==t?void 0:t.id);let l=[];l.push(t);let n=[],s={method:""},r={myMetis:myMetis,myMetamodel:myMetis.currentMetamodel,myCurrentModelview:myMetis.currentModelview,currentObject:e,currentObjectview:t,objectviews:l,relshipviews:n,myDiagram:myDiagram,case:"Execute Method",title:"Select Method",dispatch:myDiagram.dispatch,postOperation:_akmm_ui_methods__WEBPACK_IMPORTED_MODULE_14__.PR,traverseViews:!0,nolevels:"9",level:0,args:s};_akmm_ui_methods__WEBPACK_IMPORTED_MODULE_14__.Ku(r)}},function(e){let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){var i;let e=t.object,l=null==e?void 0:null===(i=e.type)||void 0===i?void 0:i.methods;if((null==l?void 0:l.length)>0)return!0}return!1}),makeButton("Undo",function(e,t){e.diagram.commandHandler.undo()},function(e){return e.diagram.commandHandler.canUndo()}),makeButton("Redo",function(e,t){e.diagram.commandHandler.redo()},function(e){return e.diagram.commandHandler.canRedo()}),makeButton("Get My Scale",function(e,t){let i=myMetis.gojsModel,l=t.part.data,n=i.findNodeByViewId(l.objviewRef),s="";alert(s=n?"My Scale is: "+(null==n?void 0:n.getMyScale(i)):l.scale)},function(e){return e.part.data,!0})),linkContextMenu=$(gojs__WEBPACK_IMPORTED_MODULE_2__.h2,"Vertical",makeButton("Edit Relationship",function(e,t){let i=t.part.data,l=myMetis.findRelationship(null==i?void 0:i.relshipRef),n=myMetis.findRelationshipView(null==i?void 0:i.relviewRef),s=myMetis.findRelationshipType(null==l?void 0:l.typeRef),r=null==s?void 0:s.typeview,a={what:"editRelationship",title:"Edit Relationship",myDiagram:myDiagram,myContext:{object:null,objectview:null,objecttype:null,objecttypeview:null,relship:l,relshipview:n,relshiptype:s,relshiptypeview:r,model:myMetis.currentModel,modelview:myMetis.currentModelview,metamodel:myMetis.currentMetamodel}};myMetis.currentLink=i,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(i,a)},function(e){return e.part.data.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP}),makeButton("Edit Relationship View",function(e,t){let i=t.part.data,l=myMetis.findRelationship(null==i?void 0:i.relshipRef),n=myMetis.findRelationshipView(null==i?void 0:i.relviewRef),s=myMetis.findRelationshipType(null==l?void 0:l.reltypeRef),r=null==s?void 0:s.typeview,a={what:"editRelshipview",title:"Edit Relationship View",myDiagram:myDiagram,myContext:{object:null,objectview:null,objecttype:null,objecttypeview:null,relship:l,relshipview:n,relshiptype:s,relshiptypeview:r,model:myMetis.currentModel,modelview:myMetis.currentModelview,metamodel:myMetis.currentMetamodel}};myMetis.currentLink=i,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(i,a)},function(e){return e.part.data.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP}),makeButton("Cut",function(e,t){e.diagram.commandHandler.cutSelection()},function(e){return!1}),makeButton("Delete",function(e,t){confirm("Do you really want to delete the current selection?")&&(myMetis.deleteViewsOnly=!1,e.diagram.commandHandler.deleteSelection())},function(e){return e.diagram.commandHandler.canDeleteSelection()}),makeButton("Delete View",function(e,t){confirm("Do you really want to delete the current selection?")&&(myMetis.deleteViewsOnly=!0,e.diagram.commandHandler.deleteSelection())},function(e){return e.diagram.commandHandler.canDeleteSelection()}),makeButton("Hide View",function(e,t){let i=myDiagram.selection;if(0==i.count){let e=t.part.data;e&&myDiagram.select(myDiagram.findLinkForKey(e.key)),i=myDiagram.selection}let l=[],n=[];myDiagram.selection.each(function(e){let t=e,i=t.data.relshipview;if(i){(i=myModelview.findRelationshipView(i.id)).visible=!1;let e=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.GI(i);n.push(e),t.visible=!1,l.push(t)}});for(let e=0;e<l.length;e++){let t=l[e];myDiagram.remove(t)}n.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),myDiagram.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})})},function(e){return e.part.data.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP}),makeButton("Add to Selection",function(e,t){let i=t.part.data?t.part.data:t.part;i.isSelected=!0,i.relship,i.relshipview},function(e){return!1}),makeButton("----------"),makeButton("TEST",function(e,t){let i=e.diagram,l=t.part,n=i.links;for(let e=n.iterator;null==e?void 0:e.next();){e.value;for(let e=n.iterator;null==e?void 0:e.next();)e.value.key===l.key&&(e.value=l)}},function(e){return!0}),makeButton("New Typeview",function(e,t){let i=t.part.data;if(i.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP){var l,n;let t=myMetis.findRelationship(null===(l=i.relship)||void 0===l?void 0:l.id);t||(t=myMetis.findRelationship(i.relshipRef));let s=myMetis.findRelationshipView(null===(n=i.relshipview)||void 0===n?void 0:n.id);if(t&&s){let l=myMetis.currentMetamodel,n=t.type,r=s.typeview,a=n.typeview;if(!r||r.id===a.id){let t=_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.gj(),d=n.name+"_"+n.getRelshipKind();(r=new _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_7__.Fu(t,d,n,"")).data=a.data,r.data.strokecolor="red",r.nameId=void 0,r.modified=!0,s.typeview=r;let p=r.data;for(let e in r.data)myDiagram.model.setDataProperty(i,e,p[e]);i.typeview=r,myDiagram.requestUpdate(),l.addRelationshipTypeView(r),myMetis.addRelationshipTypeView(r);let c=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.KW(r),u=[];u.push(c),u.map(t=>{let i=t;i=JSON.parse(JSON.stringify(i)),e.diagram.dispatch({type:"UPDATE_RELSHIPTYPEVIEW_PROPERTIES",data:i})});let h=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.GI(s),m=[];m.push(h),m.map(t=>{let i=t;i=JSON.parse(JSON.stringify(i)),e.diagram.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:i})})}}}},function(e){return!1}),makeButton("Edit Relationship Type",function(e,t){let i=t.part.data,l={what:"editRelationshipType",title:"Edit Relationship Type",myDiagram:myDiagram};myMetis.currentLink=i,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(i,l)},function(e){return e.part.data.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELSHIPTYPE}),makeButton("Change Relationship Type",function(e,t){myMetis.gojsModel;let i=myMetis.currentModelview,l=myMetis.currentMetamodel,n=i.includeInheritedReltypes,s=!1,r=t.part.data,a=r.relshipRef,d=myMetis.findRelationship(a),p=d.fromObject.type.id,c=l.findObjectType(p);c||(c=myMetis.findObjectType(p));let u=d.toObject.type.id,h=l.findObjectType(u);h||(h=myMetis.findObjectType(u)),(null==c?void 0:c.name)===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_ENTITY_TYPE&&(null==h?void 0:h.name)===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_ENTITY_TYPE&&(s=!0);let m=l.findRelationshipTypesBetweenTypes(c,h,n),f=myMetis.findRelationshipTypesBetweenTypes(c,h,!0);for(let e=0;e<(null==f?void 0:f.length);e++){let t=f[e];t.name===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_GENERIC_REL&&m.push(t),t.name===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_REFERS_TO&&m.push(t)}if(r.choices=[],m){for(let e=0;e<(null==m?void 0:m.length);e++){let t=m[e];r.choices.push(t.name)}s&&m.push(_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_IS);let e=_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.EL(r.choices);r.choices=e}let y={what:"selectDropdown",title:"Select Relationship Type",case:"Change Relationship type",myDiagram:myDiagram,args:{typeNames:r.choices}};myMetis.currentLink=r,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(r.choices,y)},function(e){return e.part.data.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP}),makeButton("Edit Typeview",function(e,t){let i=t.part.data;_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.VZ(i,myMetis,myDiagram)},function(e){return!1}),makeButton("Reset to Typeview",function(e,t){let i=myDiagram.selection;if(0==i.count){let e=t.part.data;currentNode&&myDiagram.select(myDiagram.findLinkForKey(e.key)),i=myDiagram.selection}myMetis.gojsModel,myDiagram.selection.each(function(e){let t=e.data;t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP&&_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.S0(t,myMetis,myDiagram)})},function(e){let t=e.part.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP){let e=t.relship,i=t.relshipview;if(e&&i){let i=e.type,l=t.typeview,n=i.typeview;l&&(l.id,n.id)}return!0}return t.category,_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELSHIPTYPE,!1}),makeButton("Edit Attribute",function(e,t){let i=t.part.data;if(i.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP){let e=i.relship,t=null==e?void 0:e.type;if(t){let e=[];e.push("description");let i=t.properties;for(let t=0;t<(null==i?void 0:i.length);t++){let l=i[t];e.push(l.name)}let l="";e.length>0&&(l=e[0]);let n={what:"selectDropdown",title:"Select Attribute",case:"Edit Attribute",myDiagram:myDiagram};myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(e,n)}}else if(i.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELSHIPTYPE){let e=[];e.push("description"),e.push("cardinality");let t="";e.length>0&&(t=e[0]);let l={what:"selectDropdown",title:"Select Attribute",case:"Edit Attribute",myDiagram:myDiagram};myMetis.currentLink=i,myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(e,l)}},function(e){return!1}),makeButton("----------"),makeButton("Generate Relationship Type",function(e,t){let i={myMetis:myMetis,myMetamodel:myMetis.currentMetamodel,myTargetMetamodel:myMetis.currentTargetMetamodel,myModel:myMetis.currentModel,myCurrentModelview:myMetis.currentModelview,myDiagram:e.diagram,dispatch:e.diagram.dispatch};t.part.adornedPart.data.relship,i.myTargetMetamodel=myMetis.currentTargetMetamodel,_akmm_ui_generateTypes__WEBPACK_IMPORTED_MODULE_15__.eT(i)},function(e){let t=e.part.data.relship;if(!t)return!1;let i=t.fromObject,l=t.toObject;return t.type,i.type.name===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_INFORMATION&&(l.type.name===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_INFORMATION||void 0)}),makeButton("----------"),makeButton("Select all views of this relationship",function(e,t){var i;let l=t.part.data,n=myMetis.findRelationship(null===(i=l.relship)||void 0===i?void 0:i.id);n||(n=myMetis.findRelationship(l.relshipRef));let s=myDiagram.links;for(let e=s.iterator;null==e?void 0:e.next();){let t=e.value;t.data.relship.id==n.id&&(t.isSelected=!0)}},function(e){var t;let i=e.part.data,l=myMetis.findRelationship(null===(t=i.relship)||void 0===t?void 0:t.id);l||(l=myMetis.findRelationship(i.relshipRef));let n=myDiagram.links,s=0;for(let e=n.iterator;null==e?void 0:e.next();)e.value.data.relship.id==l.id&&s++;return s>1}),makeButton("Select all relationships of this type",function(e,t){var i,l;let n=t.part.data,s=myMetis.findRelationship(null===(i=n.relship)||void 0===i?void 0:i.id);s||(s=myMetis.findRelationship(n.relshipRef));let r=null==s?void 0:s.type,a=myDiagram.links;for(let e=a.iterator;null==e?void 0:e.next();){let t=e.value;(null===(l=t.data.relshiptype)||void 0===l?void 0:l.id)==(null==r?void 0:r.id)&&(t.isSelected=!0)}},function(e){return!0}),makeButton("Add to Selection",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.Dh(t,myDiagram)},function(e){return!0}),makeButton("Clear Path",function(e,t){let i=myDiagram.selection,l=[];i.each(function(e){!(e instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.bP)&&(l.push(e),_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.tO(l,myMetis,myDiagram))})},function(e){return!!e.part.data.points}));makeButton("Undo",function(e,t){e.diagram.commandHandler.undo()},function(e){return e.diagram.commandHandler.canUndo()}),makeButton("Redo",function(e,t){e.diagram.commandHandler.redo()},function(e){return e.diagram.commandHandler.canRedo()});var portContextMenu=$("ContextMenu",makeButton("Change port name",function(e,t){let i=e.diagram.selection.first().data.object;i=myMetis.findObject(i.id);let l=t.part.adornedObject,n=l.data.name,s=l.data.side,r=i.getPort(s,n);n=prompt("Enter port name",n),r&&(r.name=n);let a=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.pJ(i),d=[];d.push(a),d.map(t=>{let i=t;i=JSON.parse(JSON.stringify(i)),e.diagram.dispatch({type:"UPDATE_OBJECT_PROPERTIES",data:i})}),_akmm_ui_templates__WEBPACK_IMPORTED_MODULE_13__.bP(l,n,myDiagram)}),makeButton("Change port color",function(e,t){let i=e.diagram.selection.first().data.object;i=myMetis.findObject(i.id);let l=t.part.adornedObject,n=l.data.color,s=l.data.side,r=i.getPort(s,l.data.name);(n=prompt("Enter port color",n))&&n.trim()||(n="transparent"),r&&(r.color=n);let a=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.pJ(i),d=[];d.push(a),d.map(t=>{let i=t;i=JSON.parse(JSON.stringify(i)),e.diagram.dispatch({type:"UPDATE_OBJECT_PROPERTIES",data:i})}),_akmm_ui_templates__WEBPACK_IMPORTED_MODULE_13__.t(l,n,myDiagram)}),makeButton("Remove port",function(e,t){let i=e.diagram.selection.first().data,l=t.part.adornedObject,n=i.object,s=(n=myMetis.findObject(n.id)).getRelsConnectedToPort(l.data.id),r=[];for(let e=0;e<s.length;e++){let t=s[e];if(t){let e=t.relshipview;e&&(e.markedAsDeleted=!0),t.markedAsDeleted=!0;let i=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.w(t);r.push(i)}}r.map(t=>{let i=t;i=JSON.parse(JSON.stringify(i)),e.diagram.dispatch({type:"UPDATE_RELSHIP_PROPERTIES",data:i})}),n.deletePort(l.data.side,l.data.name);let a=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.pJ(n),d=[];d.push(a),d.map(t=>{let i=t;i=JSON.parse(JSON.stringify(i)),e.diagram.dispatch({type:"UPDATE_OBJECT_PROPERTIES",data:i})}),_akmm_ui_templates__WEBPACK_IMPORTED_MODULE_13__.ki(l,myDiagram),myDiagram.requestUpdate()}));myDiagram.contextMenu=$(gojs__WEBPACK_IMPORTED_MODULE_2__.h2,"Vertical",makeButton("Paste",function(e,t){myMetis.pasteViewsOnly=!1;let i=[];e.diagram.selection.each(function(e){i.push(e.data)}),myMetis.currentSelection=i;let l=e.diagram.toolManager.contextMenuTool.mouseDownPoint;e.diagram.commandHandler.pasteSelection(l)},function(e){return e.diagram.commandHandler.canPasteSelection()}),makeButton("Paste View",function(e,t){myMetis.pasteViewsOnly=!0;let i=[];e.diagram.selection.each(function(e){i.push(e.data)}),myMetis.currentSelection=i;let l=e.diagram.toolManager.contextMenuTool.mouseDownPoint;e.diagram.commandHandler.pasteSelection(l)},function(e){return e.diagram.commandHandler.canPasteSelection()}),makeButton("----------",function(e,t){console.log("TEST")},function(e){return"Metamodelling"!==myMetis.modelType&&e.diagram.commandHandler.canPasteSelection()}),makeButton("New Model",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.wc(myMetis,myDiagram)},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("New Modelview",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.Hw(myMetis,myDiagram)},function(e){if("Metamodelling"===myMetis.modelType)return!1;let t=myMetis.adminModel;return myMetis.currentModel.id!==t.id}),makeButton("Set Modelview as Template",function(e,t){let i=myMetis.currentModelview,l=myMetis.currentModel;l.addTemplate(i),i.setIsTemplate(!0),l.setIsTemplate(!0),alert("Current modelview has been set as template")},function(e){return!1}),makeButton("Delete Model",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.De(myMetis,myDiagram)},function(e){if("Metamodelling"===myMetis.modelType)return!1;let t=0,i=myMetis.models;for(let e=0;e<i.length;e++)!i[e].markedAsDeleted&&t++;return t>1}),makeButton("Delete Current Modelview",function(e,t){if(confirm("Do you really want to delete the current modelview?")){myMetis.currentModel;let e=myMetis.currentModelview;_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.kY(e,myMetis,myDiagram)}},function(e){if("Metamodelling"===myMetis.modelType)return!1;let t=myMetis.currentModel,i=0,l=t.modelviews;for(let e=0;e<l.length;e++)!l[e].markedAsDeleted&&i++;return i>1}),makeButton("New Target Model",function(e,t){let i;let l=myMetis.currentTargetMetamodel,n=prompt("Enter Target Model name:","");if(null==n||""===n)alert("New operation was cancelled");else{i=new _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_7__.DM(_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.gj(),n,l,""),myMetis.addModel(i);let t=prompt("Enter Modelview name:",i.name);if(null==t||""===t)alert("New operation was cancelled");else{let l=myMetis.currentModel,n=new _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_7__.it(_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.gj(),t,l,"");i.addModelView(n),myMetis.addModelView(n);let s=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.bp(i,!0);s=JSON.parse(JSON.stringify(s)),e.diagram.dispatch({type:"LOAD_TOSTORE_NEWMODELVIEW",data:s})}}},function(e){return"Metamodelling"!==myMetis.modelType&&!!myMetis.currentTargetMetamodel}),makeButton("Set Target Model",function(e,t){myMetis.currentMetamodel,myMetis.currentModel,myMetis.currentModelview,myMetis.currentTargetMetamodel,e.diagram;let i={what:"selectDropdown",title:"Select Target Model",case:"Set Target Model",myDiagram:myDiagram},l=myMetis.models.map(e=>e&&e.nameId);myDiagram.handleOpenModal(l,i)},function(e){return!1}),makeButton("----------",function(e,t){},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Edit Model Suite",function(e,t){let i=prompt("Enter the name of the Model Suite:",myMetis.name);(null==i?void 0:i.length)>0&&(myMetis.name=i);let l=prompt("Enter Model Suite description:",myMetis.description);(null==l?void 0:l.length)>0&&(myMetis.description=l),myMetis.currentMetamodel.findObjectTypeByName("Datatype")&&(confirm("Allow generate current metamodel: (OK = Yes))")?myMetis.allowGenerateCurrentMetamodel=!0:myMetis.allowGenerateCurrentMetamodel=!1);let n={name:myMetis.name,description:myMetis.description,allowGenerateCurrentMetamodel:myMetis.allowGenerateCurrentMetamodel},s=[];s.push(n),null==s||s.map(t=>{var i;let l=t&&t;l=JSON.parse(JSON.stringify(l)),null===(i=e.diagram)||void 0===i||i.dispatch({type:"UPDATE_PROJECT_PROPERTIES",data:l})})},function(e){if("Metamodelling"===myMetis.modelType)return!1;let t=myMetis.adminModel;return myMetis.currentModel.id!==t.id}),makeButton("Edit Metamodel",function(e,t){let i=myMetis.currentMetamodel,l=i.name,n=prompt("Enter Metamodel name:",l);(null==n?void 0:n.length)>0&&(i.name=n);let s=prompt("Enter Metamodel description:",i.description);(null==s?void 0:s.length)>0&&(i.description=s),l!==n&&(i.id=_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.gj());let r={metis:new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.io(myMetis,!0)};r=JSON.parse(JSON.stringify(r)),myDiagram.dispatch({type:"LOAD_TOSTORE_PHDATA",data:r})},function(e){if("Metamodelling"===myMetis.modelType)return!0}),makeButton("Edit Model",function(e,t){let i=myMetis.currentModel,l=prompt("Enter Model name:",i.name);(null==l?void 0:l.length)>0&&(i.name=l);let n=prompt("Enter Model description:",i.description);(null==n?void 0:n.length)>0&&(i.description=n);let s=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.bp(i,!0),r=[];r.push(s),null==r||r.map(t=>{var i;let l=t&&t;l=JSON.parse(JSON.stringify(l)),null===(i=e.diagram)||void 0===i||i.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:l})})},function(e){if("Metamodelling"===myMetis.modelType)return!1;let t=myMetis.adminModel;return myMetis.currentModel.id!==t.id}),makeButton("Edit Modelview",function(e,t){{let t=myMetis.currentModelview,i=prompt("Enter Modelview name:",t.name);(null==i?void 0:i.length)>0&&(t.name=i);let l=prompt("Enter Modelview description:",t.description);(null==l?void 0:l.length)>0&&(t.description=l);let n=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.Yp(t),s=[];s.push(n),null==s||s.map(t=>{var i;let l=t&&t;l=JSON.parse(JSON.stringify(l)),null===(i=e.diagram)||void 0===i||i.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:l})})}},function(e){if("Metamodelling"===myMetis.modelType)return!1;let t=myMetis.adminModel;return myMetis.currentModel.id!==t.id}),makeButton("Open/Close All Groups",function(e,t){let i=confirm("Open (OK) or Close all Groups?","true");_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.Mq(myDiagram,i)},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Update Project from AdminModel",function(e,t){myMetis.adminModel&&_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.bb(myMetis,myDiagram)},function(e){if("Metamodelling"===myMetis.modelType)return!1;let t=myMetis.adminModel;return myMetis.currentModel.id===t.id}),makeButton("----------",function(e,t){},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Select all objects of type",function(e,t){let i=myMetis.currentModel;myMetis.currentModelview;let l=myMetis.gojsModel,n=prompt("Enter object type name",""),s=i.getObjectsByTypename(n,!1),r=!0;for(let e=0;e<s.length;e++){let t=s[e];if(t){let e=t.objectviews;if(e)for(let t=0;t<e.length;t++){let i=e[t];if(i){let e=l.findNodeByViewId(null==i?void 0:i.id),t=myDiagram.findNodeForKey(null==e?void 0:e.key);t&&(r?(myDiagram.select(t),r=!1):t.isSelected=!0)}}}}},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Select by Object Name",function(e,t){let i=prompt("Enter name ","");RegExp(i,"i");let l=myDiagram.findNodesByExample({name:i}).iterator;for(;l.next();){let e=l.value,t=myDiagram.findNodeForKey(null==e?void 0:e.key);t&&(t.isSelected=!0)}},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Add Missing Relationship Views",function(e,t){let i=myMetis.currentModelview,l=_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.y8(i,myMetis);for(let e=0;e<l.length;e++){let t=l[e];myDiagram.model.addLinkData(t)}},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Unhide Hidden Relationship Views",function(e,t){let i=myMetis.currentModelview;_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.os(i,myMetis)},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Delete Invisible Objects",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.HE(myMetis,myDiagram)},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Undelete Selection",function(e,t){if(confirm("Do you really want to undelete the current selection?")){myDiagram.selection.each(function(e){let t=e.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_OBJECT){let e=t.objectview;if(e){(e=myMetis.findObjectView(e.id)).markedAsDeleted=!1,e.typeview?e.strokecolor=e.typeview.strokecolor:e.strokecolor="black";let t=e.object;t&&(t.markedAsDeleted=!1)}}if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP){let t=e.data.relshipview;if(t){(t=myMetis.findRelationshipView(t.id)).markedAsDeleted=!1,t.typeview?t.strokecolor=t.typeview.strokecolor:t.strokecolor="black";let e=t.relship;e&&(e.markedAsDeleted=!1)}}});let t=myMetis.currentModel,i=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.bp(t,!0),l=[];l.push(i),l.map(t=>{let i=t;i=JSON.parse(JSON.stringify(i)),e.diagram.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:i})})}},function(e){return e.part.data,myDiagram.selection.count>0}),makeButton("----------",function(e,t){},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Zoom All",function(e,t){e.diagram.commandHandler.zoomToFit()},function(e){return!0}),makeButton("Zoom Selection",function(e,t){myDiagram.selection;let i=0,l=0,n=0,s=0,r=0,a=0;myDiagram.selection.each(function(e){0==i&&(i=e.actualBounds.x),0==l&&(l=e.actualBounds.y),0==r&&(r=e.actualBounds.width),0==a&&(a=e.actualBounds.height),n=i+r,s=l+a;let t=e.actualBounds.x;t<i&&(i=t);let d=e.actualBounds.y;d<l&&(l=d);let p=t+e.actualBounds.width,c=d+e.actualBounds.height;p>n&&(n=p),c>s&&(s=c),r=n-i,a=s-l});let d=new gojs__WEBPACK_IMPORTED_MODULE_2__.rw(i,l,r,a);myDiagram.zoomToRect(d)},function(e){return myDiagram.selection.count>0}),makeButton("Set Layout Scheme",function(e,t){let i=()=>[{value:"Circular",label:"Circular Layout"},{value:"Grid",label:"Grid Layout"},{value:"Tree",label:"Tree Layout"},{value:"ForceDirected",label:"ForceDirected Layout"},{value:"LayeredDigraph",label:"LayeredDigraph Layout"},{value:"Manual",label:"Manual Layout"}];i().map(e=>e&&e.label);let l={what:"selectDropdown",title:"Set Layout Scheme",case:"Set Layout Scheme",layoutList:i(),myDiagram:myDiagram};myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(myDiagram,l)},function(e){return!0}),makeButton("Do Layout",function(e,t){let i=myMetis.currentModelview;myDiagram.modelview=i;let l="",n=[];if("Modelling"===myMetis.modelType){var s;myDiagram.selection.each(function(e){let t=e.data;if(t.category===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.gojs.C_RELATIONSHIP){let e;let i=t.from,l=t.to;if(e=myDiagram.modelview.findRelationshipView(t.key)){let s=e.fromObjview,r=e.toObjview;t.points=[],t.from=i,t.to=l,myDiagram.model.setDataProperty(t,"points",[]),e.points=[],e.fromObjview=s,e.toObjview=r;let a=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.GI(e);n.push(a)}}}),i.clearRelviewPoints(),l=null===(s=myMetis.gojsModel.modelView)||void 0===s?void 0:s.layout}else"Metamodelling"===myMetis.modelType&&(l=myMetis.currentMetamodel.layout);setLayout(myDiagram,l);let r=myDiagram.nodes;for(let e=r.iterator;null==e?void 0:e.next();){let t=e.value.data,l=t.objectview;l||(l=i.findObjectView(t.objviewRef)),l&&(l.loc=t.loc)}n.map(t=>{let i=t;i=JSON.parse(JSON.stringify(i)),e.diagram.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:i})});let a={metis:new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.io(myMetis,!0)};a=JSON.parse(JSON.stringify(a)),myDiagram.dispatch({type:"LOAD_TOSTORE_PHDATA",data:a})},function(e){return!0}),makeButton("Save Layout",function(e,t){if("Metamodelling"===myMetis.modelType){let e=myMetis.currentMetamodel,t=myDiagram.nodes,i=[];for(let l=t.iterator;null==l?void 0:l.next();){let t=l.value.data,n=t.objecttype;if(n){let l=new _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_7__.Ah(_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.gj(),e,n,"","");l.setLoc(t.loc),l.setSize(t.size),l.setModified(),i.push(l)}}e.objtypegeos=i}else if("Modelling"===myMetis.modelType){let e=myMetis.currentModelview,t=myDiagram.nodes;for(let i=t.iterator;null==i?void 0:i.next();){let t=i.value.data,l=t.objectview;l||(l=e.findObjectView(t.objviewRef)),l&&(l.loc=t.loc)}}let i={metis:new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.io(myMetis,!0)};i=JSON.parse(JSON.stringify(i)),myDiagram.dispatch({type:"LOAD_TOSTORE_PHDATA",data:i})},function(e){return"Metamodelling"===myMetis.modelType||!0}),makeButton("Set Link Routing",function(e,t){let i=()=>[{value:"Normal",label:"Normal"},{value:"Orthogonal",label:"Orthogonal"},{value:"AvoidsNodes",label:"Avoids Nodes"}];i().map(e=>e&&e.label);let l={what:"selectDropdown",title:"Set Routing Scheme",case:"Set Routing Scheme",routingList:i(),myDiagram:myDiagram};myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(myDiagram,l)},function(e){return!0}),makeButton("Set Link Curve",function(e,t){let i=()=>[{value:"None",label:"None"},{value:"Bezier",label:"Bezier"},{value:"JumpOver",label:"Jump Over"},{value:"JumpGap",label:"Jump Gap"}];i().map(e=>e&&e.label);let l={what:"selectDropdown",title:"Set Link Curve",case:"Set Link Curve",curveList:i(),myDiagram:myDiagram};myMetis.myDiagram=myDiagram,myDiagram.handleOpenModal(myDiagram,l)},function(e){return!0}),makeButton("----------",function(e,t){},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Verify and Repair Model",function(e,t){let i=myMetis.currentModel,l=i.modelviews,n=myMetis.currentMetamodel;myDiagram.myGoModel=myMetis.gojsModel,_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.NQ(i,n,l,myDiagram,myMetis),alert("The current model has been repaired")},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("!!! PURGE DELETED !!!",function(e,t){confirm("Do you really want to permamently delete all instances marked as deleted?")&&_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.g3(myMetis,myDiagram)},function(e){return!0}),makeButton("----------",function(e,t){},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("New Metamodel",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.Bq(myMetis,myDiagram)},function(e){return"Metamodelling"!==myMetis.modelType&&!_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.Sy(myMetis)}),makeButton("Generate Metamodel",function(e,t){_akmm_ui_generateTypes__WEBPACK_IMPORTED_MODULE_15__.rG(t,myMetis,myDiagram)},function(e){return"Metamodelling"===myMetis.modelType||_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.Sy(myMetis),!1}),makeButton("Replace Current Metamodel",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.qF(myMetis,myDiagram)},function(e){return"Metamodelling"!==myMetis.modelType&&!_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.Sy(myMetis)}),makeButton("Add Metamodel",function(e,t){let i=!1;_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.QK(myMetis,myDiagram,i)},function(e){return!("Metamodelling"===myMetis.modelType||_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.Sy(myMetis))&&myMetis.metamodels.length>=2}),makeButton("Add Sub-Metamodel",function(e,t){let i=!0;_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.QK(myMetis,myDiagram,i)},function(e){return"Metamodelling"!==myMetis.modelType&&!_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.Sy(myMetis)}),makeButton("Delete Metamodel",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.my(myMetis,myDiagram)},function(e){if("Metamodelling"===myMetis.modelType||_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.Sy(myMetis))return!1;let t=0,i=myMetis.metamodels;for(let e=0;e<i.length;e++)!i[e].markedAsDeleted&&t++;return t>1}),makeButton("Clear Metamodel Content",function(e,t){_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_11__.iY(myMetis,myDiagram)},function(e){if("Metamodelling"===myMetis.modelType||_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.Sy(myMetis))return!1;let t=0,i=myMetis.metamodels;for(let e=0;e<i.length;e++)!i[e].markedAsDeleted&&t++;return t>1}),makeButton("Undo",function(e,t){e.diagram.commandHandler.undo()},function(e){return e.diagram.commandHandler.canUndo()}),makeButton("Redo",function(e,t){e.diagram.commandHandler.redo()},function(e){return e.diagram.commandHandler.canRedo()}),makeButton("Generate SVG",function(e,t){console.log(myDiagram.makeSvg({scale:1,maxSize:new gojs__WEBPACK_IMPORTED_MODULE_2__.or(NaN,NaN)}))},function(e){return myMetis.modelType,!1}),makeButton("Toggle Admin layer",function(e,t){_akmm_utilities__WEBPACK_IMPORTED_MODULE_16__.XR()},function(e){return myMetis.modelType,!1}),makeButton("Modelview nodes",function(e,t){let i=myModelview.objectviews;for(let e=0;e<(null==i?void 0:i.length);e++){let t=i[e],l=myMetis.gojsModel.findNodeByViewId(null==t?void 0:t.id);if(l)for(let e=myMetis.myDiagram.nodes;null==e?void 0:e.next();){let i=e.value,n=i.data;n.key===(null==t?void 0:t.id)&&console.log("300 ",null==t?void 0:t.name,"\n objview: ",t,"\n goNode: ",l,"\n n, data: ",i,n)}}console.log("333 goModel",myMetis.gojsModel)},function(e){return!0}),makeButton("Modelview links",function(e,t){let i=myModelview.relshipviews;for(let e=0;e<(null==i?void 0:i.length);e++){let t=i[e],l=myMetis.gojsModel.findLinkByViewId(t.id);if(l)for(let e=myDiagram.links;null==e?void 0:e.next();){let i=e.value,n=i.data;n.key===t.id&&console.log("310 ",t.name+" "+t.toObjview.name,"\n relview: ",t,"\n goLink: ",l,"\n link: ",i,n)}}},function(e){return!0}),makeButton("----------",function(e,t){},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Toggle Cardinality On/Off",function(e,t){let i=myMetis.currentModelview;void 0==i.showCardinality&&(i.showCardinality=!0),i.showCardinality=!i.showCardinality,i.showCardinality?alert("Cardinality on relationships WILL be shown!"):alert("Cardinality on relationships will NOT be shown!");let l=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.Yp(i),n=[];n.push(l),n.map(t=>{let i=t;i=JSON.parse(JSON.stringify(i)),e.diagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:i})})},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Toggle 'Include Relationship Kind' On/Off",function(e,t){let i=myMetis.currentModel,l=i.includeRelshipkind;i.includeRelshipkind=!l,i.includeRelshipkind?alert("Setting 'Relationship Kind' WILL be allowed!"):alert("Setting 'Relationship Kind' will NOT be allowed!");let n=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.bp(i,!0),s=[];s.push(n),s.map(t=>{let i=t;i=JSON.parse(JSON.stringify(i)),e.diagram.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:i})})},function(e){return!0}),makeButton("Toggle Show Relationship Names On/Off",function(e,t){let i=myMetis.currentModelview;void 0==i.showRelshipNames&&(i.showRelshipNames=!0),i.showRelshipNames=!i.showRelshipNames,i.showRelshipNames?alert("Relationship Names will be shown!"):alert("Relationship Names will NOT be shown!");let l=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.Yp(i),n=[];n.push(l),n.map(t=>{let i=t;i=JSON.parse(JSON.stringify(i)),e.diagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:i})})},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Toggle 'Ask for Relationship Name' On/Off",function(e,t){let i=myMetis.currentModelview;void 0==i.askForRelshipName&&(i.askForRelshipName=!1),i.askForRelshipName=!i.askForRelshipName,i.askForRelshipName?alert("Relationship names WILL be asked for!"):alert("Relationship names will NOT be asked for!");let l=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.Yp(i),n=[];n.push(l),n.map(t=>{let i=t;i=JSON.parse(JSON.stringify(i)),e.diagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:i})})},function(e){return!0}),makeButton("Toggle 'Include Inherited Relshiptypes' On/Off",function(e,t){let i=myMetis.currentModelview;void 0==i.includeInheritedReltypes&&(i.includeInheritedReltypes=!1),i.includeInheritedReltypes=!i.includeInheritedReltypes,i.includeInheritedReltypes?alert("Inherited Relationship types ARE included!"):alert("Inherited Relationship types are NOT included!");let l=new _akmm_ui_json__WEBPACK_IMPORTED_MODULE_9__.Yp(i),n=[];n.push(l),n.map(t=>{let i=t;i=JSON.parse(JSON.stringify(i)),e.diagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:i})})},function(e){return!0}),makeButton("Make Diagram",function(e,t){myDiagram.makeImage({scale:1,background:"AntiqueWhite",type:"image/jpeg"})},function(e){return!1}),makeButton("----------",function(e,t){},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Verify and Repair Metamodels",function(e,t){_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.Di(myMetis,myDiagram),alert("The metamodels have been repaired")},function(e){return"Metamodelling"!==myMetis.modelType}),makeButton("Verify and Repair myMetis",function(e,t){_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.Xi(myMetis,myDiagram),alert("myMetis has been repaired")},function(e){return!1}),makeButton("Clear RelationshipTypeViews",function(e,t){let i=myMetis.currentMetamodel;_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.ad(i,myDiagram,myMetis),alert("The relshiptypeviews has been cleared")},function(e){return"Metamodelling"===myMetis.modelType}));var linkTemplateMap=new gojs__WEBPACK_IMPORTED_MODULE_2__.T5;_akmm_ui_templates__WEBPACK_IMPORTED_MODULE_13__.zk(linkTemplateMap,linkContextMenu,myMetis),linkToLink&&myDiagram.linkTemplateMap.add("linkToLink",$("Link",{relinkableFrom:!1,relinkableTo:!1},$("Shape",{stroke:"#2D9945",strokeWidth:2})));var groupTemplateMap=new gojs__WEBPACK_IMPORTED_MODULE_2__.T5;_akmm_ui_templates__WEBPACK_IMPORTED_MODULE_13__.Kl(groupTemplateMap,partContextMenu,portContextMenu,myMetis);var nodeTemplateMap=new gojs__WEBPACK_IMPORTED_MODULE_2__.T5;_akmm_ui_templates__WEBPACK_IMPORTED_MODULE_13__.J9(nodeTemplateMap,partContextMenu,portContextMenu,myMetis),nodeTemplateMap.add("LinkLabel",$("Node",{selectable:!1,avoidable:!1,layerName:"Foreground"},$("Shape","Ellipse",{width:5,height:5,stroke:null,portId:"",fromLinkable:!0,toLinkable:!1,cursor:"pointer"}))),myDiagram.nodeTemplateMap=nodeTemplateMap,myDiagram.linkTemplateMap=linkTemplateMap,myDiagram.groupTemplateMap=groupTemplateMap,linkToLink&&(myDiagram.toolManager.linkingTool.archetypeLabelNodeData={category:"LinkLabel"});var paletteGroupTemplate1=$(gojs__WEBPACK_IMPORTED_MODULE_2__.YJ,"Auto",new gojs__WEBPACK_IMPORTED_MODULE_2__.Of("text","name"),$(gojs__WEBPACK_IMPORTED_MODULE_2__.yp,"Rectangle",{name:"SHAPE",fill:"lightyellow"}),$(gojs__WEBPACK_IMPORTED_MODULE_2__.Zk,"Vertical",$(gojs__WEBPACK_IMPORTED_MODULE_2__.Zk,"Table",{defaultRowSeparatorStroke:"black",maxSize:new gojs__WEBPACK_IMPORTED_MODULE_2__.or(150,999),margin:new gojs__WEBPACK_IMPORTED_MODULE_2__.R5(6,10,0,3),defaultAlignment:gojs__WEBPACK_IMPORTED_MODULE_2__.P1.Left},$(gojs__WEBPACK_IMPORTED_MODULE_2__.Gk,{column:2,width:4}),$(gojs__WEBPACK_IMPORTED_MODULE_2__.VJ,_akmm_ui_templates__WEBPACK_IMPORTED_MODULE_13__.XC(),{row:0,column:0,columnSpan:6,font:"12pt Segoe UI,sans-serif",editable:!0,isMultiline:!1,minSize:new gojs__WEBPACK_IMPORTED_MODULE_2__.or(10,16),name:"name"},new gojs__WEBPACK_IMPORTED_MODULE_2__.Of("text","name").makeTwoWay()))));function addSourceNode(e,t){for(let i=0;i<e.length;i++)if(e[i].key===t.data.key)return;let i={key:t.data.key,name:t.data.name,objid:t.data.objRef,objviewid:t.data.key,group:t.data.group,isGroup:t.data.isGroup,loc:new String(t.data.loc),scale:new String(t.scale),size:new String(t.data.size),template:t.data.template,figure:t.data.figure,geometry:t.data.geometry,fillcolor:t.data.fillcolor,fillcolor2:t.data.fillcolor2,strokecolor:t.data.strokecolor,strokecolor2:t.data.strokecolor2,textcolor:t.data.textcolor,strokewidth:t.data.strokewidth,textscale:t.data.textscale,icon:t.data.icon};if(e.push(i),t.data.isGroup)for(let i=t.memberParts.iterator;null==i?void 0:i.next();){let t=i.value;t instanceof gojs__WEBPACK_IMPORTED_MODULE_2__.bP&&t&&addSourceNode(e,t)}}function getSourceNode(e,t){for(let i=0;i<e.length;i++)if(e[i].key===t)return e[i];return null}function addSourceLink(e,t){let i={key:t.data.key,from:t.data.from,to:t.data.to,type:t.data.type,name:t.data.name,relid:t.data.relshipRef,relviewid:t.data.relviewRef,scale:new String(t.scale),template:t.data.template,strokecolor:t.data.strokecolor,strokewidth:t.data.strokewidth,textcolor:t.data.textcolor,strokewidth:t.data.strokewidth,textscale:t.data.textscale,arrowscale:t.data.arrowscale,fromArrow:t.data.fromArrow,toArrow:t.data.toArrow,fromArrowColor:t.data.fromArrowColor,toArrowColor:t.data.toArrowColor,dash:t.data.dash,routing:t.data.routing,corner:t.data.corner,curve:t.data.curve,points:t.data.points};e.push(i)}function getSourceLink(e,t){for(let i=0;i<e.length;i++)if(e[i].key===t)return e[i];return null}function setLayout(e,t){switch(t){case"Circular":e.layout=$(gojs__WEBPACK_IMPORTED_MODULE_2__.ke);break;case"Grid":e.layout=$(gojs__WEBPACK_IMPORTED_MODULE_2__.JT);break;case"Tree":e.layout=$(gojs__WEBPACK_IMPORTED_MODULE_2__.jg);break;case"ForceDirected":e.layout=$(gojs__WEBPACK_IMPORTED_MODULE_2__.Wn);break;case"LayeredDigraph":e.layout=$(gojs__WEBPACK_IMPORTED_MODULE_2__.St);break;case"Manual":e.layout.isInitial=!1,e.layout.isOngoing=!1}e.layoutDiagram()}function clearInstance(e){}function maybeChangeLinkCategory(e){var t,i;let l=e.subject,n=(null===(t=l.fromNode)||void 0===t?void 0:t.isLinkLabel)||(null===(i=l.toNode)||void 0===i?void 0:i.isLinkLabel);e.diagram.model.setCategoryForLinkData(l.data,n?"linkToLink":"")}function makeButton(e,t,i){return"function"!=typeof t&&(t=()=>{}),$("ContextMenuButton",$(gojs__WEBPACK_IMPORTED_MODULE_2__.VJ,e),{click:t},i?new gojs__WEBPACK_IMPORTED_MODULE_2__.Of("visible","",function(e,t){return!!e.diagram&&i(e,t)}).ofObject():{})}return myDiagram}render(){var e,t,i,l,n,s,r,a,d,p,c,u,h;let m,f,y,g;let v=!0,w=this.state.selectedData,b=this.myMetis,T=b.currentModel,j=T.metamodel,O=this.state.modalContext;w&&(w=b.removeClassInstances(w));let k=[{tabName:"Default"}];if((null==O?void 0:O.what)==="editObject"){let e=!1,t=!1,i=null===(p=this.state.selectedData)||void 0===p?void 0:p.objRef,l=this.myMetis.findObject(i),n=null===(c=this.state.selectedData)||void 0===c?void 0:c.objtypeRef,s=j.findObjectType(n),r=O.myContext.supertypes;(null==s?void 0:s.name)==="Method"&&(v=!0),(null==l?void 0:l.hasInheritedProperties(T))&&(e=!0,v=!0);let a=null==l?void 0:l.getConnectedObjects2(b);(null==a?void 0:a.length)>0&&(t=!0,v=!0);let d={myMetis:b,myModel:T,myMetamodel:j,objtype:s,supertypes:r,includeConnected:t,includeInherited:e},u=v?_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.a2(l,d,!0):[],h=null==l?void 0:l.getConnectedObjectRoles(b);k=[];for(let e=0;e<(null==u?void 0:u.length);e++){let t=u[e];if(t===_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.types.AKM_ELEMENT)continue;if(h&&h.length>0&&e>0){let i=h[e-1];i&&(t=i)}let i={tabName:t};k.push(i)}}if((null==O?void 0:O.what)==="editRelationship"){let e=!1,t=!1,i=null===(u=this.state.selectedData)||void 0===u?void 0:u.relshipRef;i||(i=null===(h=this.state.selectedData)||void 0===h?void 0:h.key);let l=this.myMetis.findRelationship(i);(null==l?void 0:l.hasInheritedProperties(T))&&(e=!0,v=!0);let n={myMetis:b,myModel:T,myMetamodel:j,includeConnected:t,includeInherited:e},s=v?_akmm_ui_common__WEBPACK_IMPORTED_MODULE_10__.a2(l,n,!0):[];k=[];for(let e=0;e<s.length;e++){let t={tabName:s[e]};k.push(t)}}switch(null==O?void 0:O.what){case"selectDropdown":let M,R="",{Option:A}=react_select__WEBPACK_IMPORTED_MODULE_21__.c,E=e=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(A,{...e,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("img",{className:"option-img mr-2",src:e.data.value}),e.data.label]}),D=e=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("img",{className:"option-img mr-2",src:e.data.value}),e.data.label]});if((null==O?void 0:O.title)==="Select Icon")R=this.state.modalContext.iconList.map(e=>({value:e.value.includes("//")?e.value:"./../images/"+e.value,label:e.label})),M={Option:E,SingleValue:D};else if((null==O?void 0:O.title)==="Set Layout Scheme"){let e;R=this.state.modalContext.layoutList.map(t=>(e="./../images/default.png",{value:t.value,label:t.label})),M={Option:E,SingleValue:D}}else if((null==O?void 0:O.title)==="Set Routing Scheme"){let e;R=this.state.modalContext.routingList.map(t=>(e="./../images/default.png",{value:t.value,label:t.label})),M={Option:E,SingleValue:D}}else if((null==O?void 0:O.title)==="Set Link Curve"){let e;R=this.state.modalContext.curveList.map(t=>(e="./../images/default.png",{value:t.value,label:t.label})),M={Option:E,SingleValue:D}}else if((null==O?void 0:O.title)==="Select Relationship Type"){let e;R=this.state.modalContext.args.typeNames.map(t=>(e="./../images/default.png",{value:t,label:t})),M={Option:E,SingleValue:D}}else R=this.state.selectedData.map(e=>e&&{label:e,value:e}),M=null;let{selectedOption:S}=this.state;S?S.value:R[0],f=O.title,m=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"modal-selection d-flex justify-content-center",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_select__WEBPACK_IMPORTED_MODULE_22__.Ay,{className:"modal-select",options:R,components:M,onChange:e=>this.handleSelectDropdownChange(e)})});break;case"editObjectType":case"editObject":case"editObjectview":f=O.title,y=w.category,null!==w&&null!=this.myMetis&&(m=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"modal-prop",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_SelectionInspector__WEBPACK_IMPORTED_MODULE_6__.E,{myMetis:b,selectedData:this.state.selectedData,context:this.state.modalContext,onInputChange:this.handleInputChange,activeTab:this.state.currentActiveTab})}));break;case"editRelationshipType":case"editRelationship":case"editRelshipview":case"editTypeview":f=O.title+":",y=this.state.selectedData.category,g=O.typename?"("+O.typename+")":"("+this.state.selectedData.name+")",null!==this.state.selectedData&&null!=this.myMetis&&(m=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"modal-prop",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_SelectionInspector__WEBPACK_IMPORTED_MODULE_6__.E,{myMetis:b,selectedData:this.state.selectedData,context:this.state.modalContext,onInputChange:this.handleInputChange,activeTab:this.state.currentActiveTab})}))}let N=e=>{this.state.currentActiveTab!==e&&this.setState({currentActiveTab:e})},P=k?k.map((e,t)=>{if(e){let i=null==e?void 0:e.tabName,l=t.toString();return this.state.currentActiveTab,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_23__.A,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_24__.A,{className:classnames__WEBPACK_IMPORTED_MODULE_5___default()({active:this.state.currentActiveTab===l}),onClick:()=>{N(l)},children:i})},l)}}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{}),C=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_25__.A,{tabs:!0,children:P}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_26__.A,{activeTab:this.state.currentActiveTab,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_27__.A,{tabId:this.state.currentActiveTab,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"bg-white mt-0 p-1 pt-2",children:m})})})]});return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"jsx-6510c67a7baba217",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(gojs_react__WEBPACK_IMPORTED_MODULE_3__.Vg,{ref:this.diagramRef,divClassName:"diagram-component",initDiagram:this.initDiagram,nodeDataArray:this.props.nodeDataArray,linkDataArray:this.props.linkDataArray,modelData:this.props.modelData,onModelChange:this.props.onModelChange,skipsDiagramUpdate:this.props.skipsDiagramUpdate,style:this.props.diagramStyle}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_28__.A,{isOpen:this.state.showModal,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"jsx-6510c67a7baba217 modal-content",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"jsx-6510c67a7baba217 modal-head px-2 ",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"jsx-6510c67a7baba217 d-flex p-1 ",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{className:"jsx-6510c67a7baba217 text-secondary w-100 pt-1",children:[f,":"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"jsx-6510c67a7baba217 ml-auto ",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_29__.A,{className:"modal-button btn-sm",onClick:()=>{this.handleCloseModal("x")},children:"x"})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(reactstrap__WEBPACK_IMPORTED_MODULE_30__.A,{className:"modal-header",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{className:"jsx-6510c67a7baba217 modal-name ml-2",children:[null===(e=this.state.selectedData)||void 0===e?void 0:e.name," "]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{className:"jsx-6510c67a7baba217 modal-objecttype",children:[" ",(null===(i=this.state.selectedData)||void 0===i?void 0:null===(t=i.objecttype)||void 0===t?void 0:t.name)?"(".concat(null===(n=this.state.selectedData)||void 0===n?void 0:null===(l=n.objecttype)||void 0===l?void 0:l.name,")"):(null===(r=this.state.selectedData)||void 0===r?void 0:null===(s=r.relshiptype)||void 0===s?void 0:s.name)?"(".concat(null===(d=this.state.selectedData)||void 0===d?void 0:null===(a=d.relshiptype)||void 0===a?void 0:a.name,")"):""]})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_31__.A,{className:"modal-body w-100",children:C}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_32__.A,{className:"modal-footer",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_29__.A,{className:"modal-button bg-link m-0 p-0",color:"link",onClick:()=>{this.handleCloseModal()},children:"Done"})})]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(styled_jsx_style__WEBPACK_IMPORTED_MODULE_1___default(),{id:"6510c67a7baba217",children:""})]})}constructor(e){super(e),this.handleSelectDropdownChange=e=>{let t=this.myMetis,i={myMetis:t,myMetamodel:t.currentMetamodel,myModel:t.currentModel,myModelview:t.currentModelview,myGoModel:t.gojsModel,myDiagram:t.myDiagram,modalContext:this.state.modalContext};_akmm_ui_modal__WEBPACK_IMPORTED_MODULE_12__.Gd(e,i)},this.exportSvg=()=>new Promise(e=>{let t=this.diagramRef.current.getDiagram();e(t?t.makeSvg({scale:.7}):null)}),this.myMetis=e.myMetis,this.myMetis.modelType=e.modelType,this.diagramRef=react__WEBPACK_IMPORTED_MODULE_4__.createRef(),this.state={nodeDataArray:this.props.nodeDataArray,linkDataArray:this.props.linkDataArray,showModal:!1,selectedData:null,modalContext:null,selectedOption:null,currentActiveTab:null,diagramStyle:e.diagramStyle,onExportSvgReady:e.onExportSvgReady},this.mapNodeKeyIdx=new Map,this.mapLinkKeyIdx=new Map,this.initDiagram=this.initDiagram.bind(this),this.handleOpenModal=this.handleOpenModal.bind(this),this.handleCloseModal=this.handleCloseModal.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleSelectDropdownChange=this.handleSelectDropdownChange.bind(this);let t=this.myMetis.findModelByName(_akmm_constants__WEBPACK_IMPORTED_MODULE_17__.admin.AKM_ADMIN_MODEL);this.myMetis.adminModel=t,this.myMetis.showAdminModel=!1}}},6671:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ku:()=>askForMethod,Oh:()=>getConnectedObjects,PR:()=>executeMethod,PZ:()=>aggregateValue,Y$:()=>calculateValue,j$:()=>getConnectedObject});var _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7089),_akmm_ui_gojs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(7662),_akmm_ui_common__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(2210),_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(6196),_ui_json__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(3022),_akmm_utilities__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2588);let debug=!1;function askForMethod(e){debug&&console.log("433 context",e);let t=e.currentObject.type,i=e.myDiagram,l={what:"selectDropdown",title:e.title,case:e.case,myDiagram:i,context:e},n=[],s=t.methods;for(let e=0;e<(null==s?void 0:s.length);e++){let t=s[e];t.markedAsDeleted||n.push(t)}let r=(n=[...new Set(n)]).map(e=>e&&e.nameId);debug&&console.log("452",r,l,e),i.handleOpenModal(r,l)}function executeMethod(e){if(e.traverseViews&&e.currentObjectview){let t=e.objectviews;e.objectviews||(e.objectviews=[]),e.relshipviews||(e.relshipviews=[]),(null==t?void 0:t.length)>50||traverseViews(e.currentObjectview,e)}else if(!e.traverseViews&&e.currentObject){let t=e.objects;if(e.objects||(e.objects=[]),e.relships||(e.relships=[]),(null==t?void 0:t.length)>50)return;traverse(e.currentObject,e)}}function execMethod(e,t){let i=t.myDiagram.nodes,l=[],n=[],s=[],r=[];for(let a=i.iterator;null==a?void 0:a.next();){let i=a.value,d=i.data.object,p=null==d?void 0:d.id;if(p||(p=i.data.objectRef),p==e.id)switch(t.action){case"Highlight":i.isHighlighted=!0;break;case"Select":i.isSelected=!0;break;case"deleteView":deleteView(i.data.objectview,l,n,t);break;case"deleteObject":deleteObject(e,s,r,t);break;case"addConnectedObject":addConnectedObject(e,t)}}}function traverse(e,t){let i;let l=t.args.method;if(!l)return!1;let n=!0,s=t.myMetis,r=t.myMetamodel;t.myModelview;let a=t.objects,d=t.relships,p=l.reldir;l.objtypes;let c=l.reltypes,u=l.preaction,h=l.postaction;if(t.level,conditionIsFulfilled(e,t)&&u&&(t.level++,t.mode="preaction",t.action=u,execMethod(e,t)),c){let e=c.split(",")[0];try{i=r.findRelationshipTypeByName(e)}catch(t){i=s.findRelationshipTypeByName(e)}}let m="in"===p,f="out"===p,y=!m&&!f,g=[];if(m&&e.inputrels&&(g=e.inputrels),f&&e.outputrels&&(g=e.outputrels),y&&(g=(g=e.inputrels)?g.concat(e.outputrels):e.outputrels),g){debug&&console.log("226 rels",g);let r=!1;for(let p=0;p<g.length;p++){let c=g[p];if(!c||i&&(null==c?void 0:c.type.id)!==(null==i?void 0:i.id))continue;for(let e=0;e<d.length;e++){let t=d[e];if(c.id===t.id){r=!0;break}}r||d.push(c);let u=c.fromObject;u||(u=s.findObject(c.fromObjectRef));let v=c.toObject;v||(v=s.findObject(c.toObjectRef)),(m||y)&&v.id===e.id?v=c.fromObject:(f||y)&&u.id===e.id&&(v=c.toObject);let w=!1;if(v){for(let e=0;e<a.length;e++)if(a[e].id===v.id){w=!0;break}}!w&&v&&(a.push(v),l.level++,n=traverse(v,t),l.noLevels--,conditionIsFulfilled(v,t)&&h&&(t.mode="postaction",t.action=h,execMethod(v,t)))}}return n}function traverseViews(e,t){let i;let l=t.args.method;if(!l)return!1;let n=!0,s=t.myMetis,r=t.myMetamodel,a=t.myCurrentModelview;t.myGoModel,t.objects,t.relships;let d=a.objectviews;t.relshipviews;let p=l.reldir;l.objtypes;let c=l.reltypes,u=l.preaction,h=l.postaction,m=parseInt(t.nolevels);if(t.level,conditionIsFulfilled(e.object,t)&&u&&(t.level++,t.mode="preaction",t.action=u,execMethod(e.object,t)),c){let e=c.split(",")[0];try{i=r.findRelationshipTypeByName(e)}catch(t){i=s.findRelationshipTypeByName(e)}}let f="in"===p,y="out"===p,g=!f&&!y,v=[];if(f&&e.inputrelviews&&(v=e.inputrelviews),y&&e.outputrelviews&&(v=e.outputrelviews),g&&(v=(v=e.inputrelviews)?v.concat(e.outputrelviews):e.outputrelviews),v){debug&&console.log("226 rels",rels);let l=!1;for(let s=0;s<v.length;s++){var w,b,T;let r;let a=v[s];if(!a||i&&(null===(b=a.relship)||void 0===b?void 0:null===(w=b.type)||void 0===w?void 0:w.name)!==reltypename)continue;for(let e=0;e<v.length;e++){let t=v[e];if(a.id===t.id){l=!0;break}}l||v.push(a),(f||g)&&(null===(T=a.toObjview)||void 0===T?void 0:T.id)===e.id?r=a.fromObjview:(y||g)&&a.fromObjview.id===e.id&&(r=a.toObjview);let p=!1;if(r){for(let e=0;e<d.length;e++)if(d[e].id===r.id){p=!0;break}}!p&&r&&d.push(r),t.level<m&&(t.level++,n=traverseViews(r,t),t.level--,conditionIsFulfilled(r.object,t)&&h&&(t.mode="postaction",t.action=h,execMethod(r.object,t)))}}return n}function conditionIsFulfilled(object,context){let retval=!0,myMetis=context.myMetis,myMetamodel=context.myMetamodel,method=context.args.method,objtypecondition=method.objtypes,reltypecondition=method.reltypes,valuecondition=method.valuecondition,objtype=objtypecondition?myMetamodel.findObjectTypeByName(objtypecondition):null,otype=null==object?void 0:object.type;if(objtype&&otype&&otype.id!==objtype.id&&(retval=!1),retval&&valuecondition){let expression=substitutePropnamesInExpression(object,valuecondition,myMetis);try{retval=eval(expression)}catch(e){e instanceof SyntaxError&&alert(e.message),retval=!1}}return retval}function hasChildren(e,t){let i=!1,l=t.reltypes,n=l?l.split(",")[0]:null,s=n?t.myMetamodel.findRelationshipTypeByName(n):null,r="in"===t.reldir?e.inputrels:e.outputrels;for(let e=0;e<(null==r?void 0:r.length);e++){let t=r[e];if(!s||(null==t?void 0:t.type.id)==s.id){i=!0;break}}return i}function getChildren(e,t){let i=[],l=t.reltypes,n=l?l.split(",")[0]:null,s=n?t.myMetamodel.findRelationshipTypeByName(n):null,r=t.reldir,a=t.objtypes,d=a?a.split(",")[0]:null,p=d?t.myMetamodel.findObjectTypeByName(d):null,c=!!r&&"in"===r,u=c?e.inputrels:e.outputrels;if(u||(u=e.inputrels),u){let t=e.outputrels;t&&u.concat(t)}else u=e.outputrels;if(u)for(let e=0;e<(null==u?void 0:u.length);e++){let t;let l=u[e];if(s){var h;if((null==l?void 0:null===(h=l.type)||void 0===h?void 0:h.name)!==(null==s?void 0:s.name))continue}t=c?l.fromObject:l.toObject,debug&&console.log("403 child",t),t&&(p?t.type.name===d&&i.push(t):i.push(t))}return i}function expandPropScript(object,prop,myMetis){let retval="";if(!prop)return retval;let pi=3.14159265,mtd=prop.method;mtd||(mtd=myMetis.findMethod(prop.methodRef));let dtype=prop.datatype;dtype||(dtype=myMetis.findDatatype(prop.datatypeRef));let expression=null==mtd?void 0:mtd.expression;if(expression){let type=object.type;expression=substitutePropnamesInExpression(object,expression,myMetis),debug&&console.log("455 expression",expression);try{if("now"===expression){if((null==dtype?void 0:dtype.name)==="date"){let d=new Date,year=d.getFullYear(),month=d.getMonth()+1;month<10&&(month="0"+month);let day=d.getDate();day<10&&(day="0"+day),retval=year+"-"+month+"-"+day}else(null==dtype?void 0:dtype.name)==="time"&&(retval=new Date().getTime())}else retval=eval(expression);retval||(retval=expression)}catch(e){retval=expression}debug&&console.log("464 retval",retval)}else retval=object[prop.name],debug&&console.log("467 retval",retval);return retval}function substitutePropnamesInExpression(e,t,i){let l=e.type.properties;debug&&console.log("472 props",l);for(let n=0;n<l.length;n++){let s=l[n];if(-1==t.indexOf(s.name)){debug&&console.log("475 expression, prop",t,s);continue}debug&&console.log("478 prop",s);let r=s.name.length,a=e.getPropertyValue(s,i),d=[],p=0,c=0,u=0,h=0;d.push(p);for(let e=0;e<t.length&&-1!=(c=t.substring(h).indexOf(s.name));e++)0==e?p=c:p+=c+1,u+=c+1,d.push(p),h=p+1;debug&&console.log("500 pos",d);let m=d.length;debug&&console.log("503 siz",m);for(let e=m-1;e>0;e--){let i=d[e]+r,l=t.substring(i);t=t.substring(0,d[e])+a+l}}return debug&&console.log("511 expression",t),t}function calculateValue(e,t){let i;let l=t.myMetis,n=expandPropScript(e,t.prop,l);return _akmm_utilities__WEBPACK_IMPORTED_MODULE_5__.kf(n)?Number(n):n}function aggregateValue(e,t){let i=0,l=getChildren(e,t);for(let e=0;e<(null==l?void 0:l.length);e++){let n;let s=l[e];i+=Number(n=hasChildren(s,t)?aggregateValue(s,t):calculateValue(s,t))}return i}function getConnectedObject(e,t){let i=t.myMetis,l=t.prop,n=getChildren(e,t);debug&&console.log("431 children",n);for(let e=0;e<(null==n?void 0:n.length);e++){let t=n[e],s=expandPropScript(t,l,i);if(debug&&console.log("435 test, child, prop",s,t,l),s)return t}return null}function getConnectedObjects(e,t){let i=t.myMetis,l=t.prop,n=[],s=getChildren(e,t);debug&&console.log("431 children",s);for(let e=0;e<(null==s?void 0:s.length);e++){let t=s[e],r=expandPropScript(t,l,i);debug&&console.log("435 test, child, prop",r,t,l),r&&n.push(t)}return n}function addConnectedObject(e,t){let i=t.args.method;if(1>parseInt(i.nolevels))return;let l=t.myMetis,n=t.myGoModel,s=t.myDiagram,r=t.myMetamodel;t.myModel;let a=t.myModelview,d=i.reldir,p=i.objtypes,c=i.reltypes,u=[],h=[],m=[],f=p?p.split(",")[0]:null,y=f?r.findObjectTypeByName(f):null,g=c?c.split(",")[0]:null,v=g?r.findRelationshipTypeByName(g):null,w="in"===d,b="out"===d,T=!w&&!b,j=[];if(w&&e.inputrels&&(j=e.inputrels),b&&e.outputrels&&(j=e.outputrels),T&&(j=(j=e.inputrels)?j.concat(e.outputrels):e.outputrels),j)for(let t=0;t<j.length;t++){let i,r,d,p,c=j[t];if(c){if(c=l.findRelationship(c.id),v&&(null==c?void 0:c.type.name)!==g||(w||T)&&c.fromObject.id===e.id&&(i=c.fromObject,d=c.toObject,y&&i.type.name!==f)||(b||T)&&c.toObject.id===e.id&&(i=c.fromObject,d=c.toObject,y&&d.type.name!==f))continue;if(i&&d){if(!(r=a.findObjectViewByName(i.name))){r=new _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_0__.wN(_akmm_utilities__WEBPACK_IMPORTED_MODULE_5__.gj(),i.name,i,"",a);let e=new _akmm_ui_gojs__WEBPACK_IMPORTED_MODULE_1__.mC(r.id,n,r);n.addNode(e),a.addObjectView(r);let t=i.type.getDefaultTypeView();_akmm_ui_common__WEBPACK_IMPORTED_MODULE_2__.vn(e,t,s,n),s.model.addNodeData(e),m.push(r);let l=new _ui_json__WEBPACK_IMPORTED_MODULE_4__.g_(r);u.push(l)}if(!(p=a.findObjectViewByName(d.name))){p=new _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_0__.wN(_akmm_utilities__WEBPACK_IMPORTED_MODULE_5__.gj(),d.name,d,"",a);let e=new _akmm_ui_gojs__WEBPACK_IMPORTED_MODULE_1__.mC(p.id,n,p);n.addNode(e),a.addObjectView(p);let t=d.type.getDefaultTypeView();_akmm_ui_common__WEBPACK_IMPORTED_MODULE_2__.vn(e,t,s,n),s.model.addNodeData(e),m.push(p);let i=new _ui_json__WEBPACK_IMPORTED_MODULE_4__.g_(p);u.push(i)}let e=a.findRelationshipViewsByRel(c);if(0==e.length){var O;let t=new _akmm_metamodeller__WEBPACK_IMPORTED_MODULE_0__.Zc(_akmm_utilities__WEBPACK_IMPORTED_MODULE_5__.gj(),c.name,c,"");t.fromObjview=r,t.toObjview=p,e.push(t);let i=new _ui_json__WEBPACK_IMPORTED_MODULE_4__.GI(t);h.push(i);let l=new _akmm_ui_gojs__WEBPACK_IMPORTED_MODULE_1__.gR(_akmm_utilities__WEBPACK_IMPORTED_MODULE_5__.gj(),n,t);l.loadLinkContent(n),l.fromNode=_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_3__.Sr(r.id,s),l.from=null===(O=l.fromNode)||void 0===O?void 0:O.key,n.addLink(l),s.model.addLinkData(l)}s.requestUpdate()}}}u.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),s.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})}),h.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),s.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})})}function deleteObject(e,t,i,l){e.markedAsDeleted=!0;let n=new _ui_json__WEBPACK_IMPORTED_MODULE_4__.pJ(e);t.push(n);let s=e.outputrels;if(s)for(let e=0;e<s.length;e++){let t=s[e];t.markedAsDeleted=!0;let l=new _ui_json__WEBPACK_IMPORTED_MODULE_4__.w(t);i.push(l)}}function deleteView(e,t,i,l){let n=l.myDiagram;e.markedAsDeleted=!0;let s=new _ui_json__WEBPACK_IMPORTED_MODULE_4__.g_(e);t.push(s);let r=e.outputrelviews;if(r)for(let e=0;e<r.length;e++){let t=r[e];t.markedAsDeleted=!0;let l=new _ui_json__WEBPACK_IMPORTED_MODULE_4__.GI(t);i.push(l);let s=_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_3__.av(t.id,n);s&&n.model.removeLinkData(s)}let a=_akmm_ui_diagram__WEBPACK_IMPORTED_MODULE_3__.Sr(e.id,n);a&&n.model.removeNodeData(a)}function generateosduId(e){let t;let i=e.myObject,l=e.myDiagram,n=e.myModel,s=e.args.method,r=s.reltype,a=n.metamodel.findRelationshipTypesByName(r),d="in"===s.reldir,p=d?i.outputrels:i.inputrels;if(p)for(let e=0;e<p.length;e++){let i=p[e];for(let e=0;e<a.length;e++){let l=a[e];if((null==i?void 0:i.type.name)===(null==l?void 0:l.name)){t=d?i.toObject:i.fromObject;break}}}let c="";t&&(c=t.getStringValue2(s.propname));let u=i.name;c&&c.length>0&&(u=c+"|"+i.name),i.setStringValue2(s.propname,u);let h=new _ui_json__WEBPACK_IMPORTED_MODULE_4__.pJ(i),m=[];m.push(h),null==m||m.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),l.dispatch({type:"UPDATE_OBJECT_PROPERTIES",data:t})})}},7089:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$$:()=>cxObjectType,$s:()=>cxProperty,Ah:()=>cxObjtypeGeo,CK:()=>cxRelationship,Cj:()=>cxObjtypeviewData,DM:()=>cxModel,E7:()=>cxMetaModel,Fu:()=>cxRelationshipTypeView,GC:()=>cxObjectTypeView,Jo:()=>cxObject,KU:()=>cxMetis,MX:()=>cxRelationshipType,Rb:()=>cxMethodType,T6:()=>cxCollectionOfViews,Y9:()=>cxIdent,Zc:()=>cxRelationshipView,_6:()=>cxViewStyle,it:()=>cxModelView,k2:()=>cxNode,pF:()=>cxMethod,qx:()=>cxDatatype,wN:()=>cxObjectView});var _ui_methods__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6671),_utilities__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2588),_constants__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1457);let debug=!1;class cxMetis{importData(e,t){this.name=e.name,this.description=e.description,this.initImport(e,t);let i=e&&e.projects;if(i&&i.length)for(let e=0;e<i.length;e++){let t=i[e];t&&this.importProject(t)}let l=e&&e.metamodels,n=l.length;if(l&&l.length>0){for(let e=n-1;e>=0;e--){let t=l[e];t&&t.name!==_constants__WEBPACK_IMPORTED_MODULE_2__.core.AKM_CORE_MM&&t&&t.id&&(this.importMetamodel(t),this.addMetamodel(t))}for(let e=n-1;e>=0;e--){let t=l[e];t&&t.name===_constants__WEBPACK_IMPORTED_MODULE_2__.core.AKM_CORE_MM&&t&&t.id&&(this.importMetamodel(t),this.addMetamodel(t),this.coreMetamodel=t)}}let s=e&&e.viewstyles;s&&s.length&&s.forEach(e=>{e&&!e.markedAsDeleted&&this.importViewStyle(e,null)});let r=e&&e.geometries;r&&r.length&&r.forEach(e=>{e&&!e.markedAsDeleted&&this.importGeometry(e,null)});let a=e&&e.models;a&&a.length&&a.forEach(e=>{e&&!e.markedAsDeleted&&this.importModel(e)});let d=e.metamodels;if(d&&d.length&&d.forEach(e=>{let t=e.subModels;if(t&&t.length)t.forEach(t=>{let i=this.findSubModel(t.id);if(i){let t=this.findMetamodel(e.id);t&&t.addSubModel(i)}});else{let t=e.subModelRefs;t&&t.length&&t.forEach(t=>{let i=this.findModel(t);i&&this.findMetamodel(e.id).addSubModel(i)})}}),e.currentProjectRef){let t=this.findProject(e.currentProjectRef);t&&(this.currentProject=t)}if(e.currentMetamodelRef){let t=this.findMetamodel(e.currentMetamodelRef);t&&(this.currentMetamodel=t,this.currentMetamodelRef=t.id)}if(e.currentModelRef){let t=this.findModel(e.currentModelRef);t&&(this.currentModel=t,this.currentModelRef=t.id)}if(e.currentModelviewRef){let t=this.findModelView(e.currentModelviewRef);t&&(this.currentModelview=t,this.currentModelviewRef=t.id)}if(e.currentTemplateModelRef){let t=this.findModel(e.currentTemplateModelRef);t&&this.setCurrentTemplateModel(t)}if(e.currentTargetMetamodelRef){let t=this.findMetamodel(e.currentTargetMetamodelRef);t&&this.setCurrentTargetMetamodel(t)}if(e.currentTargetModelRef){let t=this.findModel(e.currentTargetModelRef);t&&this.setCurrentTargetModel(t)}if(e.currentModelviewRef){let t=this.findModelView(e.currentTargetModelviewRef);t&&(this.currentTargetModelview=t)}if(e.currentTaskModelRef){let t=this.findModel(e.currentTaskModelRef);t&&this.setCurrentTaskModel(t)}debug&&console.log("211 this",this);let p=this.objecttypes;for(let e=0;e<(null==p?void 0:p.length);e++){let t=p[e],i=t.findSupertypes(0);for(let e=0;e<(null==i?void 0:i.length);e++){let l=i[e];t.addSupertype(l)}}let c=this.objecttypeviews;for(let e=0;e<(null==c?void 0:c.length);e++){let t=c[e];if(t&&t.name===t.id){let e=this.findObjectType(t.typeRef);e&&(t.name=e.name)}}d=this.metamodels;let u=this.relshiptypes;for(let e=0;e<(null==u?void 0:u.length);e++){let t=u[e],i=t.findSupertypes(0);for(let e=0;e<(null==i?void 0:i.length);e++){let l=i[e];t.addSupertype(l)}}let h=null,m=this.findRelationshipTypeByName(_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ANNOTATES);if(m){var f;let e=this.findRelationshipTypeView(null===(f=m.typeview)||void 0===f?void 0:f.id);e&&(h=e)}for(let e=0;e<(null==d?void 0:d.length);e++){let t=d[e].relshiptypes;for(let e=0;e<(null==t?void 0:t.length);e++){let i=t[e];"annotates"===i.name&&(i.typeview=h)}}}initImport(e,t){this.allowGenerateCurrentMetamodel=e.allowGenerateCurrentMetamodel,debug&&console.log("304 importedData",e);let i=e&&e.metamodels,l=[],n=i.length;if(i&&i.length)for(let e=n-1;e>=0;e--){let n=i[e];if(n&&n.id&&(t||!n.markedAsDeleted)){let e=n&&new cxMetaModel(n.id,n.name,n.description);e.markedAsDeleted=null==n?void 0:n.markedAsDeleted,e.layout=n.layout,e.routing=n.routing,e.linkcurve=n.linkcurve,e.generatedFromModelRef=n.generatedFromModelRef,e.includeInheritedReltypes=n.includeInheritedReltypes,this.addMetamodel(e);let i=n.subModels;if(i&&i.length)for(let l=0;l<i.length;l++){let n=i[l];if(t||!n.markedAsDeleted){let t=new cxModel(n.id,n.name,n.description);e.addSubModel(t),this.addSubModel(t)}}if((i=n.datatypes)&&i.length)for(let l=0;l<i.length;l++){let n=i[l];if("today"!==n.name&&(t||!n.markedAsDeleted)){let t=new cxDatatype(n.id,n.name,n.description);"time"===t.name&&(t.fieldType="time"),e.addDatatype(t),this.addDatatype(t)}}if((i=n.properties)&&i.length)for(let l=0;l<i.length;l++){let n=i[l];if(t||!n.markedAsDeleted){let t=new cxProperty(n.id,n.name,n.description);t.datatypeRef=n.datatypeRef,e.addProperty(t),this.addProperty(t)}}if((i=n.methodtypes)&&i.length)for(let l=0;l<i.length;l++){let n=i[l];if(t||!n.markedAsDeleted){let t=new cxMethodType(n.id,n.name,n.description);e.addMethodType(t),this.addMethodType(t)}}if((i=n.methods)&&i.length)for(let l=0;l<i.length;l++){let n=i[l];if(t||!n.markedAsDeleted){let t=new cxMethod(n.id,n.name,n.description);if(!t)continue;t.methodtype=n.methodtype,t.expression=n.expression,e.addMethod(t),this.addMethod(t)}}if((i=n.objecttypes)&&i.length)for(let l=0;l<i.length;l++){let n=i[l];if(t||!n.markedAsDeleted){let t=new cxObjectType(n.id,n.name,n.description);if(!t)continue;e.addObjectType(t),this.addObjectType(t),debug&&console.log("183 otype",t)}}if((i=n.objtypegeos)&&i.length)for(let l=0;l<i.length;l++){let n=i[l];if(t||!n.markedAsDeleted){let t=new cxObjtypeGeo(n.id,null,null,"","");if(!t)continue;e.addObjtypeGeo(t),this.addObjtypeGeo(t)}}if((i=n.objecttypeviews)&&i.length)for(let l=0;l<i.length;l++){let n=i[l];if(t||!n.markedAsDeleted){let t=new cxObjectTypeView(n.id,n.name,null,n.description);if(!t)continue;e.addObjectTypeView(t),this.addObjectTypeView(t)}}if((i=n.relshiptypes)&&i.length)for(let l=0;l<i.length;l++){let n=i[l];if(t||!n.markedAsDeleted){let t=new cxRelationshipType(n.id,n.name,null,null,n.description);if(!t)continue;e.addRelationshipType(t),this.addRelationshipType(t)}}if(e.relshiptypeviews=[],(i=n.relshiptypeviews)&&i.sort(_utilities__WEBPACK_IMPORTED_MODULE_1__.UD),i&&i.length){for(let e=0;e<i.length;e++){let t=i[e],l=n[e+1];if((null==l?void 0:l.name)===t.name&&(null==l?void 0:l.typeRef)===t.typeRef){t.markedAsDeleted=!0;continue}}for(let l=0;l<i.length;l++){let n=i[l];if(t||!n.markedAsDeleted){let t=new cxRelationshipTypeView(n.id,n.name,null,n.description);if(!t)continue;e.addRelationshipTypeView(t),this.addRelationshipTypeView(t)}}}if((i=n.viewstyles)&&i.length)for(let l=0;l<i.length;l++){let n=i[l];if(t||!n.markedAsDeleted){let t=new cxViewStyle(n.id,n.name,n.description);if(!t)continue;e.addViewStyle(t),this.addViewStyle(t)}}if((i=n.geometries)&&i.length)for(let l=0;l<i.length;l++){let n=i[l];if(t||!n.markedAsDeleted){let t=new cxGeometry(n.id,n.name,n.description);if(!t)continue;e.addGeometry(t),this.addGeometry(t)}}l.push(e)}}this.metamodels=l,debug&&console.log("471 metamodels, mmodels",i,l);let s=e&&e.models;if(s&&s.length)for(let i=0;i<s.length;i++){let l=s[i],n=new cxModel(l.id,l.name,null,l.description);this.addModel(n);let r=e&&e.models;if(r&&r.length)for(let e=0;e<r.length;e++){let i=r[e];if(t||!i.markedAsDeleted){let e=new cxModel(i.id,i.name,null,i.description);if(!e)continue;this.addModel(e);let l=i.objects;if(l&&l.length)for(let i=0;i<l.length;i++){let n=l[i];if(n&&(t||!n.markedAsDeleted)){let t=new cxObject(n.id,n.name,null,n.description);if(!t)continue;for(let e in n)t[e]=n[e];e.addObject(t),this.addObject(t)}}let n=i.relships;if(n&&n.length)for(let i=0;i<n.length;i++){let l=n[i];if(l&&(t||!l.markedAsDeleted)){let t=new cxRelationship(l.id,null,null,null,l.name,l.description);if(!t)continue;for(let e in l)t[e]=l[e];e.addRelationship(t),this.addRelationship(t)}}let s=i.modelviews;if(s&&s.length)for(let i=0;i<s.length;i++){let l=s[i];if(t||!l.markedAsDeleted){debug&&console.log("237 initImport",l);let i=new cxModelView(l.id,l.name,null,l.description);if(!i)continue;i.layout=l.layout,i.routing=l.routing,i.linkcurve=l.linkcurve,i.showCardinality=l.showCardinality,i.showRelshipNames=l.showRelshipNames,i.askForRelshipName=l.askForRelshipName,i.includeInheritedReltypes=l.includeInheritedReltypes,e.addModelView(i),this.addModelView(i),i.setModel(e);let n=l.objectviews;if(n&&n.length)for(let e=0;e<n.length;e++){let l=n[e];if(t||!l.markedAsDeleted){let e=new cxObjectView(l.id,l.name,null,l.description);if(e.markedAsDeleted=l.markedAsDeleted,!e)continue;i.addObjectView(e),this.addObjectView(e)}}if((n=l.relshipviews)&&n.length)for(let e=0;e<n.length;e++){let l=n[e];if(l&&(t||!l.markedAsDeleted)){let e=new cxRelationshipView(l.id,l.name,null,l.description);if(!e)continue;i.addRelationshipView(e),this.addRelationshipView(e)}}}}}}}}importProject(e){let t=e.id,i=this.findProject(t);if(debug&&console.log("360 item",e),i){for(let t in e)i[t]=e[t];debug&&console.log("365 project",i)}}importViewStyle(e,t){let i=this.findViewStyle(e.id);if(debug&&console.log("392 item",e),!i)return;let l=e.objecttypeviews;l&&l.length&&l.forEach(e=>{e&&this.importObjectTypeView(e,i)}),debug&&console.log("402 this",this);let n=e.relshiptypeviews;n&&n.length&&n.forEach(e=>{e&&"undefined_undefined"!==e.name&&this.importRelshipTypeView(e,i)}),this.addViewStyle(i),t&&t.addViewStyle(i),debug&&console.log("412 viewstyle",i)}importGeometry(e,t){let i=this.findGeometry(e.id);debug&&console.log("491 item",e),i&&(this.addGeometry(i),t&&t.addGeometry(i),debug&&console.log("496 geometry",i))}importMetamodel(e){var t,i;let l=this.findMetamodel(e.id);if(!l)return;let n=e.datatypes;n&&n.length&&n.forEach(e=>{e&&this.importDatatype(e,l)});let s=e.properties;s&&s.length&&s.forEach(e=>{e&&this.importProperty(e,l)});let r=e.methodtypes;r&&r.length&&r.forEach(e=>{e&&this.importMethodType(e,l)});let a=e.methods;a&&a.length&&a.forEach(e=>{e&&this.importMethod(e,l)});let d=e.viewstyles;d&&d.length&&d.forEach(e=>{e&&this.importViewStyle(e,l)});let p=e.geometries;p&&p.length&&p.forEach(e=>{e&&this.importGeometry(e,l)}),debug&&console.log("666 this",this);let c=e.objecttypes;c&&c.length&&c.forEach(e=>{if(e){this.importObjectType(e,l);let t=this.findObjectType(e.id);t.removeDuplicateProperties(),t.methods.forEach(e=>{let i=this.findMethod(e.id);t.addMethod(i)})}});let u=e.objecttypes0;u&&u.length&&u.forEach(e=>{if(e){let t=this.findObjectType(e.id);t||this.addObjectType(e),l.addObjectType0(t)}});let h=e.objtypegeos;h&&h.length&&(h.forEach(e=>{e&&this.importObjectTypegeo(e,l)}),l.purgeObjtypeGeos());let m=e.objecttypeviews;m&&m.length&&m.forEach(e=>{e&&this.importObjectTypeView(e,l)});let f=e.relshiptypes;f&&f.length&&f.forEach(e=>{debug&&console.log("371 reltype",e),e&&this.importRelshipType(e,l)});let y=e.relshiptypes0;y&&y.length&&y.forEach(e=>{let t=this.findRelationshipType(null==e?void 0:e.id);t&&t.name!==_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_RELSHIP_TYPE&&t.name!==_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_IS&&(t||this.addRelationshipType(e),l.addRelationshipType0(t))});let g=e.relshiptypeviews;g&&g.length&&g.forEach(e=>{e&&"undefined_undefined"!==e.name&&this.importRelshipTypeView(e,l)});let v=l.relshiptypeviews;v.sort(_utilities__WEBPACK_IMPORTED_MODULE_1__.UD);for(let e=0;e<v.length;e++){let t=v[e],i=v[e+1];(null==i?void 0:i.name)===t.name&&(null==i?void 0:i.typeRef)===t.typeRef&&(t.markedAsDeleted=!0)}for(let e=0;e<(null===(t=this.metamodels)||void 0===t?void 0:t.length);e++){let t=this.metamodels[e].relshiptypes;for(let e=0;e<(null==t?void 0:t.length);e++){let i=t[e],l=this.findRelationshipType(i.id);l&&l.typeview&&(i.typeview=l.typeview)}}{let e=l.relshiptypeviews,t=null===(i=l.relshiptypeviews)||void 0===i?void 0:i.length;for(let i=t-1;i>=0;i--)e[i].markedAsDeleted&&e.splice(i,1)}l.includeInheritedReltypes=e.includeInheritedReltypes,l.includeSystemtypes=e.includeSystemtypes;let w=e.metamodelRefs;w&&w.length&&w.forEach(e=>{if(e){let t=this.findMetamodel(e);t&&l.addMetamodel(t)}});let b=e.subMetamodelRefs;b&&b.length&&b.forEach(e=>{e&&l.addSubMetamodelRef(e)});let T=e.subModelRefs;T&&T.length&&T.forEach(e=>{if(e){let t=this.findModel(e);t&&l.addSubModel(t)}})}importDatatype(e,t){let i=e.id,l=this.findDatatype(i);if(debug&&console.log("412 item",e),l){for(let t in e)l[t]=e[t];debug&&console.log("417 datatype",l),t.addDatatype(l)}}importObjectType(e,t){let i=this.findObjectType(e.id);if(i||(i=new cxObjectType(e.id,e.name,e.description)),i){i.markedAsDeleted=e.markedAsDeleted;let l=i;for(let t in e)l[t]=e[t];if(i=l,e.typeviewRef){let l=this.findObjectTypeView(e.typeviewRef);i&&l&&i.setDefaultTypeView(l),l&&t.addObjectTypeView(l)}i&&(t.addObjectType(i),this.addObjectType(i));let n=e.properties;n&&n.length&&n.forEach(e=>{let i=e;i&&this.importProperty(i,t)}),i.attributes=[];let s=i.properties;s&&s.length&&s.forEach(e=>{let t=e,l=i.findAttributeByProperty(t.id);l||(l=new cxAttribute(i,t),i.addAttribute(l))});let r=e.methods;r&&r.length&&r.forEach(e=>{let i=e;i&&this.importMethod(i,t)})}}importRelshipType(e,t){let i=this.findRelationshipType(e.id),l=t.findObjectType(e.fromobjtypeRef),n=t.findObjectType(e.toobjtypeRef);if(debug&&console.log("447 reltype, fromtype, totype: ",i,l,n),i||(l&&n&&(i=new cxRelationshipType(e.id,e.name,l,n,e.description)),l.addOutputreltype(i),n.addInputreltype(i)),debug&&console.log("453 reltype",i),i){i.markedAsDeleted=e.markedAsDeleted;let l=i;for(let t in l)e[t]&&(l[t]=e[t]);if(e.fromobjtypeRef&&e.toobjtypeRef){let l=this.findObjectType(e.fromobjtypeRef),n=this.findObjectType(e.toobjtypeRef);if(i&&l&&(i.setFromObjtype(l),l.addOutputreltype(i)),i&&n&&(i.setToObjtype(n),n.addInputreltype(i)),i&&e.typeviewRef){let l=this.findRelationshipTypeView(e.typeviewRef);if(l)i.setDefaultTypeView(l);else{let l=new cxRelationshipTypeView(e.typeviewRef,"",i,"");this.addRelationshipTypeView(l),t.addRelationshipTypeView(l),i.typeview=l}}let s=e.properties;s&&s.length&&s.forEach(e=>{let i=e;i&&this.importProperty(i,t)})}t.addRelationshipType(i),debug&&console.log("485 reltype",i,t,this)}}importObjectTypeView(e,t){let i=this.findObjectTypeView(e.id),l=e.typeRef,n=this.findObjectType(l);e.template&&""!==e.template||(e.template=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_NODETEMPLATE),e.geometry||(e.geometry=""),i&&n&&(i.setMarkedAsDeleted(e.markedAsDeleted),i.setStrokewidth(Number(e.strokewidth)),i.setType(n),i.setTemplate(e.template),i.setTemplate2(e.template2),i.setViewKind(e.viewkind),i.setMemberscale(Number(e.memberscale)),i.setGeometry(e.geometry),i.setFigure(e.figure),i.setFillcolor(e.fillcolor),i.setFillcolor2(e.fillcolor2),i.setTextcolor(e.textcolor),i.setTextcolor2(e.textcolor2),i.setTextscale(Number(e.textscale)),i.setStrokecolor(e.strokecolor),i.setStrokecolor2(e.strokecolor2),i.setStrokewidth(Number(e.strokewidth)),i.setIcon(e.icon),i.setImage(e.image),i.setGrabIsAllowed(e.grabIsAllowed),debug&&console.log("222 objtypeview",i,e),t.addObjectTypeView(i),debug&&console.log("Importing objtypeview: "+e.id+", "+e.name))}importObjectTypegeo(e,t){let i=e.typeRef,l=this.findObjectType(i);if(l){let i=this.findObjtypeGeo(e.id);i&&(i.setType(l),i.setMetamodel(t),i.setLoc(e.loc),i.setSize(e.size),t.addObjtypeGeo(i))}}importRelshipTypeView(e,t){let i=this.findRelationshipTypeView(e.id),l=e.typeRef,n=this.findRelationshipType(l);e.template||(e.template=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_LINKEMPLATE),i&&n&&(i.setMarkedAsDeleted(e.markedAsDeleted),i.setType(n),i.setName(e.name),i.setTemplate(e.template),i.setTemplate2(e.template2),i.setStrokecolor(e.strokecolor),i.setTextcolor(e.textcolor),i.setStrokewidth(Number(e.strokewidth)),i.setDash(e.dash),i.setFromArrow(e.fromArrow),i.setToArrow(e.toArrow),i.setFromArrowColor(e.fromArrowColor),i.setToArrowColor(e.toArrowColor),i.setCurve(Number(e.curve)),i.setCorner(Number(e.corner)),i.setRouting(e.routing),t.addRelationshipTypeView(i),debug&&console.log("929 item.id, item.name, reltypeview: "+e.id+", "+e.name,i),n.setDefaultTypeView(i))}importProperty(e,t){let i=this.findProperty(e.id);if(i){for(let t in e)e[t]&&(i[t]=e[t]);t.addProperty(i)}}importMethodType(e,t){debug&&console.log("720 item",e);let i=this.findMethodType(e.id);if(i){for(let t in e)if(e[t]){let l=i;if("properties"===t){let i=[];for(let t=0;t<e.properties.length;t++){let l=e.properties[t],n=this.findProperty(l.id);if(n)i.push(n);else{let e=new cxProperty(l.id,l.name,l.description);i.push(e)}}l[t]=i}else l[t]=e[t]}t.addMethodType(i)}}importMethod(e,t){let i=this.findMethod(e.id);if(i){for(let t in e)e[t]&&(i[t]=e[t]);t.addMethod(i)}}importModel(e){let t=this.findModel(e.id);if(t){let i=this.findMetamodel(e.metamodelRef);if(i){t.setMetamodel(i);let l=e.objects;debug&&console.log("833 model",t),l&&l.length>0&&l.forEach(e=>{t&&this.importObject(e,t)});let n=e.relships;debug&&console.log("845 relships",n),n&&n.length>0&&n.forEach(e=>{t&&this.importRelship(e,t)});let s=e.modelviews;s&&s.length>0&&(s.sort(_utilities__WEBPACK_IMPORTED_MODULE_1__.UD),s.forEach(e=>{e.id&&t&&this.importModelView(e,t)})),t.includeRelshipkind=e.includeRelshipkind,t.targetMetamodelRef=e.targetMetamodelRef,t.sourceModelRef=e.sourceModelRef,t.targetModelRef=e.targetModelRef,t.args1=e.args1}let l=e.ports;l&&l.length&&l.forEach(e=>{t&&this.importPort(e,t)}),debug&&console.log("863 item, model",e,t)}}importObject(e,t){let i=this.findObject(e.id);if(i){let l=this.findObjectType(e.typeRef);l?(i.setType(l),i.markedAsDeleted=e.markedAsDeleted,i.generatedTypeId=e.generatedTypeId,t&&t.addObject(i)):i.typeName=e.typeName,debug&&console.log("623 model",t)}}importRelship(e,t){if(!e)return;let i=this.findRelationship(e.id);if(i){let l=this.findRelationshipType(e.typeRef);debug&&console.log("948 item, rel",e,i);let n=this.findObject(e.fromobjectRef),s=this.findObject(e.toobjectRef);l&&n&&s?(i.setType(l),i.setFromObject(n),i.setToObject(s),n.addOutputrel(i),s.addInputrel(i),i.fromPortid=e.fromPortid,i.toPortid=e.toPortid,i.relshipkind=e.relshipkind,i.cardinality=e.cardinality,i.cardinalityFrom=e.cardinalityFrom,i.cardinalityTo=e.cardinalityTo,i.markedAsDeleted=e.markedAsDeleted,i.generatedTypeId=e.generatedTypeId,t&&t.addRelationship(i)):i.typeName=e.typeName}}importPort(e,t){let i=this.findPort(e.id);i&&(i.markedAsDeleted=e.markedAsDeleted,t&&t.addPort(i))}importModelView(e,t){if(t){let i=this.findModelView(e.id);if(i){i.layout=e.layout,i.showCardinality=e.showCardinality,i.showRelshipNames=e.showRelshipNames,i.askForRelshipName=e.askForRelshipName,i.includeInheritedReltypes=e.includeInheritedReltypes,i.viewstyle=this.findViewStyle(e.viewstyleRef),t.addModelView(i);let l=e&&e.objectviews;null==l||l.forEach(e=>{e&&e.id&&(this.importObjectView(e,i),debug&&console.log("630 model",t))});let n=e.relshipviews;null==n||n.forEach(e=>{e&&e.id&&this.importRelshipView(e,i)}),i.focusObjectview=this.findObjectView(e.focusObjectviewRef)}}}importObjectView(e,t){if(t){let i=this.findObjectView(e.id);if(i){debug&&console.log("1170 item, objview",e,i);let l=this.findObject(e.objectRef);if(l){if(debug&&console.log("1173 item.markedAsDeleted",e.markedAsDeleted),i.setObject(l),i.setIcon(e.icon),i.setLoc(e.loc),i.setSize(e.size),i.setScale(Number(e.scale)),i.setTextscale(Number(e.textscale)),i.setTemplate(e.template),i.setTemplate2(e.template2),i.setGroup(e.group),i.setIsGroup(e.isGroup),i.setArrowscale(Number(e.arrowscale)),i.setMemberscale(Number(e.memberscale)),i.setGroupIsExpanded(e.isExpanded),i.setMarkedAsDeleted(e.markedAsDeleted),i.fillcolor=e.fillcolor,i.fillcolor2=e.fillcolor2,i.strokecolor=e.strokecolor,i.strokecolor2=e.strokecolor2,i.strokewidth=Number(e.strokewidth),i.textcolor=e.textcolor,i.textcolor2=e.textcolor2,i.textscale=Number(e.textscale),i.viewkind=e.viewkind,i.groupLayout=e.groupLayout,void 0==e.isExpanded&&void 0!==e.isCollapsed&&(i.isExpanded=!e.isCollapsed),i.isSelected=e.isSelected,i.text=e.text,i.modified=!0,debug&&console.log("1188 objview",i),e.typeviewRef){let t=this.findObjectTypeView(e.typeviewRef);if(t){i.setTypeView(t);let l=t.getData();for(let t in l)e[t]&&""!==e[t]&&(i[t]=e[t])}}i.viewkind=e.viewkind,debug&&console.log("1201 objview.markedAsDeleted",i.markedAsDeleted,i),l.addObjectView(i),debug&&console.log("1203 item, objview",e,i)}t.removeObjectView(i),debug&&console.log("1206 modelview",i.markedAsDeleted,i,t),t.addObjectView(i),debug&&console.log("1208 modelview",i.markedAsDeleted,i,t)}}}importRelshipView(e,t){if(t){debug&&console.log("1034 item (relshipview): ",e),""===e.markedAsDeleted&&(e.markedAsDeleted=!1);let n=this.findRelationshipView(e.id);if(n){let s=this.findRelationship(e.relshipRef);if(s){let r;n.setRelationship(s);let a=t.findObjectView(e.fromobjviewRef),d=t.findObjectView(e.toobjviewRef);if(!a||!d)return;if(n.setFromObjectView(a),n.setToObjectView(d),a.addOutputRelview(n),d.addInputRelview(n),n.fromPortid=s.fromPortid,n.toPortid=s.toPortid,n.template=e.template,n.template2=e.template2,n.arrowscale=Number(e.arrowscale),n.strokecolor=e.strokecolor,n.strokewidth=Number(e.strokewidth),n.textcolor=e.textcolor,n.textscale=Number(e.textscale),n.dash=e.dash,n.fromArrow=e.fromArrow,n.toArrow=e.toArrow,n.fromArrowColor=e.fromArrowColor,n.toArrowColor=e.toArrowColor,n.routing=e.routing,n.corner=Number(e.corner),n.curve=Number(e.curve),n.points=e.points,n.visible=e.visible,e.typeviewRef&&(r=this.findRelationshipTypeView(e.typeviewRef))){n.setTypeView(r);let t=r.getData();for(let i in t)e[i]&&""!==e[i]&&(n[i]=e[i])}if(!r){var i,l;if(r=null===(l=n.relship)||void 0===l?void 0:null===(i=l.type)||void 0===i?void 0:i.typeview){n.setTypeView(r);let t=r.getData();for(let i in t)e[i]&&""!==e[i]&&(n[i]=e[i])}}n.markedAsDeleted=e.markedAsDeleted,n.template=e.template,n.template2=e.template2,s.addRelationshipView(n),t.addRelationshipView(n)}}}}addMetamodel(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_METAMODEL){null==this.metamodels&&(this.metamodels=[]);let t=this.findMetamodel(e.id);t?t=e:this.metamodels.push(e)}}addModel(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_MODEL||(null==this.models&&(this.models=[]),this.findModel(e.id)||this.models.push(e))}addSubModel(e){(null==e?void 0:e.category)!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_MODEL||(null==this.submodels&&(this.submodels=[]),this.findSubModel(e.id)||this.submodels.push(e))}addModelView(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_MODELVIEW||(null==this.modelviews&&(this.modelviews=[]),this.findModelView(e.id)||this.modelviews.push(e))}addDatatype(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE||(null==this.datatypes&&(this.datatypes=[]),this.findDatatype(e.id)||this.datatypes.push(e))}addViewStyle(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_VIEWSTYLE||(null==this.viewstyles&&(this.viewstyles=[]),this.findViewStyle(e.id)||this.viewstyles.push(e))}addGeometry(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_GEOMETRY||(null==this.geometries&&(this.geometries=[]),this.findGeometry(e.id)||this.geometries.push(e))}addViewFormat(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_VIEWFORMAT||(null==this.viewformats&&(this.viewformats=[]),this.findViewFormat(e.id)||this.viewformats.push(e))}addFieldType(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_FIELDTYPE||(null==this.fieldTypes&&(this.fieldTypes=[]),this.findFieldType(e.id)||this.fieldTypes.push(e))}addInputPattern(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_INPUTPATTERN||(null==this.inputpatterns&&(this.inputpatterns=[]),this.findInputPattern(e.id)||this.inputpatterns.push(e))}addEnumeration(e){e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_ENUMERATION&&(null==this.enumerations&&(this.enumerations=[]),this.enumerations.push(e))}addUnit(e){e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_UNIT&&(null==this.units&&(this.units=[]),this.units.push(e))}addUnitCategory(e){e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_UNITCATEGORY&&(null==this.categories&&(this.categories=[]),this.categories.push(e))}addProperty(e){e&&e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_PROPERTY&&(null==this.properties&&(this.properties=[]),this.findProperty(e.id)||this.properties.push(e))}addMethodType(e){if(e&&e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_METHODTYPE){var t;let i=[],l=null===(t=this.methodtypes)||void 0===t?void 0:t.length;if(l){let t=!1;for(let n=0;n<l;n++){let l=this.methodtypes[n];l&&(l.id===e.id?(i.push(e),t=!0):i.push(l))}t||i.push(e)}else i.push(e);this.methodtypes=i}}addMethod(e){if(e&&e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_METHOD){var t;let i=[],l=null===(t=this.methods)||void 0===t?void 0:t.length;if(l){let t=!1;for(let n=0;n<l;n++){let l=this.methods[n];l&&(l.id===e.id?(i.push(e),t=!0):i.push(l))}t||i.push(e)}else i.push(e);this.methods=i}}addObjectType(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTTYPE||(null==this.objecttypes&&(this.objecttypes=[]),this.findObjectType(e.id)||this.objecttypes.push(e))}addRelationshipType(e){e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELSHIPTYPE&&(null==this.relshiptypes&&(this.relshiptypes=[]),!this.findRelationshipType(e.id)&&(this.fixObjectTypeRefs(e),this.relshiptypes.push(e),debug&&console.log("1438 Add reltype",e)))}addObjectTypeView(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTTYPEVIEW){if(null==this.objecttypeviews&&(this.objecttypeviews=[]),this.findObjectTypeView(e.id)){let t=this.objecttypeviews.length;for(let i=0;i<t;i++){let t=this.objecttypeviews[i];if(debug&&console.log("1355 objview",t),t.id===e.id){for(let i in e)t[i]=e[i];debug&&console.log("1361 objview",t);return}}}else this.objecttypeviews.push(e)}}addRelationshipTypeView(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELSHIPTYPEVIEW){if(null==this.relshiptypeviews&&(this.relshiptypeviews=[]),this.findRelationshipTypeView(e.id)){let t=this.relshiptypeviews.length;for(let i=0;i<t;i++){let t=this.relshiptypeviews[i];if(debug&&console.log("1378 rtview",t),t.id===e.id){for(let i in e)"id"!==i&&"name"!==i&&"data"!==i&&"typeRef"!==i&&(t[i]=e[i],t.data[i]=e[i]);debug&&console.log("1387 rtview",t);break}}}else this.relshiptypeviews.push(e)}}addObjtypeGeo(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTTYPEGEO||(null==this.objtypegeos&&(this.objtypegeos=[]),this.findObjtypeGeo(e.id)||this.objtypegeos.push(e))}addObject(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECT||(null==this.objects&&(this.objects=[]),this.findObject(e.id)||(debug&&console.log("863 addObject:",e),this.objects.push(e)))}addRelationship(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELATIONSHIP||(null==this.relships&&(this.relships=[]),this.findRelationship(e.id)||this.relships.push(e))}addObjectView(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTVIEW){if(null==this.objectviews&&(this.objectviews=[]),this.findObjectView(e.id)){let t=this.objectviews.length;for(let i=0;i<t;i++){let t=this.objectviews[i];if(debug&&console.log("1355 objview",t),t.id===e.id){for(let i in e)t[i]=e[i];debug&&console.log("1361 objview",t);return}}}else this.objectviews.push(e)}}addRelationshipView(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELSHIPVIEW||(null==this.relshipviews&&(this.relshipviews=[]),this.findRelationshipView(e.id)||this.relshipviews.push(e))}setGojsModel(e){this.gojsModel=e}getGojsModel(){return this.gojsModel}getMetamodels(){return this.metamodels}getModels(){return this.models}getSubModels(){return this.submodels}getModelsByMetamodel(e,t){let i=[],l=this.models;for(let n=0;n<l.length;n++){let s=l[n],r=s.metamodel;t||!r||r.isDeleted()||r.id!==e.id||i.push(s)}return i}getModels2(e){if(e||!this.models)return this.models;{let e=[];for(let t=0;t<this.models.length;t++){let i=this.models[t];i.isDeleted()||e.push(i)}return e}}getTemplateModels(){let e=[],t=this.models;if(t){let i=t.length;for(let l=0;l<i;l++){let i=t[l];_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(i)&&i.getIsTemplate()&&e.push(i)}}return e}getModelViews(){return this.modelviews}getModelViewsByModel(e){let t=[];if(e){let i=this.modelviews;if(i){let l=i.length;for(let n=0;n<l;n++){let l=i[n];if(l){let i=l.getModel();i&&e.getName()===i.getName()&&t.push(l)}}}}return t}getTemplateModelviewByName(e){if(e&&e.length>0){let t=this.modelviews;if(t){let i=t.length;for(let l=0;l<i;l++){let i=t[l];if(i&&i.getName()===e&&i.getIsTemplate())return i}}}return null}getTemplateModelviews(){let e=[],t=this.modelviews;if(t){let i=t.length;for(let l=0;l<i;l++){let i=t[l];i&&i.getIsTemplate()&&e.push(i)}}return e}getDatatypes(){return this.datatypes}getViewFormats(){return this.viewformats}getFieldTypes(){return this.fieldTypes}getInputPatterns(){return this.inputpatterns}getEnumerations(){return this.enumerations}getUnits(){return this.units}getUnitCategories(){return this.categories}getProperties(){return this.properties}getMethodTypes(){return this.methodtypes}getMethods(){return this.methods}getObjectTypes(){return this.objecttypes}getRelationshipTypes(){return this.relshiptypes}getObjectTypeViews(){return this.objecttypeviews}getObjtypeGeos(){return this.objtypegeos}getRelshipTypes(){return this.relshiptypes}getRelationshipTypeViews(){return this.relshiptypeviews}getObjects(){return this.objects}getObjectsByType(e,t){let i=[];if(this.objects)for(let t=0;t<this.objects.length;t++){let l=this.objects[t];if(l&&!l.markedAsDeleted){let t=l.type;t&&t.id===e.id&&i.push(l)}}return i}getRelationships(){return this.relships}getRelationshipsByType(e,t){let i=[];if(this.relships)for(let t=0;t<this.relships.length;t++){let l=this.relships[t];if(l&&!l.markedAsDeleted){let t=l.type;t&&t.id===(null==e?void 0:e.id)&&i.push(l)}}return i}getRelationshipsByGeneratedTypeId(e){let t=[];if(this.relships)for(let i=0;i<this.relships.length;i++){let l=this.relships[i];l&&!l.markedAsDeleted&&l.generatedTypeId===e&&t.push(l)}return t}getObjectViews(){return this.objectviews}getObjectViewsByObject(e){let t=this.objectviews,i=[];for(let l=0;l<t.length;l++){let n=t[l];if(n){let t=n.object;t&&t.id===e&&i.push(n)}}return i}getRelationshipViews(){return this.relshipviews}getRelationshipViewsByRelship(e){let t=this.relshipviews,i=[];for(let l=0;l<t.length;l++){let n=t[l];if(n){let t=n.relship;t&&t.id===e&&i.push(n)}}return i}findItem(e,t){let i=null;switch(e){case"metamodels":i=this.findMetamodel(t);break;case"datatypes":i=this.findDatatype(t);break;case"objecttypes":i=this.findObjectType(t);break;case"relationshiptypes":i=this.findRelationshipType(t);break;case"properties":i=this.findProperty(t);break;case"methods":i=this.findMethod(t);break;case"objecttypeviews":i=this.findObjectTypeView(t);break;case"relationshiptypeviews":i=this.findRelationshipTypeView(t);break;case"models":i=this.findModel(t);break;case"objects":i=this.findObject(t);break;case"relationships":i=this.findRelationship(t);break;case"objectviews":i=this.findObjectView(t);break;case"relationshipviews":i=this.findRelationshipView(t)}return i}findDatatype(e){let t=this.getDatatypes();if(t){let i=0;for(;i<t.length;){let l=t[i];if(l&&l.id===e)return l;i++}}return null}findViewStyle(e){let t=this.viewstyles;if(t){let i=0;for(;i<t.length;){let l=t[i];if(l&&l.id===e)return l;i++}}return null}findViewStyleByName(e){let t=this.viewstyles;if(!t)return null;let i=0,l=null;for(;i<t.length;){let e=(l=t[i]).getName();if(e.toLowerCase()===e.toLowerCase())return l;i++}return null}findGeometry(e){let t=this.geometries;if(t){let i=0;for(;i<t.length;){let l=t[i];if(l&&l.id===e)return l;i++}}return null}findGeometryByName(e){let t=this.geometries;if(!t)return null;let i=0,l=null;for(;i<t.length;){let e=(l=t[i]).getName();if(e.toLowerCase()===e.toLowerCase())return l;i++}return null}findViewFormat(e){let t=this.getViewFormats();if(t){let i=0;for(;i<t.length;){let l=t[i];if(l&&l.id===e)return l;i++}}return null}findFieldType(e){let t=this.getFieldTypes();if(t){let i=0;for(;i<t.length;){let l=t[i];if(l&&l.id===e)return l;i++}}return null}findInputPattern(e){let t=this.getInputPatterns();if(t){let i=0;for(;i<t.length;){let l=t[i];if(l&&l.id===e)return l;i++}}return null}findDatatypeByName(e){let t=this.getDatatypes();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i]).getName().toLowerCase()===e.toLowerCase())return l;i++}}return null}findEnumeration(e){let t=this.getEnumerations();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i]).id===e)return l;i++}}return null}findProject(e){let t=this.projects;if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i])&&l.id===e)return l;i++}}return null}findMetamodel(e){let t=this.getMetamodels();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i])&&l.id===e)return l;i++}}return null}findMetamodelByName(e){let t=this.getMetamodels();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i]).getName()===e)return l;i++}}return null}findModel(e){let t=this.getModels();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i])&&l.id===e)return l;i++}}return null}findModelView(e){let t=this.getModelViews();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i])&&l.id===e)return l;i++}}return null}findModelByName(e){let t=this.getModels();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i]).getName()===e)return l;i++}}return null}findModelsByName(e){let t=[];if(!this.getModels())return null;{let i=0,l=null;for(;i<t.length;)(l=t[i]).getName()===e&&t.push(l),i++;return t}}findModelByMetamodelAndName(e,t){let i=this.getModels();if(i){let l=0,n=null;for(;l<i.length;){if((n=i[l]).metamodel.id===e.id&&n.getName()===t)return n;l++}}return null}findSubModel(e){let t=this.submodels;if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.id===e)return l;return null}findObjectType(e){let t=this.getObjectTypes();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i])&&l.id===e&&!l.markedAsDeleted)return l;i++}}return null}findObjectTypeByName(e){let t=this.getObjectTypes();if(t){let i=0,l=null;for(;i<t.length;){if((null==(l=t[i])?void 0:l.getName())===e&&!l.markedAsDeleted)return l;i++}}return null}findObjectTypeView(e){let t=this.getObjectTypeViews();if(t){let i=0,l=null;for(;i<t.length;){if((null==(l=t[i])?void 0:l.id)===e&&!l.markedAsDeleted)return l;i++}}return null}getObjectTypeViewsByObjectType(e){let t=this.getObjectTypeViews();if(!t)return null;{let i=0,l=null,n=[];for(;i<t.length;)(null==(l=t[i])?void 0:l.markedAsDeleted)||l.typeRef!==e.id||n.push(l),i++;return n}}findObjtypeGeo(e){let t=this.getObjtypeGeos();if(t){let i=0,l=null;for(;i<t.length;){if(!(null==(l=t[i])?void 0:l.markedAsDeleted)&&l.id===e)return l;i++}}return null}findObject(e,t){let i=this.getObjects();if(i){let l=0,n=null;for(;l<i.length;){if((!(null==(n=i[l])?void 0:n.markedAsDeleted)||t)&&n.id===e)return n;l++}}return null}findObjectByTypeAndName(e,t){let i=this.getObjects();if(i&&_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(e)){let l=e.id,n=0,s=null;for(;n<i.length;){if(!(null==(s=i[n])?void 0:s.markedAsDeleted)){let e=s.getType();if(e&&e.id===l&&s.getName()===t)return s}n++}}return null}findObjectView(e,t){let i=this.getObjectViews();if(i){let l=0,n=null;for(;l<i.length;){if((!(null==(n=i[l])?void 0:n.markedAsDeleted)||t)&&n.id===e){if(!n.objectRef){let e=n.object;n.objectRef=null==e?void 0:e.id}return n}l++}}return null}findProperty(e){let t=this.getProperties();if(t){let i=0,l=null;for(;i<t.length;){if(!(null==(l=t[i])?void 0:l.markedAsDeleted)&&l.id===e)return l;i++}}return null}findPropertyByName(e){let t=this.getProperties();if(t){let i=0,l=null;for(;i<t.length;)if(!(l=t[i]).isDeleted()){if(l.name===e)return l;i++}}return null}findMethodType(e){let t=this.getMethodTypes();if(t){let i=0,l=null;for(;i<t.length;){if(!(null==(l=t[i])?void 0:l.markedAsDeleted)&&l.id===e)return l;i++}}return null}findMethodTypeByName(e){let t=this.getMethodTypes();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.getName()===e)return l;return null}findMethod(e){let t=this.getMethods();if(t){let i=0,l=null;for(;i<t.length;){if(!(null==(l=t[i])?void 0:l.markedAsDeleted)&&l.id===e)return l;i++}}return null}findMethodByName(e){let t=this.getMethods();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.getName()===e)return l;return null}findRelationshipType(e){let t=this.relshiptypes;if(t){let i=0,l=null;for(;i<t.length;){if(!(null==(l=t[i])?void 0:l.markedAsDeleted)&&l.id===e)return l;i++}}return null}findRelationshipTypesByName(e){let t=this.getRelshipTypes();if(!t)return null;let i=[],l=0,n=null;for(l=0;l<t.length;l++)(n=t[l]).isDeleted()||n.getName()!==e||i.push(n);return i}findRelationshipTypeByName(e){let t=this.getRelationshipTypes();if(t){let i=0,l=null;for(;i<t.length;)if(!(l=t[i]).isDeleted()){if(l.getName()===e)return l;i++}}return null}findRelationshipTypeByName1(e,t,i){let l=this.getRelationshipTypes();if(l)for(let r=0;r<l.length;r++){let a=l[r];if(!a.isDeleted()&&a.getName()===e){var n,s;if((null===(n=a.fromObjtype)||void 0===n?void 0:n.id)===(null==t?void 0:t.id)&&(null===(s=a.toObjtype)||void 0===s?void 0:s.id)===(null==i?void 0:i.id))return a}}return null}findRelationshipTypeByName2(e,t,i){let l=this.getRelationshipTypes();if(debug&&console.log("2171 types",l.length,l),l){let n=null;for(let s=0;s<l.length;s++)if(!(n=l[s]).isDeleted()&&n.getName()===e&&(this.fixObjectTypeRefs(n),n.isAllowedFromType(t,!0)&&n.isAllowedToType(i,!0)))return n}return null}findRelationshipTypeByName3(e,t,i,l){let n=this.getRelationshipTypes();if(debug&&console.log("2171 types",n.length,n),n){let s=null;for(let r=0;r<n.length;r++)if(s=n[r],debug&&console.log("2178 reltype",s,t,i),!s.isDeleted()&&s.getName()===e&&(this.fixObjectTypeRefs(s),(t.id===l.id||s.isAllowedFromType(t,!0))&&(i.id===l.id||s.isAllowedToType(i,!0))||(i.id===l.id||s.isAllowedToType(i,!0))&&(t.id===l.id||s.isAllowedFromType(t,!0))))return s}return null}findRelationshipTypeByNames(e,t,i){let l=this.getRelshipTypes();if(!l)return null;let n=0,s=null;for(n=0;n<l.length;n++)if(!(s=l[n]).isDeleted()&&s.getName()===e){let e=s.getFromObjType(),l=s.getToObjType();if(e&&l&&e.getName()===t&&l.getName()===i)return s}return null}findRelationshipTypesBetweenTypes0(e,t){let i=[],l=this.getRelationshipTypes();if(!l)return null;for(let n=0;n<l.length;n++){let s=l[n];if(s.getRelshipKind()!==_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.GEN&&s.name!==_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_IS||s.isDeleted())continue;let r=s.getFromObjType();if(r||(r=this.findObjectType(s.fromobjtypeRef)),!e.inherits(r))continue;let a=s.getToObjType();r||(a=this.findObjectType(s.toobjtypeRef)),t.inherits(a)&&i.push(s)}return i}findRelationshipTypesBetweenTypes(e,t,i){if(!e||!t)return null;let l=this.getRelationshipTypes();if(!l)return null;let n=[];for(let e=0;e<l.length;e++){let t=l[e];this.fixObjectTypeRefs(t)}for(let s=0;s<l.length;s++){let r=l[s];if(r){if(r.isDeleted()||r.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_IS)continue;let l=r.getFromObjType(),s=r.getToObjType();if(l&&s){if(r.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_RELATIONSHIP_TYPE){if(e.name!==_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ENTITY_TYPE||t.name!==_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ENTITY_TYPE)continue;n.push(r);continue}if(e.inherits(l)&&t.inherits(s)){l.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ENTITY_TYPE?i&&n.push(r):n.push(r);continue}}if(r.relshipkind===_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.GEN)continue;r.isAllowedFromType(e,i)&&r.isAllowedToType(t,i)&&n.push(r)}}return n}findRelationshipTypesBetweenTypes1(e,t,i){if(!e||!t)return null;let l=this.getRelationshipTypes();if(!l)return null;for(let e=0;e<l.length;e++){let t=l[e];this.fixObjectTypeRefs(t)}for(let e=0;e<l.length;e++){let t=l[e];if(t){if(t.isDeleted())continue;let e=t.getFromObjType();e||(e=this.findObjectType(t.fromobjtypeRef));let l=t.getToObjType();l||(l=this.findObjectType(t.toobjtypeRef)),this.fixObjectTypeRefs(t),t.isAllowedFromType(e,i)&&t.isAllowedToType(l,i)&&reltypes.push(t)}}return reltypes}findRelationshipTypeView(e){let t=this.relshiptypeviews;if(t){let i=0;for(;i<t.length;){let l=t[i];if(!(null==l?void 0:l.markedAsDeleted)&&l.id===e)return l;i++}}return null}findRelationship(e){let t=this.getRelationships();if(t){let i=0,l=null;for(;i<t.length;){if(!(null==(l=t[i])?void 0:l.markedAsDeleted)&&l.id===e)return l;i++}}return null}findRelationshipView(e){let t=this.getRelationshipViews();if(t){let i=0,l=null;for(;i<t.length;){if(!(null==(l=t[i])?void 0:l.markedAsDeleted)&&l.id===e)return l;i++}}return null}findSubMetamodel(e){var t;debug&&console.log("2834 findSubMetamodel",e,this,this.currentMetamodel);let i=null===(t=this.currentMetamodel)||void 0===t?void 0:t.getSubMetamodels();if(debug&&console.log("2836 findSubMetamodel",i),i){let t=0,l=null;for(;t<i.length;){if((l=i[t]).id===e)return l;t++}}return null}findUnit(e){let t=this.getUnits();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i]).id===e)return l;i++}}return null}findUnitByName(e){let t=this.getUnits();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i]).getName().toLowerCase()===e.toLowerCase())return l;i++}}return null}findUnitCategory(e){if(_utilities__WEBPACK_IMPORTED_MODULE_1__.by(this.getUnitCategories()));else{let t=0,i=null,l=this.getUnitCategories();if(l)for(;t<l.length;){if((i=l[t])&&i.id===e)return i;t++}}return null}findUnitCategoryByName(e){let t=this.getUnitCategories();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i]).getName().toLowerCase()===e.toLowerCase())return l;i++}}return null}setCurrentModelview(e){this.currentModelview=e}getCurrentModelview(){return this.currentModelview}setCurrentModel(e){this.currentModel=e}getCurrentModel(){return this.currentModel}setCurrentTemplateModel(e){this.currentTemplateModel=e}getCurrentTemplateModel(){return this.currentTemplateModel}setCurrentMetamodel(e){this.currentMetamodel=e,this.currentMetamodelRef=null==e?void 0:e.id}getCurrentMetamodel(){return this.currentMetamodel}setCurrentTargetMetamodel(e){this.currentTargetMetamodel=e,this.currentTargetMetamodelRef=e.id}getcurrentTargetMetamodel(){return this.currentTargetMetamodel}setCurrentTargetModel(e){this.currentTargetModel=e,this.currentTargetModelRef=e.id}getCurrentTargetModel(){return this.currentTargetModel}setCurrentTargetModelview(e){this.currentTargetModelview=e}getCurrentTargetModelview(){return this.currentTargetModelview}setCurrentTaskModel(e){this.currentTaskModel=e,this.currentTaskModelRef=e.id}getCurrentTaskModel(){return this.currentTaskModel}isAdminType(e){return!!e&&("Project"===e.name||"Metamodel"===e.name||"Model"===e.name||"Modelview"===e.name)}fixObjectTypeRefs(e){if(!e.fromObjtype&&e.fromobjtypeRef){let t=this.findObjectType(e.fromobjtypeRef);t&&(e.fromObjtype=t)}if(!e.toObjtype&&e.toobjtypeRef){let t=this.findObjectType(e.toobjtypeRef);t&&(e.toObjtype=t)}}purgeObjectTypeViews(){let e=this.getMetamodels();for(let t=0;t<e.length;t++){let i=e[t],l=i.getObjectTypes();for(let e=0;e<l.length;e++){let t=this.objecttypes[e],l=t.typeview.id,n=i.getObjectTypeViewsByObjectType(t);if(!(n.length<2))for(let e=0;e<n.length;e++){let t=n[e];t.id!==l&&(t.markedAsDeleted=!0)}}}return null}removeClassInstances(e){return e.objectview&&(e.objectview=null),e.object&&(e.object=null),e.objecttype&&(e.objecttype=null),e.typeview&&(e.typeview=null),e.leftPorts&&(e.leftPorts=null),e.rightPorts&&(e.rightPorts=null),e.topPorts&&(e.topPorts=null),e.bottomPorts&&(e.bottomPorts=null),e.relshipview&&(e.relshipview=null),e.relship&&(e.relship=null),e.relshiptype&&(e.relshiptype=null),e.typeview&&(e.typeview=null),e.fromNode&&(e.fromNode=null),e.toNode&&(e.toNode=null),e.fromObjview&&(e.fromObjview=null),e.toObjview&&(e.toObjview=null),e}substituteNodeMapValues(e,t,i){for(let l=0;l<e.length;l++){let n=e[l];n.to===t&&(n.to=i),n.fromGroup===t&&(n.fromGroup=i)}}getCurrentNode(){return this.currentNode()}getNodeGroup(e){return e.group}setNodeGroup(e,t){e.group=t}getNodeByGroup(e,t){let i=null;for(let l=0;l<e.length;l++){let n=e[l];n.group===t&&(i=n)}return i}constructor(){this.metamodels=null,this.coreMetamodel=null,this.models=null,this.submodels=null,this.modelviews=null,this.datatypes=null,this.inputpatterns=null,this.viewformats=null,this.fieldTypes=null,this.enumerations=null,this.units=null,this.categories=null,this.properties=null,this.methods=null,this.methodtypes=null,this.objecttypes=null,this.relshiptypes=null,this.objecttypeviews=null,this.objtypegeos=null,this.relshiptypeviews=null,this.objects=null,this.relships=null,this.objectviews=null,this.relshipviews=null,this.allowGenerateCurrentMetamodel=!1,this.gojsModel=null,this.currentProject=null,this.currentMetamodel=null,this.currentMetamodelRef=null,this.currentModel=null,this.currentModelRef=null,this.currentModelview=null,this.currentModelviewRef=null,this.currentTargetMetamodel=null,this.currentTargetModel=null,this.currentTargetModelview=null,this.currentTemplateMetamodel=null,this.currentTemplateModel=null,this.currentTemplateModelview=null,this.currentTaskModel=null,this.pasteViewsOnly=!1,this.deleteViewsOnly=!1,this.pasted=!1,this.relinkedRelview=null,this.modelType="",this.id=_utilities__WEBPACK_IMPORTED_MODULE_1__.gj(),this.name="",this.description="",this.viewstyles=[],this.geometries=[],this.category="Metis",this.fromNodes=[];let e=new cxObjectType(_utilities__WEBPACK_IMPORTED_MODULE_1__.gj(),"Port","Port type");this.objecttypes=[e]}}class cxMetaObject{getNameId(){let e=this.name;return e.replace(/ /g,"_").replace(/./g,"_"),e}getId(){return this.id?this.id:""}getCategory(){return this.category}setCategory(e){this.category=e}setName(e){this.name=e}getName(){return this.name?this.name:""}setDescription(e){this.description=e}getDescription(){return this.description?this.description:""}setMarkedAsDeleted(e){this.markedAsDeleted=e}getMarkedAsDeleted(){return this.markedAsDeleted}setDeleted(e){this.markedAsDeleted=e}isDeleted(){return this.markedAsDeleted}setModified(){this.modified=!0}clearModified(){this.modified=!1}isModified(){return this.modified}updateContent(e){for(let t in e)this[t]=e[t]}constructor(e,t,i){this.id=e,this.name=t,this.nameId=t,this.category="",this.sourceUri="",this.markedAsDeleted=!1,this.modified=!1,null==t&&(this.name=e),null==i?this.description="":this.description=i}}class cxProject extends cxMetaObject{addMetamodel(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_METAMODEL){if(null==this.metamodels&&(this.metamodels=[]),this.findMetamodel(e.id)){let t=this.metamodels;for(let i=0;i<t.length;i++)if(t[i].id===e.id){t[i]=e;break}}else this.metamodels.push(e)}}addModel(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_MODEL||(null==this.models&&(this.models=[]),this.findModel(e.id)||this.models.push(e))}findMetamodel(e){let t=this.metamodels;if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i])&&l.id===e)return l;i++}}return null}findModel(e){let t=this.models;if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i])&&l.id===e)return l;i++}}return null}constructor(e,t,i){super(e,t,i),this.metamodels=null,this.models=null}}class cxDatatype extends cxMetaObject{addAllowedValue(e){let t=0;_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(this.allowedValues)&&(t=this.allowedValues.length),0==t?(this.allowedValues=[],this.allowedValues.push(e)):_utilities__WEBPACK_IMPORTED_MODULE_1__.NF(this.allowedValues,e)||this.allowedValues.push(e)}getAllowedValues(){return this.allowedValues}setDefaultValue(e){this.defaultValue=e}getDefaultValue(){return this.defaultValue}setValue(e){this.value=e}getValue(){return this.value}setIsOfDatatype(e){this.isOfDatatype=e}getIsOfDatatype(){return this.isOfDatatype}setInputPattern(e){this.inputPattern=e}getInputPattern(){return this.inputPattern}setViewFormat(e){this.viewFormat=e}getViewFormat(){return this.viewFormat}setFieldType(e){this.fieldType=e}getFieldType(){return this.fieldType}setPointerType(e){this.pointerType=e}getPointerType(){return this.pointerType}setPointerCriteria(e){this.pointerCriteria=e}getPointerCriteria(){return this.pointerCriteria}constructor(e,t,i){super(e,t,i),this.fs_collection=_constants__WEBPACK_IMPORTED_MODULE_2__.fs.FS_C_DATATYPES,this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE,this.isOfDatatype=null,this.inputPattern="",this.viewFormat="",this.fieldType="text",this.readOnly=!1,this.allowedValues=null,this.defaultValue="",this.value="",this.pointerType=null,this.pointerCriteria="",debug&&console.log("1915 datatype: ",this),t===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE_STRING?(this.inputPattern=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE_STRING_PATTERN,this.viewFormat=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_VIEWFORMAT_TEXT):t===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE_INTEGER?(this.inputPattern=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE_INTEGER_PATTERN,this.viewFormat=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_VIEWFORMAT_INTEGER):t===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE_FLOAT?(this.inputPattern=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE_FLOAT_PATTERN,this.viewFormat=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_VIEWFORMAT_FLOAT):t===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE_DATE?(this.inputPattern=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE_DATE_PATTERN,this.viewFormat=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_VIEWFORMAT_DATE):t===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE_TIME?(this.inputPattern=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE_TIME_PATTERN,this.viewFormat=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_VIEWFORMAT_TIME):t===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE_DATETIME?(this.inputPattern=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE_DATETIME_PATTERN,this.viewFormat=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_VIEWFORMAT_DATETIME):t===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE_BOOLEAN?(this.inputPattern=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE_BOOLEAN_PATTERN,this.viewFormat=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_VIEWFORMAT_BOOLEAN):(this.inputPattern=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE_STRING_PATTERN,this.viewFormat=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_VIEWFORMAT_TEXT)}}class cxUnitCategory extends cxMetaObject{addUnit(e){e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_UNIT&&(null==this.units&&(this.units=[]),this.units.push(e))}constructor(e,t,i){super(e,t,i),this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_UNITCATEGORY,this.units=null}}class cxUnit extends cxMetaObject{setUnitCategory(e){_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(e)&&e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_UNITCATEGORY&&(this.unitCategory=e)}getUnitCategory(){return this.unitCategory}constructor(e,t,i){super(e,t,i),this.unitCategory=null}}class cxEnumeration extends cxMetaObject{addEnum(e){_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(e)&&(null==this.enumvalues&&(this.enumvalues=[]),this.enumvalues.push(e))}enumValueExists(e){if(_utilities__WEBPACK_IMPORTED_MODULE_1__.by(this.enumvalues));else{let t=0,i=null;for(;t<this.enumvalues.length;){if((i=this.enumvalues[t]).id===e)return!0;t++}}return!1}constructor(e,t,i){super(e,t,i),this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_ENUMERATION,this.enumvalues=null}}class cxMethodType extends cxMetaObject{addProperty(e){e&&e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_PROPERTY&&(null==this.properties&&(this.properties=[]),this.findProperty(e.id)||this.properties.push(e))}findProperty(e){let t=this.properties;if(!t)return null;let i=t.length,l=0;for(;l<i;){if(t[l].id===e)return t[l];l++}return null}findPropertyByName(e){let t=this.properties;if(!t)return null;{let l=t.length,n=0;for(;n<l;){var i;if((null===(i=t[n])||void 0===i?void 0:i.name)===e)return t[n];n++}return null}}getProperties(){return this.properties,debug&&console.log("2560 properties",this.properties),this.properties}hasProperties(){return!!this.properties&&!_utilities__WEBPACK_IMPORTED_MODULE_1__.by(this.properties)}constructor(e,t,i){super(e,t,i),this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_METHODTYPE,this.properties=null}}class cxMetaModel extends cxMetaObject{clearContent(){this.metamodels=[],this.submodels=[],this.submetamodelRefs=[],this.submodelRefs=[],this.viewstyle=null,this.viewstyles=[],this.geometries=[],this.containers=[],this.properties=[],this.methods=[],this.methodtypes=[],this.enumerations=[],this.units=[],this.datatypes=[],this.categories=[],this.generatedFromModelRef="",this.layout="ForceDirected",this.routing="Normal",this.linkcurve="None",this.includeInheritedReltypes=!1,this.includeSystemtypes=!1,this.objecttypes=[],this.objecttypes0=[],this.objtypegeos=[],this.objecttypeviews=[],this.relshiptypes=[],this.relshiptypes0=[],this.relshiptypeviews=[]}getLoc(e){let t="";if(_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(e)){let i=this.objtypegeos;if(i){let l=null;for(let n=0;n<i.length;n++){if((l=i[n])&&l){let i=l.type;if(i&&i.id===e.id){t=l.loc;break}}l||(l=this.setLoc(e,""),t="")}}}return t}setLoc(e,t){let i=null;if(_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(e)){let l=this.objtypegeos;if(l){for(let n=0;n<l.length;n++)if(i=l[n]){let l=i.type;if(l&&l.id===e.id){i.loc=t;break}}}else i=new cxObjtypeGeo(_utilities__WEBPACK_IMPORTED_MODULE_1__.gj(),this,e,t,""),this.addObjtypeGeo(i)}return i}getSize(e){let t="";if(e){let i=this.objtypegeos;if(i){let l=null;for(let n=0;n<i.length;n++)if(l=i[n]){let i=l.type;if(i&&i.id===e.id){t=l.size;break}}}}return t}setSize(e,t){let i=null;if(void 0==t&&(t=""),e){let l=this.objtypegeos;if(l){for(let n=0;n<l.length;n++)if(i=l[n]){let l=i.type;if(l&&l.id===e.id){i.size=t;break}}}else i=new cxObjtypeGeo(_utilities__WEBPACK_IMPORTED_MODULE_1__.gj(),this,e,"",t),this.addObjtypeGeo(i)}return i}setGeometries(e){this.geometries=e}close(){this.metamodels=null,this.objecttypes=null,this.properties=null,this.enumerations=null,this.units=null,this.datatypes=null,this.categories=null,this.description="",this.name="",this.id=""}send(){let e="Metamodel<br>";if(e+="id: "+this.id+"<br>",e+="name: "+this.name+"<br>",this.description.length>0&&(e+="description: "+this.description+"<br>"),this.objecttypes){let t=this.objecttypes.length;t>0&&(e+="Object types:<br>");for(let i=0;i<t;i++)e+=this.sendItem(this.objecttypes[i])}return e}sendItem(e){let t="    id: "+e.id+"<br>";return t+="    name: "+e.name+"<br>",e.description.length>0&&(t+="    description: "+e.description+"<br>"),t}getMetamodels(){return this.metamodels}getContainedMetamodels(){return this.metamodels}getSubMetamodelRefs(){return this.submetamodelRefs}getSubModels(){return this.submodels}getSubModelRefs(){return this.submodelRefs}getCategories(){return this.categories}getDatatypes(){return this.datatypes}getCurrentViewstyle(){return this.viewstyle}setCurrentViewstyle(e){this.viewstyle=e,this.findViewStyle(e.id)||this.addViewStyle(e)}getViewStyles(){return this.viewstyles}getGeometries(){return this.geometries}getViewFormats(){return this.viewformats}getFieldTypes(){return this.fieldTypes}getInputPatterns(){return this.inputpatterns}getEnumerations(){return this.enumerations}getObjtypeNames(){let e=[],t=this.getObjectTypes();if(t)for(let i=0;i<t.length;i++){let l=t[i];if(!(null==l?void 0:l.markedAsDeleted)){let t=l.getName();_utilities__WEBPACK_IMPORTED_MODULE_1__.NF(e,t)||e.push(t)}}return e}getObjectTypes(){return this.objecttypes}getObjectTypes0(){return this.objecttypes0}getObjectTypeViews(){return this.objecttypeviews}getObjectTypeViewsByObjectType(e){let t=this.getObjectTypeViews();if(!t)return null;{let i=0,l=null,n=[];for(;i<t.length;)(null==(l=t[i])?void 0:l.markedAsDeleted)||l.typeRef!==e.id||n.push(l),i++;return n}}removeAllObjectTypeViewsByObjectType(e){let t=this.getObjectTypeViews(),i=this.getObjectTypeViewsByObjectType(e);if(!i)return[];for(let e=0;e<i.length;e++){let l=i[e];if(l)for(let e=0;e<t.length;e++){let i=t[e];if(i&&i.id===l.id){t.splice(e,1);break}}}return t}getRelshipTypeViewsByRelshipType(e){let t=this.getRelshipTypeViews();if(!t)return null;{let i=0,l=null,n=[];for(;i<t.length;)(null==(l=t[i])?void 0:l.markedAsDeleted)||l.typeRef!==e.id||n.push(l),i++;return n}}removeAllRelshipTypeViewsByRelshipType(e){let t=this.getRelshipTypeViews(),i=this.getRelshipTypeViewsByRelshipType(e);if(!i)return[];for(let e=0;e<i.length;e++){let l=i[e];if(l)for(let e=0;e<t.length;e++){let i=t[e];if(i&&i.id===l.id){t.splice(e,1);break}}}return t}getObjtypeGeos(){return this.objtypegeos}getProperties(){return this.properties}getMethods(){return this.methods}getMethodTypes(){return this.methodtypes}getReltypeNames(e){let t=[],i=this.getRelshipTypes();if(i){for(let l=0;l<i.length;l++){let n=i[l];if((!e||(null==n?void 0:n.getRelshipKind())!==_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.GEN)&&!(null==n?void 0:n.markedAsDeleted)){let e=n.getName();_utilities__WEBPACK_IMPORTED_MODULE_1__.NF(t,e)||t.push(e)}}t.sort()}return t}getRelshipTypes(){return this.relshiptypes}getRelshipTypes0(){return this.relshiptypes0}getRelshipTypeViews(){return this.relshiptypeviews}getMetaContainers(){return this.containers}getUnits(){return this.units}addMetamodel(e){(null==e?void 0:e.category)===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_METAMODEL&&(null==this.metamodels&&(this.metamodels=[]),this.metamodels.push(e),this.metamodels=[...new Set(this.metamodels)])}addContainedMetamodel(e){(null==e?void 0:e.category)!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_METAMODEL||(null==this.metamodels&&(this.metamodels=[]),this.findContainedMetamodel(e.id)||this.metamodels.push(e))}addSubMetamodelRef(e){null==this.submetamodelRefs&&(this.submetamodelRefs=[]),this.findSubMetamodelRef(e)||this.submetamodelRefs.push(e)}addMetamodelContent(e){null==this.metamodels&&(this.metamodels=[]);let t=e.getObjectTypes();if(t)for(let e=0;e<t.length;e++){let i=t[e];this.findObjectType(i.id)||this.objecttypes.push(i)}let i=e.getRelshipTypes();if(i)for(let e=0;e<i.length;e++){let t=i[e];this.findRelationshipType(t.id)||this.relshiptypes.push(t)}}addSubModel(e){(null==e?void 0:e.category)!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_MODEL||(null==this.submodels&&(this.submodels=[]),this.findSubModel(e.id)||this.submodels.push(e))}addDatatype(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_DATATYPE){if(null==this.datatypes&&(this.datatypes=[]),this.findDatatype(e.id)){let t=this.datatypes;for(let i=0;i<t.length;i++)if(t[i].id===e.id){t[i]=e;break}}else this.datatypes.push(e)}}addViewStyle(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_VIEWSTYLE||(this.viewstyle||(this.viewstyle=e),null==this.viewstyles&&(this.viewstyles=[]),this.findViewStyle(e.id)||this.viewstyles.push(e))}addGeometry(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_GEOMETRY||(null==this.geometries&&(this.geometries=[]),this.findGeometry(e.id)||this.geometries.push(e))}addViewFormat(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_VIEWFORMAT||(null==this.viewformats&&(this.viewformats=[]),this.findViewFormat(e.id)||this.viewformats.push(e))}addFieldType(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_FIELDTYPE||(null==this.fieldTypes&&(this.fieldTypes=[]),this.findFieldType(e.id)||this.fieldTypes.push(e))}addInputPattern(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_INPUTPATTERN||(null==this.inputpatterns&&(this.inputpatterns=[]),this.findInputPattern(e.id)||this.inputpatterns.push(e))}addEnumeration(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_ENUMERATION||(null==this.enumerations&&(this.enumerations=[]),this.findEnumeration(e.id)||this.enumerations.push(e))}addObjectType(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTTYPE){if(null==this.objecttypes&&(this.objecttypes=[]),this.findObjectType(e.id)){let t=this.objecttypes;for(let i=0;i<t.length;i++)if(t[i].id===e.id){t[i]=e;break}}else this.objecttypes.push(e)}}addObjectTypeByName(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTTYPE){if(null==this.objecttypes&&(this.objecttypes=[]),this.findObjectTypeByName(e.name)){let t=this.objecttypes;for(let i=0;i<t.length;i++)if(t[i].name===e.name){t[i]=e;break}}else this.objecttypes.push(e)}}addObjectType0(e){if(e&&e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTTYPE){if(null==this.objecttypes0&&(this.objecttypes0=[]),this.findObjectType0(e.id)){let t=this.objecttypes0;for(let i=0;i<t.length;i++)if(t[i].id===e.id){t[i]=e;break}}else this.objecttypes0.push(e)}}addObjectType0ByName(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTTYPE){if(null==this.objecttypes0&&(this.objecttypes0=[]),this.findObjectType0ByName(e.name)){let t=this.objecttypes0;for(let i=0;i<t.length;i++)if(t[i].name===e.name){t[i]=e;break}}else this.objecttypes0.push(e)}}removeObjectType(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTTYPE){let t=[];for(let i=0;i<this.objecttypes.length;i++)this.findObjectType(e.id)||t.push(e);this.objecttypes=t}}addObjectTypeView(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTTYPEVIEW){if(null==this.objecttypeviews&&(this.objecttypeviews=[]),this.findObjectTypeView(e.id)){let t=this.objecttypeviews;for(let i=0;i<t.length;i++)if(t[i].id===e.id){t[i]=e;break}}else this.objecttypeviews.push(e)}}addObjtypeGeo(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTTYPEGEO){if(null==this.objtypegeos&&(this.objtypegeos=[]),this.findObjtypeGeo(e.id)){let t=this.objtypegeos;for(let i=0;i<t.length;i++)if(t[i].id===e.id){t[i]=e;break}}else this.objtypegeos.push(e)}}addProperty(e){e&&e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_PROPERTY&&(null==this.properties&&(this.properties=[]),this.findPropertyByName(e.name)||this.properties.push(e))}addMethod(e){if(e&&e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_METHOD){var t;let i=[],l=null===(t=this.methods)||void 0===t?void 0:t.length;if(l){let t=!1;for(let n=0;n<l;n++){let l=this.methods[n];l&&(l.id===e.id?(i.push(e),t=!0):i.push(l))}t||i.push(e)}else i.push(e);this.methods=i}}addMethodType(e){if(e&&e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_METHODTYPE){var t;let i=[],l=null===(t=this.methodtypes)||void 0===t?void 0:t.length;if(l){let t=!1;for(let n=0;n<l;n++){let l=this.methodtypes[n];l&&(l.id===e.id?(i.push(e),t=!0):i.push(l))}t||i.push(e)}else i.push(e);this.methodtypes=i}}addRelationshipType(e){if((null==e?void 0:e.category)===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELSHIPTYPE){if(null==this.relshiptypes&&(this.relshiptypes=[]),this.findRelationshipType(e.id)){if(e){let t=this.relshiptypes;for(let i=0;i<t.length;i++)if(t[i].id===(null==e?void 0:e.id)){t[i]=e;break}}}else this.relshiptypes.push(e),debug&&console.log("3757 Add reltype",e)}}addRelationshipType0(e){if((null==e?void 0:e.category)===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELSHIPTYPE){if(e.name!==_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_RELSHIP_TYPE&&e.name!==_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM__IS)null==this.relshiptypes0&&(this.relshiptypes0=[]),this.findRelationshipType0(e.id)||this.relshiptypes0.push(e);else{let i=this.relshiptypes0;for(let l=0;l<i.length;l++){var t;if(i[l].id===(null===(t=reltype)||void 0===t?void 0:t.id)){i[l]=e;break}}}}}addRelationshipTypeView(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELSHIPTYPEVIEW){if(null==this.relshiptypeviews&&(this.relshiptypeviews=[]),this.findRelationshipTypeView(e.id)){let t=this.relshiptypeviews.length;for(let i=0;i<t;i++){let t=this.relshiptypeviews[i];if(debug&&console.log("3687 rtview",t),t.id===e.id){for(let i in e)"id"!==i&&"name"!==i&&"data"!==i&&"typeRef"!==i&&(t[i]=e[i],t.data[i]=e[i]);debug&&console.log("3694 rtview",t);return}}}else this.relshiptypeviews.push(e),debug&&console.log("3682 reltypeview",e)}}addSubMetamodel(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_METAMODEL||(null==this.submetamodelRefs&&(this.submetamodelRefs=[]),this.findSubMetamodelRef(e.id)||this.submetamodelRefs.push(e.id))}addMetaContainer(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_METACONTAINER||(null==this.containers&&(this.containers=[]),this.findMetaContainer(e.id)||this.containers.push(e))}addUnit(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_UNIT){null==this.units&&(this.units=[]);let t=e.getName();for(let e=0;e<this.units.length;e++)if(this.units[e].getName()===t)return;this.units.push(e)}}addUnitCategory(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_UNITCATEGORY||(null==this.categories&&(this.categories=[]),this.findUnitCategory(e.id)||this.categories.push(e))}findDatatype(e){let t=this.getDatatypes();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.id===e)return l;return null}findDatatypeByName(e){let t=this.getDatatypes();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.getName()===e)return l;return null}findViewFormat(e){let t=this.getViewFormats();if(t){let i=0;for(;i<t.length;){let l=t[i];if(l&&l.id===e)return l;i++}}return null}findFieldType(e){let t=this.getFieldTypes();if(t){let i=0;for(;i<t.length;){let l=t[i];if(l&&l.id===e)return l;i++}}return null}findInputPattern(e){let t=this.getInputPatterns();if(t){let i=0;for(;i<t.length;){let l=t[i];if(l&&l.id===e)return l;i++}}return null}findEnumeration(e){let t=this.getEnumerations();if(!t)return null;let i=0,l=null;for(;i<t.length;){if((l=t[i]).id===e)return l;i++}return null}findObjectType(e){let t=this.getObjectTypes();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(l=t[i]){if(l.isDeleted())continue;if(l.id===e)return l}return null}findObjectType0(e){let t=this.getObjectTypes0();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i])&&l.id===e)return l;i++}}return null}findObjectTypeByName(e){let t=this.getObjectTypes();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.getName()===e)return l;return null}findObjectType0ByName(e){let t=this.getObjectTypes0();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.getName()===e)return l;return null}findObjectTypeView(e){let t=this.getObjectTypeViews();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(l=t[i]){if(l.isDeleted())continue;if(l.id===e)return l}return null}findObjectTypeViewByName(e){let t=this.getObjectTypeViews();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.getName()===e)return l;return null}findObjtypeGeo(e){let t=this.getObjtypeGeos();if(!t)return null;let i=0,l=null;for(;i<t.length;){if((l=t[i])&&l.id===e)return l;i++}return null}findObjtypeGeoByType(e){if(!e)return null;let t=this.getObjtypeGeos();if(!t)return null;for(let i=0;i<t.length;i++){let l=t[i];if(!(null==l?void 0:l.markedAsDeleted)&&l.type&&l.type.id===e.id)return l}return null}findProperty(e){let t=this.getProperties();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if((!(l=t[i])||!l.markedAsDeleted)&&l.id===e)return l;return null}findPropertyByName(e){let t=this.getProperties();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.getName()===e)return l;return null}findMethod(e){let t=this.getMethods();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if((!(l=t[i])||!l.isDeleted)&&l.id===e)return l;return null}findMethodByName(e){let t=this.getMethods();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.getName()===e)return l;return null}findMethodType(e){let t=this.getMethodTypes();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if((!(l=t[i])||!l.isDeleted)&&l.id===e)return l;return null}findMethodTypeByName(e){let t=this.getMethodTypes();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.getName()===e)return l;return null}findRelationshipType(e){let t=this.getRelshipTypes();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(l=t[i]){if(l.isDeleted())continue;if(l.id===e)return l}return null}findRelationshipType0(e){let t=this.getRelshipTypes0();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(l=t[i]){if(l.isDeleted())continue;if(l.id===e)return l}return null}findRelationshipTypeByName(e){let t=this.getRelshipTypes();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.getName()===e)return l;return null}findRelationshipTypeByName1(e,t,i){let l=this.getRelshipTypes();if(l)for(let r=0;r<l.length;r++){let a=l[r];if(!a.isDeleted()&&a.getName()===e){var n,s;if((null===(n=a.fromObjtype)||void 0===n?void 0:n.id)===(null==t?void 0:t.id)&&(null===(s=a.toObjtype)||void 0===s?void 0:s.id)===(null==i?void 0:i.id))return a}}return null}findRelationshipTypeByName2(e,t,i){let l=this.getRelshipTypes();if(l)for(let n=0;n<l.length;n++){let s=l[n];if(!s.isDeleted()&&s.getName()===e&&s.isAllowedFromType(t,!0)&&(debug&&console.log("3737 reltype",s,t,i),s.isAllowedToType(i,!0)))return debug&&console.log("3739 reltype",s,t,i),s}return null}findRelationshipTypeByNames(e,t,i){let l=this.getRelshipTypes();if(!l)return null;let n=0,s=null;for(n=0;n<l.length;n++)if(!(s=l[n]).isDeleted()&&s.getName()===e){let e=s.getFromObjType(),l=s.getToObjType();if(e&&l&&e.getName()===t&&l.getName()===i)return s}return null}findRelationshipType0ByNames(e,t,i){let l=this.getRelshipTypes0();if(!l)return null;let n=0,s=null;for(n=0;n<l.length;n++)if(!(s=l[n]).isDeleted()&&s.getName()===e){let e=s.getFromObjType(),l=s.getToObjType();if(e&&l&&e.getName()===t&&l.getName()===i)return s}return null}findRelationshipTypesByName(e){let t=this.getRelshipTypes();if(!t)return null;let i=[],l=0,n=null;for(l=0;l<t.length;l++)(n=t[l]).isDeleted()||n.getName()!==e||i.push(n);return i}findRelationshipTypesBetweenTypes(e,t,i){if(!e||!t)return null;let l=this.getRelshipTypes();if(!l)return null;let n=[],s=0,r=null;for(s=0;s<l.length;s++){if((r=l[s]).isDeleted()||r.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_IS)continue;if(r.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_REFERS_TO){n.push(r);continue}let a=r.getFromObjType(),d=r.getToObjType();if(a&&d){if(r.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_RELATIONSHIP_TYPE){if(e.name!==_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ENTITY_TYPE||t.name!==_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ENTITY_TYPE)continue;n.push(r)}e.inherits(a)&&t.inherits(d)?a.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ENTITY_TYPE||a.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_GENERIC?i&&n.push(r):a.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ENTITY_TYPE&&n.push(r):i&&a.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ENTITY_TYPE&&d.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ENTITY_TYPE&&n.push(r)}r.relshipkind!==_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.GEN&&r.isAllowedFromType(e,i)&&r.isAllowedToType(t,i)&&n.push(r)}return n}findRelationshipTypes0BetweenTypes(e,t,i){if(!e||!t)return null;let l=this.getRelshipTypes0();if(!l)return null;let n=[],s=0,r=null;for(s=0;s<l.length;s++){if((r=l[s]).isDeleted()||r.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_IS)continue;if(r.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_REFERS_TO){n.push(r);continue}let a=r.getFromObjType(),d=r.getToObjType();if(a&&d){if(r.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_RELATIONSHIP_TYPE){if(e.name!==_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ENTITY_TYPE||t.name!==_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ENTITY_TYPE)continue;n.push(r)}e.inherits(a)&&t.inherits(d)?a.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ENTITY_TYPE||a.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_GENERIC?i&&n.push(r):a.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ENTITY_TYPE&&n.push(r):i&&a.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ENTITY_TYPE&&d.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ENTITY_TYPE&&n.push(r)}r.relshipkind!==_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.GEN&&r.isAllowedFromType(e,i)&&r.isAllowedToType(t,i)&&n.push(r)}return n}findRelationshipTypeView(e){if(!this.relshiptypeviews)return null;let t=0,i=null;for(t=0;t<this.relshiptypeviews.length;t++)if(i=this.relshiptypeviews[t]){if(i.isDeleted())continue;if(i.id===e)return i}return null}findMetamodel(e){let t=this.metamodels;if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.id===e)return l;return null}findContainedMetamodel(e){let t=this.metamodels;if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.id===e)return l;return null}findSubMetamodelRef(e){let t=this.submetamodelRefs;if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if((l=t[i])===e)return l;return null}findSubModel(e){let t=this.submodels;if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.id===e)return l;return null}findSubModelByName(e){let t=this.submodels;if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.name===e)return l;return null}findMetaContainer(e){let t=this.getMetaContainers();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.id===e)return l;return null}findUnit(e){let t=this.getUnits();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.id===e)return l;return null}findUnitByName(e){let t=this.getUnits();if(!t)return null;let i=0,l=null;for(;i<t.length;){let e=(l=t[i]).getName();if(e.toLowerCase()===e.toLowerCase())return l;i++}return null}findUnitCategory(e){let t=this.getCategories();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.id===e)return l;return null}findViewStyle(e){let t=this.getViewStyles();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.id===e)return l;return null}findViewStyleByName(e){let t=this.getViewStyles();if(!t)return null;let i=0,l=null;for(;i<t.length;){let e=(l=t[i]).getName();if(e.toLowerCase()===e.toLowerCase())return l;i++}return null}findGeometry(e){let t=this.getGeometries();if(!t)return null;let i=0,l=null;for(i=0;i<t.length;i++)if(!(l=t[i]).isDeleted()&&l.id===e)return l;return null}findGeometryByName(e){let t=this.getGeometries();if(!t)return null;let i=0,l=null;for(;i<t.length;){let e=(l=t[i]).getName();if(e.toLowerCase()===e.toLowerCase())return l;i++}return null}setLayout(e){this.layout=e}getLayout(){return this.layout}setRouting(e){this.routing=e}getRouting(){return this.routing}purgeObjtypeGeos(){let e=[],t=this.objtypegeos;if(t){for(let n=0;n<t.length;n++){let s=t[n];if(s.isDeleted())continue;if((null==e?void 0:e.length)===0){e.push(s);continue}let r=!1;for(let t=0;t<(null==e?void 0:e.length);t++){var i,l;let n=e[t];if((null==n?void 0:null===(i=n.type)||void 0===i?void 0:i.id)===(null==s?void 0:null===(l=s.type)||void 0===l?void 0:l.id)){r=!0;continue}}r||e.push(s)}return debug&&console.log("purgeObjtypeGeos: "+e),e}}embedContainedMetamodels(){let e=this.metamodels;if(e)for(let t=0;t<e.length;t++){let i="id",l=e[t];l.isDeleted()||(this.objecttypes=this.objecttypes.concat(l.objecttypes),_utilities__WEBPACK_IMPORTED_MODULE_1__.Ip(this.objecttypes,i),this.objecttypes0=this.objecttypes0.concat(l.objecttypes0),_utilities__WEBPACK_IMPORTED_MODULE_1__.Ip(this.objecttypes0,i),this.relshiptypes=this.relshiptypes.concat(l.relshiptypes),_utilities__WEBPACK_IMPORTED_MODULE_1__.Ip(this.relshiptypes,i),this.relshiptypes0=this.relshiptypes0.concat(l.relshiptypes0),_utilities__WEBPACK_IMPORTED_MODULE_1__.Ip(this.relshiptypes0,i),this.objecttypeviews=this.objecttypeviews.concat(l.objecttypeviews),_utilities__WEBPACK_IMPORTED_MODULE_1__.Ip(this.objecttypeviews,i),this.relshiptypeviews=this.relshiptypeviews.concat(l.relshiptypeviews),_utilities__WEBPACK_IMPORTED_MODULE_1__.Ip(this.relshiptypeviews,i))}}constructor(e,t,i){super(e,t,i),this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_METAMODEL,this.clearContent()}}class cxMetaContainer extends cxMetaObject{constructor(e,t,i){super(e,t,i),this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_CONTAINER,this.members=null,this.subcontainers=null}}class cxType extends cxMetaObject{addSupertype(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTTYPE||e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELSHIPTYPE){this.supertypes||(this.supertypes=[]);for(let t=0;t<this.supertypes.length;t++)if(this.supertypes[t].id===e.id)return;this.supertypes.push(e)}}addProperty(e){if(e&&e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_PROPERTY){var t;let i=null===(t=this.properties)||void 0===t?void 0:t.length;if(i){let t=!1;for(let l=0;l<i;l++){let i=this.properties[l];i&&i.name===e.name&&(this.properties[l]=e,t=!0)}t||this.properties.push(e)}else this.properties.push(e)}}addProperty2(e,t,i,l){this.properties||(this.properties=[]);let n=new cxProperty(e,t,i);return n.setDescription(i),n.setDatatype(l),this.properties.push(n),n}addAttribute(e){e&&this.attributes.push(e)}addAttribute2(e){let t=new cxAttribute(this,e);t&&this.attributes.push(t)}addMethod(e){if(e&&e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_METHOD){var t;let i=[],l=null===(t=this.methods)||void 0===t?void 0:t.length;if(l){let t=!1;for(let n=0;n<l;n++){let l=this.methods[n];l&&(l.id===e.id?(i.push(e),t=!0):i.push(l))}t||i.push(e)}else i.push(e);this.methods=i}}addQuery(e){}findAttributeByProperty(e){let t=this.attributes;for(let i=0;i<t.length;i++){let l=t[i];if(l.propRef===e)return l}return null}findProperty(e){let t=this.properties;if(!t)return null;let i=t.length,l=0;for(;l<i;){if(t[l].id===e)return t[l];l++}return null}findPropertyByName(e){let t=this.properties;if(!t)return null;{let l=t.length,n=0;for(;n<l;){var i;if((null===(i=t[n])||void 0===i?void 0:i.name)===e)return t[n];n++}return null}}findPropertyByName2(e,t){debug&&console.log("3488 propname, this",e,this);let i=this.properties;if(i){let t=i.length,l=0;for(;l<t;){if(i[l].name===e)return i[l];l++}}if(t&&(debug&&console.log("3501 supertypes",this.supertypes),this.supertypes)){let t=this.supertypes.length;for(let i=0;i<t;i++){let t=this.supertypes[i];if(debug&&console.log("3490 supertype",t),t){let i=t.properties;for(let t=0;t<(null==i?void 0:i.length);t++){let l=i[t];if(l&&l.name===e)return l}}}}return null}findMethod(e){let t=this.methods;if(!t)return null;let i=t.length,l=0;for(;l<i;){if(t[l].id===e)return t[l];l++}return null}findMethodByName(e){let t=this.methods;if(!t)return null;{let l=t.length,n=0;for(;n<l;){var i;if((null===(i=t[n])||void 0===i?void 0:i.name)===e)return t[n];n++}return null}}findMethodByName2(e,t){debug&&console.log("3740 propname, this",e,this);let i=this.methods;if(i){let t=i.length,l=0;for(;l<t;){if(i[l].name===e)return i[l];l++}}if(t&&(debug&&console.log("3753 supertypes",this.supertypes),this.supertypes)){let t=this.supertypes.length;for(let i=0;i<t;i++){let t=this.supertypes[i];if(debug&&console.log("3758 supertype",t),t){let i=t.methods;for(let t=0;t<(null==i?void 0:i.length);t++){let l=i[t];if(l&&l.name===e)return l}}}}return null}getViewKind(){return _utilities__WEBPACK_IMPORTED_MODULE_1__.y9(this.viewkind)?this.viewkind:""}setViewKind(e){this.viewkind=e}setRelshipKind(e){this.relshipkind=e}getRelshipKind(){return _utilities__WEBPACK_IMPORTED_MODULE_1__.y9(this.relshipkind)?this.relshipkind:_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.REL}getSupertypes(){return this.supertypes}getProperties(e){if(!e)return this.properties;let t=this.properties;if(e){if(debug&&console.log("3485 superprops",this.supertypes),this.supertypes){let e=this.supertypes.length;for(let i=0;i<e;i++){let e=this.supertypes[i];if(debug&&console.log("3490 supertype",e),e){let i=e.properties;for(let e=0;e<(null==i?void 0:i.length);e++){let l=i[e];if(l){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];if(n&&n.id===l.id){e=!0;break}}e||this.properties.push(l)}}}}}this.removeDuplicateProperties()}return debug&&console.log("3505 properties",this.properties),this.properties}hasProperties(){return!!_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(this.properties)&&!_utilities__WEBPACK_IMPORTED_MODULE_1__.by(this.properties)}getPointerProperties(e){let t=this.getProperties(e);if(!t)return t;let i=[];for(let e=0;e<t.length;e++){let l=t[e];l&&l.isPointerProperty()&&i.push(l)}return i}getAttributes(){return this.attributes}getMethods(){return this.methods}hasMethods(){return!_utilities__WEBPACK_IMPORTED_MODULE_1__.by(this.methods)}getQueries(){return this.queries}hasQueries(){return!_utilities__WEBPACK_IMPORTED_MODULE_1__.by(this.queries)}setAbstract(e){this.abstract=e}getAbstract(){return!!_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(this.abstract)&&this.abstract}clearAbstract(){this.abstract=!1}isAbstract(){return this.getAbstract()}setDefaultValueset(e){this.defaultValueset=e}getDefaultTypeView(){return this.typeview}getDefaultValueset(){return this.defaultValueset}removeDuplicateProperties(){let e=[],t=this.properties,i=this.properties;for(let l=0;l<(null==t?void 0:t.length);l++){let n=t[l];for(let t=0;t<i.length;t++){let l=i[t];if(n&&l&&n.name===l.name){if(n.id!==l.id)break;e.push(n);break}}}debug&&console.log("3893 this.properties, props",this.properties,e),this.properties=e}isOfType(e){let t=!1;if(this.name===e)return!0;let i=this.supertypes;for(let t=0;t<(null==i?void 0:i.length);t++){let l=i[t];if((null==l?void 0:l.name)===e)return!0}return t}constructor(e,t,i){super(e,t,i),this.abstract=!1,this.supertypes=[],this.supertypeRefs=[],this.properties=[],this.propertyRefs=[],this.attributes=[],this.typeview=null,this.typeviewRef="",this.viewkind="",this.relshipkind="",this.defaultValueset=null,this.methods=[],this.methodRefs=[],this.queries=[]}}class cxObjectType extends cxType{addInputreltype(e){this.inputreltypes||(this.inputreltypes=[]);let t=this.inputreltypes.length;for(let i=0;i<t;i++)if(this.inputreltypes[i].id===(null==e?void 0:e.id))return;this.inputreltypes.push(e)}removeInputreltype(e){if(!this.inputreltypes)return;let t=[],i=this.inputreltypes.length;for(let l=0;l<i;l++)this.inputreltypes[l].id!==e.id&&t.push(e);this.inputreltypes=t}addOutputreltype(e){this.outputreltypes||(this.outputreltypes=[]);let t=this.outputreltypes.length;for(let i=0;i<t;i++)if(this.outputreltypes[i].id===(null==e?void 0:e.id))return;this.outputreltypes.push(e)}removeOutputreltype(e){if(!this.outputreltypes)return;let t=[],i=this.outputreltypes.length;for(let l=0;l<i;l++){let i=this.outputreltypes[l];i.id!==e.id&&t.push(i)}this.outputreltypes=t}getOutputReltypes(e){if(!this.outputreltypes)return null;let t=[],i=this.outputreltypes.length;for(let l=0;l<i;l++){let i=this.outputreltypes[l];e?i.relshipkind===e&&t.push(i):t.push(i)}return t}addPort(e){let t;this.ports||(this.ports=[]);let i=(t=this.ports).length;for(let l=0;l<i;l++){if(t[l].id===e.id)return;t.push(e)}}getPorts(){return this.ports}getPort(e){let t=this.ports,i=t.length;for(let l=0;l<i;l++){let i=t[l];if(i.id===e)return i}return null}getPortsBySide(e){let t=[],i=this.ports.length;for(let l=0;l<i;l++){let i=this.ports[l];i.side===e&&t.push(i)}return t}getPortByNameAndSide(e,t){let i=this.getPortsBySide(t);if(!i)return null;let l=i.length;for(let t=0;t<l;t++){let l=i[t];if(l.name===e)return l}return null}getLoc(e){if(null==e?void 0:e.objtypegeos){let t=e.objtypegeos;if(t)for(let i=0;i<t.length;i++){let l=t[i];if(l&&l.metamodel&&l.metamodel.id===e.id){let e=l.type;if(e&&e.id==this.id)return l.loc}}}return""}getSize(e){if(null==e?void 0:e.objtypegeos){let t=e.objtypegeos;if(t)for(let i=0;i<t.length;i++){let l=t[i];if(l){let t=l.metamodel;if(t&&t.id===e.id){let e=l.type;if(e&&e.id==this.id)return l.size}}}}return""}getObjtypeGeos(){return this.objtypegeos}addObjtypeGeo(e){null==this.objtypegeos&&(this.objtypegeos=[]),this.objtypegeos.push(e)}setDefaultTypeView(e){let t=e;t&&(this.typeview=t)}getTypeId(){return this.typeid}getDefaultTypeView(){return this.typeview}newDefaultTypeView(e){let t=this.name+"_"+e,i=new cxObjectTypeView(_utilities__WEBPACK_IMPORTED_MODULE_1__.gj(),t,this,"");return _utilities__WEBPACK_IMPORTED_MODULE_1__.y9(i)&&i.setViewKind(this.viewkind),this.typeview=i,this.typeview}isInstantiable(){let e=!0;return this.markedAsDeleted?e=!1:this.abstract&&(e=!1),e}getViewKind(){return _utilities__WEBPACK_IMPORTED_MODULE_1__.y9(this.viewkind)?this.viewkind:""}setViewKind(e){this.viewkind=e}setRelshipKind(e){this.relshipkind=e}getRelshipKind(){return _utilities__WEBPACK_IMPORTED_MODULE_1__.y9(this.relshipkind)?this.relshipkind:_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.REL}setFromObjtype(e){this.fromObjtype=e}getFromObjType(){return this.fromObjtype}setToObjtype(e){this.toObjtype=e}getToObjType(){return this.toObjtype}setAllObjecttypes(e){this.allObjecttypes=e}getAllObjecttypes(){return this.allObjecttypes}setAllRelationshiptypes(e){this.allRelationshiptypes=e}getAllRelationshiptypes(){return this.allRelationshiptypes}isContainer(){return this.viewkind==_constants__WEBPACK_IMPORTED_MODULE_2__.viewkinds.CONT}findRelatedObjectTypes(e){let t=[],i=this.allRelationshiptypes;if(debug&&console.log("3414 allReltypes",i),!i)return null;{let l=0,n=null;for(;l<i.length;){if((n=i[l])&&n.getRelshipKind()===e){let e=n.getFromObjType();if(e&&(debug&&console.log("3426 reltype",e.name),n.getFromObjType().id===this.id)){let e=n.getToObjType();debug&&console.log("3429 reltype",e.name),t.push(e)}}l++}}return t}findSupertypes(e){let t=[];try{e||(e=0);let i=this.outputreltypes;if(i)for(let l=0;l<(null==i?void 0:i.length);l++){let n=i[l];if((null==n?void 0:n.relshipkind)===_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.GEN){let i=n.toObjtype;if(i){if(t.push(i),t=[...new Set(t)],e>5)return t;let l=i.findSupertypes(++e);if(l)for(let e=0;e<l.length;e++){let i=l[e];t.push(i),t=[...new Set(t)]}}}}}catch(e){console.log("5680 error",e)}return t}inherits(e,t){if(t||(t=0),t>5)return!1;let i=!1;if(this.id===e.id)return!0;{let l=this.getOutputReltypes(_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.GEN);if(l)for(let n=0;n<l.length;n++){let s=l[n],r=null==s?void 0:s.toObjtype;if(r){if(r.id===e.id){i=!0;break}t++,i=r.inherits(e,t)}}}return i}findRelshipTypeByKind(e,t){let i=this.findRelshipTypeByKind1(e,t,this.allRelationshiptypes);return i||(i=this.findRelshipTypeByKind2(e,t))?i:i=this.findRelshipTypeByKind3(e,t)}findRelshipTypeByKind1(e,t,i){if(i){let l,n=0;for(;n<i.length;){if((l=i[n])&&l.getRelshipKind()===e){let n=l.getFromObjType();if(n&&n.id===this.id){let n=l.getToObjType();if(n&&n.id===t.id)return l;{let l=_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.GEN,n=t.findRelatedObjectTypes(l);if(n)for(let t=0;t<n.length;t++){let l=n[t],s=this.findRelshipTypeByKind1(e,l,i);if(s)return s}}}}n++}}return null}findRelshipTypeByKind2(e,t){let i=this.findRelatedObjectTypes(e);if(i&&i.length>0)for(let l=0;l<i.length;l++){let n=i[l];if(t.inherits(n)){let t=this.findRelshipTypeByKind1(e,n,this.allRelationshiptypes);if(t)return t}else{let t=_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.GEN,i=n.findRelatedObjectTypes(t);if(i.length>0)for(let t=0;t<i.length;t++){let l=i[t],n=this.findRelshipTypeByKind2(e,l);if(n)return n}}}return null}findRelshipTypeByKind3(e,t){let i=_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.GEN,l=this.findRelatedObjectTypes(i);if(l&&l.length>0){for(let i=0;i<l.length;i++){let n=l[i],s=n.findRelshipTypeByKind1(e,t,null);if(_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(s)||(s=n.findRelshipTypeByKind3(e,t),_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(s)))return s}return null}}numberOfMetamodelsUsage(e){let t=0,i=e.metamodels;for(let e=0;e<i.length;e++){let l=i[e].objecttypes;for(let e=0;e<l.length;e++)if(l[e].id===this.id){t++;break}}return t}constructor(e,t,i){super(e,t,i),this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTTYPE,this.typeid=_constants__WEBPACK_IMPORTED_MODULE_2__.types.OBJECTTYPE_ID,this.viewkind=_constants__WEBPACK_IMPORTED_MODULE_2__.viewkinds.OBJ,this.relshipkind="",this.ports=null,this.fromObjtype=null,this.toObjtype=null,this.objtypegeos=null,this.inputreltypes=null,this.outputreltypes=null,this.allObjecttypes=null,this.allRelationshiptypes=null,this.markedAsDeleted=!1,debug&&console.log("3268 this",this)}}class cxObjtypeGeo extends cxMetaObject{getMetamodel(){return this.metamodel}setMetamodel(e){_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(e)&&(this.metamodel=e)}getType(){return this.type}setType(e){e&&(this.type=e)}getLoc(){return this.loc}setLoc(e){this.loc=e}getSize(){return void 0==this.size?"":this.size}setSize(e){void 0==e&&(e=""),this.size=e}constructor(e,t,i,l,n){super(e,"",""),this.category="Object type geo",this.metamodel=t,this.metamodelRef="",this.type=i,this.loc=void 0===l?"":l,this.size=void 0===n?"":n}}class cxRelationshipType extends cxObjectType{setDefaultTypeView(e){this.typeview=e}newDefaultTypeView(e){let t=this.name+"_"+e,i=new cxRelationshipTypeView(_utilities__WEBPACK_IMPORTED_MODULE_1__.gj(),t,this,"");return _utilities__WEBPACK_IMPORTED_MODULE_1__.y9(i)&&(i.setRelshipKind(this.relshipkind),i.setFromArrow2(e),i.setToArrow2(e)),this.typeview=i,this.typeview}getDefaultTypeView(){return this.typeview}setCardinality(e){this.cardinality=e}getCardinality(){return this.cardinality}getCardinalityFrom(){return this.cardinalityFrom}getCardinalityTo(){return this.cardinalityTo}setNameFrom(e){this.nameFrom=e}getNameFrom(){return this.nameFrom}setNameTo(e){this.nameTo=e}getNameTo(){return this.nameTo}isInstantiable(){let e=!0;return this.markedAsDeleted?e=!1:this.abstract&&(e=!1),e}isAllowedFromType(e,t){return!!(e&&this.fromObjtype&&(this.fromObjtype.id===e.id||t&&e.inherits(this.fromObjtype)))}isAllowedToType(e,t){return!!(e&&this.toObjtype&&(this.toObjtype.id===e.id||t&&e.inherits(this.toObjtype)))}isAllowedFromAndToTypes(e,t){let i=!1;return(e||t)&&this.toObjtype.name!==_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ELEMENT&&this.toObjtype.name!==_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ENTITY_TYPE&&e.inherits(this.toObjtype)&&t.inherits(this.toObjtype)&&(i=!0),i}setFromObjectType(e){this.fromObjtype=e,this.fromobjtypeRef=e.id}setToObjectType(e){this.toObjtype=e,this.toobjtypeRef=e.id}findSupertypes(e){let t=[];try{e||(e=0);let i=this.outputreltypes;if(i)for(let l=0;l<(null==i?void 0:i.length);l++){let n=i[l];if((null==n?void 0:n.relshipkind)===_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.GEN){let i=n.toObjtype;if(i){if(t.push(i),t=[...new Set(t)],e>5)return t;let l=i.findSupertypes(++e);if(l)for(let e=0;e<l.length;e++){let i=l[e];t.push(i),t=[...new Set(t)]}}}}}catch(e){console.log("5680 error",e)}return t}numberOfMetamodelsUsage(e){let t=0,i=e.metamodels;for(let e=0;e<i.length;e++){let l=i[e].relshiptypes;for(let e=0;e<l.length;e++)if(l[e].id===this.id){t++;break}}return t}constructor(e,t,i,l,n){super(e,t,n),this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELSHIPTYPE,this.typeid=_constants__WEBPACK_IMPORTED_MODULE_2__.types.RELATIONSHIPTYPE_ID,this.fromObjtype=i,this.fromobjtypeRef=null==i?void 0:i.id,this.toObjtype=l,this.toobjtypeRef=null==l?void 0:l.id,this.relshipkind=_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.REL,this.viewkind="",this.cardinality="",this.cardinalityFrom="",this.nameTo="",this.nameFrom="",this.cardinalityTo="",this.markedAsDeleted=!1,debug&&console.log("5422 New reltype",this)}}class cxProperty extends cxMetaObject{setDatatype(e){this.datatype=e,this.datatypeRef=e.id}getDatatype(){return this.datatype?this.datatype:null}getDatatypeRef(){return this.datatypeRef}setMethod(e){this.method=e}getMethod(){return this.method?this.method:null}getMethodRef(){return this.methodRef}setUnitCategory(e){this.unitCategory=e}getUnitCategory(){return _utilities__WEBPACK_IMPORTED_MODULE_1__.y9(this.unitCategory)?this.unitCategory:null}addSubProperty(e){null==this.subProperties&&(this.subProperties=[]),this.subProperties.push(e)}getSubProperties(){return this.subProperties}getSubProperty(e){if(this.subProperties)for(let t=0;t<this.subProperties.length;t++){let i=this.subProperties[t];if(i.name===e)return i}return null}setDefaultValue(e){this.defaultValue=e}getDefaultValue(){return _utilities__WEBPACK_IMPORTED_MODULE_1__.y9(this.defaultValue)?this.defaultValue:""}isPointerProperty(){let e=this.getDatatype();return null!=e&&!!e.getPointerType()}constructor(e,t,i){super(e,t,i),this.fs_collection=_constants__WEBPACK_IMPORTED_MODULE_2__.fs.FS_C_PROPERTIES,this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_PROPERTY,this.datatype=null,this.datatypeRef="",this.method=null,this.methodRef="",this.unitCategory=null,this.unitCategoryRef="",this.subProperties=null,this.defaultValue=" ",this.readOnly=!1,this.inputPattern="",this.viewFormat="",this.example=""}}class cxAttribute{constructor(e,t){t&&e&&(this.typeName=e.name,this.propName=t.name,this.name=this.typeName+"."+this.propName,this.propRef=t.id)}}class cxMethod extends cxMetaObject{setAllProperties(e){this.allProperties=e}getAllProperties(){return this.allProperties}evaluateExpression(expr){let pi=3.14159265;if(expr.length>0)return eval(expr)}constructor(e,t,i){super(e,t,i),this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_METHOD,this.methodtype=_constants__WEBPACK_IMPORTED_MODULE_2__.types.MTD_CALCULATEVALUE,this.expression="",this.allProperties=null}}class cxViewStyle extends cxMetaObject{addObjectTypeView(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTTYPEVIEW||(null==this.objecttypeviews&&(this.objecttypeviews=[]),this.findObjectTypeView(e.id)||this.objecttypeviews.push(e))}findObjectTypeView(e){let t=this.objecttypeviews;if(!t)return null;let i=null;for(let l=0;l<t.length;l++)if((i=t[l]).id===e)return i;return null}addRelationshipTypeView(e){e.category!==_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELSHIPTYPEVIEW||(null==this.relshiptypeviews&&(this.relshiptypeviews=[]),this.findRelationshipTypeView(e.id)||this.relshiptypeviews.push(e))}findRelationshipTypeView(e){let t=this.relshiptypeviews;if(!t)return null;let i=null;for(let l=0;l<t.length;l++)if((i=t[l]).id===e)return i;return null}constructor(e,t,i){super(e,t,i),this.relshiptypeviews=null,this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_VIEWSTYLE,this.objecttypeviews=null,this.relshiptypeviews=null}}class cxObjtypeviewData{constructor(){this.memberscale=1,this.arrowscale=1.3,this.viewkind=_constants__WEBPACK_IMPORTED_MODULE_2__.viewkinds.OBJ,this.template="textAndIcon",this.template2="",this.figure="",this.geometry="",this.icon="",this.image="",this.grabIsAllowed=!1,this.fillcolor="",this.fillcolor2="",this.strokecolor="gray",this.strokecolor2="gray",this.strokewidth=1,this.textcolor="",this.textcolor2="",this.textscale=1}}class cxObjectTypeView extends cxMetaObject{applyObjectViewParameters(e){if(e){let t;let i=this.data;for(t in i)void 0!=e[t]&&""!==e[t]&&(i[t]=e[t]);for(t in debug&&console.log("5580 data",i),i)this[t]=i[t];debug&&console.log("5584 this",this)}}setType(e){this.typeRef=null==e?void 0:e.id}getTypeRef(){return this.typeRef}setData(e){this.data=e}getData(){return this.data}setViewKind(e){this.data.viewkind=e,this.viewkind=e}getViewKind(){return this.data.viewkind?this.data.viewkind:_constants__WEBPACK_IMPORTED_MODULE_2__.viewkinds.OBJ}setAbstract(e){this.data.abstract=e}getAbstract(){return this.data.abstract}setGrabIsAllowed(e){this.grabIsAllowed=e}getGrabIsAllowed(){return this.grabIsAllowed}setTemplate(e){this.data.template=e,this.template=e}getTemplate(){return this.data.template?this.data.template:this.template?this.template:""}setTemplate2(e){this.data.template2=e,this.getTemplate2=e}getTemplate2(){return this.data.template2?this.data.template2:this.template2?this.template2:""}setFigure(e){this.data.figure=e,this.figure=e}getFigure(){return this.figure?this.figure:this.data.figure?this.data.figure:""}setGeometry(e){this.data.geometry=e,this.geometry=e}getGeometry(){return this.geometry?this.geometry:this.data.geometry?this.data.geometry:""}setFillcolor(e){this.data.fillcolor=e,this.fillcolor=e}getFillcolor(){return this.fillcolor?this.fillcolor:this.data.fillcolor?this.data.fillcolor:"white"}setFillcolor2(e){this.data.fillcolor2=e,this.fillcolor2=e}getFillcolor2(){return this.fillcolor2?this.fillcolor2:this.data.fillcolor2?this.data.fillcolor2:"white"}setTextcolor(e){this.data.textcolor=e,this.textcolor=e}getTextcolor(){return this.textcolor?this.textcolor:this.data.textcolor?this.data.textcolor:"black"}setTextcolor2(e){this.data.textcolor2=e,this.textcolor2=e}getTextcolor2(){return this.textcolor2?this.textcolor2:this.data.textcolor2?this.data.textcolor2:"black"}setTextscale(e){(void 0==e||null==e)&&(e=1),this.data.textscale=e,this.textscale=e}getTextscale(){return this.textscale?this.textscale:this.data.textscale?this.data.textscale:1}setStrokecolor(e){this.data.strokecolor=e,this.strokecolor=e}getStrokecolor(){return this.strokecolor?this.strokecolor:this.data.strokecolor?this.data.strokecolor:"black"}setStrokecolor2(e){this.data.strokecolor2=e,this.strokecolor2=e}getStrokecolor2(){return this.strokecolor2?this.strokecolor2:this.data.strokecolor2?this.data.strokecolor2:"black"}setStrokewidth(e){this.strokewidth=e,this.data.strokewidth=e}getStrokewidth(){return this.strokewidth?this.strokewidth:this.data.strokewidth?this.data.strokewidth:2}setMemberscale(e){this.memberscale=e,this.data.memberscale=e}getMemberscale(){return this.memberscale?this.memberscale:this.data.memberscale?this.data.memberscale:1}setArrowscale(e){this.arrowscale=e,this.data.arrowscale=e}getArrowscale(){return this.arrowscale?this.arrowscale:this.data.arrowscale?this.data.arrowscale:1.3}setIcon(e){this.data.icon=e,this.icon=e}getIcon(){return this.icon?this.icon:""}setImage(e){this.data.image=e,this.image=e}getImage(){return this.image?this.image:this.data.image?this.data.image:""}constructor(e,t,i,l){if(super(e,t,l),this.fs_collection=_constants__WEBPACK_IMPORTED_MODULE_2__.fs.FS_C_OBJECTTYPEVIEWS,this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTTYPEVIEW,this.typeRef=null==i?void 0:i.id,this.template="",this.template2="",this.figure="",this.geometry="",this.arrowscale=1,this.memberscale=1,this.fillcolor="",this.fillcolor2="",this.strokecolor="",this.strokecolor2="",this.strokewidth=1,this.textcolor="",this.textcolor2="",this.textscale=1,this.viewkind=_constants__WEBPACK_IMPORTED_MODULE_2__.viewkinds.OBJ,this.grabIsAllowed=!1,this.icon="",this.image="",this.data=new cxObjtypeviewData,i){let e=i.abstract;e&&(this.data.abstract=e)}}}class cxReltypeviewData{constructor(){this.abstract=!1,this.relshipkind=_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.REL,this.template="linkTemplate1",this.template2="",this.strokecolor="black",this.strokewidth=1,this.textcolor="black",this.arrowscale=1.3,this.textscale=1,this.dash="None",this.fromArrow="",this.toArrow="OpenTriangle",this.fromArrowColor="",this.toArrowColor="white",this.routing="Normal",this.corner=0,this.curve=0}}class cxRelationshipTypeView extends cxMetaObject{applyRelationshipViewParameters(e){if(e){let t;let i=this.data;for(t in i)void 0!=e[t]&&""!==e[t]&&("template"===t&&(i[t]=e[t]),"template2"===t&&(i[t]=e[t]),"strokecolor"===t&&(i[t]=e[t]),"strokewidth"===t&&(i[t]=e[t]),"textcolor"===t&&(i[t]=e[t]),"textscale"===t&&(i[t]=e[t]),"dash"===t&&(i[t]=e[t]),"fromArrow"===t&&(i[t]=e[t]),"toArrow"===t&&(i[t]=e[t]),"fromArrowColor"===t&&(i[t]=e[t]),"toArrowColor"===t&&(i[t]=e[t]),"routing"===t&&(i[t]=e[t]),"corner"===t&&(i[t]=e[t]),"curve"===t&&(i[t]=e[t]));for(t in debug&&console.log("5883 data",i),i)this[t]=i[t];debug&&console.log("5887 this",this)}}setType(e){this.typeRef=null==e?void 0:e.id}getTypeRef(){return this.typeRef}setData(e){this.data=e}getData(){return this.data}setAbstract(e){this.data.abstract=e}getAbstract(){return this.data.abstract}setRelshipKind(e){this.data.relshipkind=e,this.setFromArrow2(e),this.setToArrow2(e)}setTemplate(e){this.data.template=e,this.template=e}getTemplate(){return this.template?this.template:this.data.template?this.data.template:"linkTemplate1"}setTemplate2(e){this.data.template2=e,this.template2=e}getTemplate2(){return this.template2?this.template2:this.data.template2?this.data.template2:"linkTemplate1"}setStrokecolor(e){this.data.strokecolor=e,this.strokecolor=e}getStrokecolor(){return this.strokecolor?this.strokecolor:this.data.strokecolor?this.data.strokecolor:"black"}setTextcolor(e){this.data.textcolor=e,this.textcolor=e}getTextcolor(){return this.textcolor?this.textcolor:this.data.textcolor?this.data.textcolor:"black"}setTextscale(e){(void 0==e||null==e)&&(e=1),this.data.textscale=e,this.textscale=e}getTextscale(){return this.textscale?this.textscale:this.data.textscale?this.data.textscale:1}setArrowscale(e){(void 0==e||null==e)&&(e=1),this.data.arrowscale=e,this.arrowscale=e}getArrowscale(){return this.arrowscale?this.arrowscale:this.data.arrowscale?this.data.arrowscale:1}setStrokewidth(e){this.data.strokewidth=e,this.strokewidth=e}getStrokewidth(){return this.strokewidth?this.strokewidth:this.data.strokewidth?this.data.strokewidth:1}setDash(e){this.data.dash=e,this.dash=e}getDash(){return this.dash?this.dash:this.data.dash?this.data.dash:""}setRouting(e){this.data.routing=e,this.routing=e}getRouting(){return this.routing?this.routing:this.data.routing?this.data.routing:""}setCurve(e){this.data.curve=e,this.curve=e}getCurve(){return this.curve?this.curve:this.data.curve?this.data.curve:0}setCorner(e){this.data.corner=e,this.corner=e}getCorner(){return this.corner?this.corner:this.data.corner?this.data.corner:0}setFromArrow(e){this.data.fromArrow=e,this.fromArrow=e}getFromArrow(){return this.fromArrow?this.fromArrow:this.data.fromArrow?this.data.fromArrow:""}setToArrow(e){this.data.toArrow=e,this.toArrow=e}setFromArrow2(e){switch(e){case"Composition":this.setFromArrow("StretchedDiamond"),this.setFromArrowColor("black");break;case"Aggregation":this.setFromArrow("StretchedDiamond"),this.setFromArrowColor("white");break;case"Generalization":this.setFromArrow(""),this.setFromArrowColor("")}}setToArrow2(e){"Generalization"===e&&(this.setToArrow("Triangle"),this.setToArrowColor("white"),this.textcolor="black")}getToArrow(){return this.toArrow?this.toArrow:this.data.toArrow?this.data.toArrow:""}setFromArrowColor(e){this.data.fromArrowColor=e,this.fromArrowColor=e}getFromArrowColor(){return this.fromArrowColor?this.fromArrowColor:this.data.fromArrowColor?this.data.fromArrowColor:""}setToArrowColor(e){this.data.toArrowColor=e,this.toArrowColor=e}getToArrowColor(){return this.toArrowColor?this.toArrowColor:this.data.toArrowColor?this.data.toArrowColor:""}constructor(e,t,i,l){for(let n in(""===t||t===e)&&(t=(null==i?void 0:i.name)+"_"+(null==i?void 0:i.relshipkind)),super(e,t,l),this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELSHIPTYPEVIEW,this.typeRef=null==i?void 0:i.id,this.data=new cxReltypeviewData,this.data)this[n]=this.data[n];this.setFromArrow2(null==i?void 0:i.relshipkind),this.setToArrow2(null==i?void 0:i.relshipkind)}}class cxModel extends cxMetaObject{clearContent(){this.sourceMetamodelRef="",this.targetMetamodelRef="",this.sourceModelRef="",this.targetModelRef="",this.templates=null,this.isTemplate=!1,this.isMetamodel=!1,this.includeSystemtypes=!0,this.includeRelshipkind=!0,this.layer="Foreground",this.submodels=null,this.objects=null,this.relships=null,this.ports=null,this.modelviews=null,this.objectRefs=null,this.relshipRefs=null,this.portRefs=null,this.modelviewRefs=null,this.selectedNodes=[],this.selectedLinks=[]}setMetamodel(e){this.metamodel=e}getMetamodel(){return this.metamodel}addTemplate(e){null==this.templates&&(this.templates=[]),this.findTemplate(e.id)||this.templates.push(e)}findTemplate(e){let t=this.getTemplates();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i])&&l.id===e)return l;i++}}}getTemplates(){return this.templates}setIsTemplate(e){this.isTemplate=e}getIsTemplate(){return this.isTemplate}setIsMetamodel(e){this.isMetamodel=e}getIsMetamodel(){return this.isMetamodel}getModelViews(){return this.modelviews}getObjects(){return this.objects}getObjectViewsByObject(e){let t=this.modelviews,i=[];for(let l=0;l<t.length;l++){let n=t[l].findObjectViewsByObject(e);for(let e=0;e<n.length;e++){let t=n[e];i.push(t)}}return i.length>1&&_utilities__WEBPACK_IMPORTED_MODULE_1__.EL(i),i}getObjectsByType(e,t){let i=[];if(this.objects)for(let t=0;t<this.objects.length;t++){let l=this.objects[t];if(l&&!l.markedAsDeleted){let t=l.getType();t&&t.getId()===e.getId()&&i.push(l)}}return i}getObjectsByTypename(e,t){let i=[];if(this.objects)for(let t=0;t<this.objects.length;t++){let l=this.objects[t];if(l&&!l.markedAsDeleted){let t=l.getType();t&&t.name===e&&i.push(l)}}return i}getCopiedFromObject(e){debug&&console.log("5972 this.objects, fromId",this.objects,e);for(let t=0;t<this.objects.length;t++){let i=this.objects[t];if(i.copiedFromId===e)return debug&&console.log("5977 obj, fromId",i,e),i}return null}getRelationships(){return this.relships}getRelationshipsByType(e,t){let i=[];if(this.relships)for(let t=0;t<this.relships.length;t++){let l=this.relships[t];if(l&&!l.markedAsDeleted){let t=l.getType();t&&t.getId()===(null==e?void 0:e.getId())&&i.push(l)}}return i}getRelationshipsByTypeName(e,t){let i=[];if(this.relships)for(let l=0;l<this.relships.length;l++){let n=this.relships[l];n.name!==e||n.markedAsDeleted||n.relshipkind!==t||i.push(n)}return i}getSubmodels(){return this.submodels}addSubmodel(e){null==this.submodels&&(this.submodels=[]),this.findSubmodel(e.id)||this.submodels.push(e)}addModelView(e){null==this.modelviews&&(this.modelviews=[]),this.findModelView(e.id)||this.modelviews.push(e)}addObject(e){if((null==e?void 0:e.category)===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECT){if(null==this.objects&&(this.objects=[]),this.findObject(e.id)){let t=this.objects;for(let i=0;i<t.length;i++)if(t[i].id===e.id){t[i]=e;break}}else this.objects.push(e);""==e.parentModelRef&&(e.parentModelRef=this.id)}}addObjectRef(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECT){if(null==this.objectRefs&&(this.objectRefs=[]),this.findObject(e.id)){let t=this.objectRefs,i=!1;for(let l=0;l<t.length;l++)if(t[l]===e.id){i=!0;break}i||t.push(e.id)}else this.objectRefs.push(e.id)}}addRelationship(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELATIONSHIP){if(null==this.relships&&(this.relships=[]),this.findRelationship(e.id)){let t=this.relships;for(let i=0;i<t.length;i++)if(t[i].id===e.id){t[i]=e;break}}else this.relships.push(e)}}addRelshipRef(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELATIONSHIP){if(null==this.relshipRefs&&(this.relshipRefs=[]),this.findRelationship(e.id)){let t=this.relshipRefs,i=!1;for(let l=0;l<t.length;l++)if(t[l]===e.id){i=!0;break}i||t.push(e.id)}else this.relshipRefs.push(e.id)}}addPort(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_PORT){if(null==this.ports&&(this.ports=[]),this.findPort(e.id)){let t=this.ports;for(let i=0;i<t.length;i++)if(t[i].id===e.id){t[i]=e;break}}else this.ports.push(e)}}addObjects(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let l=0;for(;l<t.length;)this.addObject(t[l]),l++}addRelationships(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let l=0;for(;l<t.length;)this.addRelationship(t[l]),l++}findSubmodel(e){let t=this.getSubmodels();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i])&&l.id===e)return l;i++}}}findModelView(e){let t=this.getModelViews();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i])&&l.id===e)return l;i++}}}findModelViewByName(e){let t=this.getModelViews();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i])&&l.name===e)return l;i++}}}findObject(e){let t=this.getObjects();if(!t)return null;let i=0,l=null;for(;i<t.length;){if((l=t[i])&&l.id===e)return l;i++}return null}findObjectByName(e){let t=this.getObjects();if(!t)return null;let i=t.length,l=0;for(;l<i;){if(t[l].getName()===e)return t[l];l++}return null}findObjectByTypeAndName(e,t){if(!e)return null;let i=this.getObjects();if(!i)return null;let l=i.length,n=0;for(;n<l;){let l=i[n];if(l){let i=l.type;if(i&&i.id===e.id&&l.getName()===t)return l}n++}return null}findRelationship(e){let t=this.getRelationships();if(t){let i=0,l=null;for(;i<t.length;){if((l=t[i])&&l.id===e)return l;i++}}return null}findRelationship1(e,t,i,l,n){let s=this.relships;if(s){let r=_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(s)?s.length:0;for(let a=0;a<r;a++){let r=s[a];if(r){let s=r.getType();if(s){let a=r.getFromObject(),d=r.getToObject();if(a&&d&&s.id===(null==i?void 0:i.id)&&a.id===e.id&&d.id===t.id&&(!l&&!n||r.fromPortid===l.id&&r.toPortid===n.id))return r}}}}return null}findRelationship2(e,t,i,l,n,s){let r=this.relships;if(r){let a=_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(r)?r.length:0;for(let d=0;d<a;d++){let a=r[d];if(a&&a.name===i){let i=a.getType();if(i){let r=a.getFromObject(),d=a.getToObject();if(r&&d&&i.id===(null==l?void 0:l.id)&&r.id===(null==e?void 0:e.id)&&d.id===(null==t?void 0:t.id)&&(!n&&!s||a.fromPortid===n.id&&a.toPortid===s.id))return a}}}}return null}findEkaRelationship(e,t,i){if(!_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(e)||!_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(t)||!_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(i))return null;let l=this.objects;if(l){let n=l.length;for(let s=0;s<n;s++){let n=l[s],r=n.getType();if(r){let l=n.getFromObject(),s=n.getToObject();if(l&&s&&r.id===(null==i?void 0:i.id)&&l.id===e.id&&s.id===t.id)return n}}}return null}findRelationships(e,t,i){let l=[],n=this.relships;if(n){let s=null==n?void 0:n.length;for(let r=0;r<s;r++){let s=n[r],a=s.type;if(a&&a.id===(null==i?void 0:i.id)){let i=s.getFromObject(),n=s.getToObject();i&&n&&i.id===e.id&&n.id===t.id&&l.push(s)}}}return l}findRelationships1(e,t,i){let l=[],n=this.relships;if(n){let s=null==n?void 0:n.length;for(let r=0;r<s;r++){let s=n[r],a=s.getType();if(a&&a.getRelshipKind()===i){let i=s.getFromObject(),n=s.getToObject();i&&n&&i.id===e.id&&n.id===t.id&&l.push(s)}}}return l}deleteObjectViewsWithoutObjects(){let e=this.modelviews;for(let t=0;t<e.length;t++){let i=e[t].objectviews;for(let e=0;e<i.length;e++){let t=i[e];t.object||(t.markedAsDeleted=!0)}}}constructor(e,t,i,l){super(e,t,l),this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_MODEL,this.metamodel=i,this.clearContent()}}class cxInstance extends cxMetaObject{setAndGetAllProperties(e){let t=e.findObjectType(this.type.id);if(t||(t=e.findRelationshipType(this.type.id)),!t)return null;let i=t.getProperties(!1),l=null;if(debug&&console.log("7133 this",this),"Method"===t.name){let t=this.methodtype;if(t){let i=e.currentMetamodel.findMethodTypeByName(t);i&&(l=i.properties,debug&&console.log("7141 mtype, mtdprops",i,l))}}let n=null==i?void 0:i.concat(l);return n=null==n?void 0:n.filter(function(e){return null!=e}),this.allProperties=n,debug&&console.log("7150 properties",n),n}addInputrel(e){this.inputrels||(this.inputrels=[]);let t=this.inputrels.length;for(let i=0;i<t;i++)if(this.inputrels[i].id===e.id)return;this.inputrels.push(e)}removeInputrel(e){if(!this.inputrels)return;let t=[],i=this.inputrels.length;for(let l=0;l<i;l++){let i=this.inputrels[l];i.id!==e.id&&t.push(i)}this.inputrels=t}addOutputrel(e){this.outputrels||(this.outputrels=[]);let t=this.outputrels.length;for(let i=0;i<t;i++)if(this.outputrels[i].id===e.id)return;this.outputrels.push(e)}removeOutputrel(e){if(!this.outputrels)return;let t=[],i=this.outputrels.length;for(let l=0;l<i;l++){let i=this.outputrels[l];i.id!==e.id&&t.push(i)}this.outputrels=t}setType(e){this.type=e,this.typeName=e.name}getType(){return this.type}getInheritedTypes(){let e=[],t=this.getType();if(!t)return null;if(t.supertypes.length>0)return t.supertypes;let i=[];try{i=null==t?void 0:t.findSupertypes(0)}catch(e){i=[]}for(let t=0;t<(null==i?void 0:i.length);t++){var l;(null===(l=i[t])||void 0===l?void 0:l.name)!==_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ELEMENT&&e.push(i[t])}return[...new Set(e)]}getInheritedTypeNames(){let e=[],t=this.getType(),i=null==t?void 0:t.findSupertypes(0);for(let t=0;t<(null==i?void 0:i.length);t++){var l;let n=null===(l=i[t])||void 0===l?void 0:l.name;n!==_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ELEMENT&&e.push(n)}return e}setFromObject(e){this.fromObject=e}getFromObject(){return this.fromObject}getInheritanceObjects(e){let t=[],i=this.getOutputRelships(e,_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.GEN);if(null==i?void 0:i.length)for(let e=0;e<(null==i?void 0:i.length);e++){let l=i[e];if(l){let e=l.toObject;e&&t.push(e)}}return debug&&console.log("6459 objlist",t),t}getInheritedObjectTypes(e){let t=[],i=e.metamodel,l=this.getOutputRelships(e,_constants__WEBPACK_IMPORTED_MODULE_2__.relkinds.GEN);for(let e=0;e<(null==l?void 0:l.length);e++){let n=l[e];if(n){let e=n.toObject;if(e&&e.type){let l=e.type;l=null==i?void 0:i.findObjectType(l.id),t.push(l)}}}let n=this.type;n=null==i?void 0:i.findObjectType(null==n?void 0:n.id);try{let e=null==n?void 0:n.getSupertypes();for(let l=0;l<(null==e?void 0:e.length);l++){let n=e[l];(n=null==i?void 0:i.findObjectType(null==n?void 0:n.id))&&t.push(n)}}catch(e){debug&&console.log("6470 error",e)}return debug&&console.log("6472 typelist",t),t}hasInheritedProperties(e){let t=!1,i=e.metamodel,l=this.getInheritedTypes();if((null==l?void 0:l.length)>0)for(let e=0;e<l.length;e++){let t=l[e];if(null==(t=null==i?void 0:i.findObjectType(null==t?void 0:t.id))?void 0:t.hasProperties())return!0}if((null==(l=this.getInheritedObjectTypes(e))?void 0:l.length)>0)for(let e=0;e<(null==l?void 0:l.length);e++){let t=l[e];if(null==(t=null==i?void 0:i.findObjectType(t.id))?void 0:t.hasProperties())return!0}let n=this.getInheritanceObjects(e);if(debug&&console.log("6496 this, objects",this,n),(null==l?void 0:l.length)>0)for(let e=0;e<(null==n?void 0:n.length);e++){let t=n[e],l=null==t?void 0:t.type;if(null==(l=null==i?void 0:i.findObjectType(null==l?void 0:l.id))?void 0:l.hasProperties())return!0}return t}getInheritedProperties(e){let t=[],i=e.metamodel,l=this.getInheritanceObjects(e);debug&&console.log("7159 inheritanceObjects",l);for(let e=0;e<(null==l?void 0:l.length);e++){let n=l[e],s=null==n?void 0:n.type;if(null==(s=null==i?void 0:i.findObjectType(null==s?void 0:s.id))?void 0:s.hasProperties()){let e=s.properties;for(let i=0;i<e.length;i++){let l=e[i];t.push(l)}}}return debug&&console.log("7171 inherited Properties",t),t}getConnectedProperties(e){let t=[],i=this.getConnectedObjects2(e);for(let e=0;e<(null==i?void 0:i.length);e++){let l=i[e],n=new cxProperty(_utilities__WEBPACK_IMPORTED_MODULE_1__.gj(),l.type.name,"");t.push(n)}return t}isOfType(e){var t,i;let l=!1;if((null===(t=this.type)||void 0===t?void 0:t.name)===e)return!0;let n=null===(i=this.type)||void 0===i?void 0:i.supertypes;for(let t=0;t<(null==n?void 0:n.length);t++){let i=n[t];if((null==i?void 0:i.name)===e)return!0}return l}isOfSystemType(e){let t=!1,i=this.type;if(this.name===(null==i?void 0:i.name)||(null==i?void 0:i.name)===e)return!0;let l=null==i?void 0:i.supertypes;for(let t=0;t<(null==l?void 0:l.length);t++){let i=l[t];if((null==i?void 0:i.name)===e)return!0}return t}addPort(e,t){let i=new cxPort(_utilities__WEBPACK_IMPORTED_MODULE_1__.gj(),t,"",e);return i.color=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_PORT_COLOR,this.ports.push(i),i}deletePort(e,t){this.ports=this.ports.filter(i=>i.name!==t&&i.side!==e)}deleteSidePorts(e){this.ports=this.ports.filter(t=>t.side!==e)}getPort(e,t){var i;let l=null;for(let n=0;n<(null===(i=this.ports)||void 0===i?void 0:i.length);n++){let i=this.ports[n];if(i.side===e&&i.name===t){l=i;break}}return l}setToObject(e){this.toObject=e}getToObject(){return this.toObject}setRelshipKind(e){this.relshipkind=e}getRelshipKind(){let e=this.relshipkind;if(e||(e=""),0==e.length){let t=this.type;try{e=t.getRelshipKind(),this.relshipkind=e}catch(t){e=""}}return e}setAbstract(e){this.abstract=e}getAbstract(){return this.abstract}setViewKind(e){this.viewkind=e}getViewKind(){return this.viewkind}getValueset(){return this.valueset}getPropertyValues(){return this.getValueset()}addValue(e){"cxPropertyValue"===e.constructor.name&&(null==this.valueset&&(this.valueset=[]),this.valueset.push(e))}addStringValue(e,t,i,l){if("name"===e)this.setName(i);else if("description"===e)this.setDescription(i);else{let t=this.getType();t&&t.findProperty(e)&&debug&&console.log("Function 'addStringValue' not yet implemented!")}}isEkaRelationship(){let e=!1;return this.viewkind===_constants__WEBPACK_IMPORTED_MODULE_2__.viewkinds.REL&&(e=!0),e}setValue(e,t){if(t.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_PROPVALUE){let i=0;for(this.valueset||(this.valueset=[]);i<this.valueset.length;){if(this.valueset[i].getName()===e){this.valueset[i]=t;break}i++}}}setStringValue(e,t){let i=!1,l=null,n=0;for(this.valueset||(this.valueset=[]);n<this.valueset.length;){if((l=this.valueset[n]).getName()===e){l.value=t,i=!0;break}n++}return i}setStringValue2(e,t){let i=this;return i[e]=t,!0}getPropertyValue(e,t){let i;let l=this,n=e.methodRef,s=t.findMethod(n),r=e.name;if(debug&&console.log("7377 prop, method",e,s),s){let n;switch(s.methodtype){case _constants__WEBPACK_IMPORTED_MODULE_2__.types.MTD_AGGREGATEVALUE:n={myMetis:t,myMetamodel:t.currentMetamodel,reltypes:s.reltypes,reldir:s.reldir,objtypes:s.objtypes,prop:e},i=_ui_methods__WEBPACK_IMPORTED_MODULE_0__.PZ(l,n),debug&&console.log("7397 inst, context, value",l,n,i);break;case _constants__WEBPACK_IMPORTED_MODULE_2__.types.MTD_GETCONNECTEDOBJECT:{debug&&console.log("7401 method",s);let r=s.reltype,a=s.reldir,d=null;"any"!==r&&"null"!==r&&(d=t.findRelationshipTypeByName(r)),debug&&console.log("7407 rtypename, reltype",r,d);let p=s.objtype,c=null;"any"!==p&&"null"!==p&&(c=t.findObjectTypeByName(p)),debug&&console.log("7412 otypename, objtype",p,c),n={myMetis:t,reltype:d,reldir:a,objtype:c,prop:e},debug&&console.log("7420 inst, context",l,n);let u=_ui_methods__WEBPACK_IMPORTED_MODULE_0__.j$(l,n);debug&&console.log("7422 inst, context, obj",l,n,u),i=null==u?void 0:u.name}break;case _constants__WEBPACK_IMPORTED_MODULE_2__.types.MTD_CALCULATEVALUE:default:debug&&console.log("7428 method",s),n={myMetis:t,prop:e},i=_ui_methods__WEBPACK_IMPORTED_MODULE_0__.Y$(l,n),l[r]=i,debug&&console.log("7435 inst, context, value",l,n,i)}}else i=l[r];return i}getStringValue2(e){debug&&console.log("4767 inst",e,this);let t=this[e];return debug&&console.log("4769 inst",e,t,this),t}getInputRelships(e,t){let i=e.relships;if(!i)return null;let l=[];for(let e=0;e<i.length;e++){let n=i[e];if(n){if(n.markedAsDeleted)continue;let e=n.type;if(e){let i=e.relshipkind;if(i.length>0&&i!==t)continue}let i=n.toObject;i&&i.id===this.id&&l.push(n)}}return l}getOutputRelships(e,t){let i=e.relships;if(!i)return null;let l=[];for(let e=0;e<i.length;e++){let n=i[e];if(n){if(n.markedAsDeleted)continue;let e=n.type;if(e){let i=e.relshipkind;if(i.length>0&&i!==t)continue}let i=n.fromObject;i&&i.id===this.id&&l.push(n)}}return l}getInputRelshipsByType(e){let t=[];if(this.inputrels)for(let i=0;i<this.inputrels.length;i++){let l=this.inputrels[i];if(l&&!l.markedAsDeleted){let i=l.type;i&&i.id===(null==e?void 0:e.id)&&t.push(l)}}return t}getOutputRelshipsByType(e){let t=[];if(this.outputrels)for(let i=0;i<this.outputrels.length;i++){let l=this.outputrels[i];if(l&&!l.markedAsDeleted){let i=l.type;i&&i.id===(null==e?void 0:e.id)&&t.push(l)}}return t}addJsonValue(e,t){this.valueset||(this.valueset=[]);let i=this.allProperties;for(let l=0;l<i.length;l++){let n=i[l];if(n&&n.id===e){let e=new cxPropertyValue(n,t);e&&(e.value=t,this.valueset.push(e))}}}constructor(e,t,i,l){super(e,t,l),this.id=e,this.type=i,this.typeRef=null==i?void 0:i.id,this.typeName=null==i?void 0:i.name,this.typeDescription=null==i?void 0:i.description,this.typeview=null,this.fromObject=null,this.toObject=null,this.relshipkind="",this.abstract=!1,this.viewkind="",this.generatedTypeId="",this.valueset=null,this.inputrels=null,this.outputrels=null,this.parentModelRef="",this.allProperties=null,this.copiedFromId="",this.type&&(this.relshipkind=this.getRelshipKind())}}class cxObject extends cxInstance{addObjectView(e){this.objectviews||(this.objectviews=[]);let t=this.objectviews.length;debug&&console.log("4881 objview",e.markedAsDeleted,e,this.objectviews);for(let i=0;i<t;i++){let t=this.objectviews[i];if(debug&&console.log("4884 objview",t.markedAsDeleted,t),t.id===e.id){for(let i in e)t[i]=e[i];debug&&console.log("4890 objview",t.markedAsDeleted,t);return}}this.objectviews.push(e)}removeObjectView(e){if(debug&&console.log("4893 this.objectviews",this.objectviews),!this.objectviews)return;let t=[],i=this.objectviews.length;for(let l=0;l<i;l++){let i=this.objectviews[l];i.id!==e.id&&t.push(i)}debug&&console.log("4904 objview, objviews",e,t),this.objectviews=t}getObjectType(){return this.type}getConnectedObject(e,t){let i=null,l=this,n=e.methodRef,s=t.findMethod(n);if(e.name,debug&&console.log("7083 prop, method",e,s),s&&s.methodtype===_constants__WEBPACK_IMPORTED_MODULE_2__.types.MTD_GETCONNECTEDOBJECT){let n;debug&&console.log("7087 method",s);let r=s.reltype,a=s.reldir,d=null;"any"!==r&&"null"!==r&&(d=t.findRelationshipTypeByName(r)),debug&&console.log("7093 rtypename, reltype",r,d);let p=s.objtype,c=null;"any"!==p&&"null"!==p&&(c=t.findObjectTypeByName(p)),debug&&console.log("7098 otypename, objtype",p,c),n={myMetis:t,reltype:d,reldir:a,objtype:c,prop:e},i=_ui_methods__WEBPACK_IMPORTED_MODULE_0__.j$(this,n),debug&&console.log("7107 inst, context, obj",l,n,i)}return i}getConnectedObjects(e){let t=this.type,i=null==t?void 0:t.properties,l=[];for(let t=0;t<(null==i?void 0:i.length);t++){let n=i[t];if(n){let t=this.getConnectedObject(n,e);t&&l.push(t)}}return l}getConnectedObjects1(e,t){let i=null;if(!e)return i;let l=this,n=e.methodRef,s=t.findMethod(n);if(e.name,debug&&console.log("7307 prop, method",e,s),s&&s.methodtype===_constants__WEBPACK_IMPORTED_MODULE_2__.types.MTD_GETCONNECTEDOBJECT){let n;debug&&console.log("7312 method",s);let r=s.reltype,a=s.reldir,d=s.objtype,p=null;"any"!==d&&"null"!==d&&(p=t.findObjectTypeByName(d)),debug&&console.log("7319 otypename, objtype",d,p);let c=null;"any"!==r&&"null"!==r&&(c=t.findRelationshipTypeByName2(r,this.type,p)),debug&&console.log("7323 rtypename, reltype",r,c),n={myMetis:t,reltype:c,reldir:a,objtype:p,prop:e},i=_ui_methods__WEBPACK_IMPORTED_MODULE_0__.Oh(this,n),debug&&console.log("7332 inst, context, objects",l,n,i)}return i}getConnectedObjects2(e){let t=this.type,i=null==t?void 0:t.properties,l=[];for(let t=0;t<(null==i?void 0:i.length);t++){let n=i[t];if(n){let t=this.getConnectedObjects1(n,e);for(let e=0;e<(null==t?void 0:t.length);e++)l.push(t[e])}}return l}getConnectedObjectRoles(e){let t=this.type,i=null==t?void 0:t.properties,l=[];for(let t=0;t<(null==i?void 0:i.length);t++){let n=i[t];if(n){let t=this.getConnectedObjects1(n,e);for(let e=0;e<(null==t?void 0:t.length);e++)l.push(n.name)}}return l}getPorts(){return this.ports}getLeftPorts(){var e;let t=[];for(let i=0;i<(null===(e=this.ports)||void 0===e?void 0:e.length);i++){let e=this.ports[i];e.side===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_LEFT&&t.push(e)}return t}getRightPorts(){var e;let t=[];for(let i=0;i<(null===(e=this.ports)||void 0===e?void 0:e.length);i++){let e=this.ports[i];e.side===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RIGHT&&t.push(e)}return t}getTopPorts(){var e;let t=[];for(let i=0;i<(null===(e=this.ports)||void 0===e?void 0:e.length);i++){let e=this.ports[i];e.side===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_TOP&&t.push(e)}return t}getBottomPorts(){var e;let t=[];for(let i=0;i<(null===(e=this.ports)||void 0===e?void 0:e.length);i++){let e=this.ports[i];e.side===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_BOTTOM&&t.push(e)}return t}getRelsConnectedToPort(e){let t=[],i=this.inputrels;for(let l=0;l<(null==i?void 0:i.length);l++){let n=i[l];(n.fromPortid===e||n.toPortid===e)&&t.push(n)}let l=this.outputrels;for(let i=0;i<(null==l?void 0:l.length);i++){let n=l[i];(n.fromPortid===e||n.toPortid===e)&&t.push(n)}return t}constructor(e,t,i,l){var n,s,r;super(e,t,i,l),this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECT,this.ports=[],this.objectviews=null;let a=null===(n=this.type)||void 0===n?void 0:n.properties;for(let e=0;e<(null==a?void 0:a.length);e++){let t=a[e];"id"!==t.name&&t&&(this[t.name]="")}(null===(s=this.type)||void 0===s?void 0:s.name)==="Label"&&(this.text="Label"),debug&&console.log("4600 obj",this);let d=null===(r=this.type)||void 0===r?void 0:r.ports;if(d){this.ports=[];for(let e=0;e<d.length;e++){let t=d[e];if(t){let e=new cxPort(_utilities__WEBPACK_IMPORTED_MODULE_1__.gj(),t.name,t.description,t.side);e.color=t.color,this.ports.push(e)}}}}}class cxPort extends cxMetaObject{setSide(e){this.side=e}getSide(){return this.side}setColor(e){this.color=e}getColor(){return this.color}getType(){return this.type}constructor(e,t,i,l,n=null){super(e,t,i),this.side=l,this.color="white",this.type=n}}class cxRelationship extends cxInstance{setNameFrom(e){this.nameFrom=e}getNameFrom(){return this.nameFrom}setNameTo(e){this.nameTo=e}getNameTo(){return this.nameTo}setFromPortid(e){this.fromPortid=e}getFromPortid(){return this.fromPortid}setToPortid(e){this.toPortid=e}getToPortid(){return this.toPortid}addRelationshipView(e){this.relshipviews||(this.relshipviews=[]);let t=this.relshipviews.length;for(let i=0;i<t;i++){let t=this.relshipviews[i];if(t.id===e.id||!t.fromObjview||!t.toObjview)return}this.relshipviews.push(e)}removeRelationshipView(e){if(!this.relshipviews)return;let t=[],i=this.relshipviews.length;for(let l=0;l<i;l++){let i=this.relshipviews[l];i.id!==e.id&&t.push(i)}this.relshipviews=t}relocate(e,t,i,l){this.fromObject&&e&&t&&(e.removeOutputrel(this),this.fromObject=t,t.addOutputrel(this)),this.toObject&&i&&l&&(i.removeInputrel(this),this.toObject=l,l.addInputrel(this))}getRelationshipViews(){return this.relshipviews}getPurgedRelationshipViews(){let e=this.relshipviews;for(let t=0;t<(null==e?void 0:e.length);t++)e[t].markedAsDeleted&&e.splice(t,1);return e}getRelationshipType(){return this.type}getCardinality(){let e=this.cardinality;return e||(e=""),0==e.length&&(e=this.type.getCardinality(),this.cardinality=e),e}getCardinalityFrom(){let e=this.cardinalityFrom;if(e||(e=""),0==e.length){let t=this.type;t&&(e=t.getCardinalityFrom(),this.cardinalityFrom=e)}return e}getCardinalityTo(){let e=this.cardinalityTo;if(e||(e=""),0==e.length){let t=this.type;t&&(e=t.getCardinalityTo(),this.cardinalityTo=e)}return e}isSystemRel(){let e=!1,t=this.type;if(t&&t.toObjtype)return t.toObjtype.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_PROPERTY?t.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_HAS_PROPERTY&&(e=!0):t.toObjtype.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_METHOD?t.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_HAS_METHOD&&(e=!0):t.toObjtype.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_INPUTPATTERN?t.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_HAS_INPUTPATTERN&&(e=!0):t.toObjtype.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_VIEWFORMAT?t.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_HAS_VIEWFORMAT&&(e=!0):t.toObjtype.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_FIELDTYPE?t.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_HAS_FIELDTYPE&&(e=!0):t.toObjtype.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_COLLECTION?t.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_HAS_COLLECTION&&(e=!0):t.name===_constants__WEBPACK_IMPORTED_MODULE_2__.types.AKM_ANNOTATES&&(e=!0),e}constructor(e,t,i,l,n,s){var r;super(e,n,t,s),this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELATIONSHIP,this.relshipviews=null,this.fromObject=i,this.toObject=l,this.cardinality="",this.cardinalityFrom="",this.cardinalityTo="",this.nameFrom="",this.nameTo="",this.fromPortid="",this.toPortid="",this.typeName||(this.typeName=n),this.type&&(this.cardinality=this.getCardinality(),this.cardinalityFrom=this.getCardinalityFrom(),this.cardinalityTo=this.getCardinalityTo());let a=null===(r=this.type)||void 0===r?void 0:r.properties;for(let e=0;e<(null==a?void 0:a.length);e++){let t=a[e];"id"!==t.name&&t&&(this[t.name]="")}}}class cxPropertyValue{constructor(e,t){this.property=e,this.value=t}}class cxValue extends cxMetaObject{constructor(e,t,i){super(e,t,i),this.value=this.name}}class cxViewFormat extends cxMetaObject{getViewFormat(){return this.viewFormat}setViewFormat(e){this.viewFormat=e}constructor(e,t,i){super(e,t,i),this.viewFormat="%s"}}class cxFieldType extends cxMetaObject{getFieldType(){return this.fieldType}setFieldType(e){this.fieldType=e}constructor(e,t,i){super(e,t,i),this.fieldType="text"}}class cxInputPattern extends cxMetaObject{getInputPattern(){return this.inputPattern}setInputPattern(e){this.inputPattern=e}constructor(e,t,i){super(e,t,i),this.inputPattern=""}}class cxModelView extends cxMetaObject{clearContent(){this.viewstyle=null,this.viewstyles=null,this.objecttypeviews=null,this.relshiptypeviews=null,this.objectviews=null,this.relshipviews=null,this.layout="Tree",this.routing="Normal",this.linkcurve="None",this.showCardinality=!1,this.showRelshipNames=!0,this.askForRelshipName=!1,this.template=null,this.isTemplate=!1,this.diagrams=null}clearRelviewPoints(){let e=this.relshipviews;if(e)for(let t=0;t<e.length;t++)e[t].points=null}setModel(e){this.model=e}getModel(){return this.model}setFocusObjectview(e){this.focusObjectview=e}getFocusObjectview(){return this.focusObjectview}setViewStyle(e){this.viewstyle=e}getViewStyle(){return this.viewstyle}setViewStyles(e){this.viewstyles=e}getViewStyles(){return this.viewstyles}setLayout(e){this.layout=e}getLayout(){return this.layout}setRouting(e){this.routing=e}getRouting(){return this.routing}setTemplate(e){this.template=e}getTemplate(){return this.template}setIsTemplate(e){this.isTemplate=e}getIsTemplate(){return this.isTemplate}setObjectViews(e){this.objectviews=e}getObjectViews(){return this.objectviews}setObjectTypeViews(e){this.objecttypeviews=e}getObjecTypeViews(){return this.objecttypeviews}setRelationshipViews(e){this.relshipviews=e}getRelationshipViews(){return this.relshipviews}getRelationshipViewsByTypeName(e,t){let i=[];if(this.relshipviews)for(let l=0;l<this.relshipviews.length;l++){let n=this.relshipviews[l],s=n.relship;n.name!==e||s.markedAsDeleted||s.relshipkind!==t||i.push(n)}return i}setRelationshipTypeViews(e){this.relshiptypeviews=e}getRelationshipTypeViews(){return this.relshiptypeviews}addObjectTypeView(e){e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTTYPEVIEW&&(null==this.objecttypeviews&&(this.objecttypeviews=[]),this.objecttypeviews.push(e))}addRelationshipTypeView(e){e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELSHIPTYPEVIEW&&(null==this.relshiptypeviews&&(this.relshiptypeviews=[]),this.relshiptypeviews.push(e),debug&&console.log("7870 Add reltypeView",e))}addObjectView(e){if(e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTVIEW){if(null==this.objectviews&&(this.objectviews=[]),this.findObjectView(e.id))for(let t in e)e[t]=e[t];else this.objectviews.push(e)}}removeObjectView(e){if(!this.objectviews)return;let t=[],i=this.objectviews.length;for(let l=0;l<i;l++){let i=this.objectviews[l];i.id!==e.id&&t.push(i)}debug&&console.log("5171 objview, objviews",e,t),this.objectviews=t}addRelationshipView(e){e.category===_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELSHIPVIEW&&(null==this.relshipviews&&(this.relshipviews=[]),!this.findRelationshipView(e.id))&&e.fromObjview&&e.toObjview&&this.relshipviews.push(e)}findObjectView(e){if(!this.objectviews)return null;let t=0,i=null;for(;t<this.objectviews.length;){if(!(null==(i=this.objectviews[t])?void 0:i.isDeleted())&&i.id===e){if(!i.objectRef){let e=i.object;e&&(i.objectRef=e.id)}return i}t++}}findObjectViewByName(e){if(!this.objectviews)return null;let t=0,i=null;for(;t<this.objectviews.length;){if(!(null==(i=this.objectviews[t])?void 0:i.isDeleted())){let t=i.object;if((null==t?void 0:t.name)===e)return i}t++}}findObjectViewsByObject(e){let t=[],i=this.objectviews;if(!i)return null;for(let n=0;n<i.length;n++){let s=i[n];if(!s.isDeleted()&&s&&e){var l;(null===(l=s.object)||void 0===l?void 0:l.id)===e.id&&t.push(s)}}return t}findObjectTypeView(e){if(!this.objecttypeviews)return null;let t=0,i=null;for(;t<this.objecttypeviews.length;){if(!(null==(i=this.objecttypeviews[t])?void 0:i.isDeleted())&&i.id===e)return i;t++}}findRelationshipView(e){let t=this.relshipviews;if(!t)return null;let i=0,l=null;for(;i<t.length;){if((l=t[i])&&!(null==l?void 0:l.isDeleted())&&l.id===e)return l;i++}}findRelationshipViewsById(e){if(!this.relshipviews)return null;let t=this.relshipviews,i=[],l=0,n=null;for(;l<t.length;)(n=t[l]).id===e&&i.push(n),l++;return i}findRelationshipViewsByRel(e,t){let i=[],l=this.relshipviews;if(!l)return null;for(let n=0;n<l.length;n++){let s=l[n];if(s.relship.id===e.id){if(!t&&(null==s?void 0:s.markedAsDeleted))continue;i.push(s)}}return i}findRelationshipViewsByRel2(e,t,i,l){let n=[];if(t&&i){let d=this.relshipviews;if(!d)return null;for(let p=0;p<d.length;p++){var s,r,a;let c=d[p];(l||null==c||!c.markedAsDeleted)&&(null==c?void 0:null===(s=c.relship)||void 0===s?void 0:s.id)===(null==e?void 0:e.id)&&(null===(r=c.fromObjview)||void 0===r?void 0:r.id)===t.id&&(null===(a=c.toObjview)||void 0===a?void 0:a.id)===i.id&&n.push(c)}}return n}findRelationshipTypeView(e){var t;if(!this.relshiptypeviews)return null;let i=0,l=null;for(;i<(null===(t=this.relshiptypeviews)||void 0===t?void 0:t.length);)if(null==(l=this.relshiptypeviews[i])||!l.markedAsDeleted){if(l&&l.id===e)return l;i++}return null}getRelviewsByFromAndToObjviews(e,t){let i=[];if(e&&t){let s=this.relshipviews;if(!s)return null;for(let r=0;r<s.length;r++){var l,n;let a=s[r];null!=a&&a.markedAsDeleted||(null==a?void 0:null===(l=a.fromObjview)||void 0===l?void 0:l.id)!==e.id||(null==a?void 0:null===(n=a.toObjview)||void 0===n?void 0:n.id)!==t.id||i.push(a)}}return i}getRelshipviewsInGroup(e){let t=[],i=e.getGroupMembers(this);for(let l=0;l<(null==i?void 0:i.length);l++){let n=i[l].getOutputRelviews();if(n)for(let i=0;i<n.length;i++){let l=n[i],s=l.getToObjectView();(null==s?void 0:s.group)===e.id&&t.push(l)}}return t}repairObjectView(e){var t;if(!e||e.isDeleted()||!e.object||(null===(t=e.object)||void 0===t?void 0:t.markedAsDeleted))return!1;let i=e.getInputRelviews();if(i)for(let e=0;e<i.length;e++){let t=i[e];if(!t.fromObjview){let e=t.relship;if(e){let i=e.fromObject;if(i){let e=this.findObjectView(i.id);e&&(t.fromObjview=e)}let l=e.toObject;if(l){let e=this.findObjectView(l.id);e&&(t.toObjview=e)}}}}let l=e.getOutputRelviews();if(l)for(let e=0;e<l.length;e++){let t=l[e];if(!t.toObjview){let e=t.relship;if(e){let i=e.fromObject;if(i){let e=this.findObjectView(i.id);e&&(t.fromObjview=e)}let l=e.toObject;if(l){let e=this.findObjectView(l.id);e&&(t.toObjview=e)}}}}}purgeRelshipviewsById(e){if(this.relshipviews){let i=[];for(let l=0;l<this.relshipviews.length;l++){let n=this.relshipviews[l];if(!n)continue;let s=null==n?void 0:n.id;e.findRelationshipViewsById(s);let r=!1;for(let e=0;e<(null==i?void 0:i.length);e++){var t;(null===(t=i[e])||void 0===t?void 0:t.id)==s&&(r=!0)}r||i.push(n[l])}this.relshipviews=i}}constructor(e,t,i,l){super(e,t,l),this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_MODELVIEW,this.model=i,this.viewstyle=null,this.viewstyles=null,this.objecttypeviews=null,this.relshiptypeviews=null,this.objectviews=null,this.relshipviews=null,this.focusObjectview=null,this.scale=1,this.memberscale=_constants__WEBPACK_IMPORTED_MODULE_2__.params.MEMBERSCALE,this.layout="ForceDirected",this.routing="Normal",this.linkcurve="None",this.showCardinality=!1,this.showRelshipNames=!0,this.askForRelshipName=!1,this.includeInheritedReltypes=null,this.template=null,this.isTemplate=!1,this.diagrams=null}}class cxCollectionOfViews{addObjectView(e){this.objectviews||(this.objectviews=[]);let t=this.objectviews.length;for(let i=0;i<t;i++)if(this.objectviews[i].id===e.id)return;this.objectviews.push(e)}addRelshipView(e){this.relshipviews||(this.relshipviews=[]);let t=this.relshipviews.length;for(let i=0;i<t;i++)if(this.relshipviews[i].id===e.id)return;this.relshipviews.push(e)}constructor(e){this.modelview=e,this.objectviews=[],this.relshipviews=[]}}class cxObjectView extends cxMetaObject{setModelView(e){this.modelview=e}getModelView(){return this.modelview}setObject(e){_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(e)&&(this.object=e)}getObject(){return this.object}getObjectType(){let e=this.getObject();if(e)return e.getType()}addInputRelview(e){this.inputrelviews||(this.inputrelviews=[]);let t=this.inputrelviews.length;for(let i=0;i<t;i++)if(this.inputrelviews[i].id===e.id)return;this.inputrelviews.push(e)}removeInputRelview(e){if(!this.inputrelviews)return;let t=[],i=this.inputrelviews.length;for(let l=0;l<i;l++)this.inputrelviews[l].id!==e.id&&t.push(e);this.inputrelviews=t}addOutputRelview(e){this.outputrelviews||(this.outputrelviews=[]);let t=this.outputrelviews.length;for(let i=0;i<t;i++)if(this.outputrelviews[i].id===e.id)return;this.outputrelviews.push(e)}removeOutputRelview(e){if(!this.outputrelviews)return;let t=[],i=this.outputrelviews.length;for(let l=0;l<i;l++){let i=this.outputrelviews[l];i.id!==e.id&&t.push(i)}this.outputrelviews=t}getInputRelviews(){return this.inputrelviews}getOutputRelviews(){return this.outputrelviews}purgeInputRelviews(){if(this.inputrelviews){let e=[],t=this.inputrelviews[0];t&&!t.markedAsDeleted&&e.push(t);for(let t=1;t<this.inputrelviews.length;t++){let i=this.inputrelviews[t];i.markedAsDeleted||e.push(i)}0==e.length&&t&&e.push(t),this.inputrelviews=e}}purgeOutputRelviews(){if(this.outputrelviews){let e=[],t=this.outputrelviews[0];t&&!t.markedAsDeleted&&e.push(t);for(let t=1;t<this.outputrelviews.length;t++){let i=this.outputrelviews[t];i.markedAsDeleted||e.push(i)}0==e.length&&t&&e.push(t),this.outputrelviews=e}}setTypeView(e){e&&(this.typeview=e)}getTypeView(){return this.typeview}getDefaultTypeView(){let e=this.getObject();if(e){let t=e.getType();if(t)return t.typeview}return null}setIcon(e){this.icon=e}getIcon(){return this.icon?this.icon:""}setImage(e){this.icon=icon}getImage(){return this.image?this.image:""}setIsGroup(e){this.isGroup=e}getIsGroup(){return!!_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(this.isGroup)&&this.isGroup}setGroup(e){this.group=e}getGroup(){return _utilities__WEBPACK_IMPORTED_MODULE_1__.y9(this.group)?this.group:""}setGroupLayout(e){this.groupLayout=e}getGroupLayout(){return _utilities__WEBPACK_IMPORTED_MODULE_1__.y9(this.groupLayout)?this.groupLayout:""}setGroupIsExpanded(e){this.isExpanded=e}getGroupIsExpanded(){return!!_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(this.isExpanded)&&this.isExpanded}getParentModelView(e){let t=e.modelviews;for(let e=0;e<t.length;e++){let i=t[e];if(i){let e=i.objectviews;for(let t=0;t<e.length;t++){let l=e[t];if(this.id===l.id)return i}}}return null}getGroupMembers(e){let t=[];if(this.isGroup){let i=this.id,l=e.getObjectViews();for(let e=0;e<(null==l?void 0:l.length);e++){let n=l[e];n.group===i&&t.push(n)}}return t}setParent(e){this.parent=e}getParent(){return _utilities__WEBPACK_IMPORTED_MODULE_1__.y9(this.parent)?this.parent:""}setTemplate(e){void 0==e&&(e=""),this.template=e}getTemplate(){return void 0==this.template?"":this.template}setTemplate2(e){void 0==e&&(e=""),this.template2=e}getTemplate2(){return void 0==this.template2?"":this.template2}setFigure(e){void 0==e&&(e=""),this.figure=e}getFigure(){return void 0==this.template?"":this.template}setGrabIsAllowed(e){this.grabIsAllowed=e}getGrabIsAllowed(){return this.grabIsAllowed}setSize(e){void 0==e&&(e=""),this.size=e}getSize(){return void 0==this.size?"":this.size}setScale(e){(void 0==e||null==e)&&(e=1),this.scale=e}getScale(){let e=this.scale;return void 0==e||null==e?1:this.scale}setMemberscale(e){var t;(void 0==e||null==e)&&(this.memberscale=(null===(t=this.typeview)||void 0===t?void 0:t.memberscale)?this.typeview.memberscale:1),this.memberscale=e}getMemberscale(){var e;let t=this.memberscale;return void 0==t||""==t||null==t?(null===(e=this.typeview)||void 0===e?void 0:e.memberscale)?this.typeview.memberscale:1:this.memberscale}setArrowscale(e){var t;(void 0==e||null==e)&&(this.arrowscale=(null===(t=this.typeview)||void 0===t?void 0:t.arrowscale)?this.typeview.arrowscale:1.3),this.arrowscale=e}getArrowscale(){var e;let t=this.arrowscale;return void 0==t||null==t?(null===(e=this.typeview)||void 0===e?void 0:e.arrowscale)?this.typeview.arrowscale:1.3:this.arrowscale}setTextscale(e){(void 0==e||null==e)&&(e=1),this.textscale=e}getTextscale(){let e=this.textscale;return void 0==e||null==e?1:this.textscale}setLoc(e){this.loc=e}getLoc(){return _utilities__WEBPACK_IMPORTED_MODULE_1__.y9(this.loc)?this.loc:""}applyTypeview(){var e;let t=null===(e=this.typeview)||void 0===e?void 0:e.data;if(!t){let e=this.getObject();if(e){let i=e.getType();if(i){let e=i.typeview;e&&(t=e.data)}}}for(let e in t)"class"!==e&&"abstract"!==e&&"isGroup"!==e&&"group"!==e&&"viewkind"!==e&&(this[e]=t[e])}clearViewdata(){var e;let t=null===(e=this.typeview)||void 0===e?void 0:e.data;if(!t){let e=this.getObject();if(e){let i=e.getType();if(i){let e=i.typeview;e&&(t=e.data)}}}for(let e in t)"class"!==e&&"abstract"!==e&&"isGroup"!==e&&"group"!==e&&"viewkind"!==e&&(this[e]="")}constructor(e,t,i,l,n){var s,r,a,d,p;super(e,t,l),this.modelview=n,this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_OBJECTVIEW,this.markedAsDeleted=!1,this.object=i,this.objectRef=null==i?void 0:i.id,this.inputrelviews=null,this.outputrelviews=null,this.template="",this.template2="",this.typeview=null==i?void 0:null===(s=i.type)||void 0===s?void 0:s.typeview,this.typeviewRef=null===(r=this.typeview)||void 0===r?void 0:r.id,this.memberscale=(null===(a=this.typeview)||void 0===a?void 0:a.memberscale)?this.typeview.memberscale:1,this.arrowscale=(null===(d=this.typeview)||void 0===d?void 0:d.arrowscale)?this.typeview.arrowscale:1.3,this.textscale=(null===(p=this.typeview)||void 0===p?void 0:p.textscale)?this.typeview.textscale:1}}class cxRelationshipView extends cxMetaObject{getRelationship(){return this.relship}setRelationship(e){e&&(this.relship=e)}setTypeView(e){e&&(this.typeview=e)}getTypeView(){return this.typeview}setFromObjectView(e){_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(e)&&(this.fromObjview=e)}getFromObjectView(){return this.fromObjview}setToObjectView(e){_utilities__WEBPACK_IMPORTED_MODULE_1__.y9(e)&&(this.toObjview=e)}getToObjectView(){return this.toObjview}clearViewdata(){let e=this.typeview.data;for(let t in e)"class"!==t&&"abstract"!==t&&"relshipkind"!==t&&(this[t]="")}relocate(e,t){e&&(this.fromObjview=e,this.fromObjview.removeOutputRelview(this),this.fromObjview=e,e.addOutputRelview(this)),t&&(this.toObjview=t,this.toObjview.removeOutputRelview(this),this.toObjview=t,t.addOutputRelview(this))}setTemplate(e){void 0==e&&(e=""),this.template=e}getTemplate(){return void 0==this.template?"":this.template}setTemplate2(e){void 0==e&&(e=""),this.template2=e}getTemplate(){return void 0==this.template2?"":this.template2}setTextScale(e){this.textscale=e}getTextScale(){return void 0==this.textscale?1:this.textscale}setArrowScale(e){(void 0==e||null==e)&&(e=1),this.arrowscale=e}getArrowScale(){return void 0==this.arrowscale?1:this.arrowscale}setFromArrow(e){this.fromArrow=e}getFromArrow(){return void 0==this.fromArrow?"":this.fromArrow}setFromArrowColor(e){this.fromArrowColor=e}getFromArrowColor(){return void 0==this.fromArrowColor?"":this.fromArrowColor}setFromArrow2(e){switch(e){case"Composition":this.setFromArrow("StretchedDiamond"),this.setFromArrowColor("black"),this.textcolor="black";break;case"Aggregation":this.setFromArrow("StretchedDiamond"),this.setFromArrowColor("white"),this.textcolor="black";break;case"Generalization":this.setFromArrow(""),this.setFromArrowColor(""),this.textcolor="black"}debug&&console.log("5773 fromArrowColor",this.fromArrowColor)}setToArrow(e){this.toArrow=e}getToArrow(){return void 0==this.toArrow?"":this.toArrow}setToArrowColor(e){this.toArrowColor=e}getToArrowColor(){return void 0==this.toArrowColor?"":this.toArrowColor}setToArrow2(e){switch(e){case"Generalization":this.setToArrow("Triangle"),this.setToArrowColor("white"),this.textcolor="black";break;case"Aggregation":case"Composition":this.setToArrow("OpenTriangle"),this.textcolor="black"}}setCurve(e){this.curve=e}getCurve(){return void 0==this.curve?"":this.curve}setCorner(e){this.corner=e}getCorner(){return void 0==this.corner?0:this.corner}setRouting(e){this.routing=e}getRouting(){return void 0==this.routing?0:this.routing}setDash(e){this.dash=e}getDash(){return void 0==this.dash?"":this.dash}setStrokeColor(e){this.strokecolor=e}getStrokeColor(){return void 0==this.strokecolor?"":this.strokecolor}setStrokeWidth(e){this.strokewidth=e}getStrokeWidth(){return void 0==this.strokewidth?1:this.strokewidth}setTextColor(e){this.textcolor=e}getTextColor(){return void 0==this.textcolor?"":this.textcolor}setPoints(e){this.points=e}getPoints(){return this.points}constructor(e,t,i,l){var n;super(e,t,l),this.category=_constants__WEBPACK_IMPORTED_MODULE_2__.gojs.C_RELSHIPVIEW,this.relship=i,this.typeview=null==i?void 0:null===(n=i.type)||void 0===n?void 0:n.typeview,this.markedAsDeleted=!1,this.fromObjview=null,this.fromPortid="",this.toPortid="",this.toObjview=null,this.template="",this.template2="",this.textscale=1,this.arrowscale=1,this.strokecolor="black",this.strokewidth=1,this.textcolor="black",this.dash="",this.fromArrow="",this.toArrow="",this.fromArrowColor="",this.toArrowColor="",this.routing="",this.curve=0,this.corner=0,this.points=[],this.visible=!0,this.readonly=!1,this.isLayoutPositioned=!1}}class cxGeometry extends cxMetaObject{setGeometry(e,t,i){this.geometry=e,this.stroke=t,this.fill=i}constructor(e,t,i){super(e,t,i),this.geometry="",this.stroke="",this.fill=""}}class cxDiagram extends cxMetaObject{setModelView(e){this.modelview=e}getModelView(){return this.modelview}setContent(e){this.content=e}getContent(){return this.content}constructor(e,t,i,l){super(e,t,l),this.modelview=i,this.content=null}}class cxIdent{constructor(e,t){this.id=e,this.name=t}}class cxNodeAndLinkMaps{addNodeMap(e){this.nodeMaps.push(e)}addLinkMap(e){this.linkMaps.push(e)}replaceLinkMap(e){for(let t=0;t<this.linkMaps.length;t++){let i=this.linkMaps[t];if(i.inst.id===e.inst.id&&i.fromNodeKey===e.fromNodeKey&&i.toNodeKey===e.toNodeKey&&i.fromLinkKey===e.fromLinkKey){i=e;break}}}getNodeMap(e,t,i){for(let i=0;i<this.nodeMaps.length;i++){let l=this.nodeMaps[i];if(l.inst.id===e.id&&l.fromSourceKey===t)return l}return null}getLinkMap(e,t,i){for(let l=0;l<this.linkMaps.length;l++){let n=this.linkMaps[l];if(n.name===e&&n.fromLinkKey===t&&n.toNodeKey===i)return n}return null}getNodeMapByToGroup(e){for(let t=0;t<this.nodeMaps.length;t++){let i=this.nodeMaps[t];if(i.toGroup===e)return i}return null}setFromModelView(e){this.fromModelView=e}setFromModel(e){this.fromModel=e}setToModelView(e){this.toModelView=e}setToModel(e){this.toModel=e}alignNodeMaps(){for(let e=0;e<this.nodeMaps.length;e++)this.nodeMaps[e]}replaceNodeKeys(e,t){for(let i=0;i<this.nodeMaps.length;i++){let l=this.nodeMaps[i];l.toTargetKey===e&&(l.toTargetKey=t),l.toGroupKey===e&&(l.toGroupKey=t)}}constructor(e,t,i,l){this.fromModel=e,this.toModel=t,this.fromModelView=i,this.toModelView=l,this.nodeMaps=[],this.linkMaps=[]}}class cxLinkMap{constructor(e,t,i,l,n){this.inst=e,this.name=null==e?void 0:e.name,this.sourceFromNodeKey=t,this.sourceToNodeKey=i,this.targetFromNodeKey="",this.targetToNodeKey="",this.sourceLinkKey=l,this.targetLinkKey=n}}class cxNode{}class cxNodeMap{setToGroup(e){this.toGroup=e}setFromLoc(e){this.fromLoc=e}setToLoc(e){this.toLoc=e}setInstance(e){this.inst=e}getInstance(){return this.inst}addMap(e,t,i,l,n){this.name=e,this.fromSource=t,this.toTarget=i,this.fromGroup=n,this.toGroup="",this.isGroup=l}getMap(e){if(e===this.name)return this}getToTarget(e){return e===this.fromSourceKey?this.toTargetKey:""}getToGroup(e){return e===this.toTarget?this.group:""}isGroupMap(e){return e===this.fromGroup&&this.isGroup}replaceId(e,t){this.fromSource===e&&(this.fromSource=t),this.toTarget===e&&(this.toTarget=t),this.fromGroup===e&&(this.fromGroup=t),this.toGroup===e&&(this.toGroup=t)}constructor(e,t,i,l,n,s,r,a){this.inst=e,this.name=null==e?void 0:e.name,this.isGroup=l,this.fromSourceKey=t,this.toTargetKey=i,this.fromGroupKey=n,this.toGroupKey=s,this.fromLoc=r,this.toLoc=a}}class cxTraverseDialog{}},7662:(e,t,i)=>{"use strict";i.d(t,{UB:()=>f,_e:()=>u,c7:()=>g,gR:()=>m,mC:()=>c,q0:()=>a});var l=i(1457),n=i(2588),s=i(7089);let r=!1;class a{fixGoModel(){for(let i=0;i<this.nodes.length;i++){let l=this.nodes[i];if(l instanceof c){var e,t;let n=l.object,s=l.objecttype;if(s||(s=null===(e=this.metamodel)||void 0===e?void 0:e.findObjectType(n.typeRef)),s){let e=null===(t=this.metamodel)||void 0===t?void 0:t.getObjectTypeViewsByObjectType(s);(null==e?void 0:e.length)>0&&(l.typeview=e[0])}for(let e in l)l[e]!==this.nodes[i][e]&&(l[e]=this.nodes[i][e])}this.node=l}}getModelView(){return this.modelView}getModel(){if(this.modelView)return this.modelView.model}getMetamodel(){return this.metamodel}setMetamodel(e){this.metamodel=e}addNode(e){var t;e.setParentModelRef(this);let i=[];for(let l=0;l<(null===(t=this.nodes)||void 0===t?void 0:t.length);l++){let t=this.nodes[l];t.key!==e.key&&i.push(t)}i.push(e),this.nodes=i}addLink(e){let t=[];for(let e=0;e<this.links.length;e++){let i=this.links[e];t.push(i)}t.push(e),this.links=t}findNodeByViewId(e){let t=null;if(this.nodes){var i;let t=0;for(;t<(null===(i=this.nodes)||void 0===i?void 0:i.length);){let i=this.nodes[t];if(i.key===e)return i;t++}}return t}findNodeByObjectId(e){let t=null;if(!n.by(this.nodes)){var i;let t=0;for(;t<(null===(i=this.nodes)||void 0===i?void 0:i.length);){let i=this.nodes[t];if(i.objectRef===e)return i;t++}}return t}findNode(e){let t=null;if(!n.by(this.nodes)){var i;let t=0;for(;t<(null===(i=this.nodes)||void 0===i?void 0:i.length);){let i=this.nodes[t];if(i.key===e)return i;t++}}return t}findTypeNode(e){let t=null;if(!n.by(this.nodes)){var i;let l=0;for(;l<(null===(i=this.nodes)||void 0===i?void 0:i.length);){let i=this.nodes[l];if(i.objecttype.id===e){t=i;break}l++}}return t}findGroup(e){let t=this.nodes,i=null==t?void 0:t.length;for(let l=0;l<i;l++){let i=t[l];if(!i.isGroup)continue;let n=i.objectview;if(n&&n.id===e)return i}return null}findLink(e){let t=null;if(!n.by(this.links)){let t=0;for(;t<this.links.length;){let i=this.links[t];if(i.key===e)return i;t++}}return t}findLinkByViewId(e){let t=null;if(this.links){let t=0;for(;t<this.links.length;){let i=this.links[t];if(i.key===e)return i;t++}}return t}updateNode(e){let t=this.nodes;for(let i=0;i<t.length;i++){let l=t[i];if(l.key===e.key){for(let t in l)"string"==typeof t&&e[t]!==l[t]&&(l[t]=e[t]);break}}}updateTypeNode(e){let t=this.nodes;for(let i=0;i<t.length;i++)if(t[i].key===e.key){t[i]=e;break}}updateLink(e){let t=this.links;for(let i=0;i<t.length;i++)if(t[i].key===e.key){t[i]=e;break}}updateTypeLink(e){let t=this.links;for(let i=0;i<t.length;i++)if(t[i].key===e.key){t[i]=e;break}}loadMetamodel(e){if(n.y9(e)&&(this.metamodel=e,e.objecttypes)){let t=new a(n.gj(),e.getName(),this.modelView),i=e.getObjectTypes();if(i){let l=0,s=i.length;for(l=0;l<s;l++){let s=i[l];if(n.y9(s)&&!s.getMarkedAsDeleted()){let i=new u(n.gj(),s);i.loadNodeContent(e),t.addNode(i)}}let r=e.getRelshipTypes();if(r)for(l=0,s=r?r.length:0,l=0;l<s;l++){let e=r[l];if(e&&!e.getMarkedAsDeleted()){let i=new f(n.gj(),t,e);i.loadLinkContent()&&t.addLink(i)}}}}}constructor(e,t,i){var n,s,a;this.key=e,this.name=t,this.modelView=i,this.nodes=[],this.links=[],this.model=i?i.model:null,this.metamodel=i&&i.model?i.model.metamodel:null,this.layout="",this.layer=null===(n=this.model)||void 0===n?void 0:n.layer,this.visible="Admin"!==this.layer,this.args1=null===(s=this.model)||void 0===s?void 0:s.args1,this.args2=null===(a=this.model)||void 0===a?void 0:a.args2,r&&console.log("41 constants",l,this)}}class d{getClass(){return this.class}getParentModelRef(){return this.parentModelRef}setParentModelRef(e){this.parentModelRef=null==e?void 0:e.key}getKey(){return this.key}setType(e){this.type=e}getType(){return this.type}setName(e){this.name=e}getName(){return this.name}addData(e){y(this,e)}getData(){return this.data}constructor(e){this.parentModelRef="",this.key=e,this.category="default",this.type=null,this.name="",this.data=[]}}class p extends d{setLoc(e){this.loc=e}getLoc(){return this.loc}setSize(e){this.size=e}getSize(){return this.size}setScale(e){(void 0==e||null==e)&&(e=1),this.scale=e}getScale(){let e=this.scale;return(void 0==e||null==e)&&(this.scale=1),this.scale}setViewkind(e){this.viewkind=e}getViewkind(){return this.viewkind}setLayout(e){this.layout=e}getLayout(){return this.layout}constructor(e,t){super(e),this.parentModelRef=null==t?void 0:t.key,this.text="",this.loc="",this.size=1,this.scale=1,this.memberscale=1,this.arrowscale=1.3,this.strokecolor="",this.strokecolor2="",this.fillcolor="",this.fillcolor2="",this.viewkind="",this.layout="",this.markedAsDeleted=!1}}class c extends p{getObjectViewId(e){return this.objectview?this.objectview.getId():""}loadNodeContent(e){if(this.typeview){let t=this.typeview.getData();if(this.addData(t),this.objectview){let i=this.objectview;for(let e in t)i[e]&&""!==i[e]&&(this[e]=i[e]),"scale"===e&&(i.scale||(this[e]=1),this[e]=Number(this[e]));let l=this.objectview.group;if(""!==l){let t=this.getGroupFromObjviewId(l,e);""!==t&&(this.group=t)}return this.objectview.isGroup&&(this.isGroup=!0),this.setName(this.objectview.getName()),this.setLoc(this.objectview.getLoc()),this.setSize(this.objectview.getSize()),this.setScale(this.objectview.getScale()),this.isExpanded=this.objectview.isExpanded,r&&console.log("415 goObjectNode",this),!0}}return!1}updateNode(e,t){if(e.typeview){var i;let e;let l=null===(i=l.typeview)||void 0===i?void 0:i.data;for(e in l)null!=l[e]&&t.model.setDataProperty(l,e,l[e])}}getParentNode(e){let t=this.group;if(""!==t&&void 0!==t){let i=e.nodes;for(let e=0;e<(null==i?void 0:i.length);e++){let l=i[e];if(l.key===t)return l}}return null}getTopNode(e){let t=this.getParentNode(e);if(t){if(t.key===this.key);else{let i=t.getTopNode(e);if(i)return i}}return this}getMyScale(e){let t=this.scale;this.group||(t=1);let i=this.getParentNode(e);return i?((t=i.memberscale)&&"undefined"!=t||(t=i.typeview.memberscale),t*=i.getMyScale(e)):t=1,t}getActualScale(e){let t=this.scale;t&&"undefined"!=t||(t=1);let i=this.getParentNode(e);return r&&console.log("597 node",i),i&&i.key!==this.key&&(t*=i.getActualScale(e)),t}getGroupFromObjviewId(e,t){let i=t.nodes;for(let t=0;t<(null==i?void 0:i.length);t++){let l=i[t],n=l.objectview;if(n&&n.id===e)return l.key}return""}getGroupMembers(e){if(!this.isGroup||!e)return null;let t=[],i=this.key,l=e.nodes;for(let e=0;e<(null==l?void 0:l.length);e++){let n=l[e];n.group===i&&t.push(n)}return t}getGroupMembers2(e){if(!this.isGroup)return null;let t=[],i=this.key,l=e.nodes;for(let e=0;e<l.length;e++){let n=l[e];n.group===i&&t.push(n.objectview)}return t}getGroupLinkMembers(e){if(!this.isGroup)return null;let t=this.key,i=[],l=e.links;for(let e=0;e<l.length;e++){let n=l[e],s=n.fromNode,a=n.toNode;r&&console.log("488 groupId, nodes",t,s,a),s.group===t&&a.group===t&&i.push(n)}return i}getGroupLinkMembers2(e){if(!this.isGroup)return null;let t=this.key,i=[],l=e.links;for(let e=0;e<l.length;e++){let n=l[e],s=n.fromNode,a=n.toNode;if(r&&console.log("501 groupId, nodes",t,s,a),(null==s?void 0:s.group)===t&&(null==a?void 0:a.group)===t){let e=n.relshipview;i.push(e)}}return i}addPort(e,t){let i=new cxPort(n.gj(),t,"",e);e===l.gojs.C_LEFT?this.leftPorts.push(i):e===l.gojs.C_RIGHT?this.rightPorts.push(i):e===l.gojs.C_TOP?this.topPorts.push(i):e===l.gojs.C_BOTTOM&&this.bottomPorts.push(i)}removePort(e,t){e===l.gojs.C_LEFT?this.leftPorts=this.leftPorts.filter(e=>e.name!==t):e===l.gojs.C_RIGHT?this.rightPorts=this.rightPorts.filter(e=>e.name!==t):e===l.gojs.C_TOP?this.topPorts=this.topPorts.filter(e=>e.name!==t):e===l.gojs.C_BOTTOM&&(this.bottomPorts=this.bottomPorts.filter(e=>e.name!==t))}removeClassInstances(){this.objectview=null,this.object=null,this.objecttype=null,this.typeview=null,this.leftPorts=null,this.rightPorts=null,this.topPorts=null,this.bottomPorts=null}constructor(e,t,i){var n,r,a,d,p,c,u;if(super(e,t),this.name=null==i?void 0:i.name,this.category=l.gojs.C_OBJECT,this.objectview=i,this.object=null,this.objecttype=null,this.objviewRef=null==i?void 0:i.id,this.objRef=null==i?void 0:null===(n=i.object)||void 0===n?void 0:n.id,this.objtypeRef=null==i?void 0:null===(a=i.object)||void 0===a?void 0:null===(r=a.type)||void 0===r?void 0:r.id,this.leftPorts=null,this.rightPorts=null,this.topPorts=null,this.bottomPorts=null,this.typename="",this.typedescription="",i){this.template=i.template,this.template2=i.template2,this.figure=i.figure?i.figure:"",this.geometry=i.geometry?i.geometry:"",this.fillcolor=i.fillcolor?i.fillcolor:"",this.fillcolor2=i.fillcolor2?i.fillcolor2:"",this.strokecolor=i.strokecolor?i.strokecolor:"",this.strokecolor2=i.strokecolor2?i.strokecolor2:"",this.strokewidth=i.strokewidth?i.strokewidth:1,this.textcolor=i.textcolor?i.textcolor:"",this.textcolor2=i.textcolor2?i.textcolor2:"",this.textscale=i.textscale?i.textscale:1,this.icon=i.icon?i.icon:"",this.image=i.image?i.image:"",this.isGroup=i.isGroup,this.loc=i.loc,this.size=i.size,this.scale=i.scale,this.memberscale=i.memberscale,this.grabIsAllowed=i.grabIsAllowed,this.isExpanded=i.isExpanded,this.isSelected=i.isSelected,this.groupLayout=i.groupLayout,this.group=i.group,this.parent="";let e=null==i?void 0:i.getObject();if(e&&e instanceof s.Jo){this.object=e,this.name=e.getName();let t=e.getType();if(t){let i=new s.$$(t.id,t.name,t.description);this.objecttype=i,this.typename=i.name,this.typedescription=i.description;let n=l.props.DRAFT;if(i.findPropertyByName(n)){let t=e.getStringValue2(n);t&&(null==t?void 0:t.length)>0&&(this.typename=t)}}else this.objecttype=null,this.typename="",this.typedescription="";this.leftPorts=e.getLeftPorts(),this.rightPorts=e.getRightPorts(),this.topPorts=e.getTopPorts(),this.bottomPorts=e.getBottomPorts()}this.typeview=i.getTypeView(),this.template||(this.template=null===(d=this.typeview)||void 0===d?void 0:d.template),this.template2||(this.template2=null===(p=this.typeview)||void 0===p?void 0:p.template2),this.geometry||(this.geometry=null===(c=this.typeview)||void 0===c?void 0:c.geometry),this.figure||(this.figure=null===(u=this.typeview)||void 0===u?void 0:u.figure),this.figure||(this.figure="")}}}class u extends p{getObjectTypeId(){return this.objecttype?this.objecttype.getId():""}loadNodeContent(e){if(this.objecttype){let t=this.objecttype,i=this.typeview;if(i){let n=i.getData();if(this.addData(n),this.setName(t.getName()),this.setType(l.gojs.C_OBJECTTYPE),this.setViewkind(t.getViewKind()),e){let i=t.getLoc(e);this.setLoc(i);let l=t.getSize(e);this.setSize(l)}}return r&&console.log("671 loadNodeContent",this),!0}return!1}updateNode(e,t){if(this.typeview){let e;let i=this.typeview.getData();for(e in i)null!=i[e]&&t.model.setDataProperty(i,e,i[e])}}constructor(e,t){if(super(e,null),this.category=l.gojs.C_OBJECTTYPE,this.objecttype=t,this.typeview=null,this.typename=l.gojs.C_OBJECTTYPE,this.typedescription="",r&&console.log("416 this",this),t){this.setName(t.getName()),this.setType(l.gojs.C_OBJECTTYPE);let e=t.getDefaultTypeView();e&&(this.typeview=e)}}}class h extends d{constructor(e,t){super(e),this.parentModelRef=t.key,this.markedAsDeleted=!1}}class m extends h{getRelshipView(){return this.relshipview}getFromNode(){return this.fromNode}setFromNode(e){this.fromNode=e}getToNode(){return this.toNode}setFromPort(e){this.fromPort=e}getFromPort(){return this.fromPort}setToPort(e){this.toPort=e}getToPort(){return this.toPort}setToNode(e){this.toNode=e}getRelshipKind(){let e=this.typeview;return e?e.getRelshipKind():this.relshipkind}setRelshipKind(e){this.relshipkind=e}loadLinkContent(e){let t=this.relshipview,i=this.typeview,l=e.modelView;if(r&&console.log("722 typeview, relview: ",i,t),t&&i){if(!t.markedAsDeleted&&this.toNode&&this.fromNode){let e=i.data;for(let l in i.data,this.setName(t.name),this.points=t.points,e)"abstract"!==l&&"class"!==l&&"category"!==l&&(t[l]&&""!==t[l]&&void 0!=t[l]?this[l]=t[l]:this[l]=e[l])}r&&console.log("744 goRelshipLink, typeview, relview: ",this,i,t)}if(this.routing=l.routing,this.curve=l.linkcurve,l.showCardinality){var n,s;this.cardinalityFrom=null===(n=t.relship)||void 0===n?void 0:n.getCardinalityFrom(),this.cardinalityTo=null===(s=t.relship)||void 0===s?void 0:s.getCardinalityTo()}else this.cardinalityFrom="",this.cardinalityTo="";this.fromArrow||this.toArrow||(this.fromArrow="",this.toArrow="OpenTriangle"),this.toArrow&&"None"===this.toArrow&&(this.toArrow=""),r&&console.log("764 goRelshipLink, this: ",this)}updateLink(e,t){if(this.typeview){let e;let i=this.typeview.getData();for(e in i)null!=i[e]&&t.model.setDataProperty(i,e,i[e])}}removeClassInstances(){this.relshipview=null,this.relship=null,this.relshiptype=null,this.typeview=null,this.fromNode=null,this.toNode=null}constructor(e,t,i){var n,a,d,p,c,u;if(super(e,t),this.category=l.gojs.C_RELATIONSHIP,this.relshipview=i,this.relship=null,this.relshiptype=null,this.relviewRef=null==i?void 0:i.id,this.relshipRef=null==i?void 0:null===(n=i.relship)||void 0===n?void 0:n.id,this.reltypeRef=null==i?void 0:null===(d=i.relship)||void 0===d?void 0:null===(a=d.type)||void 0===a?void 0:a.id,this.typename="",this.typedescription="",this.typeview=null,this.fromNode=null,this.toNode=null,this.from="",this.to="",this.fromPort=null==i?void 0:i.fromPortid,this.toPort=null==i?void 0:i.toPortid,this.typename="",this.template=null==i?void 0:i.template,this.template2=null==i?void 0:i.template2,this.arrowscale=null==i?void 0:i.arrowscale,this.strokecolor=null==i?void 0:i.strokecolor,this.strokewidth=null==i?void 0:i.strokewidth,this.textcolor=null==i?void 0:i.textcolor,this.textscale=null==i?void 0:i.textscale,this.dash=null==i?void 0:i.dash,this.fromArrow=null==i?void 0:i.fromArrow,this.fromArrowColor=null==i?void 0:i.fromArrowColor,this.toArrow=null==i?void 0:i.toArrow,this.toArrowColor=null==i?void 0:i.toArrowColor,this.routing=(null==i?void 0:i.routing)?i.routing:"",this.curve=(null==i?void 0:i.curve)?i.curve:"",this.corner=(null==i?void 0:i.corner)?i.corner:"",this.points=[],this.relshipkind="",this.cardinality="",this.cardinalityFrom="",this.cardinalityTo="",this.nameFrom="",this.nameTo="",this.visible=null==i?void 0:i.visible,i){let e=i.getRelationship();if(e&&e instanceof s.CK){this.relship=e,this.name=e.getName();let t=e.getType();if(t&&t instanceof s.MX){this.relshiptype=e.type,this.reltypeRef=t.id,this.typename=t.getName(),this.typedescription=this.relshiptype.getDescription(),this.name=this.relship.name,0==this.name.length&&(this.name=this.typename),this.cardinalityFrom=this.relship.cardinalityFrom,this.cardinalityTo=this.relship.cardinalityTo,this.nameFrom=this.relship.nameFrom,this.nameTo=this.relship.nameTo,r&&console.log("629 relshipLink",this);let i=l.props.DRAFT;if(t.findPropertyByName(i)){let t=e.getStringValue2(i);t&&(null==t?void 0:t.length)>0&&(this.name=t)}}else this.reltype=null,this.typename="",this.typedescription=""}this.typeview=i.getTypeView(),this.relshipkind=null===(p=this.relshiptype)||void 0===p?void 0:p.getRelshipKind(),this.template||(this.template=null===(c=this.typeview)||void 0===c?void 0:c.template),this.template2||(this.template=null===(u=this.typeview)||void 0===u?void 0:u.template2);let n=i.getFromObjectView();if(n){let e=null==t?void 0:t.findNodeByViewId(n.id);e&&(this.fromNode=e,this.from=e.key)}let a=i.getToObjectView();if(a){let e=null==t?void 0:t.findNodeByViewId(a.id);e&&(this.toNode=e,this.to=e.key)}}}}class f extends h{getTypeView(){return this.typeview}getFromNode(){return this.fromNode}getToNode(){return this.toNode}loadLinkContent(){if(this.reltype&&!1===this.reltype.markedAsDeleted&&this.toNode&&this.fromNode){let e=this.typeview;if(e){let t=e.getData();return this.addData(t),this.setName(this.reltype.getName()),this.strokewidth||(this.strokewidth="1.0"),this.strokecolor||(this.strokecolor="black"),(" "===this.fromArrow||"None"===this.fromArrow)&&(this.fromArrow=""),!0}}return!1}updateLink(e,t){if(this.typeview){let i;let l=this.typeview.getData();for(i in l)null!=l[i]&&t.model.setDataProperty(e,i,l[i])}}constructor(e,t,i){if(super(e,t),this.category=l.gojs.C_RELSHIPTYPE,this.reltype=i,this.typeview=null,this.fromNode=null,this.toNode=null,this.from="",this.to="",this.template="",this.template2="",this.relshipkind="",this.cardinality="",this.cardinalityFrom="",this.cardinalityTo="",this.nameFrom="",this.nameTo="",this.points=[],i){this.setName(i.getName()),this.setType(l.gojs.C_RELSHIPTYPE),this.relshipkind=this.reltype.relshipkind,this.cardinalityFrom=this.reltype.cardinalityFrom,this.cardinalityTo=this.reltype.cardinalityTo,this.nameFrom=this.reltype.nameFrom,this.nameTo=this.reltype.nameTo;let e=i.getDefaultTypeView();if(e){this.typeview=e;let l=e.getData();this.addData(l);let r=i.getFromObjType();if(r){var n,s;this.fromNode=t.findTypeNode(r.id),this.from=null===(n=this.fromNode)||void 0===n?void 0:n.key;let e=i.getToObjType();e&&(this.toNode=t.findTypeNode(e.id),this.to=null===(s=this.toNode)||void 0===s?void 0:s.key)}}}}}function y(e,t){let i;for(i in t)"class"!==i&&(e[i]=t[i])}class g{constructor(e,t,i,l,n){this.key=e,this.type=t,this.category=i,this.viewkind="Object",this.abstract=!1,this.name=l,this.description=n,this.isGroup=!1,this.template="",this.figure="",this.geometry="",this.fillcolor="lightyellow",this.fillcolor2="",this.strokecolor="black",this.strokewidth=1,this.icon="",this.image=""}}},8044:(e,t,i)=>{"use strict";i.d(t,{E:()=>M});var l=i(7876),n=i(4232),s=i(7658),r=i.n(s);let a=!1;class d extends n.PureComponent{handleInputChange(e){a&&console.log("33 this.props, e.target",this.props,e.target);let t=this.props.type,i=e.target.value;if("checkbox"===t&&"true"===this.props.value&&(e.target.checked=!0),"checkbox"===t&&(i=e.target.checked),a&&console.log("41 e.target: ",e.target,e.type),a&&console.log("42 InspectorRow: this.props, value: ",this.props,i),this.props.onInputChange(this.props,i,"blur"===e.type),"blur"===e.type){let e=this.props.pattern;if((null==e?void 0:e.length)>0&&(null==i?void 0:i.length)>0){let t=new(r())(e);a&&console.log("50 pattern, value, regex:",e,i,t),t.test(i)||alert("Value: '"+i+"' IS NOT valid")}}}formatLocation(e){let t=e.split(" ");if(2===t.length){let e=parseFloat(t[0]),i=parseFloat(t[1]);if(!isNaN(e)&&!isNaN(i))return"".concat(e.toFixed(0)," ").concat(i.toFixed(0))}return e}render(){let e="Fieldtype : ".concat(this.props.type," \nDescription: ").concat(this.props.description);a&&console.log("74 InspectorRow: this.props",this.props);let t=this.props.value;if("Not valid"===t&&alert("Input is not valid: "+t),"textarea"===this.props.type)return a&&console.log("80 props",this.props),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"label pr-2 w-25",children:this.props.id}),(0,l.jsx)("td",{children:(0,l.jsx)("textarea",{disabled:this.props.disabled,id:this.props.id,value:t,onChange:this.handleInputChange,onBlur:this.handleInputChange,rows:Math.ceil((null==t?void 0:t.length)/69)||1})}),(0,l.jsx)("td",{children:(0,l.jsx)("div",{className:"btn-sm bg-light text-green px-1 py-2 float-right","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:e,children:"i"})})]});if("select"!==this.props.type)return a&&console.log("132 props",this.props),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"pr-2  w-25",children:this.props.id}),(0,l.jsx)("td",{children:(0,l.jsx)("input",{disabled:this.props.disabled,id:this.props.id,value:t,checked:this.props.checked,type:this.props.type,onChange:this.handleInputChange,onBlur:this.handleInputChange})}),(0,l.jsx)("td",{children:(0,l.jsx)("div",{className:"btn-sm bg-light text-green px-1 py-2 float-right","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:e,children:"i"})})]});{let i="Select_"+this.props.id,n=this.props.values,s=null==n?void 0:n.map(e=>(0,l.jsx)("option",{value:e},e)),r=(0,l.jsx)("datalist",{id:i,children:s});return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"pr-2 w-25",children:this.props.id}),(0,l.jsxs)("td",{children:[(0,l.jsx)("input",{id:this.props.id,type:"text",list:i,placeholder:null==t?void 0:t.toString(),onChange:this.handleInputChange,onBlur:this.handleInputChange}),r]}),(0,l.jsx)("td",{children:(0,l.jsx)("div",{className:"btn-sm bg-light text-green px-1 py-2 float-right","data-toggle":"tooltip","data-placement":"top","data-bs-html":"true",title:e,children:"i"})})]})}}constructor(e){super(e),a&&console.log("28 InspectorRow: props",this.props),this.handleInputChange=this.handleInputChange.bind(this),a&&console.log("30 InspectorRow: this",this,this.props)}}var p=i(6738),c=i.n(p),u=i(1324),h=i.n(u),m=i(7089),f=i(2210),y=i(6046),g=i(2588),v=i(1457);let w=!1,b=["None","Standard","Backward","OpenTriangle","Triangle","BackwardOpenTriangle","BackwardTriangle","Diamond","StretchedDiamond","Fork","BackwardFork","LineFork","BackwardLineFork","Circle","Block"],T=["lightsalmon","#87CEFE","turquoise","#FFD701","black","white","red","darkred","pink","green","palegreen","lightgreen","darkgreen","seagreen","blue","lightblue","darkblue","skyblue","grey","lightgrey","darkgrey","yellow","lightyellow","yellowgreen","orange","brown","purple","violet","transparent"],j=["1","2","3","4","5"],O=!0,k=!0;class M extends n.PureComponent{renderObjectDetails(){let e=this.props.context.what,t=[];return"editObject"===e||"editRelationship"===e?this.renderObjectDetails1(t):this.renderObjectDetails2(t)}renderObjectDetails1(e){let t,i,n,s,r,a,p,u,M,R=null,A="",E=this.props.activeTab;w&&console.log("62 SelectionInspector: myMetis",this.props);let D=this.props.context,S=this.props.myMetis,N=D.myContext,P=N.metamodel,C=N.model;N.modelview;let x=N.object,_=N.objecttype,I=N.supertypes,V=N.relship,L=N.relshiptype;V&&!L&&(L=S.findRelationshipType(V.typeRef)),(null==_?void 0:_.name)===v.types.AKM_ENTITY_TYPE&&(_.properties=[]);let F=null==C?void 0:C.includeSystemtypes,B=!1;S.submodels=[],S.submetamodels=[],w&&console.log("64 SelectionInspector: myMetis",S),w&&console.log("66 activeTab",E);let G=this.props.selectedData,K=null==G?void 0:G.category;if((null==G?void 0:G.type)==="GraphLinksModel")return;_||(_=S.findObjectType(null==G?void 0:G.objtypeRef)),L||(L=S.findRelationshipType(null==G?void 0:G.reltypeRef));let J="",W="",U="";switch(K){case v.gojs.C_OBJECT:(i=x)&&(t=i),n=_;break;case v.gojs.C_RELATIONSHIP:let z=L;i=t=V,n=z}t.parentModelRef,C.id;let H=!1,Y=!1,Z={myMetis:S,includeConnected:!1,includeInherited:!1};{var q,X;let e=[];if(K===v.gojs.C_OBJECT){if(A=f.a2(t,Z,!0),(null==n?void 0:n.name)==="Method")s=p=_;else{if(p=s=_,r=t,W=null==s?void 0:s.name,U=null==s?void 0:s.description,O&&(null==D?void 0:D.what)==="editObject"){(null==(e=I)?void 0:e.length)>0&&(Z.includeInherited=!0);let i=[];try{i=null==t?void 0:t.getConnectedObjects2(S)}catch(e){}(null==i?void 0:i.length)>0&&(Z.includeConnected=!0)}if("Details"===(W=(A=f.a2(t,Z,!0))[E])&&(W=null==s?void 0:s.name),A.length>1&&"Element"!==W)for(let t=0;t<(null==I?void 0:I.length);t++)(null===(q=I[t])||void 0===q?void 0:q.name)===W&&(p=n=e[t])}}else if(K===v.gojs.C_RELATIONSHIP&&(p=s=n,r=i,W=s.name,U=s.description,O&&"editRelationship"===D.what)){let e=null==i?void 0:i.getInheritedTypes();if(e.push(s),e=[...new Set(e)],(null==i?void 0:i.hasInheritedProperties(C))&&(H=!0),Z={myMetis:S,myModel:C,myMetamodel:P,activeTab:E,includeConnected:!1,includeInherited:H},"Details"===(W=(A=f.a2(i,Z,!0))[E])&&(W=null==s?void 0:s.name),A.length>1){for(let t=0;t<e.length;t++)if((null===(X=e[t])||void 0===X?void 0:X.name)===W){p=n=e[t];break}}(null==i?void 0:i.hasInheritedProperties(C))||(p=s,n=s)}}if("object"!=typeof n)return;let $=!1,Q=!1,ee=!1,et=D.what;if(K===v.gojs.C_OBJECT){if(p)try{a=p.getProperties(!1)}catch(e){}if((null==n?void 0:n.name)==="Method"){let e=S.findObject(t.id);e&&(t=e),a=t.setAndGetAllProperties(S),r=t}else if(n){let e=!1;t=S.findObject(t.id),n=S.findObjectType(n.id);try{let i=null==n?void 0:n.getProperties(e),l=null==t?void 0:t.getInheritedProperties(C);a=(null==l?void 0:l.length)>0?i.concat(l):i}catch(e){}}}else if(K===v.gojs.C_RELATIONSHIP){let e=!1,i=null==n?void 0:n.getProperties(e);a=t.setAndGetAllProperties(S),a=i}else v.gojs.C_RELSHIPTYPE;for(let e=0;e<(null==a?void 0:a.length);e++){let t=a[e];t&&r&&!r[t.name]&&(r[t.name]="")}switch(et){case"editObject":(null==n?void 0:n.name)===v.types.AKM_LABEL&&(ee=!0),u=r;break;case"editRelationship":u=r;break;default:u=t}let ei=0,el=[];for(let e in p){if("id"===e||!f.A1(e,p)||"viewkind"===e||"grabIsAllowed"===e&&("editObjectview"!==et&&"editTypeview"!==et||"Container"!==u.viewkind))continue;if("abstract"===e){if("editObject"===et){if(n&&n.name!==v.types.AKM_ENTITY_TYPE)continue}else if("editObjectType"!==et)continue}if("text"===e&&!ee||"copiedFromId"===e||"markedAsDeleted"===e||"object"==typeof e)continue;ei++;let t=new m.Y9(ei,e);el.push(t)}w&&console.log("proplist",el),A.length>1&&"Type"===W&&(a=[]);for(let e=0;e<(null==a?void 0:a.length);e++){let t=a[e],i=!1;for(let e=0;e<(null==el?void 0:el.length);e++)if(el[e].name===t.name){i=!0;break}if(i)continue;ei++;let l=new m.Y9(ei,t.name);el.push(l)}ei++,"editRelationship"===et&&(M=new m.Y9(ei,"typename"),el.push(M),M=new m.Y9(ei,"typedescription"),el.push(M)),el=[...new Set(el)],M=new m.Y9(ei,"id"),el.push(M);for(let i=0;i<(null==el?void 0:el.length);i++){let p="",O="text",M="",D=B,C=!1,x=!1,_=".",I=!1,V="",L=[],K=!1,W=el[i].name;if((null==a?void 0:a.length)>0)for(let e=0;e<a.length;e++){let i=a[e];if(i){if(i.name!==W)continue;let e=P.findProperty(i.id);e||((e=P.findPropertyByName(i.name))||(e=new m.$s(i.id,i.name,i.description)),e.methodRef=i.methodRef,e.datatypeRef=i.datatypeRef),(i=e).readOnly&&(D=!0),i.isRequired&&(I=!0);let l=i.datatype;if(!l){let e=i.datatypeRef;e&&(l=P.findDatatype(e))}if(l){let e=l.getIsOfDatatype();e&&(l=e)}if(l&&(O=l.fieldType,M=l.viewFormat,_=l.inputPattern,V=l.defaultValue,L=l.allowedValues,J=i.description),null==i?void 0:i.methodRef){if(D=!0,(null==t?void 0:t.category)===v.gojs.C_OBJECT){let e=S.findObject(t.id);e&&(t=e)}else if((null==t?void 0:t.category)===v.gojs.C_RELATIONSHIP){let e=S.findRelationship(t.id);e&&(t=e)}try{p=u.getPropertyValue(i,S),K=!0}catch(e){}}else D=!1;if((null==t?void 0:t.category)===v.gojs.C_OBJECT){let e=null==t?void 0:t.getConnectedObjects1(i,S);(null==e?void 0:e.length)>1&&(p="");for(let t=0;t<(null==e?void 0:e.length);t++){let i=e[t];i&&(0==t?p=i.name:p+=" | "+i.name)}}}}if("editObject"===et){if(Y&&"name"===W){p=r.getName();break}K||(p=r[W]),"typename"===W?p=s.name:"typedescription"===W?p=s.description:"typeid"===W?p=s.id:K||(p=r[W])}else if("editRelationship"===et){if(!f.A1(W,n))continue;p="typename"===W?s.name:"typedescription"===W?s.description:"typeid"===W?s.id:r[W]}if(W){($&&"fillcolor"===W||$&&"fillcolor2"===W||Q&&"strokecolor"===W||Q&&"strokecolor2"===W)&&(""===p&&"editObjectview"===et&&(p=typeview.fillcolor),O="color",(null==p?void 0:p.substring(0,3))==="rgb("&&(p=("#"+p.match(/\d+/g).map(function(e){return 1==(e=parseInt(e).toString(16)).length?"0"+e:e}).join("")).toUpperCase()),p&&"#"!==p[0]&&(p=c()(p)));{let e;switch(W){case"id":case"typename":case"typedescription":case"description":case"geometry":O="textarea";break;case"cardinalityFrom":case"cardinalityTo":(e=P.findDatatypeByName("cardinality"))&&(O="select",M=e.viewFormat,_=e.inputPattern,V=e.defaultValue,L=e.allowedValues),F||(C=!0);break;case"fieldType":case"viewkind":(e=P.findDatatypeByName(W))&&(O=e.fieldType,_=e.inputPattern,V=e.defaultValue,L=e.allowedValues),F||(C=!0);break;case"relshipkind":O="select",V="Association",L=["Association","Generalization","Composition","Aggregation"];break;case"abstract":e=S.findDatatypeByName("boolean"),k?O="checkbox":(O="radio",V="false",L=["false","true"]),F||(C=!0);break;case"grabIsAllowed":O="checkbox";break;case"methodtype":let t=P.methodtypes;t&&(L=t.map(e=>e&&e.name),O="radio");break;case"dash":L=["None","Dashed","Dotted"],V="None",O="radio";break;case"template":case"template2":G.isGroup?"Container"===G.viewkind&&(L=y._k(),V="",O="radio"):G.category===v.gojs.C_RELATIONSHIP?(L=y.b0(),V="",O="radio"):G.category===v.gojs.C_RELSHIPTYPE?(L=y.b0(),V="",O="radio"):(G.category===v.gojs.C_OBJECT||G.category===v.gojs.C_OBJECTTYPE)&&("Object"===G.viewkind?(L=y.tV(),V="",O="radio"):"Container"===G.viewkind&&(L=y._k(),V="",O="radio"));break;case"figure":(G.category===v.gojs.C_OBJECT||G.category===v.gojs.C_OBJECTTYPE)&&(L=y.ZQ(),V="",O="radio");break;case"routing":L=["Normal","Orthogonal","AvoidsNodes"],V="None",O="radio";break;case"curve":L=["None","Bezier","JumpOver","JumpGap"],V="None",O="radio";break;case"fromArrow":L=b,V="None",O="select";break;case"toArrow":L=b,V="OpenTriangle",O="select";break;case"fillcolor":case"fillcolor2":$||(L=T,V="white",O="select");break;case"strokecolor":case"strokecolor2":Q||(L=T,V="black",O="select");break;case"strokewidth":L=j,V="1",O="select";break;case"textcolor":case"textcolor2":case"fromArrowColor":case"toArrowColor":L=T,V="black",O="select";break;default:O||(O="textarea")}}if("checkbox"===O&&(x=p),"radio"===O){O="select";let e="^(",t=")$",i="";for(let e=0;e<(null==L?void 0:L.length);e++){let t=L[e];""===i?i=t:i+="|"+t}_=e+i+t}if("select"===O&&""===p&&(p=V),"date"===O&&(w&&console.log("771 prop",prop),_="",""===p&&(p=new Date().toISOString().slice(0,10)),D&&(C=!0)),"time"===O&&(_="",""===p&&(p=new Date().getTime()),D&&(C=!0)),"name"===W&&(O="text"),M&&g.kf(p)&&"time"!==O&&(p=h()(M,Number(p))),C=!!D,A.length>1){if(E>0&&("name"===W||"description"===W||"id"===W)||"Type"===A[E]&&"typename"!==W&&"typedescription"!==W&&"typeid"!==W||"Type"!==A[E]&&("typename"===W||"typedescription"===W||"typeid"===W))continue;("id"===W||"typeid"===W||"typename"===W||"typedescription"===W)&&(C=!0)}R=(0,l.jsx)(d,{id:W,type:O,value:p,values:L,description:J,default:V,readonly:D,disabled:C,required:I,checked:x,pattern:_,obj:G,context:N,onInputChange:this.props.onInputChange},W)}"key"===W?e.unshift(R):e.push(R)}return e}renderObjectDetails2(e){let t,i,n,s,r,a,p,u,m,O,M;let R=this.props.activeTab;w&&console.log("62 SelectionInspector: myMetis",this.props);let A=this.props.context,E=A.what,D=this.props.myMetis,S=A.myContext;S.myContext;let N=S.metamodel,P=S.model,C=S.object,x=S.objectview,_=S.objecttype,I=S.objecttypeview,V=S.relship,L=S.relshipview,F=S.relshiptype,B=S.relshiptypeview,G=null==P?void 0:P.includeSystemtypes;D.submodels=[],D.submetamodels=[],w&&console.log("64 SelectionInspector: myMetis",D),w&&console.log("66 activeTab",R);let K=this.props.selectedData,J=null==K?void 0:K.category;if((null==K?void 0:K.type)==="GraphLinksModel")return;switch(_||(I=null==(_=D.findObjectType(null==K?void 0:K.objtypeRef))?void 0:_.typeview),I&&(I.viewkind=I.data.viewkind),F||(B=null==(F=D.findRelationshipType(null==K?void 0:K.reltypeRef))?void 0:F.typeview),J){case v.gojs.C_OBJECT:s=x,C||(C=null==x?void 0:x.object),n=C,s&&(i=s),t=n,r=_,p=u=I,(null==n?void 0:n.template)==="Pool"&&(i.viewkind="Container",u.template="Pool",u.viewkind="Container"),console.log("96",r,a,u,p);break;case v.gojs.C_OBJECTTYPE:r=_,p=u=I;break;case v.gojs.C_RELATIONSHIP:let W=V,U=F;i=L,n=t=W,a=r=U,p=B;break;case v.gojs.C_RELSHIPTYPE:r=F,p=B}let z=!1,H=0;if("object"!=typeof r)return;let Y=!1,Z=!1,q=!1,X=null;switch(E){case"editModelview":X=O=modelview;break;case"editObjectview":case"editRelshipview":case"editTypeview":K.category===v.gojs.C_RELATIONSHIP?(O=i,"editTypeview"===E&&(O=m)):K.category===v.gojs.C_RELSHIPTYPE?(O=null==m?void 0:m.data,O=m):K.category===v.gojs.C_OBJECT?(O=i,"editTypeview"===E&&(O=u)):K.category===v.gojs.C_OBJECTTYPE&&(O=null==u?void 0:u.data,O=u),O||(O=t),"editObjectview"===E?(null==r?void 0:r.name)!==v.types.AKM_PORT&&(Y=!1):("editRelshipview"===E||"editTypeview"===E)&&(Z=!1),X=null==p?void 0:p.data;break;default:O=t}for(let t in X){let i;if(f.A1(t,r)){if("grabIsAllowed"===t&&("editObjectview"!==E&&"editTypeview"!==E||"Container"!==O.viewkind))continue;if("abstract"===t){if("editObjectType"!==E)continue;if(O.category===v.gojs.C_OBJECTTYPE)switch(O.name){case"Property":case"Datatype":case"Method":case"MethodType":case"Value":case"FieldType":case"ViewFormat":case"InputPattern":case"undefined":continue}}if("viewkind"===t&&("editObjectview"!==E&&"editTypeview"!==E&&"editObjectType"!==E||q)||"text"===t&&!q||"copiedFromId"===t||"markedAsDeleted"===t)continue;if(M="",t){let e="text",n="",s=!1,r=!1,a=!1,f=".",R=!1,A="",P=[],C=K[t];switch(C||(C=""),"dash"===t&&"object"==typeof C&&(C=C.valueOf()),E){case"editTypeview":u?C=K[t]:m&&(C=O[t]);break;case"editObjectview":"grabIsAllowed"===t&&(C=K[t])}(Y&&"fillcolor"===t||Y&&"fillcolor2"===t||Z&&"strokecolor"===t||Z&&"strokecolor2"===t)&&(""===C&&"editObjectview"===E&&(C=p.fillcolor),e="color",(null==C?void 0:C.substring(0,3))==="rgb("&&(C=("#"+C.match(/\d+/g).map(function(e){return 1==(e=parseInt(e).toString(16)).length?"0"+e:e}).join("")).toUpperCase()),C&&"#"!==C[0]&&(C=c()(C)));{let i;switch(t){case"description":case"typedescription":case"geometry":e="textarea";break;case"cardinalityFrom":case"cardinalityTo":(i=N.findDatatypeByName("cardinality"))&&(e="select",n=i.viewFormat,f=i.inputPattern,A=i.defaultValue,P=i.allowedValues),G||(r=!0);break;case"fieldType":case"viewkind":(i=N.findDatatypeByName(t))&&(e=i.fieldType,f=i.inputPattern,A=i.defaultValue,P=i.allowedValues),G||(r=!0);break;case"relshipkind":e="select",A="Association",P=["Association","Generalization","Composition","Aggregation"];break;case"abstract":i=D.findDatatypeByName("boolean"),k?e="checkbox":(e="radio",A="false",P=["false","true"]),G||(r=!0);break;case"grabIsAllowed":e="checkbox";break;case"methodtype":let l=N.methodtypes;l&&(P=l.map(e=>e&&e.name),e="radio");break;case"dash":P=["None","Dashed","Dotted"],A="None",e="radio";break;case"template":case"template2":K.isGroup?"Container"===K.viewkind&&(P=y._k(),A="",e="radio"):K.category===v.gojs.C_RELATIONSHIP?(P=y.b0(),A="",e="radio"):K.category===v.gojs.C_RELSHIPTYPE?(P=y.b0(),A="",e="radio"):(K.category===v.gojs.C_OBJECT||K.category===v.gojs.C_OBJECTTYPE)&&("Object"===K.viewkind?(P=y.tV(),A="",e="radio"):"Container"===K.viewkind&&(P=y._k(),A="",e="radio"));break;case"figure":(K.category===v.gojs.C_OBJECT||K.category===v.gojs.C_OBJECTTYPE)&&(P=y.ZQ(),A="",e="radio");break;case"routing":P=["Normal","Orthogonal","AvoidsNodes"],A="None",e="radio";break;case"curve":P=["None","Bezier","JumpOver","JumpGap"],A="None",e="radio";break;case"fromArrow":P=b,A="None",e="select";break;case"toArrow":P=b,A="OpenTriangle",e="select";break;case"fillcolor":case"fillcolor2":Y||(P=T,A="white",e="select");break;case"strokecolor":case"strokecolor2":Z||(P=T,A="black",e="select");break;case"strokewidth":P=j,A="1",e="select";break;case"textcolor":case"textcolor2":case"fromArrowColor":case"toArrowColor":P=T,A="black",e="select";break;default:e||(e="textarea")}}if("checkbox"===e&&(a=C),"radio"===e){e="select";let t="^(",i=")$",l="";for(let e=0;e<(null==P?void 0:P.length);e++){let t=P[e];""===l?l=t:l+="|"+t}f=t+l+i}switch("select"===e&&""===C&&(C=A),"date"===e&&(w&&console.log("771 prop",prop),f="",""===C&&(C=new Date().toISOString().slice(0,10)),s&&(r=!0)),"time"===e&&(f="",""===C&&(C=new Date().getTime()),s&&(r=!0)),"name"===t&&(e="text"),n&&g.kf(C)&&"time"!==e&&(C=h()(n,Number(C))),z&&H>0&&(r=!0),t){case"id":M="Unique identifier";case"typename":case"typeName":case"typedescription":case"typeDescription":case"loc":case"size":case"markedAsDeleted":case"modelId":case"metamodelId":case"modelviewId":r=!0}q&&"text"!==t&&(r=!0),w&&console.log("918 k, val, readonly, disabled",t,C,s,r),i=(0,l.jsx)(d,{id:t,type:e,value:C,values:P,description:M,default:A,readonly:s,disabled:r,required:R,checked:a,pattern:f,obj:K,context:S,onInputChange:this.props.onInputChange},t)}"key"===t?e.unshift(i):e.push(i)}}return e}render(){let e=this.props.context;return(w&&console.log("950 SelectionInspector: modalContext",e),e)?(0,l.jsx)("div",{id:"myInspectorDiv",className:"inspector w-100",children:(0,l.jsx)("table",{className:"w-100",children:(0,l.jsx)("tbody",{className:"table-body",children:this.renderObjectDetails()})})}):null}}},8296:(e,t,i)=>{"use strict";i.d(t,{Gd:()=>m,Pp:()=>h,wm:()=>f});var l=i(7089),n=i(3022),s=i(2210),r=i(6196),a=i(6046),d=i(1457),p=i(2588),c=i(7658);let u=!1;function h(e,t,i){let l,n,s,r,a,p,c;let u=t.id;t.type;let h=t.obj,m=t.context;if(t.pattern,h.category===d.gojs.C_OBJECTTYPE){let e=h;l=e.objecttype,s=e.typeview,(null==m?void 0:m.what)==="editType"?c=l:(null==m?void 0:m.what)==="editTypeview"&&(c=s);try{c[u]=i}catch(e){}}if(h.category===d.gojs.C_OBJECT){var f,y;let t=h;if(n=e.findObjectView(null==t?void 0:t.key),(r=e.findObject(null==n?void 0:n.objectRef))||(r=h),a=n,s=null==r?void 0:null===(f=r.type)||void 0===f?void 0:f.typeview,(null==m?void 0:m.what)==="editObjectview"){if(a)for(let e in c=a,null==s?void 0:s.data)c[e]=h[e]}else c=(null==m?void 0:m.what)==="editTypeview"?null===(y=r.type)||void 0===y?void 0:y.typeview:r;try{c[u]=i}catch(e){}}if(h.category===d.gojs.C_RELSHIPTYPE){let t=h;l=t.reltype,s=t.reltype.typeview,(null==m?void 0:m.what)==="editType"?c=l:(null==m?void 0:m.what)==="editTypeview"&&(c=s,p=e.findRelationshipTypeView(null==s?void 0:s.id));try{c[u]=i,p[u]=i}catch(e){}}if(h.category===d.gojs.C_RELATIONSHIP){let t=h,l=e.findRelationshipView(null==t?void 0:t.key),n=null==l?void 0:l.relship;n||(n=h);let s=null==l?void 0:l.typeview;(c=(null==m?void 0:m.what)==="editRelshipview"?l:(null==m?void 0:m.what)==="editTypeview"?s:n)&&(c[u]=i)}}function m(e,t){let i=t.myDiagram,a=t.myMetis,u=t.myMetamodel,h=t.myGoModel,m=t.myModel,f=t.myModelview,y=t.modalContext;y.selected=e,y.myMetamodel=u;let g=e.value,v=y.objectview;switch(y.case){case"Change Object type":{let e=g&&g,l=u.findObjectTypeByName(e);i.selection.each(function(e){let n=e.data;if(n.category===d.gojs.C_OBJECT){let e=h.findNodeByViewId(n.key);null==e||e.object,s.aW(n,l,t,!1);let p=i.findNodeForKey(n.key);l.name!==d.types.AKM_ENTITY_TYPE&&r.S0(n,a,i),p&&(p.isSelected=!1),a.myDiagram.requestUpdate()}});break}case"Change Icon":{let e=g&&g,t=[];i.selection.each(function(e){let i=e.data;i&&t.push(i)}),0===t.length&&t.push(y.currentNode),t.map(t=>{if(t.category===d.gojs.C_OBJECT){let l=t.objectview;l||(l=a.findObjectView(t.objviewRef));let s=i.findNodeForKey(t.key).data;if(i.model.setDataProperty(s,"icon",e),i.requestUpdate(),l){(l=a.findObjectView(l.id)).icon=e;let t=new n.g_(l),i=[];i.push(t),i.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),a.myDiagram.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})})}let r=i.findNodeForKey(t.key);r&&(r.isSelected=!1)}else if(t.category===d.gojs.C_OBJECTTYPE){let t=a.currentNode,l=i.findNodeForKey(t.key).data;i.model.setDataProperty(l,"icon",e),i.requestUpdate();let s=t.typeview;if(s=a.findObjectTypeView(null==s?void 0:s.id),i.model.setDataProperty(t,"icon",e),s){s.icon=e,s.data.icon=e;let t=new n.mX(s),l=[];l.push(t),l.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),i.dispatch({type:"UPDATE_OBJECTTYPEVIEW_PROPERTIES",data:t})})}i.requestUpdate()}});break}case"Set Layout Scheme":{let e=f,t="Metamodelling"===a.modelType;if(t&&(e=u),!e)break;let i=g&&g;if(v){v.groupLayout=i;let e=new n.g_(v),t=[];t.push(e),t.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),a.myDiagram.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})})}else if(t){u.layout=i;let e=[];e.push(new n.YS(u,!0)),e.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),a.myDiagram.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:t})})}else{f.layout=i;let e=[];e.push(new n.Yp(f)),e.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),a.myDiagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:t})})}break}case"Set Routing Scheme":{let e=f,t="Metamodelling"===a.modelType;if(t&&(e=u),!e)break;let i=g&&g;if(t){u.routing=i;let e=[];e.push(new n.YS(u,!0)),e.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),a.myDiagram.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:t})})}else{f.routing=i;let e=[];e.push(new n.Yp(f)),e.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),a.myDiagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:t})})}break}case"Set Link Curve":{let e=f,t="Metamodelling"===a.modelType;if(t&&(e=u),!e)break;let i=g&&g;if(t){u.linkcurve=i;let e=[];e.push(new n.YS(u,!0)),e.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),a.myDiagram.dispatch({type:"UPDATE_METAMODEL_PROPERTIES",data:t})})}else{f.linkcurve=i;let e=[];e.push(new n.Yp(f)),e.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),a.myDiagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:t})})}break}case"New Model":{let e=g&&g;a.findMetamodelByName(e);break}case"Set Target Model":{let e=g&&g,t=a.findModelByName(e);a.currentTargetModel=t,a.currentModel.targetModelRef=t.id;let i=new n.bp(a.currentModel,!0);i=JSON.parse(JSON.stringify(i)),a.myDiagram.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:i});break}case"Set Target Metamodel":case"Generate Target Metamodel":{let e=g&&g,t=a.findMetamodelByName(e);t||(t=new l.E7(p.gj(),e),a.addMetamodel(t)),a.currentModel.targetMetamodelRef=null==t?void 0:t.id;let i=new n.bp(a.currentModel,!0);i=JSON.parse(JSON.stringify(i)),a.myDiagram.dispatch({type:"UPDATE_MODEL_PROPERTIES",data:i});break}case"Change Relationship type":{let e=g&&g;i.selection.each(function(l){let n=l.data;if(n.category===d.gojs.C_RELATIONSHIP){if(!n)return;let l=n.relshipRef,d=m.findRelationship(l);d||(d=a.findRelationship(l));let p=n.fromNode,c=n.toNode,u=null==p?void 0:p.objecttype,h=null==c?void 0:c.objecttype;u=a.findObjectType(null==u?void 0:u.id),h=a.findObjectType(null==h?void 0:h.id);let f=a.findRelationshipTypeByName2(e,u,h),y=null==f?void 0:f.relshipkind;switch(d.setRelshipKind(y),y){case"Composition":case"Aggregation":d.cardinalityFrom=f.cardinalityFrom,d.cardinalityTo=f.cardinalityTo}f&&s.xw(n,f,t),r.S0(n,a,i),a.myDiagram.requestUpdate()}});break}case"Edit Attribute":{let t=e.value;if(t&&t.length>0){let e=a.currentNode,i=a.currentLink,l=null,s="";if(e?l=null==e?void 0:e.object:(l=null==i?void 0:i.relship)||(l=null==i?void 0:i.reltype),!l)break;s=l[t];let r=prompt("Enter value of "+t,s);if(r)switch("description"===t?l.description=r:l[t]=r,l.category){case"Relationship":(l=a.findRelationship(l.id))[t]=r;let d=[];d.push(new n.w(l)),null==d||d.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),a.myDiagram.dispatch({type:"UPDATE_RELSHIP_PROPERTIES",data:t})});break;case"Relationship type":if(l=a.findRelationshipType(l.id),"cardinalityFrom"===t||"cardinalityTo"===t){let e="\\b(n|[0-9])\\b[-]\\b(n|[1-9])\\b";if(!new c.RegexParser(e).test(r)){alert("Value: "+r+" IS NOT valid");break}}l[t]=r;let p=[];p.push(new n.Mq(l,!0)),null==p||p.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),a.myDiagram.dispatch({type:"UPDATE_RELSHIPTYPE_PROPERTIES",data:t})})}}break}case"Create Relationship":{var w,b;let i=t.myMetamodel,l=t.myGoModel,s=t.myDiagram,r=t.modalContext,a=e.value;r.typename=a;let d=l.findNode(r.gjsFromNode);d||(d=l.findNode(r.gjsFromNode.key)),r.portFrom;let p=l.findNode(r.gjsToNode);p||(p=l.findNode(r.gjsToNode.key)),r.portTo;let c=r.fromType;c||(c=i.findObjectType(null==d?void 0:null===(w=d.object)||void 0===w?void 0:w.typeRef)),c&&(c.allObjecttypes=i.objecttypes,c.allRelationshiptypes=i.relshiptypes);let u=r.toType;u||(u=i.findObjectType(null==p?void 0:null===(b=p.object)||void 0===b?void 0:b.typeRef)),u&&(u.allObjecttypes=i.objecttypes,u.allRelationshiptypes=i.relshiptypes);let h=i.findRelationshipTypeByName2(a,c,u);if(h){let e=h.typeview;if(e){let t=[];t.push(new n.KW(e)),null==t||t.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),s.dispatch({type:"UPDATE_RELSHIPTYPEVIEW_PROPERTIES",data:t})})}}t.relshiptype=h}}}function f(e,t,i){var c,h,m,f,y,g,v,w,b,T,j,O,k;let M=i.what,R=i.myDiagram;R&&i.context&&(R=i.context.myDiagram),R.selection;let A=t.myMetis,E=A.currentMetamodel,D=A.currentModel,S=A.currentModelview,N=A.gojsModel,P=[],C=[],x=[],_=[],I=[];switch(M){case"editObjectType":{let t=e,i=R.findNodeForKey(t.key);i&&(i.isSelected=!0);let l=t.objecttype;l=A.findObjectType(l.id);let r=i.data;for(let e in l)"id"!==e&&"object"!=typeof l[e]&&"function"!=typeof l[e]&&s.A1(e,l)&&(l[e]=t[e],R.model.setDataProperty(r,e,l[e]));i&&(i.isSelected=!1);let a=new n.DY(l,!0);P.push(a),P.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),R.dispatch({type:"UPDATE_OBJECTTYPE_PROPERTIES",data:t})});break}case"editRelationshipType":{let t=e,i=R.findLinkForKey(t.key);if(!i)break;let l=t.type,r=i.data;(l=i.relshiptype)||(l=r.relshiptype);let a=null==(l=A.findRelationshipType(null==l?void 0:l.id))?void 0:l.typeview;if(l){let e=l.getCardinalityFrom(),t=l.getCardinalityTo();l.cardinalityFrom=e,l.cardinalityTo=t,a&&(a.setRelshipKind(l.relshipkind),a.setTemplate(r.template))}else break;for(let e in selObj)"object"!=typeof l[e]&&"function"!=typeof l[e]&&s.A1(e,l)&&(l[e]=selObj[e],R.model.setDataProperty(i.data,e,l[e]));let d=new n.Mq(l,!0);C.push(d),C.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),R.dispatch({type:"UPDATE_RELSHIPTYPE_PROPERTIES",data:t})});break}case"editPort":{let t=e,i=R.findNodeForKey(t.key);i&&(i.isSelected=!0);break}case"editObject":{let t=e,i=N.findNodeByViewId(t.key),l=S.findObjectView(t.key);r.UD(t,i,l,R);let s=l.object;if(s||(s=A.findObject(l.objectRef)),s){let e=JSON.parse(JSON.stringify(new n.pJ(s)));A.myDiagram.dispatch({type:"UPDATE_OBJECT_PROPERTIES",data:e})}let a=JSON.parse(JSON.stringify(new n.g_(l)));A.myDiagram.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:a});break}case"addPort":case"editModelview":break;case"editRelationship":{let t=e,i=R.findLinkForKey(t.key);if(!i)break;i&&(i.isSelected=!0);let l=i.data;N.findLinkByViewId(t.key);let r=S.findRelationshipView(t.key),a=r.relship,p=a.type;a.cardinalityFrom=a.getCardinalityFrom(),a.cardinalityTo=a.getCardinalityTo(),""===a.name&&(a.name=" ");let c=t;for(let e in c)"object"!=typeof c[e]&&"function"!=typeof c[e]&&s.A1(e,p)&&(e===d.props.DRAFT&&R.model.setDataProperty(l,"name",c[e]),R.model.setDataProperty(l,e,a[e]));if("Is"===a.name&&(a.relshipkind="Generalization"),a.relshipkind!==d.relkinds.REL){r.setFromArrow2(a.relshipkind),r.setToArrow2(a.relshipkind);let e=r.fromArrow;"None"===e&&(e="");let t=r.toArrow;"None"===t&&(t=""),R.model.setDataProperty(l,"fromArrow",e),R.model.setDataProperty(l,"toArrow",t),R.model.setDataProperty(l,"fromArrowColor",r.fromArrowColor),R.model.setDataProperty(l,"toArrowColor",r.toArrowColor)}S.showCardinality?(R.model.setDataProperty(l,"cardinalityFrom",a.getCardinalityFrom()),R.model.setDataProperty(l,"cardinalityTo",a.getCardinalityTo())):(R.model.setDataProperty(l,"cardinalityFrom",""),R.model.setDataProperty(l,"cardinalityTo",""));let u=JSON.parse(JSON.stringify(new n.w(a)));A.myDiagram.dispatch({type:"UPDATE_RELSHIP_PROPERTIES",data:u}),u=JSON.parse(JSON.stringify(new n.GI(r))),A.myDiagram.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:u});break}case"editObjectview":{let t=e,i=N.findNodeByViewId(t.key),l=S.findObjectView(t.key);i.template2=t.template2,l.template2=t.template2,r.UD(t,i,l,R),S.addObjectView(l),u&&console.log("editObjectview: ",t);let s=JSON.parse(JSON.stringify(new n.g_(l)));A.myDiagram.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:s});let a=[];a.push(new n.Yp(S)),a.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),A.myDiagram.dispatch({type:"UPDATE_MODELVIEW_PROPERTIES",data:t})});return}case"selectDropdown":if("Select Icon"===i.title){if(e.category===d.gojs.C_OBJECT){let t=e,i=R.findNodeForKey(t.key).data,l=i.objectview;if(l){l.icon=i.icon;let e=new n.g_(i.objectview),t=[];t.push(e),t.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),R.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})})}for(let e in null==l?void 0:l.data)"icon"===e&&""!==l[e]&&R.model.setDataProperty(i,e,l[e])}else if(e.category===d.gojs.C_OBJECTTYPE){let t=e,i=t.objecttype,l=(i=A.findObjectType(i.id)).typeview;l.icon=t.icon,l.data.icon=t.icon;let s=new n.mX(l);x.push(s),x.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),R.dispatch({type:"UPDATE_OBJECTTYPEVIEW_PROPERTIES",data:t})})}}else if("Set Layout Scheme"===i.title){let e=i.objectview;if(e){e.groupLayout=i.selected.value+"Layout";let t=new n.g_(e),l=[];l.push(t),l.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),R.dispatch({type:"UPDATE_OBJECTVIEW_PROPERTIES",data:t})})}}else if("New Model"===i.case){let e=null===(c=i.selected)||void 0===c?void 0:c.value,t=A.findMetamodelByName(e),l=i.context;l.args.metamodel=t,i.context.postOperation(l)}else if("Generate Target Metamodel"===i.case){let t;let n=i.context;try{t=e[0]}catch(i){t=e}n.myCurrentObjectview=A.currentModelview.findObjectViewByName(t);let s=A.findMetamodelByName(t);s||(s=new l.E7(p.gj(),t,"")),n.myTargetMetamodel=s,n.myCurrentModelview=A.currentModelview,A.currentModel.targetMetamodelRef=s.id,i.context.postOperation(n)}else if("Add Metamodel"===i.case){let e=i.context,t=null===(h=i.selected)||void 0===h?void 0:h.value,l=A.findMetamodelByName(t),n=e.args.metamodels;for(let e=0;e<(null==n?void 0:n.length);e++){let i=n[e];i.name===t&&(l=i)}e.args.metamodel=l,i.context.postOperation(e)}else if("Replace Metamodel"===i.case){let e=i.context,t=null===(m=i.selected)||void 0===m?void 0:m.value,l=A.findMetamodelByName(t),n=e.args.metamodels;for(let e=0;e<(null==n?void 0:n.length);e++){let i=n[e];i.name===t&&(l=i)}e.args.metamodel=l,i.context.postOperation(e)}else if("Delete Metamodel"===i.case){let e=null===(f=i.selected)||void 0===f?void 0:f.value,t=A.findMetamodelByName(e),l=i.context;l.args.metamodel=t,i.context.postOperation(l)}else if("Clear Metamodel"===i.case){let e=null===(y=i.selected)||void 0===y?void 0:y.value,t=A.findMetamodelByName(e),l=i.context;l.args.metamodel=t,i.context.postOperation(l)}else if("Delete Model"===i.case){let e=null===(g=i.selected)||void 0===g?void 0:g.value,t=A.findModelByName(e),l=i.context;l.args.model=t,i.context.postOperation(l)}else if("Generate Method"===i.case){let e=i.context.myMetamodel,t=null===(v=i.selected)||void 0===v?void 0:v.value,l=e.findMethodTypeByName(t),n=i.context;n.methodType=l,i.context.postOperation(n)}else if("Execute Method"===i.case){let e=i.context.myMetamodel,t=null===(w=i.selected)||void 0===w?void 0:w.value,l=e.findMethodByName(t);l.level=0;let n=i.context;n.args.method=l,i.context.postOperation(n)}else if("Export Task Model"===i.case){let e=i.context,t=null===(b=i.selected)||void 0===b?void 0:b.value,l=A.findModelByName(t),n=e.args.objectview;e.args.objectview=n,e.args.model=l,i.context.postOperation(e)}else if("Add Port"===i.case){let e;let t=null===(T=i.selected)||void 0===T?void 0:T.value,l=i.node,s=l.object;e=s?s.id:l.objRef,s=A.findObject(e);let r=t,d="";switch(r){case"top":d="C";break;case"bottom":d="M";break;case"left":d="I";break;case"right":d="O"}d=prompt("Enter port name",d);let p=s.getPort(r,d);if(p)alert("The port "+d+" on side "+r+" already exists\n Aborted");else{p=s.addPort(r,d);let e=new n.pJ(s),t=[];t.push(e),t.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),R.dispatch({type:"UPDATE_OBJECT_PROPERTIES",data:t})}),a.hr(p,R),R.requestUpdate()}}else if("Change Relationship type"===i.case){let e=null===(j=i.selected)||void 0===j?void 0:j.value,t=E.findRelationshipTypeByName(e),l=A.currentLink;(l=R.findLinkForKey(l.key)).data.relshiptype=t;let s=l.data.relshipRef,r=D.findRelationship(s);r||(r=A.findRelationshipType(s));let a=r.type;r.name===a.name&&(r.name=t.name,R.model.setDataProperty(l.data,"name",r.name)),r.type=t;let d=[];d.push(new n.w(r)),null==d||d.map(e=>{let t=e&&e;t=JSON.parse(JSON.stringify(t)),R.dispatch({type:"UPDATE_RELSHIP_PROPERTIES",data:t})})}break;case"editRelshipview":{let t=e,i=R.findLinkForKey(t.key);if(!i)break;i&&(i.isSelected=!0),i.data;let l=N.findLinkByViewId(t.key),s=S.findRelationshipView(t.key);l.template2=t.template2,s.template2=t.template2;let r=s.relship.type.typeview;if(R.selection.each(function(t){let i=e,l=i.relshipview;if(l||(l=S.findRelationshipView(i.key)),l){for(let e in null==r?void 0:r.data)if("class"!==e)try{l[e]=i[e]}catch(e){}A.addRelationshipView(l)}}),i&&s){let e=i.data;for(let t in null==r?void 0:r.data){if("template"===t&&""!==s[t]&&R.model.setDataProperty(e,t,s[t]),"template2"===t&&""!==s[t]&&R.model.setDataProperty(e,t,s[t]),"strokecolor"===t&&""!==s[t]&&R.model.setDataProperty(e,t,s[t]),"strokewidth"===t&&s[t]&&R.model.setDataProperty(e,t,s[t]),"textcolor"===t&&""!==s[t]&&R.model.setDataProperty(e,t,s[t]),"textscale"===t&&s[t]&&R.model.setDataProperty(e,t,s[t]),"dash"===t&&""!==s[t]&&R.model.setDataProperty(e,t,s[t]),"routing"===t&&s[t]&&R.model.setDataProperty(e,t,s[t]),"curve"===t&&s[t]&&R.model.setDataProperty(e,t,s[t]),"fromArrow"===t){let i=s[t];""===s[t]&&(i=r.data[t]),"None"===i&&(i=""),R.model.setDataProperty(e,t,i)}if("fromArrowColor"===t&&""!==s[t]&&R.model.setDataProperty(e,t,s[t]),"toArrow"===t){let i=s[t];""===s[t]&&(i=r.data[t]),"None"===i&&(i=""),R.model.setDataProperty(e,t,i)}"toArrowColor"===t&&""!==s[t]&&R.model.setDataProperty(e,t,s[t])}}let a=new n.GI(s);I.push(a),I.map(e=>{let t=e;R.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})});break}case"editTypeview":{let t,i,l,r;let a=e,p=R.findNodeForKey(a.key);if(!p)break;if(p&&(p.isSelected=!0),a.typeview){let e=E.findObjectTypeView(a.typeview.id);if(!e)break;A.addObjectTypeView(e)}if(a.category===d.gojs.C_OBJECTTYPE){let e=A.currentNode;for(let n in l=(t=(e=R.findNodeForKey(e.key)).data).typeview,i=E.findObjectTypeView(null==l?void 0:l.id),null==l?void 0:l.data)"id"!==n&&"name"!==n&&"abstract"!==n&&"category"!==n&&"class"!==n&&(i[n]=a[n],i.data[n]=a[n],R.model.setDataProperty(t,n,a[n]));let s=new n.mX(i);x.push(s),x.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),R.dispatch({type:"UPDATE_OBJECTTYPEVIEW_PROPERTIES",data:t})})}if(a.category===d.gojs.C_OBJECT){if(t=a,!(l=a.typeview)){let e=a.objtypeRef;l=E.findObjectType(e).typeview}for(let e in null==l?void 0:l.data)"id"!==e&&"name"!==e&&"abstract"!==e&&"category"!==e&&"class"!==e&&(l[e]=a[e],l.data[e]=a[e],R.model.setDataProperty(t,e,a[e]));if(l){A.addObjectTypeView(l);let e=new n.mX(l);x.push(e),x.map(e=>{let t=e;t=JSON.parse(JSON.stringify(t)),R.dispatch({type:"UPDATE_OBJECTTYPEVIEW_PROPERTIES",data:t})})}}if(a.category===d.gojs.C_RELSHIPTYPE){let e=(t=R.findLinkForKey(a.key).data).reltype;if((e=E.findRelationshipType(e.id))?(i=e.typeview,i=E.findRelationshipTypeView(i.id),e.typeview=i):(r=t.typeview,i=E.findRelationshipTypeView(r.id)),i){for(let e in i.setFromArrow2(a.relshipkind),i.setToArrow2(a.relshipkind),i.data)if("key"!==e&&"category"!==e&&"abstract"!==e&&"class"!==e&&"relshipkind"!==e){if("fromArrow"===e){let l=i[e];"None"===l&&(l=""),R.model.setDataProperty(t,e,l)}if("toArrow"===e){let l=i[e];"None"===l&&(l=""),R.model.setDataProperty(t,e,l)}if("memberscale"===e){let l=i[e];"None"===i[e]&&(l=1),R.model.setDataProperty(t,e,l)}else i[e]=a[e],i.data[e]=a[e],R.model.setDataProperty(t,e,a[e])}E.addRelationshipTypeView(i),A.addRelationshipTypeView(i);let e=new n.KW(i);_.push(e),_.map(e=>{let t=e;R.dispatch({type:"UPDATE_RELSHIPTYPEVIEW_PROPERTIES",data:t})})}}if(a.category===d.gojs.C_RELATIONSHIP){r=null===(O=(t=R.findLinkForKey(a.key).data).relshipview)||void 0===O?void 0:O.typeview;let e=t.relshipview,i=A.relshiptypeviews;for(let e=0;e<i.length;e++){let l=i[e];if(l.id===(null==r?void 0:r.id)){for(let e in null===(k=t.typeview)||void 0===k?void 0:k.data)l[e]=a[e],l.data[e]=a[e];A.addRelationshipTypeView(l);let e=new n.KW(l);_.push(e),_.map(e=>{let t=e;R.dispatch({type:"UPDATE_RELSHIPTYPEVIEW_PROPERTIES",data:t})})}}e=s.tX(e);let l=new n.GI(e);I.push(l),I.map(e=>{let t=e;R.dispatch({type:"UPDATE_RELSHIPVIEW_PROPERTIES",data:t})}),R.clearSelection();return}R.clearSelection();break}case"connectToSelected":{let e=i.args.nodeFrom,t=(e=N.findNode(e.key)).key,n=S.findObjectView(t);n||(n=A.findObjectView(t));let r=n.object;r||(r=A.findObject(n.objectRef));let a=r.type,c=i.args.nodesTo,u=i.selected.value;for(let t=0;t<c.length;t++){let i=c[t];if(i){let t,c;let h=i.key;i=N.findNode(h);let m=S.findObjectView(h),f=m.object;if(!f)continue;let y=f.type,g=u&&u;if(!(t=g===d.types.AKM_REFERS_TO?A.findRelationshipTypeByName(d.types.AKM_REFERS_TO):A.findRelationshipTypeByName2(g,a,y)))continue;let v=D.findRelationship2(r,f,g,t);if(v&&!v.markedAsDeleted){let e=S.findRelationshipViewsByRel(v),t=!1;for(let i=0;i<e.length;i++)if(!e[i].markedAsDeleted){t=!0;break}if(t)continue}else v=new l.CK(p.gj(),t,r,f,g,""),D.addRelationship(v),A.addRelationship(v);if(0===S.findRelationshipViewsByRel(v).length&&!c){let l={myDiagram:R,myMetis:A,myModel:D,myModelview:S,reltype:t,relTypename:g,fromObjview:n,toObjview:m,nodeFrom:e,nodeTo:i};s.ci(v,l)}}}}}}},9619:(e,t,i)=>{"use strict";i.d(t,{Bv:()=>f,Pw:()=>g,S4:()=>u,sC:()=>m,tF:()=>v,vi:()=>h,vv:()=>y});var l=i(2588),n=i(7089),s=i(7662),r=i(3022),a=i(2210),d=i(1457);let p=!1,c=!1;function u(e,t){let i;p&&console.log("16 metamodel",e);let r=[],a=null==e?void 0:e.generatedFromModelRef,c=null==t?void 0:t.findModel(a),u=[],h=(null==e?void 0:e.name)===d.core.AKM_CORE_MM;if(e){let t=[];if(u=e.includeSystemtypes?null==e?void 0:e.objecttypes:null==e?void 0:e.objecttypes0)for(let i=0;i<u.length;i++){let l=u[i];if(l){if(l.name===d.types.AKM_ENTITY_TYPE){if(!h&&e.includeSystemtypes)continue;t.push(l.name)}l.abstract||t.push(l.name)}}i=[...new Set(t)],p&&console.log("32 MM objecttypes",i)}if(c){let e=c.metamodel,t=[],i=null==e?void 0:e.objecttypes;if(i)for(let e=0;e<i.length;e++){let l=i[e];l&&t.push(l.name)}r=[...new Set(t)],p&&console.log("47 objecttypes",r)}let m=new s.q0(l.gj(),"myPaletteModel",null),f=u;if(f&&f.sort(l.UD),p&&console.log("54 objecttypes",f),f){let a=!1,c=[];for(let t=0;t<f.length;t++){a=!1;let n=f[t];if(p&&console.log("60 objtype",n),n&&!n.markedAsDeleted){if(n.abstract&&n.name===d.types.AKM_ENTITY_TYPE){if(h)i.push(n.name);else{if(h||e.includeSystemtypes)continue;i.push(n.name)}}if("Entity0"!==n.nameId){if("Datatype"===n.name&&(a=!0),!a&&!(i&&l.NF(i,n.name))&&"Generic"!==n.name&&"Container"!==n.name&&"Label"!==n.name&&r&&l.NF(r,n.name))continue;c.push(n)}}}p&&console.log("78 otypes",c);let u=c.length;for(let h=0;h<u;h++){let u=c[h];if(!a&&!(i&&l.NF(i,u.name))&&"Generic"!==u.name&&"Container"!==u.name&&"Label"!==u.name&&r&&l.NF(r,u.name))continue;let f=l.gj(),y=u.name,g=new n.Jo(f,y,u,"");if(""===g.id&&(g.id=f),""===g.name&&(g.name=y),!g.type){let t=e.findObjectType(g.type.id);g.type=t}if(g.isDeleted())continue;p&&console.log("103 obj, objtype",g,u);let v=new n.wN(l.gj(),g.name,g,"",null),w=u.getDefaultTypeView();(null==w?void 0:w.data.viewkind)==="Container"&&(u.viewkind="Container");let b=t.findObjectTypeByName(u.name);w||(w=b?b.getDefaultTypeView():u.newDefaultTypeView("Object")),v.setTypeView(w);let T=new s.mC(v.id,m,v);T.loadNodeContent(m),p&&console.log("121 node",u,v,T),T.isGroup=u.isContainer(),T.isGroup&&(T.category=d.gojs.C_OBJECT),m.addNode(T)}}return p&&console.log("128 Objecttype palette",m),m}function h(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=new s.q0(l.gj(),"myObjectPalette",null);p&&console.log("134 ui_buildmodels objects",e);let r=[];for(let a=0;a<(null==e?void 0:e.length);a++){let d=!1,u=e[a];p&&console.log("142 obj",u);let h=null==u?void 0:u.getObjectType();if(!h||!h.getDefaultTypeView)continue;let m=null==h?void 0:h.getDefaultTypeView(),f=new n.wN(l.gj(),null==h?void 0:h.getName(),u,"",null);if(f.setTypeView(m),p&&console.log("147 obj, objview:",u,f),!t&&u.isDeleted()&&(d=!1),t&&u.markedAsDeleted&&(f.strokecolor="red",d=!0),c||u.type||(p&&console.log("160 obj",u),u.markedAsDeleted=!0),c&&!u.type&&(p&&console.log("166 obj",u),f.strokecolor="green",d=!0),!u.markedAsDeleted&&u.type&&(d=!0),d){let e=new s.mC(f.id,i,f);e.isGroup=null==h?void 0:h.isContainer();let t=null==m?void 0:m.data,l=new n.Cj;for(let e in t)l[e]=t[e];""!==u.fillcolor&&void 0!==u.fillcolor&&(l.fillcolor=u.fillcolor),e.addData(l),r.push(e)}}return r}function m(e,t,i,u,h,m){var f,y,g,v,w,b,T,j,O,k,M,R,A;if(!t||!i)return;let E=i.showRelshipNames;void 0==E&&(E=!0);let D=i.id,S=new s.q0(D,"myModel",i),N=null==i?void 0:i.getObjectViews();if(N){let t=null==i?void 0:i.focusObjectview;for(let l=0;l<N.length;l++){let n,r=!1,a=N[l];if(!a.id||a.name===a.id)continue;let b=a.object;if(e.findObject(null==b?void 0:b.id)&&(a.id===(null==t?void 0:t.id)?a.isSelected=!0:a.isSelected=!1,(n=null==b?void 0:b.type)||(n=e.findObjectType(b.typeRef)),n?("Metamodel"===n.name&&(i.isMetamodel=!0),b&&(null==b?void 0:b.markedAsDeleted)==void 0&&(b.markedAsDeleted=!1),(null==b?void 0:b.markedAsDeleted)&&(a.markedAsDeleted=null==b?void 0:b.markedAsDeleted),a.name=null==b?void 0:b.name,(null==b?void 0:null===(f=b.type)||void 0===f?void 0:f.name)==="Label"&&(a.name=b.text),a.viewkind===d.viewkinds.CONT&&(a.isGroup=!0),u&&a.markedAsDeleted&&((null===(y=a.object)||void 0===y?void 0:y.markedAsDeleted)?a.strokecolor="orange":a.strokecolor="pink",r=!0),m&&a.modified&&((null===(g=a.object)||void 0===g?void 0:g.modified)&&(a.strokecolor="green",a.strokewidth=2),r=!0),h&&!a.object&&(a.strokecolor="blue",a.fillcolor||(a.fillcolor="lightgrey"),r=!0),!c||(null===(v=a.object)||void 0===v?void 0:v.type)||(p&&console.log("262 objview",a),a.strokecolor="green",a.fillcolor&&(a.fillcolor="lightgrey"),r=!0),!a.markedAsDeleted&&a.object&&(r=!0)):(r=!0,c=!0),r)){if(!u&&a.markedAsDeleted||!h&&!a.object||!c&&!(null===(w=a.object)||void 0===w?void 0:w.type))continue;let t=new s.mC(a.id,S,a);t.scale=a.scale,S.addNode(t),t.name=a.name;let i=t.object,l=null==i?void 0:i.type;l||(l=e.findObjectType(i.typeRef));let n=null==l?void 0:l.getDefaultTypeView();n&&(t.fillcolor||(t.fillcolor=n.fillcolor),""===t.fillcolor2&&(t.fillcolor2=n.fillcolor2),""===t.strokecolor&&(t.strokecolor=n.strokecolor),""===t.strokecolor2&&(t.strokecolor2=n.strokecolor2),""===t.textcolor&&(t.textcolor=n.textcolor),""===t.textcolor2&&(t.textcolor2=n.textcolor2),""===t.icon&&(t.icon=n.icon),""===t.image&&(t.image=n.image),""===t.viewkind&&(t.viewkind=n.viewkind),""===t.template&&(t.template=n.template))}}S.fixGoModel();let l=S.nodes;for(let s=0;s<l.length;s++){let r=l[s];if(!r.object)continue;let a=r.objectview;if(!(a=i.findObjectView(a.id))||!a.size||""===a.size)continue;a.id===(null==t?void 0:t.id)&&(a.isSelected=!0,r.isSelected=!0);let d=r.object;if(!e.findObject(null==d?void 0:d.id))continue;let p=d.type;(null==p?void 0:p.name)==="Label"&&(r.text=a.name);let c=a.typeview;c&&c instanceof n.GC?(c=e.findObjectTypeView(c.id),a.setTypeView(c),r.typeview=a.typeview,r.name=a.name,r.loadNodeContent(S),r.name=a.name,r.object.proposedType&&(r.typename=r.object.proposedType),S.addNode(r)):!c&&(c=null===(T=a.object)||void 0===T?void 0:null===(b=T.type)||void 0===b?void 0:b.getDefaultTypeView())&&(c=e.findObjectTypeView(c.id),a.setTypeView(c))}}let P=[],C=i&&i.getRelationshipViews();if(C){for(let e=0;e<(null==C?void 0:C.length);e++){let t=C[e];t.id&&(t.markedAsDeleted||P.push(t))}let e=[],l=(C=P).length;for(let n=0;n<l;n++){let l=!1,d=C[n];if(((null==d?void 0:d.fromArrow)==="None"||(null==d?void 0:d.fromArrow)===" ")&&(d.fromArrow=""),((null==d?void 0:d.toArrow)==="None"||(null==d?void 0:d.toArrow)===" ")&&(d.toArrow=""),(null===(j=d.points)||void 0===j?void 0:j.length)==4&&(d.points=[]),!d.template){let e=d.relship,i=e.type,l=t.getMetamodel();if(!i&&(i=l.findRelationshipType(e.typeRef))){let e=i.typeview;d.template=e.template}}let m=d.fromObjview;if(!m||!i.findObjectView(m.id))continue;let f=d.toObjview;if(!f||!i.findObjectView(f.id))continue;let y=d.relship;y&&(void 0==y.markedAsDeleted&&(y.markedAsDeleted=!1),y.markedAsDeleted&&(d.markedAsDeleted=null==y?void 0:y.markedAsDeleted),d.name=y.name);let g="black";if(u&&(d.markedAsDeleted&&(null===(O=d.relship)||void 0===O?void 0:O.markedAsDeleted)?(g="red",l=!0):d.markedAsDeleted?(g="rgb(220,0,150)",l=!0):(null===(k=d.relship)||void 0===k?void 0:k.markedAsDeleted)&&(g="orange",l=!0)),h&&!d.relship&&(g="blue",l=!0),!c||(null===(M=d.relship)||void 0===M?void 0:M.type)||(g="green",l=!0),!d.markedAsDeleted&&d.relship&&(l=!0),u||h||c||!d||""!==d.strokecolor||(g=null==d?void 0:null===(R=d.typeview)||void 0===R?void 0:R.strokecolor),g||(g="black"),!1==d.visible&&(l=!1),l){d.strokewidth||(d.strokewidth=1),d.setFromArrow2(null==y?void 0:y.relshipkind),d.setToArrow2(null==y?void 0:y.relshipkind),d=a.tX(d),P.push(d);let t=new r.GI(d);e.push(t);let l=new s.gR(d.id,S,d),n=l.name;p&&console.log("382 modelview, link:",i,l),l.loadLinkContent(S),l.name=n,l.curve=d.curve?d.curve:"None",l.routing=d.routing?d.routing:"Normal",E||(l.name=" "),(u||h||c)&&(l.strokecolor=d.strokecolor?d.strokecolor:null===(A=d.typeview)||void 0===A?void 0:A.strokecolor,l.strokewidth=d.strokewidth),S.addLink(l)}}}return i.relshipviews=P=l.EL(P),p&&console.log("445 myGoModel",S),S}function f(){p&&console.log("415 buildGoMetaPalette");let e=new s.q0(l.gj(),"myMetaPalette",null),t=[],i=new s.c7("01","objecttype","Object type","Object type","");t.push(i);let n=JSON.parse("[]");return e.nodes=t,e.links=n,p&&console.log("428 myGoMetaPalette",e),e}function y(e,t,i){if(e&&(p&&console.log("520 metamodel",e),e.objecttypes=l.Ip(null==e?void 0:e.objecttypes,"id"),e.objecttypes)){p&&console.log("438 metamodel",e);let r=new s.q0(l.gj(),"myMetamodel",null),a=null==e?void 0:e.getObjectTypes();if(a){p&&console.log("442 objtypes",a);for(let n=0;n<a.length;n++){let d=!1,c=a[n],u=c.outputreltypes;for(let t=0;t<(null==u?void 0:u.length);t++){let i=u[t];i&&(p&&console.log("450 reltype",i),!i.fromObjtype&&i.fromobjtypeRef&&(i.fromObjtype=e.findObjectType(i.fromobjtypeRef)),!i.toObjtype&&i.toobjtypeRef&&(i.toObjtype=e.findObjectType(i.toobjtypeRef)))}let h=c.typeview,m=null==h?void 0:h.strokecolor;if(null==h||h.fillcolor,c&&(c.markedAsDeleted?(p&&console.log("468 objtype",c),t&&c.markedAsDeleted&&(m="orange",d=!0)):d=!0,i&&(p&&console.log("493 ui_buildmodels ",i,c.modified,c),c.modified?c.strokecolor="green":c.strokewidth=2,d=!0),d)){c.typeview||(c.typeview=c.newDefaultTypeView("Object"));let t=new s._e(l.gj(),c);t.loadNodeContent(e),t.strokecolor=m,p&&console.log("484 objtype, node",c,t),r.addNode(t)}}}let c=e.relshiptypes;if(p&&console.log("491 relshiptypes",c),c)for(let i=0;i<c.length;i++){var n;let a=!1,u=c[i];"isRelatedTo"===u.name&&(u.name="generic")," "===u.fromArrow&&(u.fromArrow="");let h=null===(n=u.typeview)||void 0===n?void 0:n.strokecolor;if(u.cardinality.length>0&&(u.cardinalityFrom=u.getCardinalityFrom(),u.cardinalityTo=u.getCardinalityTo()),void 0===u.markedAsDeleted&&(u.markedAsDeleted=!1),u&&!u.markedAsDeleted?a=!0:t&&u.markedAsDeleted&&(h="orange",a=!0),a){p&&console.log("521 reltype",u),u.typeview||(u.typeview=u.newDefaultTypeView(u.relshipkind)),u.fromObjtype||(u.fromObjtype=e.findObjectType(u.fromobjtypeRef)),u.toObjtype||(u.toObjtype=e.findObjectType(u.toobjtypeRef)),(" "===u.typeview.fromArrow||"None"===u.typeview.fromArrow)&&(u.typeview.fromArrow=""),(" "===u.typeview.toArrow||"None"===u.typeview.toArrow)&&(u.typeview.toArrow="");let t=l.gj(),i=new s.UB(t,r,u);p&&console.log("530 reltype, link",u,i);let n=u.typeview.strokewidth;if(n||(n=1),i.loadLinkContent()){let t=u.typeview.routing;t&&"Normal"!==t||(i.routing=e.routing);let l=u.typeview.linkcurve;(l||"None"===l)&&(i.curve=e.linkcurve),i.relshipkind=u.relshipkind,i.strokewidth=n,i.strokecolor=h,i.category=d.gojs.C_RELSHIPTYPE,p&&console.log("541 link",i.name,i),r.addLink(i)}}}return p&&console.log("653 myGoMetamodel",r),r}}function g(e){let t;let i=e.findMetamodelByName(d.admin.AKM_ADMIN_MM);if(!i){p&&console.log("555 No Admin Metamodel found!");return}let s=i.findObjectTypeByName(d.admin.AKM_MODELSUITE);if(!s){let e=i.findObjectTypeByName(d.admin.AKM_PROJECT);e&&(e.name=d.admin.AKM_MODELSUITE,s=e)}if(!s){p&&console.log("561 No ModelSuite type found in the Admin Metamodel!");return}{let a=i.findRelationshipTypeByName(d.admin.AKM_GENERATEDFROM_MODEL);a&&(t=a.typeview)&&(t.toArrow="",t.strokecolor="red",t.fromArrow="BackwardOpenTriangle",t.toArrow="None");let c=e.findModelByName(d.admin.AKM_ADMIN_MODEL),u=null;if(c||(c=new n.DM(l.gj(),d.admin.AKM_ADMIN_MODEL,i,""),e.addModel(c),(u=new n.it(l.gj(),"_ADMIN",c,"")).layout="LayeredDigraph",c.addModelView(u),e.addModelView(u)),c){let i;p&&console.log("585 adminModel",c),c.objects=null,c.relships=null,(u=c.modelviews?c.modelviews[0]:null)&&(u.objectviews=null,u.relshipviews=null);let a=e.findObjectTypeByName(d.admin.AKM_METAMODEL),h=e.findObjectTypeByName(d.admin.AKM_MODEL),m=e.findObjectTypeByName(d.admin.AKM_MODELVIEW),f=e.findRelationshipTypeByName(d.admin.AKM_HAS_METAMODEL),y=e.findRelationshipTypeByName(d.admin.AKM_HAS_MODEL),g=e.findRelationshipTypeByName(d.admin.AKM_HAS_MODELVIEW),v=e.findRelationshipTypeByName(d.admin.AKM_REFERSTO_METAMODEL),w=e.findRelationshipTypeByName(d.admin.AKM_GENERATEDFROM_MODEL),b=new n.Jo(l.gj(),d.admin.AKM_MODELSUITE,s,"");b.metisId=e.id,b.name=e.name,b.description=e.description,b.allowGenerateCurrentMetamodel=e.allowGenerateCurrentMetamodel,c.addObject(b),e.addObject(b),(i=new n.wN(l.gj(),b.name,b,"")).fillcolor="lightgrey",b.addObjectView(i),u.addObjectView(i),e.addObjectView(i);let T=e.metamodels;for(let t=0;t<T.length;t++){let s=T[t];if(s){let t;if(s.name===d.admin.AKM_ADMIN_MM)continue;if(!t){(t=new n.Jo(l.gj(),s.name,a,s.description)).metamodelId=s.id,c.addObject(t),e.addObject(t);let w=new n.CK(l.gj(),f,b,t,d.admin.AKM_HAS_METAMODEL,"");c.addRelationship(w),e.addRelationship(w);let T=new n.wN(l.gj(),t.name,t,"");T.fillcolor="lightblue",t.addObjectView(T),u.addObjectView(T),e.addObjectView(T);let j=new n.Zc(l.gj(),w.name,w,"");j.setFromObjectView(i),j.setToObjectView(T),w.addRelationshipView(j),u.addRelationshipView(j),e.addRelationshipView(j);let O=e.models;p&&console.log("651 models",O);for(let p=0;p<O.length;p++){var r;let f=O[p];if(f&&(null===(r=f.metamodel)||void 0===r?void 0:r.id)===s.id){let s;if(!s){(s=new n.Jo(l.gj(),f.name,h,f.description)).modelId=f.id,c.addObject(s),e.addObject(s);let r=new n.wN(l.gj(),s.name,s,"");r.fillcolor="lightgreen",s.addObjectView(r),u.addObjectView(r),e.addObjectView(r);let p=f.metamodel;if(p&&c.findObjectByTypeAndName(a,null==p?void 0:p.name)){let i=new n.CK(l.gj(),v,s,t,d.admin.AKM_REFERSTO_METAMODEL,"");c.addRelationship(i),e.addRelationship(i);let a=new n.Zc(l.gj(),i.name,i,"");a.setFromObjectView(r),a.setToObjectView(T),i.addRelationshipView(a),a.strokecolor="blue",u.addRelationshipView(a),e.addRelationshipView(a)}let w=new n.CK(l.gj(),y,b,s,d.admin.AKM_HAS_MODEL,"");c.addRelationship(w),e.addRelationship(w);let j=new n.Zc(l.gj(),w.name,w,"");j.setFromObjectView(i),j.setToObjectView(r),w.addRelationshipView(j),u.addRelationshipView(j),e.addRelationshipView(j);let O=f.modelviews;for(let t=0;t<(null==O?void 0:O.length);t++){let i=O[t];if(i){let t;if(!t){(t=new n.Jo(l.gj(),i.name,m,i.description)).modelviewId=i.id,t.layout=i.layout,t["link routing"]=i.routing,t["link curve"]=i.linkcurve,t.showCardinality=i.showCardinality,t.askForRelshipName=i.askForRelshipName,t.includeInheritedReltypes=i.includeInheritedReltypes,c.addObject(t),e.addObject(t);let a=new n.wN(l.gj(),t.name,t,"");a.fillcolor="pink",t.addObjectView(a),u.addObjectView(a),e.addObjectView(a);let p=new n.CK(l.gj(),g,s,t,d.admin.AKM_HAS_MODELVIEW,"");p.setFromObject(s),p.setToObject(t),c.addRelationship(p),e.addRelationship(p);let h=new n.Zc(l.gj(),p.name,p,"");h.setFromObjectView(r),h.setToObjectView(a),p.addRelationshipView(h),u.addRelationshipView(h),e.addRelationshipView(h)}}}}}}}}}for(let i=0;i<T.length;i++){let s=T[i];if(s.generatedFromModelRef){let i=s.generatedFromModelRef,r=e.findModel(i);if(r){let i=c.findObjectByTypeAndName(a,s.name),m=c.findObjectByTypeAndName(h,r.name),f=new n.CK(l.gj(),w,i,m,d.admin.AKM_GENERATEDFROM_MODEL,"");f.setFromObject(i),f.setToObject(m),c.addRelationship(f),e.addRelationship(f);let y=new n.Zc(l.gj(),f.name,f,"");if(y.typeview=t,p&&console.log("772 genRelview",y),i&&m&&f&&y){let t=i.objectviews[0],l=m.objectviews[0];y.setFromObjectView(t),y.setToObjectView(l),y.strokecolor="red",y.toArrow="None",y.toArrowColor="black",y.fromArrow="BackwardOpenTriangle",f.addRelationshipView(y),u.addRelationshipView(y),p&&console.log("785 adminModelview",u),e.addRelationshipView(y)}}}}}return c}}function v(e,t,i){let s=i.findModelViewByName("_INSTANCES");s?(s.objectviews=null,s.relshipviews=null):((s=new n.it(l.gj(),"_INSTANCES",i,"")).layout="LayeredDigraph",i.addModelView(s),e.addModelView(s));let a=null==i?void 0:i.objects;for(let e=0;e<(null==a?void 0:a.length);e++){let t=a[e];if(t&&!t.markedAsDeleted){let e=new n.wN(l.gj(),t.name,t,"");null==s||s.addObjectView(e)}}let d=null==i?void 0:i.relships;for(let e=0;e<(null==d?void 0:d.length);e++){let t=d[e];if(t&&!t.markedAsDeleted){let e=null==s?void 0:s.findObjectViewsByObject(t.fromObject),i=null==s?void 0:s.findObjectViewsByObject(t.toObject),r=new n.Zc(l.gj(),t.name,t,"");e&&e.length>0&&i&&i.length>0&&(r.fromObjview=e[0],r.toObjview=i[0],null==s||s.addRelationshipView(r))}}if(s){let i={metis:new r.io(e,!0)};t({type:"LOAD_TOSTORE_PHDATA",data:i=JSON.parse(JSON.stringify(i))})}return s}}},e=>{var t=t=>e(e.s=t);e.O(0,[938,747,230,710,843,958,193,98,451,294,199,255,51,636,593,792],()=>t(5092)),_N_E=e.O()}]);